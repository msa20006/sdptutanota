{"version":3,"file":"UsageOptInNews-CSQVAKPp.js","names":["newsModel: NewsModel","usageTestModel: UsageTestModel","newsId: NewsId","optedIn?: boolean","m","buttonAttrs: Array<ButtonAttrs>"],"sources":["../../src/common/misc/news/items/UsageOptInNews.ts"],"sourcesContent":["import { NewsListItem } from \"../NewsListItem.js\"\nimport m, { Children } from \"mithril\"\nimport { NewsId } from \"../../../api/entities/tutanota/TypeRefs.js\"\nimport { locator } from \"../../../api/main/CommonLocator.js\"\nimport { InfoLink, lang } from \"../../LanguageViewModel.js\"\nimport { Dialog } from \"../../../gui/base/Dialog.js\"\nimport { Button, ButtonAttrs, ButtonType } from \"../../../gui/base/Button.js\"\nimport { NewsModel } from \"../NewsModel.js\"\nimport { UsageTestModel } from \"../../UsageTestModel.js\"\nimport { MoreInfoLink } from \"../MoreInfoLink.js\"\n\n/**\n * News item that informs users about the usage data opt-in.\n */\nexport class UsageOptInNews implements NewsListItem {\n\tconstructor(private readonly newsModel: NewsModel, private readonly usageTestModel: UsageTestModel) {}\n\n\tisShown(): Promise<boolean> {\n\t\treturn Promise.resolve(locator.usageTestModel.showOptInIndicator())\n\t}\n\n\trender(newsId: NewsId): Children {\n\t\tconst closeAction = (optedIn?: boolean) => {\n\t\t\tthis.newsModel\n\t\t\t\t.acknowledgeNews(newsId.newsItemId)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (optedIn) {\n\t\t\t\t\t\tDialog.message(\"userUsageDataOptInThankYouOptedIn_msg\")\n\t\t\t\t\t} else if (optedIn !== undefined) {\n\t\t\t\t\t\tDialog.message(\"userUsageDataOptInThankYouOptedOut_msg\")\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(m.redraw)\n\t\t}\n\n\t\tconst buttonAttrs: Array<ButtonAttrs> = [\n\t\t\t{\n\t\t\t\tlabel: \"decideLater_action\",\n\t\t\t\tclick: () => closeAction(),\n\t\t\t\ttype: ButtonType.Secondary,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"deactivate_action\",\n\t\t\t\tclick: () => {\n\t\t\t\t\tconst decision = false\n\t\t\t\t\tthis.usageTestModel.setOptInDecision(decision).then(() => closeAction(decision))\n\t\t\t\t},\n\t\t\t\ttype: ButtonType.Secondary,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"activate_action\",\n\t\t\t\tclick: () => {\n\t\t\t\t\tconst decision = true\n\t\t\t\t\tthis.usageTestModel.setOptInDecision(decision).then(() => closeAction(decision))\n\t\t\t\t},\n\t\t\t\ttype: ButtonType.Primary,\n\t\t\t},\n\t\t]\n\n\t\treturn m(\".full-width\", [\n\t\t\tm(\".h4\", lang.get(\"userUsageDataOptIn_title\")),\n\t\t\tm(\".pb\", lang.get(\"userUsageDataOptInExplanation_msg\")),\n\t\t\tm(\"ul.usage-test-opt-in-bullets\", [\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement1_msg\")),\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement2_msg\")),\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement3_msg\")),\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement4_msg\")),\n\t\t\t]),\n\t\t\tm(MoreInfoLink, { link: InfoLink.Privacy }),\n\t\t\tm(\n\t\t\t\t\".flex-end.flex-no-grow-no-shrink-auto.flex-wrap\",\n\t\t\t\tbuttonAttrs.map((a) => m(Button, a)),\n\t\t\t),\n\t\t])\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAca,iBAAN,MAA6C;CACnD,YAA6BA,WAAuCC,gBAAgC;EA6DpG,KA7D6B;EA6D5B,KA7DmE;CAAkC;CAEtG,UAA4B;AAC3B,SAAO,QAAQ,QAAQ,QAAQ,eAAe,oBAAoB,CAAC;CACnE;CAED,OAAOC,QAA0B;EAChC,MAAM,cAAc,CAACC,YAAsB;AAC1C,QAAK,UACH,gBAAgB,OAAO,WAAW,CAClC,KAAK,MAAM;AACX,QAAI,QACH,QAAO,QAAQ,wCAAwC;SAC7C,YAAY,UACtB,QAAO,QAAQ,yCAAyC;GAEzD,EAAC,CACD,KAAKC,gBAAE,OAAO;EAChB;EAED,MAAMC,cAAkC;GACvC;IACC,OAAO;IACP,OAAO,MAAM,aAAa;IAC1B,MAAM,WAAW;GACjB;GACD;IACC,OAAO;IACP,OAAO,MAAM;KACZ,MAAM,WAAW;AACjB,UAAK,eAAe,iBAAiB,SAAS,CAAC,KAAK,MAAM,YAAY,SAAS,CAAC;IAChF;IACD,MAAM,WAAW;GACjB;GACD;IACC,OAAO;IACP,OAAO,MAAM;KACZ,MAAM,WAAW;AACjB,UAAK,eAAe,iBAAiB,SAAS,CAAC,KAAK,MAAM,YAAY,SAAS,CAAC;IAChF;IACD,MAAM,WAAW;GACjB;EACD;AAED,SAAO,gBAAE,eAAe;GACvB,gBAAE,OAAO,KAAK,IAAI,2BAA2B,CAAC;GAC9C,gBAAE,OAAO,KAAK,IAAI,oCAAoC,CAAC;GACvD,gBAAE,gCAAgC;IACjC,gBAAE,MAAM,KAAK,IAAI,mCAAmC,CAAC;IACrD,gBAAE,MAAM,KAAK,IAAI,mCAAmC,CAAC;IACrD,gBAAE,MAAM,KAAK,IAAI,mCAAmC,CAAC;IACrD,gBAAE,MAAM,KAAK,IAAI,mCAAmC,CAAC;GACrD,EAAC;GACF,gBAAE,cAAc,EAAE,MAAM,SAAS,QAAS,EAAC;GAC3C,gBACC,mDACA,YAAY,IAAI,CAAC,MAAM,gBAAE,QAAQ,EAAE,CAAC,CACpC;EACD,EAAC;CACF;AACD"}