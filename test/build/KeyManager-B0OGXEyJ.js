
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { mithril_default } from "./mithril-Csg4iNnm.js";
import { mod } from "./dist-CJHwsXKY.js";
import { assertMainOrNodeBoot, isAppleDevice } from "./Env-D5xGlXfw.js";
import { Keys } from "./TutanotaConstants-3bwAESYA.js";

//#region ../src/common/misc/KeyManager.ts
assertMainOrNodeBoot();
const TABBABLE = "button, input, textarea, div[contenteditable='true'], [tabindex='0'], a, [role=button], [role=input]";
function keyboardEventToKeyPress(event) {
	const ctrlOrCmd = isAppleDevice() ? event.metaKey : event.ctrlKey;
	return {
		key: event.key,
		ctrlOrCmd,
		shift: event.shiftKey,
		alt: event.altKey,
		ctrl: !ctrlOrCmd && event.ctrlKey,
		meta: !ctrlOrCmd && event.metaKey
	};
}
function useKeyHandler(e, onKey) {
	const key = keyboardEventToKeyPress(e);
	return onKey != null ? onKey(key) : true;
}
function isFocusable(e) {
	if ("disabled" in e && !!e.disabled) return false;
	if (e.tabIndex === -1) return false;
	return e.style.display !== "none" && e.closest("[hidden]:not([hidden=false]), [aria-hidden]:not([aria-hidden=false]), [inert]:not([inert=false])") == null;
}
function focusPrevious(dom) {
	const tabbable = Array.from(dom.querySelectorAll(TABBABLE)).filter(isFocusable);
	const selected = tabbable.find((e) => document.activeElement === e);
	if (selected) {
		const selection = window.getSelection();
		if (selection && selection.focusNode && (selection.focusNode.nodeName === "LI" || selection.focusNode.parentNode && selection.focusNode.parentNode.nodeName === "LI")) return true;
else {
			tabbable[mod(tabbable.indexOf(selected) - 1, tabbable.length)].focus();
			return false;
		}
	} else if (tabbable.length > 0) {
		tabbable[tabbable.length - 1].focus();
		return false;
	}
	return true;
}
function focusNext(dom) {
	const tabbable = Array.from(dom.querySelectorAll(TABBABLE)).filter(isFocusable);
	const selected = tabbable.find((e) => document.activeElement === e);
	if (selected) {
		const selection = window.getSelection();
		if (selection && selection.focusNode && (selection.focusNode.nodeName === "LI" || selection.focusNode.parentNode && selection.focusNode.parentNode.nodeName === "LI")) return true;
else {
			tabbable[mod(tabbable.indexOf(selected) + 1, tabbable.length)].focus();
			return false;
		}
	} else if (tabbable.length > 0) {
		tabbable[0].focus();
		return false;
	}
	return true;
}
function createKeyIdentifier(key, modifiers) {
	return key + (modifiers?.ctrlOrCmd ? "X" : "") + (modifiers?.ctrl ? "C" : "") + (modifiers?.alt ? "A" : "") + (modifiers?.shift ? "S" : "") + (modifiers?.meta ? "M" : "");
}
var KeyManager = class {
	keyToShortcut;
	keyToModalShortcut;
	desktopShortcuts;
	isHelpOpen = false;
	constructor() {
		const helpShortcut = {
			key: Keys.F1,
			exec: () => this.openF1Help(),
			help: "showHelp_action"
		};
		const helpId = createKeyIdentifier(helpShortcut.key.code);
		this.keyToShortcut = new Map([[helpId, helpShortcut]]);
		this.keyToModalShortcut = new Map([[helpId, helpShortcut]]);
		this.desktopShortcuts = [];
		if (!window.document.addEventListener) return;
		window.document.addEventListener("keydown", (e) => this.handleKeydown(e), false);
	}
	handleKeydown(e) {
		if (!e.isComposing) {
			const keysToShortcuts = this.keyToModalShortcut.size > 1 ? this.keyToModalShortcut : this.keyToShortcut;
			const keyPress = keyboardEventToKeyPress(e);
			const shortcut = keyPress.key ? keysToShortcuts.get(createKeyIdentifier(e.key.toLowerCase(), keyPress)) : null;
			if (shortcut != null && (shortcut.enabled == null || shortcut.enabled())) {
				if (shortcut.exec(keyPress) !== true) e.preventDefault();
			}
			mithril_default.redraw();
		}
	}
	/**
	* open a dialog listing all currently active shortcuts
	* @param forceBaseShortcuts set to true for the special case where the dialog is opened
	* from the support dropdown (which registers its own shortcuts as modal shortcuts)
	*/
	openF1Help(forceBaseShortcuts = false) {
		if (this.isHelpOpen) return;
		this.isHelpOpen = true;
		const shortcutsToShow = this.keyToModalShortcut.size > 1 && !forceBaseShortcuts ? Array.from(this.keyToModalShortcut.values()) : [...this.keyToShortcut.values(), ...this.desktopShortcuts];
		import("./ShortcutDialog-DjCZjOxh.js").then(({ showShortcutDialog }) => showShortcutDialog(shortcutsToShow)).then(() => this.isHelpOpen = false);
	}
	registerShortcuts(shortcuts) {
		this.applyOperation(shortcuts, (id, s) => this.keyToShortcut.set(id, s));
	}
	unregisterShortcuts(shortcuts) {
		this.applyOperation(shortcuts, (id, _) => this.keyToShortcut.delete(id));
	}
	registerDesktopShortcuts(shortcuts) {
		this.applyOperation(shortcuts, (_, s) => this.desktopShortcuts.push(s));
	}
	registerModalShortcuts(shortcuts) {
		this.applyOperation(shortcuts, (id, s) => this.keyToModalShortcut.set(id, s));
	}
	unregisterModalShortcuts(shortcuts) {
		this.applyOperation(shortcuts, (id, _) => this.keyToModalShortcut.delete(id));
	}
	/**
	*
	* @param shortcuts list of shortcuts to operate on
	* @param operation operation to execute for every shortcut and its ID
	* @private
	*/
	applyOperation(shortcuts, operation) {
		for (const s of shortcuts) operation(createKeyIdentifier(s.key.code, s), s);
	}
};
function isKeyPressed(key, ...keys) {
	if (key != null) return keys.some((k) => k.code === key.toLowerCase());
	return false;
}
const keyManager = new KeyManager();

//#endregion
export { TABBABLE, focusNext, focusPrevious, isKeyPressed, keyManager, keyboardEventToKeyPress, useKeyHandler };
//# sourceMappingURL=KeyManager-B0OGXEyJ.js.map