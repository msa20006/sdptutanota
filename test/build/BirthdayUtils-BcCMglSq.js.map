{"version":3,"file":"BirthdayUtils-BcCMglSq.js","names":["m: string","birthday: Birthday","birthdayIso: string","birthdayInitializer: Partial<Birthday>","birthday: Partial<Birthday>","oldBirthday: Date"],"sources":["../../src/common/api/common/error/ParsingError.ts","../../src/common/api/common/utils/BirthdayUtils.ts"],"sourcesContent":["//@bundleInto:common-min\n\nimport { TutanotaError } from \"@tutao/tutanota-error\"\n\nexport class ParsingError extends TutanotaError {\n\tconstructor(m: string) {\n\t\tsuper(\"ParsingError\", m)\n\t}\n}\n","import type { Birthday } from \"../../entities/tutanota/TypeRefs.js\"\nimport { createBirthday } from \"../../entities/tutanota/TypeRefs.js\"\nimport { formatSortableDate } from \"@tutao/tutanota-utils\"\nimport { ParsingError } from \"../error/ParsingError\"\n\n/**\n * Converts the birthday object to iso Date format (yyyy-mm-dd) or iso Date without year (--mm-dd)\n */\nexport function birthdayToIsoDate(birthday: Birthday): string {\n\tconst month = (\"0\" + birthday.month).slice(-2)\n\tconst day = (\"0\" + birthday.day).slice(-2)\n\tconst year = birthday.year ? (\"0000\" + birthday.year).slice(-4) : \"-\"\n\treturn `${year}-${month}-${day}`\n}\n\n/**\n * Converts iso Date (yyyy-mm-dd) or Date without year (--mm-dd) into Birthday object.\n */\nexport function isoDateToBirthday(birthdayIso: string): Birthday {\n\t//return new Date(Number(newBirthday.year), Number(newBirthday.month) - 1, Number(newBirthday.day))\n\tconst birthdayInitializer: Partial<Birthday> = {}\n\tif (birthdayIso.startsWith(\"--\")) {\n\t\tconst monthAndDay = birthdayIso.substring(2).split(\"-\")\n\n\t\tif (monthAndDay.length !== 2) {\n\t\t\tthrow new ParsingError(\"invalid birthday without year: \" + birthdayIso)\n\t\t}\n\n\t\tbirthdayInitializer.month = monthAndDay[0]\n\t\tbirthdayInitializer.day = monthAndDay[1]\n\t\tbirthdayInitializer.year = null\n\t} else {\n\t\tconst yearMonthAndDay = birthdayIso.split(\"-\")\n\n\t\tif (yearMonthAndDay.length !== 3) {\n\t\t\tthrow new ParsingError(\"invalid birthday: \" + birthdayIso)\n\t\t}\n\n\t\tbirthdayInitializer.year = yearMonthAndDay[0]\n\t\tbirthdayInitializer.month = yearMonthAndDay[1]\n\t\tbirthdayInitializer.day = yearMonthAndDay[2]\n\t}\n\n\tif (!isValidBirthday(birthdayInitializer)) {\n\t\tthrow new ParsingError(\"Invalid birthday format: \" + birthdayIso)\n\t}\n\n\treturn createBirthday(birthdayInitializer)\n}\n\nexport function isValidBirthday(birthday: Partial<Birthday>): birthday is Birthday {\n\tconst day = Number(birthday.day)\n\tconst month = Number(birthday.month)\n\tconst year = birthday.year ? Number(birthday.year) : null\n\treturn day > 0 && day < 32 && month > 0 && month < 13 && (year === null || (year > 0 && year < 10000))\n}\n\n/**\n * returns new birthday format from old birthday format\n * Export for testing\n */\nexport function oldBirthdayToBirthday(oldBirthday: Date): Birthday {\n\tlet birthdayString = formatSortableDate(oldBirthday).split(\"-\")\n\treturn createBirthday({\n\t\tday: String(Number(birthdayString[2])),\n\t\tmonth: String(Number(birthdayString[1])),\n\t\tyear: String(Number(birthdayString[0])),\n\t})\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAIa,eAAN,cAA2B,cAAc;CAC/C,YAAYA,GAAW;AACtB,QAAM,gBAAgB,EAAE;CACxB;AACD;;;;ACAM,SAAS,kBAAkBC,UAA4B;CAC7D,MAAM,QAAQ,CAAC,MAAM,SAAS,OAAO,MAAM,GAAG;CAC9C,MAAM,MAAM,CAAC,MAAM,SAAS,KAAK,MAAM,GAAG;CAC1C,MAAM,OAAO,SAAS,OAAO,CAAC,SAAS,SAAS,MAAM,MAAM,GAAG,GAAG;AAClE,SAAQ,EAAE,KAAK,GAAG,MAAM,GAAG,IAAI;AAC/B;AAKM,SAAS,kBAAkBC,aAA+B;CAEhE,MAAMC,sBAAyC,CAAE;AACjD,KAAI,YAAY,WAAW,KAAK,EAAE;EACjC,MAAM,cAAc,YAAY,UAAU,EAAE,CAAC,MAAM,IAAI;AAEvD,MAAI,YAAY,WAAW,EAC1B,OAAM,IAAI,aAAa,oCAAoC;AAG5D,sBAAoB,QAAQ,YAAY;AACxC,sBAAoB,MAAM,YAAY;AACtC,sBAAoB,OAAO;CAC3B,OAAM;EACN,MAAM,kBAAkB,YAAY,MAAM,IAAI;AAE9C,MAAI,gBAAgB,WAAW,EAC9B,OAAM,IAAI,aAAa,uBAAuB;AAG/C,sBAAoB,OAAO,gBAAgB;AAC3C,sBAAoB,QAAQ,gBAAgB;AAC5C,sBAAoB,MAAM,gBAAgB;CAC1C;AAED,MAAK,gBAAgB,oBAAoB,CACxC,OAAM,IAAI,aAAa,8BAA8B;AAGtD,QAAO,eAAe,oBAAoB;AAC1C;AAEM,SAAS,gBAAgBC,UAAmD;CAClF,MAAM,MAAM,OAAO,SAAS,IAAI;CAChC,MAAM,QAAQ,OAAO,SAAS,MAAM;CACpC,MAAM,OAAO,SAAS,OAAO,OAAO,SAAS,KAAK,GAAG;AACrD,QAAO,MAAM,KAAK,MAAM,MAAM,QAAQ,KAAK,QAAQ,OAAO,SAAS,QAAS,OAAO,KAAK,OAAO;AAC/F;AAMM,SAAS,sBAAsBC,aAA6B;CAClE,IAAI,iBAAiB,mBAAmB,YAAY,CAAC,MAAM,IAAI;AAC/D,QAAO,eAAe;EACrB,KAAK,OAAO,OAAO,eAAe,GAAG,CAAC;EACtC,OAAO,OAAO,OAAO,eAAe,GAAG,CAAC;EACxC,MAAM,OAAO,OAAO,eAAe,GAAG,CAAC;CACvC,EAAC;AACF"}