
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { defer, delay, downcast } from "./dist-CJHwsXKY.js";
import { dist_default } from "./dist-Ci1bEzYU.js";
import "./testdouble-IbRSnrC0.js";
import { spy } from "./dist-BY49f75m.js";
import { DesktopNotifier } from "./DesktopNotifier-BR7GuUWK.js";

//#region tests/desktop/DesktopNotifierTest.ts
const appIcon = downcast(Symbol("appIcon"));
const icon1 = downcast(Symbol("icon1"));
dist_default.spec("Desktop Notifier Test", function() {
	const notificationStartDelay = 10;
	let createdNotifications;
	let desktopTray;
	let notificationFactory;
	let notificationMade = defer();
	dist_default.beforeEach(function() {
		createdNotifications = [];
		desktopTray = downcast({
			getAppIcon: () => appIcon,
			update: spy(() => {}),
			setBadge: spy(() => {})
		});
		notificationFactory = downcast({
			isSupported: () => true,
			makeNotification: spy((props, click) => {
				const n = {
					close: spy(),
					click
				};
				createdNotifications.push(n);
				notificationMade.resolve();
				return () => n.close();
			})
		});
	});
	dist_default("show no notifications before call to start()", async function() {
		const notifier = new DesktopNotifier(desktopTray, notificationFactory);
		notifier.showOneShot({
			title: "Title1",
			body: "Body1",
			icon: icon1
		});
		notifier.submitGroupedNotification("Title2", "Message", "gn1", () => {});
		dist_default(notificationFactory.makeNotification.calls).deepEquals([]);
		notifier.start(notificationStartDelay);
		setImmediate(() => {
			dist_default(notificationFactory.makeNotification.calls).deepEquals([]);
		});
		await delay(notificationStartDelay * 3);
		dist_default(notificationFactory.makeNotification.calls[0][0]).deepEquals({
			title: "Title1",
			body: "Body1",
			icon: icon1
		});
		dist_default(desktopTray.update.callCount).equals(1);
	});
	dist_default("show no notifications when no notifications available", async function() {
		downcast(notificationFactory).isSupported = () => false;
		const notifier = new DesktopNotifier(desktopTray, notificationFactory);
		notifier.showOneShot({
			title: "Title1",
			body: "Body1",
			icon: icon1
		}).catch(() => {});
		notifier.submitGroupedNotification("Title2", "Message", "gn1", () => {});
		notifier.start(notificationStartDelay);
		await delay(notificationStartDelay * 1.1);
		dist_default(notificationFactory.makeNotification.callCount).equals(0);
	});
	dist_default("grouped notifications replace each other", async function() {
		const notifier = new DesktopNotifier(desktopTray, notificationFactory);
		notifier.start(notificationStartDelay);
		await delay(notificationStartDelay * 1.1);
		notifier.submitGroupedNotification("Title1", "Message1", "gn1", () => {});
		await notificationMade.promise;
		notificationMade = defer();
		notifier.submitGroupedNotification("Title2", "Message2", "gn1", () => {});
		await notificationMade.promise;
		notificationMade = defer();
		notifier.submitGroupedNotification("Title3", "Message3", "gn2", () => {});
		await notificationMade.promise;
		dist_default(createdNotifications.length).equals(3);
		dist_default(createdNotifications[0].close.callCount).equals(1);
		dist_default(createdNotifications[1].close.callCount).equals(0);
		dist_default(createdNotifications[1].close.callCount).equals(0);
		dist_default(desktopTray.update.callCount).equals(3);
		dist_default(desktopTray.setBadge.callCount).equals(3);
		dist_default(notifier.hasNotificationForId("gn1")).equals(true);
		dist_default(notifier.hasNotificationForId("gn2")).equals(true);
	});
	dist_default("grouped notification disappear after clicking", async function() {
		const notifier = new DesktopNotifier(desktopTray, notificationFactory);
		notifier.start(notificationStartDelay);
		const clickHandler = spy(() => notifier.resolveGroupedNotification("gn1"));
		notifier.submitGroupedNotification("Title1", "Message1", "gn1", clickHandler);
		dist_default(createdNotifications.length).equals(0);
		dist_default(desktopTray.update.callCount).equals(0);
		dist_default(notifier.hasNotificationForId("gn1")).equals(false);
		dist_default(clickHandler.callCount).equals(0);
		await delay(notificationStartDelay * 2);
		createdNotifications[0].click();
		dist_default(clickHandler.callCount).equals(1);
		dist_default(createdNotifications.length).equals(1);
		dist_default(createdNotifications[0].close.callCount).equals(1);
		dist_default(desktopTray.update.callCount).equals(2);
		dist_default(desktopTray.setBadge.callCount).equals(1);
		dist_default(notifier.hasNotificationForId("gn1")).equals(false);
	});
});

//#endregion
//# sourceMappingURL=DesktopNotifierTest-BzmFx6hV.js.map