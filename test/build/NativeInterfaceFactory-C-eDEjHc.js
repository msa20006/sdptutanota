
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { assertNotNull, base64ToUint8Array, defer, uint8ArrayToBase64, utf8Uint8ArrayToString } from "./dist-CJHwsXKY.js";
import "./dist-Rk9U8Iqn.js";
import { ProgrammingError } from "./ProgrammingError-D8yJGVtm.js";
import { assertMainOrNode, isAndroidApp, isApp, isBrowser, isDesktop, isElectronClient, isIOSApp } from "./Env-D5xGlXfw.js";
import "./WhitelabelCustomizations-D1L5qbZi.js";
import { lang } from "./LanguageViewModel-BNC5ekpO.js";
import { client } from "./ClientDetector-D0v6Vqu6.js";
import { PushServiceType } from "./TutanotaConstants-3bwAESYA.js";
import "./RestError-D17JEBMr.js";
import "./SuspensionError-okvIjE4H.js";
import "./LoginIncompleteError-CpiW0a0l.js";
import "./CryptoError-PqdvQky4.js";
import "./error-DDmy0eAT.js";
import "./ErrorUtils-o1-v67Dd.js";
import "./RecipientsNotFoundError-D8oGE7A_.js";
import "./OfflineDbClosedError-CAwHTI6J.js";
import "./OutOfSyncError-Ck2yBBO8.js";
import "./DbError-CcwZaPG2.js";
import "./QuotaExceededError-nFM6SdTn.js";
import "./CancelledError-FjP5S_cR.js";
import "./FileOpenError-C1_8yoXr.js";
import { DeviceStorageUnavailableError } from "./DeviceStorageUnavailableError-m4Jk_0xN.js";
import "./MailBodyTooLargeError-C2i0rX_0.js";
import "./ImportError-CIXw37Kv.js";
import "./PermissionError-BGDsHuAh.js";
import "./KeyPermanentlyInvalidatedError-DJjt81rl.js";
import "./ParserCombinator-D38ofgFx.js";
import "./ExportError-DzgStBnl.js";
import "./stream-u2PttBAC.js";
import "./luxon-D6cgmg6Q.js";
import { getElementId } from "./EntityUtils-RQxXZlcV.js";
import "./CommonCalendarUtils-DKaO7v1K.js";
import "./TypeModels-XIXYys8J.js";
import "./TypeRefs-CR3TLWn0.js";
import "./TypeModels-BktRFNDN.js";
import { PushIdentifierTypeRef, createPushIdentifier } from "./TypeRefs-BP1jvX9p.js";
import "./CalendarUtils-C6jeYrj9.js";
import { ModelInfo_default$2 as ModelInfo_default } from "./ModelInfo-DEa-Yxv2.js";
import { locator$1 as locator } from "./CommonLocator-Csg4iNnm.js";
import "./ImportExportUtils-B1MoOmZ0.js";
import "./FormatValidator-2BBermUe.js";
import { deviceConfig } from "./DeviceConfig-payZM407.js";
import { MessageDispatcher, Request, RequestError, Response } from "./MessageDispatcher-wJwFhXWv.js";
import { ExportFacadeSendDispatcher, FileFacadeSendDispatcher, NativeFileApp, NativePushFacadeSendDispatcher } from "./ExportFacadeSendDispatcher-B0ubUu3N.js";
import { InterWindowEventFacadeSendDispatcher } from "./InterWindowEventFacadeSendDispatcher-BTmViZah.js";

//#region ../src/common/native/common/NativeLineProtocol.ts
function encodeNativeMessage(message) {
	let encodedMessage = [];
	encodedMessage.push(message.type);
	encodedMessage.push(message.id);
	switch (message.type) {
		case "request":
			encodedMessage.push(message.requestType);
			if (message.args.length === 0) encodedMessage.push("");
			for (const arg of message.args) encodedMessage.push(encodeValueForNative(arg));
			break;
		case "response":
			encodedMessage.push(encodeValueForNative(message.value));
			break;
		case "requestError":
			encodedMessage.push(encodeValueForNative(message.error));
			break;
	}
	return encodedMessage.join("\n");
}
function encodeValueForNative(value) {
	return JSON.stringify(replaceBytesWithWrapper(value));
}
const BYTES_MARKER = "__bytes";
function replaceBytesWithWrapper(value) {
	if (value == null) return null;
else if (value instanceof Uint8Array) return {
		data: uint8ArrayToBase64(value),
		marker: BYTES_MARKER
	};
else if (Array.isArray(value)) return value.map(replaceBytesWithWrapper);
else if (typeof value === "object") {
		const newObject = {};
		for (const [key, field] of Object.entries(value)) newObject[key] = replaceBytesWithWrapper(field);
		return newObject;
	} else return value;
}
function replaceWrapperByBytes(value) {
	if (value == null) return null;
else if (isByteWrapper(value)) return base64ToUint8Array(value.data);
else if (Array.isArray(value)) return value.map(replaceWrapperByBytes);
else if (typeof value === "object") {
		const newObject = {};
		for (const [key, field] of Object.entries(value)) newObject[key] = replaceWrapperByBytes(field);
		return newObject;
	} else return value;
}
function isByteWrapper(value) {
	return value != null && typeof value === "object" && value.marker === BYTES_MARKER && typeof value.data === "string";
}
function decodeNativeMessage(encoded) {
	const [type, messageId, ...rest] = encoded.split("\n");
	let parsedMessage;
	switch (type) {
		case "request": {
			const [requestType, ...args] = rest;
			parsedMessage = new Request(requestType, args.map((s) => decodeValueFromNative(s)));
			parsedMessage.id = messageId;
			break;
		}
		case "response": {
			const [value] = rest;
			parsedMessage = new Response(messageId, decodeValueFromNative(value));
			break;
		}
		case "requestError": {
			const [error] = rest;
			parsedMessage = new RequestError(messageId, decodeValueFromNative(error));
			break;
		}
		default: throw new ProgrammingError(`unknown message type: ${type}`);
	}
	return parsedMessage;
}
function decodeValueFromNative(encoded) {
	return replaceWrapperByBytes(JSON.parse(encoded));
}

//#endregion
//#region ../src/common/native/main/IosNativeTransport.ts
assertMainOrNode();
var IosNativeTransport = class {
	messageHandler = null;
	constructor(window$1) {
		this.window = window$1;
		this.window.tutao.nativeApp = this;
	}
	postMessage(message) {
		const encoded = encodeNativeMessage(message);
		this.window.webkit.messageHandlers.nativeApp.postMessage(encoded);
	}
	setMessageHandler(handler) {
		this.messageHandler = handler;
	}
	receiveMessageFromApp(msg64) {
		const handler = this.messageHandler;
		if (handler) {
			const msg = utf8Uint8ArrayToString(base64ToUint8Array(msg64));
			const parsed = decodeNativeMessage(msg);
			handler(parsed);
		} else console.warn("Request from native but no handler is set!");
	}
};

//#endregion
//#region ../src/common/native/main/AndroidNativeTransport.ts
assertMainOrNode();
var AndroidNativeTransport = class {
	messageHandler = null;
	deferredPort = defer();
	constructor(window$1) {
		this.window = window$1;
	}
	/**
	* Creates a global `window.onmessage` handler, and then tells native to create the messageport channel
	*/
	start() {
		this.window.onmessage = (message) => {
			const port = message.ports[0];
			port.onmessage = (messageEvent) => {
				const handler = this.messageHandler;
				if (handler) {
					const response = decodeNativeMessage(messageEvent.data);
					handler(response);
				}
			};
			this.deferredPort.resolve(port);
		};
		this.window.nativeApp.startWebMessageChannel();
	}
	postMessage(message) {
		const encoded = encodeNativeMessage(message);
		this.deferredPort.promise.then((port) => port.postMessage(encoded));
	}
	setMessageHandler(handler) {
		this.messageHandler = handler;
	}
};

//#endregion
//#region ../src/common/native/main/DesktopNativeTransport.ts
assertMainOrNode();
var DesktopNativeTransport = class {
	constructor(nativeApp) {
		this.nativeApp = nativeApp;
	}
	postMessage(message) {
		this.nativeApp.invoke(message);
	}
	setMessageHandler(handler) {
		this.nativeApp.attach(handler);
	}
};

//#endregion
//#region ../src/common/native/main/NativeInterfaceMain.ts
assertMainOrNode();
var NativeInterfaceMain = class {
	_dispatchDeferred = defer();
	_appUpdateListener = null;
	constructor(globalDispatcher) {
		this.globalDispatcher = globalDispatcher;
	}
	async init() {
		let transport;
		if (isAndroidApp()) {
			const androidTransport = new AndroidNativeTransport(window);
			androidTransport.start();
			transport = androidTransport;
		} else if (isIOSApp()) transport = new IosNativeTransport(window);
else if (isElectronClient()) transport = new DesktopNativeTransport(window.nativeApp);
else throw new ProgrammingError("Tried to create a native interface in the browser");
		const queue = new MessageDispatcher(transport, { ipc: (request) => this.globalDispatcher.dispatch(request.args[0], request.args[1], request.args.slice(2)) }, "main-worker");
		await queue.postRequest(new Request("ipc", ["CommonSystemFacade", "initializeRemoteBridge"]));
		this._dispatchDeferred.resolve(queue);
	}
	async initWithQueue(queue) {
		this._dispatchDeferred.resolve(queue);
	}
	/**
	* Send a request to the native side.
	*/
	async invokeNative(requestType, args) {
		const dispatch = await this._dispatchDeferred.promise;
		return dispatch.postRequest(new Request(requestType, args));
	}
	/**
	* Saves a listener method to be called when an app update has been downloaded on the native side.
	*/
	setAppUpdateListener(listener) {
		this._appUpdateListener = listener;
	}
	/**
	* Call the update listener if set.
	*/
	handleUpdateDownload() {
		this._appUpdateListener?.();
	}
};

//#endregion
//#region ../src/common/native/main/NativePushServiceApp.ts
const MOBILE_SYS_MODEL_VERSION = 99;
function effectiveModelVersion() {
	return isDesktop() ? ModelInfo_default.version : MOBILE_SYS_MODEL_VERSION;
}
var NativePushServiceApp = class {
	_currentIdentifier = null;
	constructor(nativePushFacade, logins, cryptoFacade, entityClient, deviceConfig$1, calendarFacade, app) {
		this.nativePushFacade = nativePushFacade;
		this.logins = logins;
		this.cryptoFacade = cryptoFacade;
		this.entityClient = entityClient;
		this.deviceConfig = deviceConfig$1;
		this.calendarFacade = calendarFacade;
		this.app = app;
	}
	async register() {
		console.log("Registering for push notifications for app", this.app);
		if (isAndroidApp() || isDesktop()) try {
			const identifier = await this.loadPushIdentifierFromNative() ?? await locator.workerFacade.generateSsePushIdentifer();
			const pushIdentifier = await this.loadPushIdentifier(identifier) ?? await this.createPushIdentifierInstance(identifier, PushServiceType.SSE);
			this._currentIdentifier = {
				identifier,
				disabled: pushIdentifier.disabled
			};
			await this.storePushIdentifierLocally(pushIdentifier);
			const userId = this.logins.getUserController().userId;
			if (!await locator.pushService.allowReceiveCalendarNotifications()) await this.nativePushFacade.invalidateAlarmsForUser(userId);
else await this.scheduleAlarmsIfNeeded(pushIdentifier);
			await this.initPushNotifications();
		} catch (e) {
			if (e instanceof DeviceStorageUnavailableError) console.warn("Device storage is unavailable, cannot register for push notifications", e);
else throw e;
		}
else if (isIOSApp()) {
			const identifier = await this.loadPushIdentifierFromNative();
			if (identifier) {
				const pushIdentifier = await this.loadPushIdentifier(identifier) ?? await this.createPushIdentifierInstance(identifier, PushServiceType.IOS);
				this._currentIdentifier = {
					identifier,
					disabled: pushIdentifier.disabled
				};
				if (pushIdentifier.language !== lang.code) {
					pushIdentifier.language = lang.code;
					locator.entityClient.update(pushIdentifier);
				}
				await this.storePushIdentifierLocally(pushIdentifier);
				const userId = this.logins.getUserController().userId;
				if (!await locator.pushService.allowReceiveCalendarNotifications()) await this.nativePushFacade.invalidateAlarmsForUser(userId);
else await this.scheduleAlarmsIfNeeded(pushIdentifier);
			} else console.log("Push notifications were rejected by user");
		}
	}
	async reRegister() {
		console.log("re-registering for push notifications, setting no alarms as scheduled");
		this.deviceConfig.setNoAlarmsScheduled();
		if (this.logins.isUserLoggedIn()) {
			await this.logins.waitForFullLogin();
			return this.register();
		} else return Promise.resolve();
	}
	async invalidateAlarmsForUser(userId) {
		return this.nativePushFacade.invalidateAlarmsForUser(userId);
	}
	removeUserFromNotifications(userId) {
		return this.nativePushFacade.removeUser(userId);
	}
	loadPushIdentifierFromNative() {
		return this.nativePushFacade.getPushIdentifier();
	}
	async storePushIdentifierLocally(pushIdentifier) {
		const userId = this.logins.getUserController().user._id;
		const sk = assertNotNull(await this.cryptoFacade.resolveSessionKeyForInstanceBinary(pushIdentifier));
		const origin = assertNotNull(env.staticUrl);
		await this.nativePushFacade.storePushIdentifierLocally(pushIdentifier.identifier, userId, origin, getElementId(pushIdentifier), sk);
	}
	async loadPushIdentifier(identifier) {
		const list = assertNotNull(this.logins.getUserController().user.pushIdentifierList);
		const identifiers = await this.entityClient.loadAll(PushIdentifierTypeRef, list.list);
		return identifiers.find((i) => i.identifier === identifier) ?? null;
	}
	async createPushIdentifierInstance(identifier, pushServiceType) {
		const list = assertNotNull(this.logins.getUserController().user.pushIdentifierList?.list);
		const pushIdentifier = createPushIdentifier({
			_area: "0",
			_owner: this.logins.getUserController().userGroupInfo.group,
			_ownerGroup: this.logins.getUserController().userGroupInfo.group,
			displayName: client.getIdentifier(),
			pushServiceType,
			identifier,
			language: lang.code,
			disabled: false,
			lastUsageTime: new Date(),
			lastNotificationDate: null,
			app: this.app
		});
		const id = await this.entityClient.setup(list, pushIdentifier);
		return this.entityClient.load(PushIdentifierTypeRef, [list, id]);
	}
	async closePushNotification(addresses) {
		await this.nativePushFacade.closePushNotifications(addresses);
	}
	getLoadedPushIdentifier() {
		return this._currentIdentifier;
	}
	getExtendedNotificationMode() {
		return this.nativePushFacade.getExtendedNotificationConfig(this.logins.getUserController().userId);
	}
	async setExtendedNotificationMode(type) {
		await this.nativePushFacade.setExtendedNotificationConfig(this.logins.getUserController().userId, type);
	}
	initPushNotifications() {
		return this.nativePushFacade.initPushNotifications();
	}
	async scheduleAlarmsIfNeeded(pushIdentifier) {
		if (this._currentIdentifier?.disabled) return;
		const userId = this.logins.getUserController().user._id;
		const scheduledAlarmsModelVersion = this.deviceConfig.getScheduledAlarmsModelVersion(userId);
		if (scheduledAlarmsModelVersion == null || scheduledAlarmsModelVersion < effectiveModelVersion()) {
			console.log(`Alarms not scheduled for user ${userId} (stored v ${scheduledAlarmsModelVersion}), scheduling`);
			await this.nativePushFacade.invalidateAlarmsForUser(userId);
			await this.calendarFacade.scheduleAlarmsForNewDevice(pushIdentifier);
			this.deviceConfig.setScheduledAlarmsModelVersion(userId, effectiveModelVersion());
		}
	}
	async setReceiveCalendarNotificationConfig(value) {
		await this.nativePushFacade.setReceiveCalendarNotificationConfig(this.getLoadedPushIdentifier().identifier, value);
	}
	async getReceiveCalendarNotificationConfig() {
		const pushIdentifier = this.getLoadedPushIdentifier();
		if (!pushIdentifier) return true;
		return await this.nativePushFacade.getReceiveCalendarNotificationConfig(pushIdentifier.identifier);
	}
	async allowReceiveCalendarNotifications() {
		return !isApp() || await this.getReceiveCalendarNotificationConfig();
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/CommonNativeFacadeReceiveDispatcher.ts
var CommonNativeFacadeReceiveDispatcher = class {
	constructor(facade) {
		this.facade = facade;
	}
	async dispatch(method, arg) {
		switch (method) {
			case "createMailEditor": {
				const filesUris = arg[0];
				const text = arg[1];
				const addresses = arg[2];
				const subject = arg[3];
				const mailToUrlString = arg[4];
				return this.facade.createMailEditor(filesUris, text, addresses, subject, mailToUrlString);
			}
			case "openMailBox": {
				const userId = arg[0];
				const address = arg[1];
				const requestedPath = arg[2];
				return this.facade.openMailBox(userId, address, requestedPath);
			}
			case "openCalendar": {
				const userId = arg[0];
				return this.facade.openCalendar(userId);
			}
			case "openContactEditor": {
				const contactId = arg[0];
				return this.facade.openContactEditor(contactId);
			}
			case "showAlertDialog": {
				const translationKey = arg[0];
				return this.facade.showAlertDialog(translationKey);
			}
			case "invalidateAlarms": return this.facade.invalidateAlarms();
			case "updateTheme": return this.facade.updateTheme();
			case "promptForNewPassword": {
				const title = arg[0];
				const oldPassword = arg[1];
				return this.facade.promptForNewPassword(title, oldPassword);
			}
			case "promptForPassword": {
				const title = arg[0];
				return this.facade.promptForPassword(title);
			}
			case "handleFileImport": {
				const filesUris = arg[0];
				return this.facade.handleFileImport(filesUris);
			}
			case "openSettings": {
				const path = arg[0];
				return this.facade.openSettings(path);
			}
		}
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/DesktopFacadeReceiveDispatcher.ts
var DesktopFacadeReceiveDispatcher = class {
	constructor(facade) {
		this.facade = facade;
	}
	async dispatch(method, arg) {
		switch (method) {
			case "print": return this.facade.print();
			case "showSpellcheckDropdown": return this.facade.showSpellcheckDropdown();
			case "openFindInPage": return this.facade.openFindInPage();
			case "applySearchResultToOverlay": {
				const result = arg[0];
				return this.facade.applySearchResultToOverlay(result);
			}
			case "reportError": {
				const errorInfo = arg[0];
				return this.facade.reportError(errorInfo);
			}
			case "updateTargetUrl": {
				const url = arg[0];
				const appPath = arg[1];
				return this.facade.updateTargetUrl(url, appPath);
			}
			case "openCustomer": {
				const mailAddress = arg[0];
				return this.facade.openCustomer(mailAddress);
			}
			case "addShortcuts": {
				const shortcuts = arg[0];
				return this.facade.addShortcuts(shortcuts);
			}
			case "appUpdateDownloaded": return this.facade.appUpdateDownloaded();
		}
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/InterWindowEventFacadeReceiveDispatcher.ts
var InterWindowEventFacadeReceiveDispatcher = class {
	constructor(facade) {
		this.facade = facade;
	}
	async dispatch(method, arg) {
		switch (method) {
			case "localUserDataInvalidated": {
				const userId = arg[0];
				return this.facade.localUserDataInvalidated(userId);
			}
			case "reloadDeviceConfig": return this.facade.reloadDeviceConfig();
		}
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/MobileFacadeReceiveDispatcher.ts
var MobileFacadeReceiveDispatcher = class {
	constructor(facade) {
		this.facade = facade;
	}
	async dispatch(method, arg) {
		switch (method) {
			case "handleBackPress": return this.facade.handleBackPress();
			case "visibilityChange": {
				const visibility = arg[0];
				return this.facade.visibilityChange(visibility);
			}
			case "keyboardSizeChanged": {
				const newSize = arg[0];
				return this.facade.keyboardSizeChanged(newSize);
			}
		}
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/WebGlobalDispatcher.ts
var WebGlobalDispatcher = class {
	commonNativeFacade;
	desktopFacade;
	interWindowEventFacade;
	mobileFacade;
	constructor(commonNativeFacade, desktopFacade, interWindowEventFacade, mobileFacade) {
		this.commonNativeFacade = new CommonNativeFacadeReceiveDispatcher(commonNativeFacade);
		this.desktopFacade = new DesktopFacadeReceiveDispatcher(desktopFacade);
		this.interWindowEventFacade = new InterWindowEventFacadeReceiveDispatcher(interWindowEventFacade);
		this.mobileFacade = new MobileFacadeReceiveDispatcher(mobileFacade);
	}
	async dispatch(facadeName, methodName, args) {
		switch (facadeName) {
			case "CommonNativeFacade": return this.commonNativeFacade.dispatch(methodName, args);
			case "DesktopFacade": return this.desktopFacade.dispatch(methodName, args);
			case "InterWindowEventFacade": return this.interWindowEventFacade.dispatch(methodName, args);
			case "MobileFacade": return this.mobileFacade.dispatch(methodName, args);
			default: throw new Error("licc messed up! " + facadeName);
		}
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/CommonSystemFacadeSendDispatcher.ts
var CommonSystemFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async initializeRemoteBridge(...args) {
		return this.transport.invokeNative("ipc", [
			"CommonSystemFacade",
			"initializeRemoteBridge",
			...args
		]);
	}
	async reload(...args) {
		return this.transport.invokeNative("ipc", [
			"CommonSystemFacade",
			"reload",
			...args
		]);
	}
	async getLog(...args) {
		return this.transport.invokeNative("ipc", [
			"CommonSystemFacade",
			"getLog",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/MobileSystemFacadeSendDispatcher.ts
var MobileSystemFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async goToSettings(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"goToSettings",
			...args
		]);
	}
	async openLink(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"openLink",
			...args
		]);
	}
	async shareText(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"shareText",
			...args
		]);
	}
	async hasPermission(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"hasPermission",
			...args
		]);
	}
	async requestPermission(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"requestPermission",
			...args
		]);
	}
	async getAppLockMethod(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"getAppLockMethod",
			...args
		]);
	}
	async setAppLockMethod(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"setAppLockMethod",
			...args
		]);
	}
	async enforceAppLock(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"enforceAppLock",
			...args
		]);
	}
	async getSupportedAppLockMethods(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"getSupportedAppLockMethods",
			...args
		]);
	}
	async openMailApp(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"openMailApp",
			...args
		]);
	}
	async openCalendarApp(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"openCalendarApp",
			...args
		]);
	}
	async getInstallationDate(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"getInstallationDate",
			...args
		]);
	}
	async requestInAppRating(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileSystemFacade",
			"requestInAppRating",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/ThemeFacadeSendDispatcher.ts
var ThemeFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async getThemes(...args) {
		return this.transport.invokeNative("ipc", [
			"ThemeFacade",
			"getThemes",
			...args
		]);
	}
	async setThemes(...args) {
		return this.transport.invokeNative("ipc", [
			"ThemeFacade",
			"setThemes",
			...args
		]);
	}
	async getThemePreference(...args) {
		return this.transport.invokeNative("ipc", [
			"ThemeFacade",
			"getThemePreference",
			...args
		]);
	}
	async setThemePreference(...args) {
		return this.transport.invokeNative("ipc", [
			"ThemeFacade",
			"setThemePreference",
			...args
		]);
	}
	async prefersDark(...args) {
		return this.transport.invokeNative("ipc", [
			"ThemeFacade",
			"prefersDark",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/SearchTextInAppFacadeSendDispatcher.ts
var SearchTextInAppFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async findInPage(...args) {
		return this.transport.invokeNative("ipc", [
			"SearchTextInAppFacade",
			"findInPage",
			...args
		]);
	}
	async stopFindInPage(...args) {
		return this.transport.invokeNative("ipc", [
			"SearchTextInAppFacade",
			"stopFindInPage",
			...args
		]);
	}
	async setSearchOverlayState(...args) {
		return this.transport.invokeNative("ipc", [
			"SearchTextInAppFacade",
			"setSearchOverlayState",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/SettingsFacadeSendDispatcher.ts
var SettingsFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async getStringConfigValue(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"getStringConfigValue",
			...args
		]);
	}
	async setStringConfigValue(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"setStringConfigValue",
			...args
		]);
	}
	async getBooleanConfigValue(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"getBooleanConfigValue",
			...args
		]);
	}
	async setBooleanConfigValue(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"setBooleanConfigValue",
			...args
		]);
	}
	async getUpdateInfo(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"getUpdateInfo",
			...args
		]);
	}
	async registerMailto(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"registerMailto",
			...args
		]);
	}
	async unregisterMailto(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"unregisterMailto",
			...args
		]);
	}
	async integrateDesktop(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"integrateDesktop",
			...args
		]);
	}
	async unIntegrateDesktop(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"unIntegrateDesktop",
			...args
		]);
	}
	async getSpellcheckLanguages(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"getSpellcheckLanguages",
			...args
		]);
	}
	async getIntegrationInfo(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"getIntegrationInfo",
			...args
		]);
	}
	async enableAutoLaunch(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"enableAutoLaunch",
			...args
		]);
	}
	async disableAutoLaunch(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"disableAutoLaunch",
			...args
		]);
	}
	async manualUpdate(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"manualUpdate",
			...args
		]);
	}
	async changeLanguage(...args) {
		return this.transport.invokeNative("ipc", [
			"SettingsFacade",
			"changeLanguage",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/DesktopSystemFacadeSendDispatcher.ts
var DesktopSystemFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async openNewWindow(...args) {
		return this.transport.invokeNative("ipc", [
			"DesktopSystemFacade",
			"openNewWindow",
			...args
		]);
	}
	async focusApplicationWindow(...args) {
		return this.transport.invokeNative("ipc", [
			"DesktopSystemFacade",
			"focusApplicationWindow",
			...args
		]);
	}
	async sendSocketMessage(...args) {
		return this.transport.invokeNative("ipc", [
			"DesktopSystemFacade",
			"sendSocketMessage",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/MobileContactsFacadeSendDispatcher.ts
var MobileContactsFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async findSuggestions(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"findSuggestions",
			...args
		]);
	}
	async saveContacts(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"saveContacts",
			...args
		]);
	}
	async syncContacts(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"syncContacts",
			...args
		]);
	}
	async getContactBooks(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"getContactBooks",
			...args
		]);
	}
	async getContactsInContactBook(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"getContactsInContactBook",
			...args
		]);
	}
	async deleteContacts(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"deleteContacts",
			...args
		]);
	}
	async isLocalStorageAvailable(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"isLocalStorageAvailable",
			...args
		]);
	}
	async findLocalMatches(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"findLocalMatches",
			...args
		]);
	}
	async deleteLocalContacts(...args) {
		return this.transport.invokeNative("ipc", [
			"MobileContactsFacade",
			"deleteLocalContacts",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/NativeCredentialsFacadeSendDispatcher.ts
var NativeCredentialsFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async getSupportedEncryptionModes(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"getSupportedEncryptionModes",
			...args
		]);
	}
	async loadAll(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"loadAll",
			...args
		]);
	}
	async store(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"store",
			...args
		]);
	}
	async storeEncrypted(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"storeEncrypted",
			...args
		]);
	}
	async loadByUserId(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"loadByUserId",
			...args
		]);
	}
	async deleteByUserId(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"deleteByUserId",
			...args
		]);
	}
	async getCredentialEncryptionMode(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"getCredentialEncryptionMode",
			...args
		]);
	}
	async setCredentialEncryptionMode(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"setCredentialEncryptionMode",
			...args
		]);
	}
	async clear(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"clear",
			...args
		]);
	}
	async migrateToNativeCredentials(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeCredentialsFacade",
			"migrateToNativeCredentials",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/MobilePaymentsFacadeSendDispatcher.ts
var MobilePaymentsFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async requestSubscriptionToPlan(...args) {
		return this.transport.invokeNative("ipc", [
			"MobilePaymentsFacade",
			"requestSubscriptionToPlan",
			...args
		]);
	}
	async getPlanPrices(...args) {
		return this.transport.invokeNative("ipc", [
			"MobilePaymentsFacade",
			"getPlanPrices",
			...args
		]);
	}
	async showSubscriptionConfigView(...args) {
		return this.transport.invokeNative("ipc", [
			"MobilePaymentsFacade",
			"showSubscriptionConfigView",
			...args
		]);
	}
	async queryAppStoreSubscriptionOwnership(...args) {
		return this.transport.invokeNative("ipc", [
			"MobilePaymentsFacade",
			"queryAppStoreSubscriptionOwnership",
			...args
		]);
	}
	async isAppStoreRenewalEnabled(...args) {
		return this.transport.invokeNative("ipc", [
			"MobilePaymentsFacade",
			"isAppStoreRenewalEnabled",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/ExternalCalendarFacadeSendDispatcher.ts
var ExternalCalendarFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async fetchExternalCalendar(...args) {
		return this.transport.invokeNative("ipc", [
			"ExternalCalendarFacade",
			"fetchExternalCalendar",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/common/generatedipc/NativeMailImportFacadeSendDispatcher.ts
var NativeMailImportFacadeSendDispatcher = class {
	constructor(transport) {
		this.transport = transport;
	}
	async getResumableImport(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeMailImportFacade",
			"getResumableImport",
			...args
		]);
	}
	async prepareNewImport(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeMailImportFacade",
			"prepareNewImport",
			...args
		]);
	}
	async setProgressAction(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeMailImportFacade",
			"setProgressAction",
			...args
		]);
	}
	async setAsyncErrorHook(...args) {
		return this.transport.invokeNative("ipc", [
			"NativeMailImportFacade",
			"setAsyncErrorHook",
			...args
		]);
	}
};

//#endregion
//#region ../src/common/native/main/NativeInterfaceFactory.ts
function createNativeInterfaces(mobileFacade, desktopFacade, interWindowEventFacade, commonNativeFacade, cryptoFacade, calendarFacade, entityClient, logins, app) {
	if (isBrowser()) throw new ProgrammingError("Tried to make native interfaces in non-native");
	const dispatcher = new WebGlobalDispatcher(commonNativeFacade, desktopFacade, interWindowEventFacade, mobileFacade);
	const native = new NativeInterfaceMain(dispatcher);
	const nativePushFacadeSendDispatcher = new NativePushFacadeSendDispatcher(native);
	const pushService = new NativePushServiceApp(nativePushFacadeSendDispatcher, logins, cryptoFacade, entityClient, deviceConfig, calendarFacade, app);
	const fileApp = new NativeFileApp(new FileFacadeSendDispatcher(native), new ExportFacadeSendDispatcher(native));
	const commonSystemFacade = new CommonSystemFacadeSendDispatcher(native);
	const mobileSystemFacade = new MobileSystemFacadeSendDispatcher(native);
	const themeFacade = new ThemeFacadeSendDispatcher(native);
	const mobileContactsFacade = new MobileContactsFacadeSendDispatcher(native);
	const nativeCredentialsFacade = new NativeCredentialsFacadeSendDispatcher(native);
	const mobilePaymentsFacade = new MobilePaymentsFacadeSendDispatcher(native);
	const externalCalendarFacade = new ExternalCalendarFacadeSendDispatcher(native);
	return {
		native,
		fileApp,
		pushService,
		mobileSystemFacade,
		commonSystemFacade,
		themeFacade,
		mobileContactsFacade,
		nativeCredentialsFacade,
		mobilePaymentsFacade,
		externalCalendarFacade
	};
}
function createDesktopInterfaces(native) {
	if (!isElectronClient()) throw new ProgrammingError("tried to create desktop interfaces in non-electron client");
	return {
		searchTextFacade: new SearchTextInAppFacadeSendDispatcher(native),
		desktopSettingsFacade: new SettingsFacadeSendDispatcher(native),
		desktopSystemFacade: new DesktopSystemFacadeSendDispatcher(native),
		nativeMailImportFacade: new NativeMailImportFacadeSendDispatcher(native),
		interWindowEventSender: new InterWindowEventFacadeSendDispatcher(native),
		exportFacade: new ExportFacadeSendDispatcher(native)
	};
}

//#endregion
export { createDesktopInterfaces, createNativeInterfaces };
//# sourceMappingURL=NativeInterfaceFactory-C-eDEjHc.js.map