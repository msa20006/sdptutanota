
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { mithril_default } from "./mithril-Csg4iNnm.js";
import { defer } from "./dist-CJHwsXKY.js";
import "./dist-Rk9U8Iqn.js";
import "./ProgrammingError-D8yJGVtm.js";
import { isAndroidApp, isIOSApp } from "./Env-D5xGlXfw.js";
import "./WhitelabelCustomizations-D1L5qbZi.js";
import { lang } from "./LanguageViewModel-BNC5ekpO.js";
import "./HtmlUtils-C-ecR7U7.js";
import "./ClientDetector-D0v6Vqu6.js";
import { Keys } from "./TutanotaConstants-3bwAESYA.js";
import { BaseButton, Button, ButtonType } from "./Icon-BuqNK7vz.js";
import "./Icons-Dl3nFav5.js";
import "./KeyManager-B0OGXEyJ.js";
import { windowFacade } from "./WindowFacade-B9kSBKw7.js";
import "./Modal-g4c-b9IU.js";
import { Dialog, DialogHeaderBar, DialogType, liveDataAttrs } from "./Dialog-B6-HFvZd.js";
import "./CountryList-DkVQtcTj.js";
import "./IconButton-DsU60HJ_.js";
import "./RestError-D17JEBMr.js";
import "./SuspensionError-okvIjE4H.js";
import "./LoginIncompleteError-CpiW0a0l.js";
import "./CryptoError-PqdvQky4.js";
import "./error-DDmy0eAT.js";
import { CredentialAuthenticationError } from "./ErrorUtils-o1-v67Dd.js";
import "./RecipientsNotFoundError-D8oGE7A_.js";
import "./OfflineDbClosedError-CAwHTI6J.js";
import "./OutOfSyncError-Ck2yBBO8.js";
import "./DbError-CcwZaPG2.js";
import "./QuotaExceededError-nFM6SdTn.js";
import { CancelledError } from "./CancelledError-FjP5S_cR.js";
import "./FileOpenError-C1_8yoXr.js";
import "./DeviceStorageUnavailableError-m4Jk_0xN.js";
import "./MailBodyTooLargeError-C2i0rX_0.js";
import "./ImportError-CIXw37Kv.js";
import "./PermissionError-BGDsHuAh.js";
import { KeyPermanentlyInvalidatedError } from "./KeyPermanentlyInvalidatedError-DJjt81rl.js";
import "./ParserCombinator-D38ofgFx.js";
import "./ExportError-DzgStBnl.js";
import "./stream-u2PttBAC.js";
import { ExternalLink } from "./ExternalLink-rsCBSC7U.js";
import { CredentialEncryptionMode } from "./CredentialEncryptionMode-BR0DkQpJ.js";
import { RadioSelector } from "./RadioSelector-DRfVlwef.js";

//#region ../src/common/gui/dialogs/SelectCredentialsEncryptionModeDialog.ts
const DEFAULT_CREDENTIAL_ENCRYPTION_MODE = CredentialEncryptionMode.DEVICE_LOCK;
async function showCredentialsEncryptionModeDialog(credentialsProvider) {
	await CredentialEncryptionMethodDialog.showAndWaitForSelection(credentialsProvider);
}
var CredentialEncryptionMethodDialog = class CredentialEncryptionMethodDialog {
	error;
	finished;
	dialog;
	constructor(credentialsProvider, supportedModes, previousSelection) {
		this.credentialsProvider = credentialsProvider;
		this.supportedModes = supportedModes;
		this.previousSelection = previousSelection;
		this.error = null;
		this.finished = defer();
		this.dialog = new Dialog(DialogType.EditMedium, { view: () => {
			return mithril_default("", [previousSelection == null ? mithril_default(DialogHeaderBar, { left: () => [{
				label: "skip_action",
				click: () => this.onModeSelected(DEFAULT_CREDENTIAL_ENCRYPTION_MODE),
				type: ButtonType.Secondary
			}] }) : null, mithril_default(SelectCredentialsEncryptionModeView, {
				class: "scroll pt plr-l height-100p",
				error: this.error,
				onConfirm: (mode) => this.onModeSelected(mode),
				supportedModes: this.supportedModes,
				previousSelection: this.previousSelection ?? DEFAULT_CREDENTIAL_ENCRYPTION_MODE
			})]);
		} }).addShortcut({
			help: "close_alt",
			key: Keys.ESC,
			exec: () => this.dialog.close()
		});
		this.dialog.setCloseHandler(() => {
			this.finished.resolve();
			this.dialog.close();
		});
	}
	static async showAndWaitForSelection(credentialsProvider) {
		const supportedModes = await credentialsProvider.getSupportedEncryptionModes();
		const previousSelection = await credentialsProvider.getCredentialEncryptionMode();
		const credentialsDialog = new CredentialEncryptionMethodDialog(credentialsProvider, supportedModes, previousSelection);
		credentialsDialog.dialog.show();
		await credentialsDialog.finished.promise;
	}
	async onModeSelected(mode) {
		try {
			await this.credentialsProvider.setCredentialEncryptionMode(mode);
			this.dialog.close();
			this.finished.resolve();
		} catch (e) {
			if (e instanceof CredentialAuthenticationError) {
				this.error = e.message;
				mithril_default.redraw();
			} else if (e instanceof KeyPermanentlyInvalidatedError) {
				await this.credentialsProvider.clearCredentials(e);
				this.dialog.close();
				await Dialog.message("credentialsKeyInvalidated_msg");
				windowFacade.reload({});
			} else if (e instanceof CancelledError) {} else throw e;
		}
	}
};
var SelectCredentialsEncryptionModeView = class {
	currentMode;
	constructor({ attrs }) {
		this.currentMode = attrs.previousSelection;
	}
	view({ attrs }) {
		const options = this.getSupportedOptions(attrs);
		const { onConfirm } = attrs;
		return [mithril_default(".flex.col", { class: attrs.class }, [
			attrs.error ? mithril_default(".small.center.statusTextColor.pb-s", liveDataAttrs(), attrs.error) : null,
			mithril_default("", lang.get("credentialsEncryptionModeSelection_msg")),
			mithril_default(".mt", mithril_default(RadioSelector, {
				name: "credentialsEncryptionMode_label",
				options,
				selectedOption: this.currentMode,
				onOptionSelected: (mode) => {
					this.currentMode = mode;
					attrs.onModeSelected?.(mode);
				}
			}))
		]), onConfirm ? this.renderSelectButton(() => onConfirm(this.currentMode)) : null];
	}
	getSupportedOptions(attrs) {
		const generateOption = (name, value) => ({
			name,
			value
		});
		const options = [
			generateOption("credentialsEncryptionModeDeviceLock_label", CredentialEncryptionMode.DEVICE_LOCK),
			generateOption("credentialsEncryptionModeDeviceCredentials_label", CredentialEncryptionMode.SYSTEM_PASSWORD),
			generateOption("credentialsEncryptionModeBiometrics_label", CredentialEncryptionMode.BIOMETRICS),
			generateOption("credentialsEncryptionModeAppPassword_label", CredentialEncryptionMode.APP_PASSWORD)
		];
		return options.filter((option) => attrs.supportedModes.includes(option.value));
	}
	renderSelectButton(onclick) {
		return mithril_default(BaseButton, {
			label: "ok_action",
			text: lang.get("ok_action"),
			class: "uppercase accent-bg full-width center b content-fg flash",
			style: { height: "60px" },
			onclick
		});
	}
};

//#endregion
//#region ../src/common/misc/news/items/PinBiometricsNews.ts
const playstoreLink = "https://play.google.com/store/apps/details?id=de.tutao.tutanota";
const appstoreLink = "https://apps.apple.com/app/tutanota/id922429609";
var PinBiometricsNews = class {
	constructor(newsModel, credentialsProvider, userId) {
		this.newsModel = newsModel;
		this.credentialsProvider = credentialsProvider;
		this.userId = userId;
	}
	isShown(newsId) {
		return Promise.resolve((isIOSApp() || isAndroidApp()) && !this.newsModel.hasAcknowledgedNewsForDevice(newsId.newsItemId));
	}
	render(newsId) {
		const displayedLink = isAndroidApp() ? playstoreLink : appstoreLink;
		return mithril_default(".full-width", [
			mithril_default(".h4", { style: { "text-transform": "capitalize" } }, lang.get("pinBiometrics_action")),
			mithril_default("p", lang.get("pinBiometrics1_msg", { "{secureNowAction}": lang.get("secureNow_action") })),
			mithril_default("p", lang.get("pinBiometrics2_msg")),
			mithril_default("p", [mithril_default(".text-break", [mithril_default(ExternalLink, {
				href: displayedLink,
				isCompanySite: false
			})])]),
			mithril_default("p", lang.get("pinBiometrics3_msg")),
			mithril_default(".flex-end.flex-no-grow-no-shrink-auto.flex-wrap", [
				this.renderLaterButton(newsId),
				this.renderDismissButton(newsId),
				this.renderConfirmButton(newsId)
			])
		]);
	}
	renderLaterButton(newsId) {
		return mithril_default(Button, {
			label: "decideLater_action",
			type: ButtonType.Secondary,
			click: async () => {
				await this.newsModel.acknowledgeNews(newsId.newsItemId);
				mithril_default.redraw();
			}
		});
	}
	renderDismissButton(newsId) {
		return mithril_default(Button, {
			label: "noThanks_action",
			type: ButtonType.Secondary,
			click: async () => {
				this.newsModel.acknowledgeNewsForDevice(newsId.newsItemId);
				await this.newsModel.acknowledgeNews(newsId.newsItemId);
				mithril_default.redraw();
			}
		});
	}
	renderConfirmButton(newsId) {
		return mithril_default(Button, {
			label: "secureNow_action",
			click: async () => {
				if (await this.credentialsProvider.getCredentialsInfoByUserId(this.userId) === null) await Dialog.message(lang.getTranslation("needSavedCredentials_msg", { "{storePasswordAction}": lang.get("storePassword_action") }));
else {
					await showCredentialsEncryptionModeDialog(this.credentialsProvider);
					this.newsModel.acknowledgeNewsForDevice(newsId.newsItemId);
					await this.newsModel.acknowledgeNews(newsId.newsItemId);
					mithril_default.redraw();
				}
			},
			type: ButtonType.Primary
		});
	}
};

//#endregion
export { PinBiometricsNews };
//# sourceMappingURL=PinBiometricsNews-1YR5uBKd.js.map