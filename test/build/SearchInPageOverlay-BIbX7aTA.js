
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { mithril_default } from "./mithril-Csg4iNnm.js";
import "./dist-CJHwsXKY.js";
import "./dist-Rk9U8Iqn.js";
import "./ProgrammingError-D8yJGVtm.js";
import { assertMainOrNode } from "./Env-D5xGlXfw.js";
import "./WhitelabelCustomizations-D1L5qbZi.js";
import { lang } from "./LanguageViewModel-BNC5ekpO.js";
import { getSafeAreaInsetBottom, px, size, styles } from "./HtmlUtils-C-ecR7U7.js";
import "./ClientDetector-D0v6Vqu6.js";
import { Keys } from "./TutanotaConstants-3bwAESYA.js";
import "./Icon-BuqNK7vz.js";
import { Icons } from "./Icons-Dl3nFav5.js";
import { isKeyPressed } from "./KeyManager-B0OGXEyJ.js";
import "./WindowFacade-B9kSBKw7.js";
import { displayOverlay } from "./Modal-g4c-b9IU.js";
import { IconButton } from "./IconButton-DsU60HJ_.js";
import { locator$1 as locator } from "./CommonLocator-Csg4iNnm.js";
import { ToggleButton } from "./ToggleButton-DxuDa0rS.js";

//#region ../src/common/gui/SearchInPageOverlay.ts
assertMainOrNode();
var SearchInPageOverlay = class {
	closeFunction;
	domInput;
	matchCase = false;
	numberOfMatches = 0;
	currentMatch = 0;
	skipNextBlur = false;
	constructor() {
		this.closeFunction = null;
	}
	open() {
		if (locator.logins.isUserLoggedIn()) {
			if (!this.closeFunction) this.closeFunction = displayOverlay(() => this.getRect(), this.getComponent(), "slide-bottom");
else {
				console.log("refocusing");
				this.domInput.focus();
				this.domInput.select();
			}
			mithril_default.redraw();
		}
	}
	close() {
		if (this.closeFunction) {
			this.closeFunction();
			locator.searchTextFacade.stopFindInPage();
			this.closeFunction = null;
		}
		mithril_default.redraw();
	}
	getRect() {
		const bottomNavHeight = size.bottom_nav_bar + getSafeAreaInsetBottom();
		return {
			height: px(size.navbar_height_mobile),
			bottom: px(styles.isUsingBottomNavigation() ? -bottomNavHeight : 0),
			right: px(0),
			left: px(0)
		};
	}
	inputField = () => {
		return mithril_default("input#search-overlay-input.dropdown-bar.elevated-bg.pl-l.button-height.inputWrapper", {
			placeholder: lang.get("searchPage_action"),
			oncreate: (vnode) => {
				this.domInput = vnode.dom;
				this.domInput.focus();
			},
			onblur: () => {
				if (this.skipNextBlur) {
					this.skipNextBlur = false;
					this.domInput.focus();
				} else locator.searchTextFacade.setSearchOverlayState(false, false);
			},
			onfocus: () => locator.searchTextFacade.setSearchOverlayState(true, false),
			oninput: () => this.find(true, true),
			style: {
				width: px(250),
				top: 0,
				height: px(size.button_height),
				left: 0
			}
		}, "");
	};
	find = async (forward, findNext) => {
		this.skipNextBlur = true;
		const r = await locator.searchTextFacade.findInPage(this.domInput.value, forward, this.matchCase, findNext);
		this.applyNextResult(r);
	};
	applyNextResult(result) {
		if (result == null) {
			this.numberOfMatches = 0;
			this.currentMatch = 0;
		} else {
			const { activeMatchOrdinal, matches } = result;
			if (matches === 1) {
				this.domInput.blur();
				this.domInput.focus();
			}
			this.numberOfMatches = matches - 1;
			this.currentMatch = activeMatchOrdinal - 1;
		}
		mithril_default.redraw();
	}
	getComponent() {
		const handleMouseUp = (event) => this.handleMouseUp(event);
		return { view: (_) => {
			return mithril_default(".flex.flex-space-between", {
				oncreate: () => window.addEventListener("mouseup", handleMouseUp),
				onremove: () => window.removeEventListener("mouseup", handleMouseUp)
			}, [mithril_default(".flex-start.center-vertically", { onkeydown: (e) => {
				if (isKeyPressed(e.key, Keys.ESC)) this.close();
				e.stopPropagation();
				return true;
			} }, [
				this.inputField(),
				mithril_default(IconButton, {
					title: "previous_action",
					icon: Icons.ArrowBackward,
					click: () => this.find(false, true)
				}),
				mithril_default(IconButton, {
					title: "next_action",
					icon: Icons.ArrowForward,
					click: () => this.find(true, true)
				}),
				mithril_default(ToggleButton, {
					title: "matchCase_alt",
					icon: Icons.MatchCase,
					toggled: this.matchCase,
					onToggled: () => {
						this.matchCase = !this.matchCase;
						this.find(true, false);
					}
				}),
				mithril_default("div.pl-m", this.numberOfMatches > 0 ? `${this.currentMatch}/${this.numberOfMatches}` : lang.get("searchNoResults_msg"))
			]), mithril_default(IconButton, {
				title: "close_alt",
				icon: Icons.Cancel,
				click: () => this.close()
			})]);
		} };
	}
	handleMouseUp(e) {
		if (!(e.target instanceof Element && e.target.id !== "search-overlay-input")) return;
		locator.searchTextFacade.setSearchOverlayState(false, true);
	}
};
const searchInPageOverlay = new SearchInPageOverlay();

//#endregion
export { searchInPageOverlay };
//# sourceMappingURL=SearchInPageOverlay-BIbX7aTA.js.map