{"version":3,"file":"testInBrowser.js","names":["result: RunResult"],"sources":["../tests/testInBrowser.ts"],"sourcesContent":["import type { RunResult } from \"@tutao/otest\"\n\n/**\n * runs this test exclusively on browsers (not nodec)\n */\nwindow.browser = (func) => func\n\n/**\n * runs this test exclusively on node (not browsers)\n */\n//@ts-ignore\nwindow.node = () => () => {}\n\nglobalThis.isBrowser = true\n\n// @ts-ignore\nwindow.tutao = {\n\tappState: {\n\t\tprefixWithoutFile: \"./\",\n\t},\n}\n\nreport(\"/status\", { status: \"loaded\" })\n\nconst searchParams = new URL(location.href).searchParams\nconst filter = searchParams.get(\"filter\") ?? undefined\n\ntry {\n\tconst { run } = await import(\"./Suite.js\")\n\n\treport(\"/status\", { status: \"imported suite\" })\n\n\tpreTest()\n\tconst result = await run({ filter })\n\tpostTest(result)\n\n\t// report results back\n\treport(\"/result\", result)\n} catch (e) {\n\treport(\"/status\", { status: \"error\", error: String(e) })\n}\n\nfunction report(path, data) {\n\tfetch(path, { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(data) })\n}\n\nfunction preTest() {\n\tdocument.body.style.fontFamily = \"sans-serif\"\n\n\tconst reportElement = document.createElement(\"p\")\n\treportElement.id = \"report\"\n\treportElement.style.fontWeight = \"bold\"\n\treportElement.style.fontSize = \"30px\"\n\treportElement.style.margin = \"30px 10px\"\n\treportElement.textContent = `Running tests...`\n\n\tdocument.body.appendChild(reportElement)\n\n\tconst filterElement = document.createElement(\"p\")\n\tfilterElement.style.fontSize = \"18px\"\n\tfilterElement.style.margin = \"30px 10px\"\n\tfilterElement.innerText = filter ? `filter: \"${filter}\"` : \"\"\n\n\tdocument.body.appendChild(filterElement)\n}\n\nfunction postTest(result: RunResult) {\n\tconst errCount = result.failingTests.length\n\tconst testPassed = errCount === 0\n\tconst p = document.getElementById(\"report\")!\n\n\tp.innerText = testPassed ? \"TEST PASSED\" : \"TEST FAILED (see console)\"\n\tp.style.color = testPassed ? \"green\" : \"red\"\n\n\tconst countersElement = document.createElement(\"p\")\n\tdocument.body.appendChild(countersElement)\n\n\tconst passingElement = document.createElement(\"span\")\n\tpassingElement.style.backgroundColor = \"#9FE181BC\"\n\tpassingElement.innerText = `passing: ${Number(result.passedTests.length)}`\n\n\tconst failingElement = document.createElement(\"span\")\n\tfailingElement.style.backgroundColor = \"#E19381BC\"\n\tfailingElement.innerText = `failing: ${Number(result.failingTests.length)}`\n\n\tconst skippedElement = document.createElement(\"span\")\n\tskippedElement.style.backgroundColor = \"#E1D381BC\"\n\tskippedElement.innerText = `skipped: ${Number(result.skippedTests.length)}`\n\n\tfor (const el of [passingElement, failingElement, skippedElement]) {\n\t\tcountersElement.appendChild(el)\n\t\tel.style.margin = \"0 10px\"\n\t\tel.style.padding = \"5px\"\n\t\tel.style.fontWeight = \"600\"\n\t\tel.style.fontSize = \"1.3em\"\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,OAAO,UAAU,CAAC,SAAS;;;;AAM3B,OAAO,OAAO,MAAM,MAAM,CAAE;AAE5B,WAAW,YAAY;AAGvB,OAAO,QAAQ,EACd,UAAU,EACT,mBAAmB,KACnB,EACD;AAED,OAAO,WAAW,EAAE,QAAQ,SAAU,EAAC;AAEvC,MAAM,eAAe,IAAI,IAAI,SAAS,MAAM;AAC5C,MAAM,SAAS,aAAa,IAAI,SAAS,IAAI;AAE7C,IAAI;CACH,MAAM,EAAE,KAAK,GAAG,MAAM,OAAO;AAE7B,QAAO,WAAW,EAAE,QAAQ,iBAAkB,EAAC;AAE/C,UAAS;CACT,MAAM,SAAS,MAAM,IAAI,EAAE,OAAQ,EAAC;AACpC,UAAS,OAAO;AAGhB,QAAO,WAAW,OAAO;AACzB,SAAQ,GAAG;AACX,QAAO,WAAW;EAAE,QAAQ;EAAS,OAAO,OAAO,EAAE;CAAE,EAAC;AACxD;AAED,SAAS,OAAO,MAAM,MAAM;AAC3B,OAAM,MAAM;EAAE,QAAQ;EAAQ,SAAS,EAAE,gBAAgB,mBAAoB;EAAE,MAAM,KAAK,UAAU,KAAK;CAAE,EAAC;AAC5G;AAED,SAAS,UAAU;AAClB,UAAS,KAAK,MAAM,aAAa;CAEjC,MAAM,gBAAgB,SAAS,cAAc,IAAI;AACjD,eAAc,KAAK;AACnB,eAAc,MAAM,aAAa;AACjC,eAAc,MAAM,WAAW;AAC/B,eAAc,MAAM,SAAS;AAC7B,eAAc,eAAe;AAE7B,UAAS,KAAK,YAAY,cAAc;CAExC,MAAM,gBAAgB,SAAS,cAAc,IAAI;AACjD,eAAc,MAAM,WAAW;AAC/B,eAAc,MAAM,SAAS;AAC7B,eAAc,YAAY,UAAU,WAAW,OAAO,KAAK;AAE3D,UAAS,KAAK,YAAY,cAAc;AACxC;AAED,SAAS,SAASA,QAAmB;CACpC,MAAM,WAAW,OAAO,aAAa;CACrC,MAAM,aAAa,aAAa;CAChC,MAAM,IAAI,SAAS,eAAe,SAAS;AAE3C,GAAE,YAAY,aAAa,gBAAgB;AAC3C,GAAE,MAAM,QAAQ,aAAa,UAAU;CAEvC,MAAM,kBAAkB,SAAS,cAAc,IAAI;AACnD,UAAS,KAAK,YAAY,gBAAgB;CAE1C,MAAM,iBAAiB,SAAS,cAAc,OAAO;AACrD,gBAAe,MAAM,kBAAkB;AACvC,gBAAe,aAAa,WAAW,OAAO,OAAO,YAAY,OAAO,CAAC;CAEzE,MAAM,iBAAiB,SAAS,cAAc,OAAO;AACrD,gBAAe,MAAM,kBAAkB;AACvC,gBAAe,aAAa,WAAW,OAAO,OAAO,aAAa,OAAO,CAAC;CAE1E,MAAM,iBAAiB,SAAS,cAAc,OAAO;AACrD,gBAAe,MAAM,kBAAkB;AACvC,gBAAe,aAAa,WAAW,OAAO,OAAO,aAAa,OAAO,CAAC;AAE1E,MAAK,MAAM,MAAM;EAAC;EAAgB;EAAgB;CAAe,GAAE;AAClE,kBAAgB,YAAY,GAAG;AAC/B,KAAG,MAAM,SAAS;AAClB,KAAG,MAAM,UAAU;AACnB,KAAG,MAAM,aAAa;AACtB,KAAG,MAAM,WAAW;CACpB;AACD"}