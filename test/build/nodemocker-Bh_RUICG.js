
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { downcast } from "./dist-CJHwsXKY.js";
import { spy } from "./dist-BY49f75m.js";

//#region tests/nodemocker.ts
/**
* you need to call .get() on the return value to actually register the replacer to spyify its functions.
* placer object that replaces the module and gets returned when require(old) is called. Its functions are spyified when .get() is called.
* warning: contents of array properties will not be spyified
* @param old name of the module to replace
* @returns {MockBuilder}
*/
function mock(old, replacer) {
	return new MockBuilder(old, replacer);
}
function getAllPropertyNames(obj) {
	const props = [];
	do 
		for (const prop of Object.getOwnPropertyNames(obj)) if (props.indexOf(prop) === -1) props.push(prop);
	while (obj = Object.getPrototypeOf(obj));
	return props;
}
function spyify(obj) {
	const anyObj = obj;
	switch (typeof obj) {
		case "function": {
			const fSpy = spy(obj);
			for (const k of Object.keys(anyObj)) if (![
				"args",
				"callCount",
				"spy"
			].includes(k)) fSpy[k] = spyify(anyObj[k]);
			return downcast(fSpy);
		}
		case "object":
			if (anyObj instanceof Promise) return downcast(anyObj);
			if (Array.isArray(anyObj)) return downcast(anyObj);
else if (anyObj instanceof Map) {
				const entries = Array.from(anyObj.entries()).map(([k, v]) => [k, spyify(v)]);
				return downcast(new Map(entries));
			} else if (anyObj == null) return anyObj;
else {
				const newObj = {};
				for (let key of getAllPropertyNames(anyObj)) if (key === "__proto__") newObj[key] = obj[key];
else newObj[key] = spyify(obj[key]);
				return downcast(newObj);
			}
		default: return obj;
	}
}
/**
* create a class-like structure from an object to be able to o.spy on method and constructor calls
* @param template
* @returns {cls}
*/
function classify(template) {
	const cls = function() {
		cls.mockedInstances.push(this);
		for (const p of Object.keys(template.prototype)) if ("function" === typeof template.prototype[p]) this[p] = spy(template.prototype[p]);
else if ("object" === typeof template.prototype[p]) {
			const obj = template.prototype[p];
			this[p] = obj == null ? obj : Object.keys(obj).reduce((newObj, key) => {
				newObj[key] = obj[key];
				return newObj;
			}, {});
		} else this[p] = template.prototype[p];
		if (typeof template.prototype["constructor"] === "function") template.prototype["constructor"].apply(this, arguments);
	};
	if (template.statics) for (const s of Object.keys(template.statics)) cls[s] = template.statics[s];
	cls.mockedInstances = [];
	return downcast(cls);
}
function setPlatform(newPlatform) {
	setProperty(process, "platform", newPlatform);
}
function setProperty(object, property, value) {
	const originalProperty = Object.getOwnPropertyDescriptor(object, property);
	Object.defineProperty(object, property, { value });
	return originalProperty;
}
/**
* recursively merge two objects
* @param obj the base object
* @param adder properties in this object will replace properties of the same name in the base object or,
* in case of object type properties, be deep assigned to them.
* @returns {B}
*/
function deepAssign(obj, adder) {
	let ret;
	if (typeof adder !== "object" || typeof obj !== "object" || adder == null || obj == null) ret = adder;
else ret = Object.keys(adder).reduce((newObj, key) => {
		newObj[key] = deepAssign(newObj[key], adder[key]);
		return newObj;
	}, Object.assign({}, obj));
	return downcast(ret);
}
var MockBuilder = class {
	_mock;
	_old;
	constructor(old, obj) {
		this._mock = obj;
		this._old = old;
	}
	/**
	*
	* @param obj the object whose properties will replace properties on this mockbuilders output
	* @returns {MockBuilder<*>} a new mockbuilder with the combined output
	*/
	with(obj) {
		return mock(this._old, deepAssign(this._mock, obj));
	}
	/**
	* register & get the actual mock module object
	* warning! This effectively returns any.
	* @returns {T} the mock with recursively o.spy()'d functions
	*/
	set() {
		const copy = spyify(this._mock);
		return downcast(copy);
	}
};
const n = {
	classify,
	mock,
	spyify,
	setPlatform
};
var nodemocker_default = n;

//#endregion
export { nodemocker_default, spyify };
//# sourceMappingURL=nodemocker-Bh_RUICG.js.map