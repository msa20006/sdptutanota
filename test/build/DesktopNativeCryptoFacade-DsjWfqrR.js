
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { base64ToBase64Url, base64ToUint8Array, stringToUtf8Uint8Array, uint8ArrayToBase64, utf8Uint8ArrayToString } from "./dist-CJHwsXKY.js";
import { bitArrayToUint8Array, generateKeyFromPassphrase, uint8ArrayToKey } from "./dist-DcZ1Y4qd.js";
import { nonClobberingFilename } from "./PathUtils-DFfSo_TG.js";
import path from "node:path";

//#region ../src/common/desktop/DesktopNativeCryptoFacade.ts
var DesktopNativeCryptoFacade = class {
	constructor(fs, cryptoFns, tfs, argon2) {
		this.fs = fs;
		this.cryptoFns = cryptoFns;
		this.tfs = tfs;
		this.argon2 = argon2;
	}
	aesEncryptObject(encryptionKey, object) {
		const serializedObject = JSON.stringify(object);
		const encryptedBytes = this.cryptoFns.aesEncrypt(encryptionKey, stringToUtf8Uint8Array(serializedObject));
		return uint8ArrayToBase64(encryptedBytes);
	}
	aesDecryptObject(encryptionKey, serializedObject) {
		const encryptedBytes = base64ToUint8Array(serializedObject);
		const decryptedBytes = this.cryptoFns.aesDecrypt(encryptionKey, encryptedBytes, true);
		const stringObject = utf8Uint8ArrayToString(decryptedBytes);
		return JSON.parse(stringObject);
	}
	async aesEncryptFile(key, fileUri) {
		const bytes = await this.fs.promises.readFile(fileUri);
		const keyBits = this.cryptoFns.bytesToKey(key);
		const encrypted = this.cryptoFns.aesEncrypt(keyBits, bytes);
		const targetDir = await this.tfs.ensureEncryptedDir();
		const writtenFileName = path.basename(fileUri);
		const filePath = path.join(targetDir, writtenFileName);
		await this.fs.promises.writeFile(filePath, encrypted);
		return {
			uri: filePath,
			unencryptedSize: bytes.length
		};
	}
	/**
	* decrypts a file and returns the decrypted files path
	*/
	async aesDecryptFile(key, encryptedFileUri) {
		const targetDir = await this.tfs.ensureUnencrytpedDir();
		const encData = await this.fs.promises.readFile(encryptedFileUri);
		const bitKey = this.cryptoFns.bytesToKey(key);
		const decData = this.cryptoFns.aesDecrypt(bitKey, encData, true);
		const filesInDirectory = await this.fs.promises.readdir(targetDir);
		const writtenFileName = path.basename(encryptedFileUri);
		const newFilename = nonClobberingFilename(filesInDirectory, writtenFileName);
		const decryptedFileUri = path.join(targetDir, newFilename);
		await this.fs.promises.writeFile(decryptedFileUri, decData, { encoding: "binary" });
		return decryptedFileUri;
	}
	unauthenticatedAes256DecryptKey(encryptionKey, keyToDecrypt) {
		return this.cryptoFns.unauthenticatedAesDecrypt(encryptionKey, keyToDecrypt, false);
	}
	aes256EncryptKey(encryptionKey, keyToEncrypt) {
		return this.cryptoFns.aesEncrypt(encryptionKey, keyToEncrypt, undefined, false);
	}
	aesDecryptBytes(encryptionKey, data) {
		return this.cryptoFns.aesDecrypt(encryptionKey, data, true);
	}
	aesEncryptBytes(encryptionKey, data) {
		return this.cryptoFns.aesEncrypt(encryptionKey, data, undefined, true, true);
	}
	decryptAndMapToInstance(model, instance, piSessionKey, piSessionKeyEncSessionKey) {
		const sk = this.cryptoFns.decryptKey(uint8ArrayToKey(piSessionKey), piSessionKeyEncSessionKey);
		return this.cryptoFns.decryptAndMapToInstance(model, instance, sk);
	}
	generateId(byteLength) {
		return base64ToBase64Url(uint8ArrayToBase64(this.cryptoFns.randomBytes(byteLength)));
	}
	verifySignature(pem, data, sig) {
		return this.cryptoFns.verifySignature(pem, data, sig);
	}
	generateDeviceKey() {
		return this.cryptoFns.aes256RandomKey();
	}
	randomBytes(count) {
		return this.cryptoFns.randomBytes(count);
	}
	async rsaDecrypt(privateKey, data) {
		throw new Error("not implemented for this platform");
	}
	async rsaEncrypt(publicKey, data, seed) {
		throw new Error("not implemented for this platform");
	}
	async argon2idGeneratePassphraseKey(passphrase, salt) {
		const hash = await generateKeyFromPassphrase(await this.argon2, passphrase, salt);
		return bitArrayToUint8Array(hash);
	}
	generateKyberKeypair(seed) {
		throw new Error("not implemented for this platform");
	}
	kyberEncapsulate(publicKey, seed) {
		throw new Error("not implemented for this platform");
	}
	kyberDecapsulate(privateKey, ciphertext) {
		throw new Error("not implemented for this platform");
	}
};

//#endregion
export { DesktopNativeCryptoFacade };
//# sourceMappingURL=DesktopNativeCryptoFacade-DsjWfqrR.js.map