
globalThis.env = {
  "staticUrl": "http://localhost:9000",
  "versionNumber": "264.250130.1",
  "dist": false,
  "mode": "Test",
  "timeout": 20000,
  "domainConfigs": {
    "mail.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.tuta.com",
      "apiUrl": "https://mail.tutanota.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "test.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.test.tuta.com",
      "apiUrl": "https://test.tutanota.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://test.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://tutanota.com"
    },
    "app.local.tutanota.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tuta.com:9000",
      "apiUrl": "https://app.local.tutanota.com:9000",
      "paymentUrl": "https://local.tutanota.com:9000/client/build/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/client/build/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/client/build/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/client/build/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/client/build/webauthnmobile",
      "webauthnRpId": "tutanota.com",
      "u2fAppId": "https://local.tutanota.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tutanota.com:9000"
    },
    "app.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://mail.tutanota.com",
      "apiUrl": "https://app.tuta.com",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://mail.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://mail.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "app.test.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://test.tutanota.com",
      "apiUrl": "https://app.test.tuta.com",
      "paymentUrl": "https://pay.test.tutanota.com/braintree.html",
      "webauthnUrl": "https://app.test.tuta.com/webauthn",
      "legacyWebauthnUrl": "https://test.tutanota.com/webauthn",
      "webauthnMobileUrl": "https://app.test.tuta.com/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://test.tutanota.com/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.test.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.test.tuta.com/giftcard",
      "referralBaseUrl": "https://app.test.tuta.com/signup",
      "websiteBaseUrl": "https://test.tuta.com"
    },
    "app.local.tuta.com": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "https://app.local.tutanota.com:9000",
      "apiUrl": "https://app.local.tuta.com:9000",
      "paymentUrl": "https://app.local.tuta.com:9000/braintree.html",
      "webauthnUrl": "https://app.local.tuta.com:9000/webauthn",
      "legacyWebauthnUrl": "https://local.tutanota.com:9000/webauthn",
      "webauthnMobileUrl": "https://app.local.tuta.com:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "https://local.tutanota.com:9000/webauthnmobile",
      "webauthnRpId": "tuta.com",
      "u2fAppId": "https://app.local.tuta.com/u2f-appid.json",
      "giftCardBaseUrl": "https://app.local.tuta.com:9000/giftcard",
      "referralBaseUrl": "https://app.local.tuta.com:9000/signup",
      "websiteBaseUrl": "https://local.tuta.com:9000"
    },
    "localhost": {
      "firstPartyDomain": true,
      "partneredDomainTransitionUrl": "http://localhost:9000",
      "apiUrl": "http://localhost:9000",
      "paymentUrl": "http://localhost:9000/braintree.html",
      "webauthnUrl": "http://localhost:9000/webauthn",
      "legacyWebauthnUrl": "http://localhost:9000/webauthn",
      "webauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "legacyWebauthnMobileUrl": "http://localhost:9000/webauthnmobile",
      "webauthnRpId": "localhost",
      "u2fAppId": "http://localhost:9000/u2f-appid.json",
      "giftCardBaseUrl": "http://localhost:9000/giftcard",
      "referralBaseUrl": "http://localhost:9000/signup",
      "websiteBaseUrl": "https://tuta.com"
    },
    "{hostname}": {
      "firstPartyDomain": false,
      "partneredDomainTransitionUrl": "{protocol}//{hostname}",
      "apiUrl": "{protocol}//{hostname}",
      "paymentUrl": "https://pay.tutanota.com/braintree.html",
      "webauthnUrl": "{protocol}//{hostname}/webauthn",
      "legacyWebauthnUrl": "{protocol}//{hostname}/webauthn",
      "webauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "legacyWebauthnMobileUrl": "{protocol}//{hostname}/webauthnmobile",
      "webauthnRpId": "{hostname}",
      "u2fAppId": "{protocol}//{hostname}/u2f-appid.json",
      "giftCardBaseUrl": "https://app.tuta.com/giftcard",
      "referralBaseUrl": "https://app.tuta.com/signup",
      "websiteBaseUrl": "https://tuta.com"
    }
  },
  "platformId": null
};
const __NODE_GYP_better_sqlite3 = `./better-sqlite3.darwin-${typeof process !== 'undefined' ? process.arch : "unknown"}.node`
import { __toESM } from "./chunk-D_5_n1c4.js";
import { downcast } from "./dist-CJHwsXKY.js";
import "./dist-Rk9U8Iqn.js";
import "./ProgrammingError-D8yJGVtm.js";
import "./Env-D5xGlXfw.js";
import "./WhitelabelCustomizations-D1L5qbZi.js";
import { lang } from "./LanguageViewModel-BNC5ekpO.js";
import { client } from "./ClientDetector-D0v6Vqu6.js";
import { dist_default } from "./dist-Ci1bEzYU.js";
import { require_testdouble } from "./testdouble-IbRSnrC0.js";
import "./dist-BY49f75m.js";
import { nodemocker_default } from "./nodemocker-Bh_RUICG.js";

//#region ../src/common/desktop/DesktopContextMenu.ts
var DesktopContextMenu = class {
	constructor(electron, windowManager) {
		this.electron = electron;
		this.windowManager = windowManager;
	}
	open(params) {
		const { linkURL, editFlags, misspelledWord, dictionarySuggestions } = params;
		const menu = new this.electron.Menu();
		const pasteItem = new this.electron.MenuItem({
			label: lang.get("paste_action"),
			accelerator: "CmdOrCtrl+V",
			click: (_, bw) => this.getWebContents(bw)?.paste(),
			enabled: editFlags.canPaste
		});
		const pasteWithoutFormattingItem = new this.electron.MenuItem({
			label: lang.get("pasteWithoutFormatting_action"),
			accelerator: client.isMacOS ? "Cmd+Option+Shift+V" : "Ctrl+Shift+V",
			click: (_, bw) => this.getWebContents(bw)?.pasteAndMatchStyle(),
			enabled: editFlags.canPaste
		});
		const copyItem = new this.electron.MenuItem({
			label: lang.get("copy_action"),
			accelerator: "CmdOrCtrl+C",
			click: (_, bw) => this.getWebContents(bw)?.copy(),
			enabled: editFlags.canCopy
		});
		const cutItem = new this.electron.MenuItem({
			label: lang.get("cut_action"),
			accelerator: "CmdOrCtrl+X",
			click: (_, bw) => this.getWebContents(bw)?.cut(),
			enabled: editFlags.canCut
		});
		const copyLinkItem = new this.electron.MenuItem({
			label: lang.get("copyLink_action"),
			click: () => !!linkURL && this.electron.clipboard.writeText(linkURL),
			enabled: !!linkURL
		});
		const undoItem = new this.electron.MenuItem({
			label: lang.get("undo_action"),
			accelerator: "CmdOrCtrl+Z",
			click: (_, bw) => this.getWebContents(bw)?.undo(),
			enabled: editFlags.canUndo
		});
		const redoItem = new this.electron.MenuItem({
			label: lang.get("redo_action"),
			accelerator: "CmdOrCtrl+Shift+Z",
			click: (_, bw) => this.getWebContents(bw)?.redo(),
			enabled: editFlags.canRedo
		});
		const spellingItem = new this.electron.MenuItem({
			label: lang.get("spelling_label"),
			submenu: this.spellingSubmenu(misspelledWord, dictionarySuggestions)
		});
		menu.append(copyItem);
		menu.append(cutItem);
		menu.append(copyLinkItem);
		menu.append(pasteItem);
		menu.append(pasteWithoutFormattingItem);
		menu.append(new this.electron.MenuItem({ type: "separator" }));
		menu.append(undoItem);
		menu.append(redoItem);
		menu.append(new this.electron.MenuItem({ type: "separator" }));
		menu.append(spellingItem);
		menu.popup();
	}
	getWebContents(bw) {
		return bw && bw instanceof this.electron.BrowserWindow && bw.webContents || null;
	}
	spellingSubmenu(misspelledWord, dictionarySuggestions) {
		const submenu = new this.electron.Menu();
		if (misspelledWord !== "") {
			for (const s of dictionarySuggestions) {
				const menuItem = new this.electron.MenuItem({
					label: s,
					click: (_, bw) => this.getWebContents(bw)?.replaceMisspelling(s)
				});
				submenu.append(menuItem);
			}
			submenu.append(new this.electron.MenuItem({ type: "separator" }));
			submenu.append(new this.electron.MenuItem({
				label: lang.get("addToDict_action", { "{word}": misspelledWord }),
				click: (_, bw) => this.getWebContents(bw)?.session.addWordToSpellCheckerDictionary(misspelledWord)
			}));
		}
		if (process.platform !== "darwin") submenu.append(new this.electron.MenuItem({
			label: lang.get("changeSpellCheckLang_action"),
			click: (_, bw) => {
				const webContents = this.getWebContents(bw);
				if (webContents) this.changeSpellcheckLanguage(webContents);
			}
		}));
		return submenu;
	}
	async changeSpellcheckLanguage(wc) {
		const windowId = this.electron.BrowserWindow.fromWebContents(wc)?.id;
		if (windowId == null) return;
		const window = this.windowManager.get(windowId);
		window?.desktopFacade.showSpellcheckDropdown();
	}
};

//#endregion
//#region tests/desktop/DesktopContextMenuTest.ts
var import_testdouble = __toESM(require_testdouble(), 1);
dist_default.spec("DesktopContextMenu Test", () => {
	const standardMocks = () => {
		const electron = {
			clipboard: { writeText: () => {} },
			Menu: nodemocker_default.classify({
				prototype: {
					append: function() {},
					popup: function() {}
				},
				statics: {}
			}),
			MenuItem: nodemocker_default.classify({
				prototype: {
					enabled: true,
					constructor: function(p) {
						Object.assign(this, p);
					}
				},
				statics: {}
			})
		};
		const electronMock = nodemocker_default.mock("electron", electron).set();
		return { electronMock };
	};
	dist_default("can handle undefined browserWindow and webContents in callback", () => {
		const { electronMock } = standardMocks();
		const wm = (0, import_testdouble.object)();
		const contextMenu = new DesktopContextMenu(electronMock, wm);
		const contextMenuParams = {
			linkURL: "nourl",
			editFlags: {
				canCut: false,
				canPaste: false,
				canCopy: false,
				canUndo: false,
				canRedo: false,
				canEditRichly: false,
				canDelete: false,
				canSelectAll: false
			},
			dictionarySuggestions: [],
			misspelledWord: ""
		};
		contextMenu.open(contextMenuParams);
		for (const i of downcast(electronMock.MenuItem).mockedInstances) i.click?.(undefined);
		for (const i of downcast(electronMock.MenuItem).mockedInstances) i.click?.(undefined);
	});
});

//#endregion
//# sourceMappingURL=DesktopContextMenuTest-BNC5ekpO.js.map