{"version":3,"file":"ProgressMonitor-HBfOF56H.js","names":["totalWork: number","updater: ProgressListener","amount: number","totalAmount: number"],"sources":["../../src/common/api/common/utils/ProgressMonitor.ts"],"sourcesContent":["import type { ProgressTracker } from \"../../main/ProgressTracker\"\nimport { assertNotNull } from \"@tutao/tutanota-utils\"\n\nexport type ProgressMonitorId = number\nexport type ProgressListener = (percentageCompleted: number) => unknown\n\nexport interface IProgressMonitor {\n\t/**\n\t * @param amount of work completed in current step\n\t */\n\tworkDone(amount: number): void\n\n\ttotalWorkDone(totalAmount: number): void\n\n\tcompleted(): void\n}\n\n/**\n * Class to calculate percentage of total work and report it back.\n * Call {@code workDone() or @code totalWorkDone()} for each work step and {@code completed()}\n * when you are done.\n */\nexport class ProgressMonitor implements IProgressMonitor {\n\tworkCompleted: number\n\n\tconstructor(readonly totalWork: number, private readonly updater: ProgressListener) {\n\t\tthis.workCompleted = 0\n\t}\n\n\tworkDone(amount: number) {\n\t\tthis.workCompleted += amount\n\t\tthis.updater(this.percentage())\n\t}\n\n\ttotalWorkDone(totalAmount: number) {\n\t\tthis.workCompleted = totalAmount\n\t\tthis.updater(this.percentage())\n\t}\n\n\tpercentage(): number {\n\t\tconst result = (100 * this.workCompleted) / this.totalWork\n\t\treturn Math.min(100, result)\n\t}\n\n\tcompleted() {\n\t\tthis.workCompleted = this.totalWork\n\t\tthis.updater(100)\n\t}\n}\n\nexport class NoopProgressMonitor implements IProgressMonitor {\n\tworkDone(amount: number) {}\n\n\ttotalWorkDone(totalAmount: number) {}\n\n\tcompleted() {}\n}\n\nexport function makeTrackedProgressMonitor(tracker: ProgressTracker, totalWork: number): IProgressMonitor {\n\tif (totalWork < 1) return new NoopProgressMonitor()\n\tconst handle = tracker.registerMonitorSync(totalWork)\n\treturn assertNotNull(tracker.getMonitor(handle))\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAsBa,kBAAN,MAAkD;CACxD;CAEA,YAAqBA,WAAoCC,SAA2B;EAsCpF,KAtCqB;EAsCpB,KAtCwD;AACxD,OAAK,gBAAgB;CACrB;CAED,SAASC,QAAgB;AACxB,OAAK,iBAAiB;AACtB,OAAK,QAAQ,KAAK,YAAY,CAAC;CAC/B;CAED,cAAcC,aAAqB;AAClC,OAAK,gBAAgB;AACrB,OAAK,QAAQ,KAAK,YAAY,CAAC;CAC/B;CAED,aAAqB;EACpB,MAAM,SAAU,MAAM,KAAK,gBAAiB,KAAK;AACjD,SAAO,KAAK,IAAI,KAAK,OAAO;CAC5B;CAED,YAAY;AACX,OAAK,gBAAgB,KAAK;AAC1B,OAAK,QAAQ,IAAI;CACjB;AACD;IAEY,sBAAN,MAAsD;CAC5D,SAASD,QAAgB,CAAE;CAE3B,cAAcC,aAAqB,CAAE;CAErC,YAAY,CAAE;AACd"}