{"version":3,"file":"TextField.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/TextField.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, ClassComponent, CVnode } from \"mithril\"\nimport { px, size } from \"../size\"\nimport { DefaultAnimationTime } from \"../animation/Animations\"\nimport { theme } from \"../theme\"\nimport type { MaybeTranslation } from \"../../misc/LanguageViewModel\"\nimport { lang } from \"../../misc/LanguageViewModel\"\nimport type { lazy } from \"@tutao/tutanota-utils\"\nimport { isKeyPressed, keyHandler, useKeyHandler } from \"../../misc/KeyManager\"\nimport { Keys, TabIndex } from \"../../api/common/TutanotaConstants\"\nimport { ClickHandler, getOperatingClasses } from \"./GuiUtils\"\nimport { AriaPopupType } from \"../AriaUtils.js\"\n\nexport type TextFieldAttrs = {\n\tid?: string\n\tlabel: MaybeTranslation\n\tvalue: string\n\tautocompleteAs?: Autocomplete\n\tautocapitalize?: Autocapitalize\n\ttype?: TextFieldType\n\thasPopup?: AriaPopupType\n\thelpLabel?: lazy<Children> | null\n\talignRight?: boolean\n\tinjectionsLeft?: lazy<Children>\n\t// only used by the BubbleTextField (-> uses old TextField) to display bubbles and out of office notification\n\tinjectionsRight?: lazy<Children>\n\tkeyHandler?: keyHandler\n\tonDomInputCreated?: (dom: HTMLInputElement) => void\n\t// interceptor used by the BubbleTextField to react on certain keys\n\tonfocus?: (dom: HTMLElement, input: HTMLInputElement) => unknown\n\tonblur?: (...args: Array<any>) => any\n\tmaxWidth?: number\n\tclass?: string\n\tstyle?: Record<string, any> //Temporary, Do not use\n\tdisabled?: boolean\n\t// Creates a dummy TextField without interactively & disabled styling\n\tisReadOnly?: boolean\n\toninput?: (value: string, input: HTMLInputElement) => unknown\n\tonclick?: ClickHandler\n\tdoShowBorder?: boolean | null\n\tfontSize?: string\n\tmin?: number\n\tmax?: number\n}\n\nexport const enum TextFieldType {\n\tText = \"text\",\n\tEmail = \"email\",\n\t/** @deprecated Prefer the `PasswordField` component over using this type with `TextField` */\n\tPassword = \"password\",\n\tArea = \"area\",\n\tNumber = \"number\",\n\tUrl = \"url\",\n\tDate = \"date\",\n\tTime = \"time\",\n}\n\n// relevant subset of possible values for the autocomplete html field\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/autocomplete\nexport const enum Autocomplete {\n\toff = \"off\",\n\temail = \"email\",\n\tusername = \"username\",\n\tnewPassword = \"new-password\",\n\tcurrentPassword = \"current-password\",\n\toneTimeCode = \"one-time-code\",\n\tccNumber = \"cc-number\",\n\tccCsc = \"cc-csc\",\n\tccExp = \"cc-exp\",\n}\n\n// relevant subset of possible values for the autocapitalize html field\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/autocapitalize\nexport const enum Autocapitalize {\n\tnone = \"none\",\n}\n\nexport const inputLineHeight: number = size.font_size_base + 8\nconst inputMarginTop = size.font_size_small + size.hpad_small + 3\n\n// this is not always correct because font size can be bigger/smaller, and we ideally should take that into account\nconst baseLabelPosition = 21\n// it should fit\n// compact button + 1 px border + 1 px padding to keep things centered = 32\n// 24px line-height + 12px label + some space between them = 36 + ?\nconst minInputHeight = 46\n\nexport class TextField implements ClassComponent<TextFieldAttrs> {\n\tactive: boolean\n\tonblur: EventListener | null = null\n\tdomInput!: HTMLInputElement\n\t_domWrapper!: HTMLElement\n\tprivate _domLabel!: HTMLElement\n\tprivate _domInputWrapper!: HTMLElement\n\tprivate _didAutofill!: boolean\n\n\tconstructor() {\n\t\tthis.active = false\n\t}\n\n\tview(vnode: CVnode<TextFieldAttrs>): Children {\n\t\tconst a = vnode.attrs\n\t\tconst maxWidth = a.maxWidth\n\t\tconst labelBase = !this.active && a.value === \"\" && !a.isReadOnly && !this._didAutofill && !a.injectionsLeft\n\t\tconst labelTransitionSpeed = DefaultAnimationTime / 2\n\t\tconst doShowBorder = a.doShowBorder !== false\n\t\tconst borderWidth = this.active ? \"2px\" : \"1px\"\n\t\tconst borderColor = this.active ? theme.content_accent : theme.content_border\n\t\treturn m(\n\t\t\t\".text-field.rel.overflow-hidden\",\n\t\t\t{\n\t\t\t\tid: vnode.attrs.id,\n\t\t\t\toncreate: (vnode) => (this._domWrapper = vnode.dom as HTMLElement),\n\t\t\t\tonclick: (e: MouseEvent) => (a.onclick ? a.onclick(e, this._domInputWrapper) : this.focus(e, a)),\n\t\t\t\t\"aria-haspopup\": a.hasPopup,\n\t\t\t\tclass: a.class != null ? a.class : \"pt\" + \" \" + getOperatingClasses(a.disabled),\n\t\t\t\tstyle: maxWidth\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tmaxWidth: px(maxWidth),\n\t\t\t\t\t\t\t...a.style,\n\t\t\t\t\t  }\n\t\t\t\t\t: { ...a.style },\n\t\t\t},\n\t\t\t[\n\t\t\t\tm(\n\t\t\t\t\t\"label.abs.text-ellipsis.noselect.z1.i.pr-s\",\n\t\t\t\t\t{\n\t\t\t\t\t\t\"aria-hidden\": \"true\",\n\t\t\t\t\t\tclass: this.active ? \"content-accent-fg\" : \"\" + \" \" + getOperatingClasses(a.disabled),\n\t\t\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\t\t\tthis._domLabel = vnode.dom as HTMLElement\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tfontSize: `${labelBase ? size.font_size_base : size.font_size_small}px`,\n\t\t\t\t\t\t\ttransform: `translateY(${labelBase ? baseLabelPosition : 0}px)`,\n\t\t\t\t\t\t\ttransition: `transform ${labelTransitionSpeed}ms ease-out, font-size ${labelTransitionSpeed}ms  ease-out`,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tlang.getTranslationText(a.label),\n\t\t\t\t),\n\t\t\t\tm(\".flex.flex-column\", [\n\t\t\t\t\t// another wrapper to fix IE 11 min-height bug https://github.com/philipwalton/flexbugs#3-min-height-on-a-flex-container-wont-apply-to-its-flex-items\n\t\t\t\t\tm(\n\t\t\t\t\t\t\".flex.items-end.flex-wrap\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// .flex-wrap\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\"min-height\": px(minInputHeight),\n\t\t\t\t\t\t\t\t// 2 px border\n\t\t\t\t\t\t\t\t\"padding-bottom\": this.active ? px(0) : px(1),\n\t\t\t\t\t\t\t\t\"border-bottom\": doShowBorder ? `${borderWidth} solid ${borderColor}` : \"\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\ta.injectionsLeft ? a.injectionsLeft() : null, // additional wrapper element for bubble input field. input field should always be in one line with right injections\n\t\t\t\t\t\t\tm(\n\t\t\t\t\t\t\t\t\".inputWrapper.flex-space-between.items-end\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\t\tminHeight: px(minInputHeight - 2), // minus padding\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\toncreate: (vnode) => (this._domInputWrapper = vnode.dom as HTMLElement),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\ta.type !== TextFieldType.Area ? this._getInputField(a) : this._getTextArea(a),\n\t\t\t\t\t\t\t\t\ta.injectionsRight\n\t\t\t\t\t\t\t\t\t\t? m(\n\t\t\t\t\t\t\t\t\t\t\t\t\".flex-end.items-center\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle: { minHeight: px(minInputHeight - 2) },\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\ta.injectionsRight(),\n\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t),\n\t\t\t\t]),\n\t\t\t\ta.helpLabel\n\t\t\t\t\t? m(\n\t\t\t\t\t\t\t\"small.noselect\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tonclick: (e: MouseEvent) => {\n\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ta.helpLabel(),\n\t\t\t\t\t  )\n\t\t\t\t\t: [],\n\t\t\t],\n\t\t)\n\t}\n\n\t_getInputField(a: TextFieldAttrs): Children {\n\t\tif (a.isReadOnly) {\n\t\t\treturn m(\n\t\t\t\t\".text-break.selectable\",\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tmarginTop: px(inputMarginTop),\n\t\t\t\t\t\tlineHeight: px(inputLineHeight),\n\t\t\t\t\t},\n\t\t\t\t\t\"data-testid\": `tf:${lang.getTestId(a.label)}`,\n\t\t\t\t},\n\t\t\t\ta.value,\n\t\t\t)\n\t\t} else {\n\t\t\t// Due to modern browser's 'smart' password managers that try to autofill everything\n\t\t\t// that remotely resembles a password field, we prepend invisible inputs to password fields\n\t\t\t// that shouldn't be autofilled.\n\t\t\t// since the autofill algorithm looks at inputs that come before and after the password field we need\n\t\t\t// three dummies.\n\t\t\tconst autofillGuard: Children =\n\t\t\t\ta.autocompleteAs === Autocomplete.off\n\t\t\t\t\t? [\n\t\t\t\t\t\t\tm(\"input.abs\", {\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\topacity: \"0\",\n\t\t\t\t\t\t\t\t\theight: \"0\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttabIndex: TabIndex.Programmatic,\n\t\t\t\t\t\t\t\ttype: TextFieldType.Text,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tm(\"input.abs\", {\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\topacity: \"0\",\n\t\t\t\t\t\t\t\t\theight: \"0\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttabIndex: TabIndex.Programmatic,\n\t\t\t\t\t\t\t\ttype: TextFieldType.Password,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tm(\"input.abs\", {\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\topacity: \"0\",\n\t\t\t\t\t\t\t\t\theight: \"0\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttabIndex: TabIndex.Programmatic,\n\t\t\t\t\t\t\t\ttype: TextFieldType.Text,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t  ]\n\t\t\t\t\t: []\n\t\t\treturn m(\n\t\t\t\t\".flex-grow.rel\",\n\t\t\t\tautofillGuard.concat([\n\t\t\t\t\tm(\"input.input\" + (a.alignRight ? \".right\" : \"\"), {\n\t\t\t\t\t\tautocomplete: a.autocompleteAs ?? \"\",\n\t\t\t\t\t\tautocapitalize: a.autocapitalize,\n\t\t\t\t\t\ttype: a.type,\n\t\t\t\t\t\tmin: a.min,\n\t\t\t\t\t\tmax: a.max,\n\t\t\t\t\t\t\"aria-label\": lang.getTranslationText(a.label),\n\t\t\t\t\t\tdisabled: a.disabled,\n\t\t\t\t\t\tclass: getOperatingClasses(a.disabled) + \" text\",\n\t\t\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\t\t\tthis.domInput = vnode.dom as HTMLInputElement\n\t\t\t\t\t\t\ta.onDomInputCreated?.(this.domInput)\n\t\t\t\t\t\t\tthis.domInput.value = a.value\n\t\t\t\t\t\t\tif (a.type !== TextFieldType.Area) {\n\t\t\t\t\t\t\t\t;(vnode.dom as HTMLElement).addEventListener(\"animationstart\", (e: AnimationEvent) => {\n\t\t\t\t\t\t\t\t\tif (e.animationName === \"onAutoFillStart\") {\n\t\t\t\t\t\t\t\t\t\tthis._didAutofill = true\n\t\t\t\t\t\t\t\t\t\tm.redraw()\n\t\t\t\t\t\t\t\t\t} else if (e.animationName === \"onAutoFillCancel\") {\n\t\t\t\t\t\t\t\t\t\tthis._didAutofill = false\n\t\t\t\t\t\t\t\t\t\tm.redraw()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonfocus: (e: FocusEvent) => {\n\t\t\t\t\t\t\tthis.focus(e, a)\n\t\t\t\t\t\t\ta.onfocus?.(this._domWrapper, this.domInput)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonblur: (e: FocusEvent) => this.blur(e, a),\n\t\t\t\t\t\tonkeydown: (e: KeyboardEvent) => {\n\t\t\t\t\t\t\tconst handled = useKeyHandler(e, a.keyHandler)\n\t\t\t\t\t\t\tif (!isKeyPressed(e.key, Keys.F1, Keys.TAB, Keys.ESC)) {\n\t\t\t\t\t\t\t\t// When we are in a text field we don't want keys propagated up to act as hotkeys\n\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn handled\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonupdate: () => {\n\t\t\t\t\t\t\t// only change the value if the value has changed otherwise the cursor in Safari and in the iOS App cannot be positioned.\n\t\t\t\t\t\t\tif (this.domInput.value !== a.value) {\n\t\t\t\t\t\t\t\tthis.domInput.value = a.value\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\toninput: () => {\n\t\t\t\t\t\t\ta.oninput?.(this.domInput.value, this.domInput)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonremove: () => {\n\t\t\t\t\t\t\t// We clean up any value that might still be in DOM e.g. password\n\t\t\t\t\t\t\tif (this.domInput) this.domInput.value = \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tmaxWidth: a.maxWidth,\n\t\t\t\t\t\t\tminWidth: px(20),\n\t\t\t\t\t\t\t// fix for edge browser. buttons are cut off in small windows otherwise\n\t\t\t\t\t\t\tlineHeight: px(inputLineHeight),\n\t\t\t\t\t\t\tfontSize: a.fontSize,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"data-testid\": `tf:${lang.getTestId(a.label)}`,\n\t\t\t\t\t}),\n\t\t\t\t]),\n\t\t\t)\n\t\t}\n\t}\n\n\t_getTextArea(a: TextFieldAttrs): Children {\n\t\tif (a.isReadOnly) {\n\t\t\treturn m(\n\t\t\t\t\".text-prewrap.text-break.selectable\",\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tmarginTop: px(inputMarginTop),\n\t\t\t\t\t\tlineHeight: px(inputLineHeight),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\ta.value,\n\t\t\t)\n\t\t} else {\n\t\t\treturn m(\"textarea.input-area.text-pre\", {\n\t\t\t\t\"aria-label\": lang.getTranslationText(a.label),\n\t\t\t\tdisabled: a.disabled,\n\t\t\t\tautocapitalize: a.autocapitalize,\n\t\t\t\tclass: getOperatingClasses(a.disabled) + \" text\",\n\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\tthis.domInput = vnode.dom as HTMLInputElement\n\t\t\t\t\tthis.domInput.value = a.value\n\t\t\t\t\tthis.domInput.style.height = px(Math.max(a.value.split(\"\\n\").length, 1) * inputLineHeight) // display all lines on creation of text area\n\t\t\t\t},\n\t\t\t\tonfocus: (e: FocusEvent) => this.focus(e, a),\n\t\t\t\tonblur: (e: FocusEvent) => this.blur(e, a),\n\t\t\t\tonkeydown: (e: KeyboardEvent) => useKeyHandler(e, a.keyHandler),\n\t\t\t\toninput: () => {\n\t\t\t\t\tthis.domInput.style.height = \"0px\"\n\t\t\t\t\tthis.domInput.style.height = px(this.domInput.scrollHeight)\n\t\t\t\t\ta.oninput?.(this.domInput.value, this.domInput)\n\t\t\t\t},\n\t\t\t\tonupdate: () => {\n\t\t\t\t\t// only change the value if the value has changed otherwise the cursor in Safari and in the iOS App cannot be positioned.\n\t\t\t\t\tif (this.domInput.value !== a.value) {\n\t\t\t\t\t\tthis.domInput.value = a.value\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\tmarginTop: px(inputMarginTop),\n\t\t\t\t\tlineHeight: px(inputLineHeight),\n\t\t\t\t\tminWidth: px(20), // fix for edge browser. buttons are cut off in small windows otherwise\n\t\t\t\t\tfontSize: a.fontSize,\n\t\t\t\t},\n\t\t\t})\n\t\t}\n\t}\n\n\tfocus(e: Event, a: TextFieldAttrs) {\n\t\tif (!this.active && !a.disabled && !a.isReadOnly) {\n\t\t\tthis.active = true\n\t\t\tthis.domInput.focus()\n\n\t\t\tthis._domWrapper.classList.add(\"active\")\n\t\t}\n\t}\n\n\tblur(e: Event, a: TextFieldAttrs) {\n\t\tthis._domWrapper.classList.remove(\"active\")\n\t\tthis.active = false\n\t\tif (a.onblur instanceof Function) a.onblur(e)\n\t}\n\n\tisEmpty(value: string): boolean {\n\t\treturn value === \"\"\n\t}\n}\n"]}