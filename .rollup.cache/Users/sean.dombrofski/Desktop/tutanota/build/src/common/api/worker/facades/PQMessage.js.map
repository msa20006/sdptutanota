{"version":3,"file":"PQMessage.js","sourceRoot":"","sources":["../../../../../../src/common/api/worker/facades/PQMessage.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,MAAM,wCAAwC,CAAA;AAa7F,MAAM,UAAU,eAAe,CAAC,OAAmB;IAClD,MAAM,cAAc,GAAG,iBAAiB,CAAC,OAAO,EAAE,CAAC,CAAC,CAAA;IACpD,OAAO;QACN,oBAAoB,EAAE,cAAc,CAAC,CAAC,CAAC;QACvC,eAAe,EAAE,cAAc,CAAC,CAAC,CAAC;QAClC,aAAa,EAAE;YACd,eAAe,EAAE,cAAc,CAAC,CAAC,CAAC;YAClC,eAAe,EAAE,cAAc,CAAC,CAAC,CAAC;SAClC;KACD,CAAA;AACF,CAAC;AAED,MAAM,UAAU,eAAe,CAAC,EAAE,oBAAoB,EAAE,eAAe,EAAE,aAAa,EAAa;IAClG,OAAO,iBAAiB,CAAC,CAAC,oBAAoB,EAAE,eAAe,EAAE,aAAa,CAAC,eAAe,EAAE,aAAa,CAAC,eAAe,CAAC,CAAC,CAAA;AAChI,CAAC","sourcesContent":["import { EccPublicKey } from \"@tutao/tutanota-crypto\"\nimport { byteArraysToBytes, bytesToByteArrays } from \"@tutao/tutanota-utils/dist/Encoding.js\"\n\nexport type PQMessage = {\n\tsenderIdentityPubKey: EccPublicKey\n\tephemeralPubKey: EccPublicKey\n\tencapsulation: PQBucketKeyEncapsulation\n}\n\nexport type PQBucketKeyEncapsulation = {\n\tkyberCipherText: Uint8Array\n\tkekEncBucketKey: Uint8Array\n}\n\nexport function decodePQMessage(encoded: Uint8Array): PQMessage {\n\tconst pqMessageParts = bytesToByteArrays(encoded, 4)\n\treturn {\n\t\tsenderIdentityPubKey: pqMessageParts[0],\n\t\tephemeralPubKey: pqMessageParts[1],\n\t\tencapsulation: {\n\t\t\tkyberCipherText: pqMessageParts[2],\n\t\t\tkekEncBucketKey: pqMessageParts[3],\n\t\t},\n\t}\n}\n\nexport function encodePQMessage({ senderIdentityPubKey, ephemeralPubKey, encapsulation }: PQMessage): Uint8Array {\n\treturn byteArraysToBytes([senderIdentityPubKey, ephemeralPubKey, encapsulation.kyberCipherText, encapsulation.kekEncBucketKey])\n}\n"]}