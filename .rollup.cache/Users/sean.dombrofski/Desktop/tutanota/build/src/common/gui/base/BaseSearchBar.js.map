{"version":3,"file":"BaseSearchBar.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/BaseSearchBar.ts"],"names":[],"mappings":"AAAA,OAAO,CAAsC,MAAM,SAAS,CAAA;AAC5D,OAAO,EAAiB,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAC9D,OAAO,EAAE,eAAe,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,YAAY,CAAA;AACtD,OAAO,EAAE,MAAM,EAAE,MAAM,cAAc,CAAA;AAGrC,OAAO,EAAE,oBAAoB,EAAE,MAAM,4BAA4B,CAAA;AAGjE,OAAO,EAAE,IAAI,EAAa,QAAQ,EAAE,MAAM,WAAW,CAAA;AACrD,OAAO,EAAE,KAAK,EAAE,MAAM,aAAa,CAAA;AAEnC,OAAO,EAAE,UAAU,EAAmB,MAAM,yBAAyB,CAAA;AACrE,OAAO,EAAE,mBAAmB,EAAE,MAAM,eAAe,CAAA;AAiBnD,MAAM,OAAO,aAAa;IACjB,QAAQ,CAAmB;IAC3B,SAAS,GAAY,KAAK,CAAA;IAElC,IAAI,CAAC,EAAE,KAAK,EAA6B;QACxC,OAAO,CAAC,CACP,mFAAmF,EACnF;YACC,OAAO,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;YAC/B,GAAG,aAAa,qCAAsB;YACtC,KAAK,EAAE,mBAAmB,CAAC,KAAK,CAAC,QAAQ,CAAC;YAC1C,KAAK,EAAE;gBACN,YAAY,EAAE,EAAE,CAAC,eAAe,GAAG,CAAC,CAAC;gBACrC,YAAY,EAAE,EAAE,CAAC,CAAC,CAAC;gBACnB,eAAe,EAAE,EAAE,CAAC,CAAC,CAAC;gBACtB,WAAW,EAAE,MAAM,CAAC,uBAAuB,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC;aAC5D;YACD,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE;gBACrB,KAAK,CAAC,gBAAgB,EAAE,CAAC,GAAkB,CAAC,CAAA;YAC7C,CAAC;YACD,OAAO,EAAE,GAAG,EAAE;gBACb,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;oBACrB,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE,CAAA;oBACtB,KAAK,CAAC,aAAa,EAAE,EAAE,CAAA;gBACxB,CAAC;YACF,CAAC;SACD,EACD;YACC,MAAM,CAAC,eAAe,EAAE;gBACvB,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;oBACR,IAAI,iCAAkB;oBACtB,IAAI,EAAE,QAAQ,CAAC,MAAM;oBACrB,KAAK,EAAE;wBACN,IAAI,EAAE,KAAK,CAAC,cAAc;qBAC1B;iBACoB,CAAC;gBACxB,CAAC,CAAC,IAAI;YACP,CAAC,CACA,oBAAoB,EACpB;gBACC,KAAK,EAAE;oBACN,KAAK,EAAE,MAAM;oBACb,UAAU,EAAE,SAAS,oBAAoB,IAAI;oBAC7C,cAAc,EAAE,MAAM,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBACzD,aAAa,EAAE,KAAK;oBACpB,gBAAgB,EAAE,KAAK;oBACvB,YAAY,EAAE,QAAQ;iBACtB;aACD,EACD,CAAC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAC9B;YACD,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI;gBACvB,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE;oBACd,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,WAAW;oBAC/C,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE;wBACb,SAAS,EAAE,KAAK;wBAChB,IAAI,EAAE,QAAQ,CAAC,MAAM;wBACrB,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,qCAAoB,CAAC,0BAAY;wBACnD,KAAK,EAAE,YAAY,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,oCAAoC,CAAC,CAAC,CAAC,EAAE,CAAC;wBAC9E,KAAK,EAAE;4BACN,IAAI,EAAE,KAAK,CAAC,aAAa;yBACzB;qBACD,CAAC;oBACF,OAAO,EAAE,GAAG,EAAE;wBACb,IAAI,CAAC,KAAK,CAAC,QAAQ;4BAAE,KAAK,CAAC,OAAO,EAAE,EAAE,CAAA;oBACvC,CAAC;oBACD,QAAQ,EAAE,KAAK,CAAC,IAAI;oBACpB,KAAK,EAAE;wBACN,KAAK,EAAE,IAAI,CAAC,eAAe;qBAC3B;iBAC0B,CAAC;gBAC9B,CAAC,CAAC,IAAI;SACP,CACD,CAAA;IACF,CAAC;IAEO,gBAAgB,CAAC,KAAyB;QACjD,OAAO,CAAC,CAAC,4BAA4B,EAAE;YACtC,mBAAmB,EAAE,MAAM;YAC3B,QAAQ,4BAAkB;YAC1B,IAAI,EAAE,UAAU;YAChB,WAAW,EAAE,KAAK,CAAC,WAAW;YAC9B,IAAI,iCAAoB;YACxB,KAAK,EAAE,KAAK,CAAC,IAAI;YACjB,QAAQ,EAAE,KAAK,CAAC,QAAQ;YACxB,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;gBACnB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,GAAuB,CAAA;gBAC7C,KAAK,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;YACtC,CAAC;YACD,OAAO,EAAE,GAAG,EAAE;gBACb,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;gBAErB,KAAK,CAAC,OAAO,EAAE,EAAE,CAAA;YAClB,CAAC;YACD,MAAM,EAAE,GAAG,EAAE;gBACZ,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;gBACtB,KAAK,CAAC,MAAM,EAAE,EAAE,CAAA;YACjB,CAAC;YACD,QAAQ,EAAE,GAAG,EAAE;gBACd,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAA;gBAC3B,IAAI,CAAC,SAAS,GAAG,KAAK,CAAA;YACvB,CAAC;YACD,OAAO,EAAE,GAAG,EAAE;gBACb,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;YACnC,CAAC;YACD,SAAS,EAAE,CAAC,CAAgB,EAAE,EAAE;gBAC/B,KAAK,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAA;YACrB,CAAC;YACD,KAAK,EAAE;gBACN,aAAa,EAAE,EAAE,CAAC,eAAe,CAAC;aAClC;SACD,CAAC,CAAA;IACH,CAAC;CACD","sourcesContent":["import m, { Children, ClassComponent, Vnode } from \"mithril\"\nimport { AriaLandmarks, landmarkAttrs } from \"../AriaUtils.js\"\nimport { inputLineHeight, px, size } from \"../size.js\"\nimport { styles } from \"../styles.js\"\nimport { TabIndex } from \"../../api/common/TutanotaConstants.js\"\nimport { BootIcons } from \"./icons/BootIcons.js\"\nimport { DefaultAnimationTime } from \"../animation/Animations.js\"\nimport { Icons } from \"./icons/Icons.js\"\nimport { TextFieldType } from \"./TextField.js\"\nimport { Icon, IconAttrs, IconSize } from \"./Icon.js\"\nimport { theme } from \"../theme.js\"\nimport { lang } from \"../../misc/LanguageViewModel.js\"\nimport { BaseButton, BaseButtonAttrs } from \"./buttons/BaseButton.js\"\nimport { getOperatingClasses } from \"./GuiUtils.js\"\n\nexport interface BaseSearchBarAttrs {\n\tplaceholder?: string | null\n\ttext: string\n\tbusy: boolean\n\tdisabled?: boolean\n\tonInput: (text: string) => unknown\n\tonFocus?: () => unknown\n\tonBlur?: () => unknown\n\tonSearchClick?: () => unknown\n\tonClear?: () => unknown\n\tonInputCreated?: (dom: HTMLElement) => unknown\n\tonWrapperCreated?: (dom: HTMLElement) => unknown\n\tonKeyDown?: (keyboardEvent: KeyboardEvent) => unknown\n}\n\nexport class BaseSearchBar implements ClassComponent<BaseSearchBarAttrs> {\n\tprivate domInput!: HTMLInputElement\n\tprivate isFocused: boolean = false\n\n\tview({ attrs }: Vnode<BaseSearchBarAttrs>) {\n\t\treturn m(\n\t\t\t\".flex-end.items-center.border-radius.plr-s.pt-xs.pb-xs.search-bar.flex-grow.click\",\n\t\t\t{\n\t\t\t\tfocused: String(this.isFocused),\n\t\t\t\t...landmarkAttrs(AriaLandmarks.Search),\n\t\t\t\tclass: getOperatingClasses(attrs.disabled),\n\t\t\t\tstyle: {\n\t\t\t\t\t\"min-height\": px(inputLineHeight + 2),\n\t\t\t\t\t\"margin-top\": px(6),\n\t\t\t\t\t\"margin-bottom\": px(6),\n\t\t\t\t\t\"max-width\": styles.isUsingBottomNavigation() ? \"\" : px(350),\n\t\t\t\t},\n\t\t\t\toncreate: ({ dom }) => {\n\t\t\t\t\tattrs.onWrapperCreated?.(dom as HTMLElement)\n\t\t\t\t},\n\t\t\t\tonclick: () => {\n\t\t\t\t\tif (!attrs.disabled) {\n\t\t\t\t\t\tthis.domInput?.focus()\n\t\t\t\t\t\tattrs.onSearchClick?.()\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t[\n\t\t\t\tstyles.isDesktopLayout()\n\t\t\t\t\t? m(Icon, {\n\t\t\t\t\t\t\ticon: BootIcons.Search,\n\t\t\t\t\t\t\tsize: IconSize.Medium,\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tfill: theme.content_button,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  } satisfies IconAttrs)\n\t\t\t\t\t: null,\n\t\t\t\tm(\n\t\t\t\t\t\".flex.items-center\",\n\t\t\t\t\t{\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\t\t\ttransition: `width ${DefaultAnimationTime}ms`,\n\t\t\t\t\t\t\t\"padding-left\": styles.isDesktopLayout() ? px(10) : px(6),\n\t\t\t\t\t\t\t\"padding-top\": \"3px\",\n\t\t\t\t\t\t\t\"padding-bottom\": \"3px\",\n\t\t\t\t\t\t\t\"overflow-x\": \"hidden\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t[this.renderInputField(attrs)],\n\t\t\t\t),\n\t\t\t\tattrs.busy || attrs.text\n\t\t\t\t\t? m(BaseButton, {\n\t\t\t\t\t\t\tlabel: attrs.busy ? \"loading_msg\" : \"close_alt\",\n\t\t\t\t\t\t\ticon: m(Icon, {\n\t\t\t\t\t\t\t\tcontainer: \"div\",\n\t\t\t\t\t\t\t\tsize: IconSize.Medium,\n\t\t\t\t\t\t\t\ticon: attrs.busy ? BootIcons.Progress : Icons.Close,\n\t\t\t\t\t\t\t\tclass: \"center-h  \" + (attrs.busy ? \"icon-progress-search icon-progress\" : \"\"),\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\tfill: theme.header_button,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tif (!attrs.disabled) attrs.onClear?.()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdisabled: attrs.busy,\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\twidth: size.icon_size_large,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  } satisfies BaseButtonAttrs)\n\t\t\t\t\t: null,\n\t\t\t],\n\t\t)\n\t}\n\n\tprivate renderInputField(attrs: BaseSearchBarAttrs): Children {\n\t\treturn m(\"input.input.input-no-clear\", {\n\t\t\t\"aria-autocomplete\": \"list\",\n\t\t\ttabindex: TabIndex.Default,\n\t\t\trole: \"combobox\",\n\t\t\tplaceholder: attrs.placeholder,\n\t\t\ttype: TextFieldType.Text,\n\t\t\tvalue: attrs.text,\n\t\t\tdisabled: attrs.disabled,\n\t\t\toncreate: (vnode) => {\n\t\t\t\tthis.domInput = vnode.dom as HTMLInputElement\n\t\t\t\tattrs.onInputCreated?.(this.domInput)\n\t\t\t},\n\t\t\tonfocus: () => {\n\t\t\t\tthis.isFocused = true\n\n\t\t\t\tattrs.onFocus?.()\n\t\t\t},\n\t\t\tonblur: () => {\n\t\t\t\tthis.isFocused = false\n\t\t\t\tattrs.onBlur?.()\n\t\t\t},\n\t\t\tonremove: () => {\n\t\t\t\tthis.domInput.onblur = null\n\t\t\t\tthis.isFocused = false\n\t\t\t},\n\t\t\toninput: () => {\n\t\t\t\tattrs.onInput(this.domInput.value)\n\t\t\t},\n\t\t\tonkeydown: (e: KeyboardEvent) => {\n\t\t\t\tattrs.onKeyDown?.(e)\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\t\"line-height\": px(inputLineHeight),\n\t\t\t},\n\t\t})\n\t}\n}\n"]}