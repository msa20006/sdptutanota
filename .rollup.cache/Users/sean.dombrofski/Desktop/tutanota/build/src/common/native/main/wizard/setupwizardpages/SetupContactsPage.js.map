{"version":3,"file":"SetupContactsPage.js","sourceRoot":"","sources":["../../../../../../../src/common/native/main/wizard/setupwizardpages/SetupContactsPage.ts"],"names":[],"mappings":"AAAA,OAAO,CAAiC,MAAM,SAAS,CAAA;AAEvD,OAAO,EAAE,IAAI,EAAuB,MAAM,uCAAuC,CAAA;AACjF,OAAO,EAAE,eAAe,EAAE,MAAM,sBAAsB,CAAA;AAGtD,OAAO,EAAE,MAAM,EAAE,MAAM,gCAAgC,CAAA;AAEvD,OAAO,EAAE,0BAA0B,EAAE,MAAM,8CAA8C,CAAA;AAEzF,MAAM,OAAO,iBAAiB;IAC7B,IAAI,CAAC,EAAE,KAAK,EAAiC;QAC5C,OAAO,CAAC,CAAC,eAAe,EAAE,EAAE,KAAK,EAAE,UAAU,EAAE,EAAE,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC,CAAA;IACzF,CAAC;IAEO,0BAA0B,CAAC,KAA6B;QAC/D,MAAM,oBAAoB,GAAG,KAAK,CAAC,WAAW,CAAC,SAAS,EAAE,CAAA;QAE1D,OAAO;YACN,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;YAC3C,0BAA0B,CAAC,eAAe,EAAE,GAAG,EAAE;gBAChD,KAAK,CAAC,eAAe,CAAC,8BAA8B,EAAE,CAAA;YACvD,CAAC,CAAC;YACF,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC;YACpD,0BAA0B,CACzB,oBAAoB,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,iBAAiB,EAC5D,GAAG,EAAE;gBACJ,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;YACvB,CAAC,EACD,oBAAoB,EACpB,MAAM,CACN;SACD,CAAA;IACF,CAAC;IAEO,KAAK,CAAC,UAAU,CAAC,KAA6B;QACrD,MAAM,OAAO,GAAG,MAAM,KAAK,CAAC,WAAW,CAAC,UAAU,EAAE,CAAA;QACpD,IAAI,CAAC,OAAO,EAAE,CAAC;YACd,MAAM,KAAK,CAAC,WAAW,CAAC,WAAW,EAAE,CAAA;YACrC,MAAM,MAAM,CAAC,OAAO,CAAC,2BAA2B,CAAC,CAAA;YACjD,MAAM,KAAK,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAA;QAC9C,CAAC;IACF,CAAC;CACD;AAED,MAAM,OAAO,sBAAsB;IAKjB;IACA;IACA;IACA;IAPjB,uBAAuB,GAAG,KAAK,CAAA;IAC/B,IAAI,GAAS,IAAI,CAAA;IAEjB,YACiB,WAAsC,EACtC,eAAgC,EAChC,kBAAsC,EACtC,yBAAkC;QAHlC,gBAAW,GAAX,WAAW,CAA2B;QACtC,oBAAe,GAAf,eAAe,CAAiB;QAChC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,8BAAyB,GAAzB,yBAAyB,CAAS;IAChD,CAAC;IAEJ,WAAW;QACV,OAAO,gBAAgB,CAAA;IACxB,CAAC;IAED,UAAU,CAAC,WAAoB;QAC9B,0CAA0C;QAC1C,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;IAC7B,CAAC;IAED,eAAe;QACd,OAAO,KAAK,CAAA;IACb,CAAC;IAED,SAAS;QACR,OAAO,IAAI,CAAC,yBAAyB,CAAA;IACtC,CAAC;CACD","sourcesContent":["import m, { Children, Component, Vnode } from \"mithril\"\nimport { WizardPageAttrs } from \"../../../../gui/base/WizardDialog.js\"\nimport { lang, type TranslationKey } from \"../../../../misc/LanguageViewModel.js\"\nimport { SetupPageLayout } from \"./SetupPageLayout.js\"\nimport { NativeContactsSyncManager } from \"../../../../../mail-app/contacts/model/NativeContactsSyncManager.js\"\nimport { ContactImporter } from \"../../../../../mail-app/contacts/ContactImporter.js\"\nimport { Dialog } from \"../../../../gui/base/Dialog.js\"\nimport { MobileSystemFacade } from \"../../../common/generatedipc/MobileSystemFacade.js\"\nimport { renderSettingsBannerButton } from \"../../../../settings/SettingsBannerButton.js\"\n\nexport class SetupContactsPage implements Component<SetupContactsPageAttrs> {\n\tview({ attrs }: Vnode<SetupContactsPageAttrs>): Children {\n\t\treturn m(SetupPageLayout, { image: \"contacts\" }, this.renderImportAndSyncButtons(attrs))\n\t}\n\n\tprivate renderImportAndSyncButtons(attrs: SetupContactsPageAttrs): Children {\n\t\tconst isContactSyncEnabled = attrs.syncManager.isEnabled()\n\n\t\treturn [\n\t\t\tm(\"p.mb-s\", lang.get(\"importContacts_msg\")),\n\t\t\trenderSettingsBannerButton(\"import_action\", () => {\n\t\t\t\tattrs.contactImporter.importContactsFromDeviceSafely()\n\t\t\t}),\n\t\t\tm(\"p.mb-s\", lang.get(\"allowContactSynchronization\")),\n\t\t\trenderSettingsBannerButton(\n\t\t\t\tisContactSyncEnabled ? \"activated_label\" : \"activate_action\",\n\t\t\t\t() => {\n\t\t\t\t\tthis.enableSync(attrs)\n\t\t\t\t},\n\t\t\t\tisContactSyncEnabled,\n\t\t\t\t\"mb-l\",\n\t\t\t),\n\t\t]\n\t}\n\n\tprivate async enableSync(attrs: SetupContactsPageAttrs): Promise<void> {\n\t\tconst success = await attrs.syncManager.enableSync()\n\t\tif (!success) {\n\t\t\tawait attrs.syncManager.disableSync()\n\t\t\tawait Dialog.message(\"allowContactReadWrite_msg\")\n\t\t\tawait attrs.mobileSystemFacade.goToSettings()\n\t\t}\n\t}\n}\n\nexport class SetupContactsPageAttrs implements WizardPageAttrs<null> {\n\thidePagingButtonForPage = false\n\tdata: null = null\n\n\tconstructor(\n\t\tpublic readonly syncManager: NativeContactsSyncManager,\n\t\tpublic readonly contactImporter: ContactImporter,\n\t\tpublic readonly mobileSystemFacade: MobileSystemFacade,\n\t\tpublic readonly allowContactSyncAndImport: boolean,\n\t) {}\n\n\theaderTitle(): TranslationKey {\n\t\treturn \"contacts_label\"\n\t}\n\n\tnextAction(showDialogs: boolean): Promise<boolean> {\n\t\t// next action not available for this page\n\t\treturn Promise.resolve(true)\n\t}\n\n\tisSkipAvailable(): boolean {\n\t\treturn false\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn this.allowContactSyncAndImport\n\t}\n}\n"]}