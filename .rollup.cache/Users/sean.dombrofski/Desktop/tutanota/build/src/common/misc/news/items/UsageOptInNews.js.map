{"version":3,"file":"UsageOptInNews.js","sourceRoot":"","sources":["../../../../../../src/common/misc/news/items/UsageOptInNews.ts"],"names":[],"mappings":"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","sourcesContent":["import { NewsListItem } from \"../NewsListItem.js\"\nimport m, { Children } from \"mithril\"\nimport { NewsId } from \"../../../api/entities/tutanota/TypeRefs.js\"\nimport { locator } from \"../../../api/main/CommonLocator.js\"\nimport { InfoLink, lang } from \"../../LanguageViewModel.js\"\nimport { Dialog } from \"../../../gui/base/Dialog.js\"\nimport { Button, ButtonAttrs, ButtonType } from \"../../../gui/base/Button.js\"\nimport { NewsModel } from \"../NewsModel.js\"\nimport { UsageTestModel } from \"../../UsageTestModel.js\"\nimport { MoreInfoLink } from \"../MoreInfoLink.js\"\n\n/**\n * News item that informs users about the usage data opt-in.\n */\nexport class UsageOptInNews implements NewsListItem {\n\tconstructor(private readonly newsModel: NewsModel, private readonly usageTestModel: UsageTestModel) {}\n\n\tisShown(): Promise<boolean> {\n\t\treturn Promise.resolve(locator.usageTestModel.showOptInIndicator())\n\t}\n\n\trender(newsId: NewsId): Children {\n\t\tconst closeAction = (optedIn?: boolean) => {\n\t\t\tthis.newsModel\n\t\t\t\t.acknowledgeNews(newsId.newsItemId)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (optedIn) {\n\t\t\t\t\t\tDialog.message(\"userUsageDataOptInThankYouOptedIn_msg\")\n\t\t\t\t\t} else if (optedIn !== undefined) {\n\t\t\t\t\t\tDialog.message(\"userUsageDataOptInThankYouOptedOut_msg\")\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(m.redraw)\n\t\t}\n\n\t\tconst buttonAttrs: Array<ButtonAttrs> = [\n\t\t\t{\n\t\t\t\tlabel: \"decideLater_action\",\n\t\t\t\tclick: () => closeAction(),\n\t\t\t\ttype: ButtonType.Secondary,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"deactivate_action\",\n\t\t\t\tclick: () => {\n\t\t\t\t\tconst decision = false\n\t\t\t\t\tthis.usageTestModel.setOptInDecision(decision).then(() => closeAction(decision))\n\t\t\t\t},\n\t\t\t\ttype: ButtonType.Secondary,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"activate_action\",\n\t\t\t\tclick: () => {\n\t\t\t\t\tconst decision = true\n\t\t\t\t\tthis.usageTestModel.setOptInDecision(decision).then(() => closeAction(decision))\n\t\t\t\t},\n\t\t\t\ttype: ButtonType.Primary,\n\t\t\t},\n\t\t]\n\n\t\treturn m(\".full-width\", [\n\t\t\tm(\".h4\", lang.get(\"userUsageDataOptIn_title\")),\n\t\t\tm(\".pb\", lang.get(\"userUsageDataOptInExplanation_msg\")),\n\t\t\tm(\"ul.usage-test-opt-in-bullets\", [\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement1_msg\")),\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement2_msg\")),\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement3_msg\")),\n\t\t\t\tm(\"li\", lang.get(\"userUsageDataOptInStatement4_msg\")),\n\t\t\t]),\n\t\t\tm(MoreInfoLink, { link: InfoLink.Privacy }),\n\t\t\tm(\n\t\t\t\t\".flex-end.flex-no-grow-no-shrink-auto.flex-wrap\",\n\t\t\t\tbuttonAttrs.map((a) => m(Button, a)),\n\t\t\t),\n\t\t])\n\t}\n}\n"]}