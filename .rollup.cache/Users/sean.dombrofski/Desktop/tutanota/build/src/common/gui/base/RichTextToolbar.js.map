{"version":3,"file":"RichTextToolbar.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/RichTextToolbar.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component, Vnode, VnodeDOM } from \"mithril\"\nimport { Icons } from \"./icons/Icons\"\nimport type { Editor, Listing, Style } from \"../editor/Editor\"\nimport { Alignment } from \"../editor/Editor\"\nimport { numberRange } from \"@tutao/tutanota-utils\"\nimport { size } from \"../size\"\nimport { createDropdown, DropdownButtonAttrs } from \"./Dropdown.js\"\nimport { lang, TranslationKey, MaybeTranslation } from \"../../misc/LanguageViewModel\"\nimport { animations, height, opacity } from \"../animation/Animations\"\nimport { client } from \"../../misc/ClientDetector\"\nimport { BrowserType } from \"../../misc/ClientConstants\"\nimport { ToggleButton } from \"./buttons/ToggleButton.js\"\nimport { IconButton, IconButtonAttrs } from \"./IconButton.js\"\nimport { ButtonSize } from \"./ButtonSize.js\"\n\nexport interface RichTextToolbarAttrs {\n\teditor: Editor\n\timageButtonClickHandler?: ((ev: Event, editor: Editor) => unknown) | null\n\talignmentEnabled?: boolean\n\tfontSizeEnabled?: boolean\n\tcustomButtonAttrs?: Array<IconButtonAttrs>\n}\n\nexport class RichTextToolbar implements Component<RichTextToolbarAttrs> {\n\tselectedSize = size.font_size_base\n\n\tconstructor({ attrs }: Vnode<RichTextToolbarAttrs>) {\n\t\ttry {\n\t\t\tthis.selectedSize = parseInt(attrs.editor.squire.getFontInfo().size.slice(0, -2))\n\t\t} catch (e) {\n\t\t\tthis.selectedSize = size.font_size_base\n\t\t}\n\t}\n\n\toncreate(vnode: VnodeDOM<any>): void {\n\t\tconst dom = vnode.dom as HTMLElement\n\t\tdom.style.height = \"0\"\n\t\tanimateToolbar(dom, true)\n\t}\n\n\tonbeforeremove(vnode: VnodeDOM<any>): Promise<void> {\n\t\treturn animateToolbar(vnode.dom as HTMLElement, false)\n\t}\n\n\tview({ attrs }: Vnode<RichTextToolbarAttrs>): Children {\n\t\treturn m(\n\t\t\t\".elevated-bg.overflow-hidden\",\n\t\t\t{\n\t\t\t\tstyle: {\n\t\t\t\t\ttop: \"0px\",\n\t\t\t\t\tposition:\n\t\t\t\t\t\tclient.browser === BrowserType.SAFARI\n\t\t\t\t\t\t\t? client.isMacOS\n\t\t\t\t\t\t\t\t? \"-webkit-sticky\" // safari on macos\n\t\t\t\t\t\t\t\t: \"inherit\" // sticky changes the rendering order on iOS\n\t\t\t\t\t\t\t: \"sticky\", // normal browsers\n\t\t\t\t},\n\t\t\t},\n\t\t\t[\n\t\t\t\tm(\n\t\t\t\t\t\".flex-end.wrap.items-center.mb-xs.mt-xs.ml-between-s\",\n\t\t\t\t\tthis.renderStyleButtons(attrs),\n\t\t\t\t\tthis.renderCustomButtons(attrs),\n\t\t\t\t\tthis.renderAlignDropDown(attrs),\n\t\t\t\t\tthis.renderSizeButtons(attrs),\n\t\t\t\t\tthis.renderRemoveFormattingButton(attrs),\n\t\t\t\t),\n\t\t\t],\n\t\t)\n\t}\n\n\tprivate renderStyleButtons(attrs: RichTextToolbarAttrs): Children {\n\t\tconst { editor, imageButtonClickHandler } = attrs\n\n\t\treturn [\n\t\t\tthis.renderStyleToggleButton(\"b\", lang.get(\"formatTextBold_msg\") + \" (Ctrl + B)\", Icons.Bold, editor),\n\t\t\tthis.renderStyleToggleButton(\"i\", lang.get(\"formatTextItalic_msg\") + \" (Ctrl + I)\", Icons.Italic, editor),\n\t\t\tthis.renderStyleToggleButton(\"u\", lang.get(\"formatTextUnderline_msg\") + \" (Ctrl + U)\", Icons.Underline, editor),\n\t\t\tthis.renderStyleToggleButton(\"c\", lang.get(\"formatTextMonospace_msg\"), Icons.Code, editor),\n\t\t\tthis.renderStyleToggleButton(\"a\", editor.hasStyle(\"a\") ? lang.get(\"breakLink_action\") : lang.get(\"makeLink_action\"), Icons.Link, editor),\n\t\t\tthis.renderListToggleButton(\"ol\", lang.get(\"formatTextOl_msg\") + \" (Ctrl + Shift + 9)\", Icons.ListOrdered, editor),\n\t\t\tthis.renderListToggleButton(\"ul\", lang.get(\"formatTextUl_msg\") + \" (Ctrl + Shift + 8)\", Icons.ListUnordered, editor),\n\t\t\timageButtonClickHandler\n\t\t\t\t? m(IconButton, {\n\t\t\t\t\t\ttitle: \"insertImage_action\",\n\t\t\t\t\t\tclick: (ev) => imageButtonClickHandler(ev, editor),\n\t\t\t\t\t\ticon: Icons.Picture,\n\t\t\t\t\t\tsize: ButtonSize.Compact,\n\t\t\t\t  })\n\t\t\t\t: null,\n\t\t]\n\t}\n\n\tprivate renderStyleToggleButton(style: Style, title: string, icon: Icons, editor: Editor): Children {\n\t\treturn this.renderToggleButton(\n\t\t\tlang.makeTranslation(title, title),\n\t\t\ticon,\n\t\t\t() => editor.setStyle(!editor.hasStyle(style), style),\n\t\t\t() => editor.hasStyle(style),\n\t\t)\n\t}\n\n\tprivate renderListToggleButton(listing: Listing, title: string, icon: Icons, editor: Editor): Children {\n\t\treturn this.renderToggleButton(\n\t\t\tlang.makeTranslation(title, title),\n\t\t\ticon,\n\t\t\t() =>\n\t\t\t\teditor.styles.listing === listing\n\t\t\t\t\t? editor.squire.removeList()\n\t\t\t\t\t: listing === \"ul\"\n\t\t\t\t\t? editor.squire.makeUnorderedList()\n\t\t\t\t\t: editor.squire.makeOrderedList(),\n\t\t\t() => editor.styles.listing === listing,\n\t\t)\n\t}\n\n\tprivate renderToggleButton(title: MaybeTranslation, icon: Icons, click: () => void, isSelected: () => boolean): Children {\n\t\treturn m(ToggleButton, {\n\t\t\ttitle: title,\n\t\t\tonToggled: click,\n\t\t\ticon: icon,\n\t\t\ttoggled: isSelected(),\n\t\t\tsize: ButtonSize.Compact,\n\t\t})\n\t}\n\n\tprivate renderCustomButtons(attrs: RichTextToolbarAttrs): Children {\n\t\treturn (attrs.customButtonAttrs ?? []).map((attrs) => m(IconButton, attrs))\n\t}\n\n\tprivate renderAlignDropDown(attrs: RichTextToolbarAttrs): Children {\n\t\tif (attrs.alignmentEnabled === false) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst alignButtonAttrs = (alignment: Alignment, title: TranslationKey, icon: Icons): DropdownButtonAttrs => {\n\t\t\treturn {\n\t\t\t\tlabel: title,\n\t\t\t\tclick: () => {\n\t\t\t\t\tattrs.editor.squire.setTextAlignment(alignment)\n\t\t\t\t\tsetTimeout(() => attrs.editor.squire.focus(), 100) // blur for the editor is fired after the handler for some reason\n\t\t\t\t\tm.redraw()\n\t\t\t\t},\n\t\t\t\ticon: icon,\n\t\t\t}\n\t\t}\n\n\t\treturn m(IconButton, {\n\t\t\t// label: () => \"▼\",\n\t\t\ttitle: \"formatTextAlignment_msg\",\n\t\t\ticon: this.alignIcon(attrs),\n\t\t\tsize: ButtonSize.Compact,\n\t\t\tclick: (e, dom) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\tcreateDropdown({\n\t\t\t\t\twidth: 200,\n\t\t\t\t\tlazyButtons: () => [\n\t\t\t\t\t\talignButtonAttrs(\"left\", \"formatTextLeft_msg\", Icons.AlignLeft),\n\t\t\t\t\t\talignButtonAttrs(\"center\", \"formatTextCenter_msg\", Icons.AlignCenter),\n\t\t\t\t\t\talignButtonAttrs(\"right\", \"formatTextRight_msg\", Icons.AlignRight),\n\t\t\t\t\t\talignButtonAttrs(\"justify\", \"formatTextJustify_msg\", Icons.AlignJustified),\n\t\t\t\t\t],\n\t\t\t\t})(e, dom)\n\t\t\t},\n\t\t})\n\t}\n\n\tprivate alignIcon(attrs: RichTextToolbarAttrs) {\n\t\tswitch (attrs.editor.styles.alignment) {\n\t\t\tcase \"left\":\n\t\t\t\treturn Icons.AlignLeft\n\n\t\t\tcase \"center\":\n\t\t\t\treturn Icons.AlignCenter\n\n\t\t\tcase \"right\":\n\t\t\t\treturn Icons.AlignRight\n\n\t\t\tcase \"justify\":\n\t\t\t\treturn Icons.AlignJustified\n\t\t}\n\t}\n\n\tprivate renderSizeButtons({ editor }: RichTextToolbarAttrs): Children {\n\t\treturn m(IconButton, {\n\t\t\ttitle: \"formatTextFontSize_msg\",\n\t\t\ticon: Icons.FontSize,\n\t\t\tsize: ButtonSize.Compact,\n\t\t\tclick: (e, dom) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\tcreateDropdown({\n\t\t\t\t\tlazyButtons: () =>\n\t\t\t\t\t\tnumberRange(8, 144).map((n) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tlabel: lang.makeTranslation(\"font_size_\" + n, n.toString()),\n\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\teditor.squire.setFontSize(n)\n\t\t\t\t\t\t\t\t\tthis.selectedSize = n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => editor.squire.focus(), 100) // blur for the editor is fired after the handler for some reason\n\t\t\t\t\t\t\t\t\tm.redraw()\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t})(e, dom)\n\t\t\t},\n\t\t})\n\t}\n\n\tprivate renderRemoveFormattingButton(attrs: RichTextToolbarAttrs): Children {\n\t\tif (attrs.fontSizeEnabled === false) {\n\t\t\treturn null\n\t\t}\n\n\t\treturn m(IconButton, {\n\t\t\ttitle: \"removeFormatting_action\",\n\t\t\ticon: Icons.FormatClear,\n\t\t\tclick: (e) => {\n\t\t\t\te.stopPropagation()\n\t\t\t\tattrs.editor.squire.removeAllFormatting()\n\t\t\t},\n\t\t\tsize: ButtonSize.Compact,\n\t\t})\n\t}\n}\n\nexport function animateToolbar(dom: HTMLElement, appear: boolean): Promise<void> {\n\tlet childHeight = Array.from(dom.children)\n\t\t.map((domElement) => (domElement as HTMLElement).offsetHeight)\n\t\t.reduce((current: number, previous: number) => Math.max(current, previous), 0)\n\treturn animations.add(dom, [height(appear ? 0 : childHeight, appear ? childHeight : 0), appear ? opacity(0, 1, false) : opacity(1, 0, false)]).then(() => {\n\t\tif (appear) {\n\t\t\tdom.style.height = \"\"\n\t\t}\n\t})\n}\n"]}