{"version":3,"file":"tutanota-v73.js","sourceRoot":"","sources":["../../../../../../../src/common/api/worker/offline/migrations/tutanota-v73.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,kBAAkB,EAAE,sBAAsB,EAAE,WAAW,EAAE,MAAM,0BAA0B,CAAA;AAClG,OAAO,EAAE,cAAc,EAAE,WAAW,EAAE,cAAc,EAAE,iBAAiB,EAAE,WAAW,EAAE,MAAM,wCAAwC,CAAA;AAEpI,MAAM,CAAC,MAAM,UAAU,GAAqB;IAC3C,GAAG,EAAE,UAAU;IACf,OAAO,EAAE,EAAE;IACX,KAAK,CAAC,OAAO,CAAC,OAAuB;QACpC,kGAAkG;QAClG,qCAAqC;QACrC,MAAM,sBAAsB,CAAC,WAAW,EAAE,OAAO,EAAE;YAClD,WAAW,CAAC,MAAM,CAAC;YACnB,WAAW,CAAC,cAAc,CAAC;YAC3B,WAAW,CAAC,cAAc,CAAC;YAC3B,WAAW,CAAC,eAAe,CAAC;YAC5B,WAAW,CAAC,UAAU,CAAC;YACvB,WAAW,CAAC,SAAS,CAAC;YACtB,WAAW,CAAC,UAAU,CAAC;SACvB,CAAC,CAAA;QAEF,wBAAwB;QACxB,MAAM,kBAAkB,CAAC,cAAc,EAAE,OAAO,EAAE,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAA;QACzE,MAAM,sBAAsB,CAAC,iBAAiB,EAAE,OAAO,EAAE,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAA;QAErF,kGAAkG;QAClG,MAAM,sBAAsB,CAAC,WAAW,EAAE,OAAO,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,CAAA;QACjG,MAAM,sBAAsB,CAAC,cAAc,EAAE,OAAO,EAAE;YACrD,WAAW,CAAC,QAAQ,CAAC;YACrB,WAAW,CAAC,OAAO,CAAC;YACpB,WAAW,CAAC,sBAAsB,CAAC,EAAE,yDAAyD;SAC9F,CAAC,CAAA;IACH,CAAC;CACD,CAAA","sourcesContent":["import { OfflineMigration } from \"../OfflineStorageMigrator.js\"\nimport { OfflineStorage } from \"../OfflineStorage.js\"\nimport { migrateAllElements, migrateAllListElements, removeValue } from \"../StandardMigrations.js\"\nimport { ContactTypeRef, FileTypeRef, MailBoxTypeRef, MailFolderTypeRef, MailTypeRef } from \"../../../entities/tutanota/TypeRefs.js\"\n\nexport const tutanota73: OfflineMigration = {\n\tapp: \"tutanota\",\n\tversion: 73,\n\tasync migrate(storage: OfflineStorage) {\n\t\t// the TutanotaModelV73 finally removes all legacy mail (without MailDetails) attributes and types\n\t\t// all mails must use MailDetails now\n\t\tawait migrateAllListElements(MailTypeRef, storage, [\n\t\t\tremoveValue(\"body\"),\n\t\t\tremoveValue(\"toRecipients\"),\n\t\t\tremoveValue(\"ccRecipients\"),\n\t\t\tremoveValue(\"bccRecipients\"),\n\t\t\tremoveValue(\"replyTos\"),\n\t\t\tremoveValue(\"headers\"),\n\t\t\tremoveValue(\"sentDate\"),\n\t\t])\n\n\t\t// cleanup TutanotaModel\n\t\tawait migrateAllElements(MailBoxTypeRef, storage, [removeValue(\"mails\")])\n\t\tawait migrateAllListElements(MailFolderTypeRef, storage, [removeValue(\"subFolders\")])\n\n\t\t// removing Value.OLD_OWNER_GROUP_NAME, and Value.OLD_AREA_ID_NAME from FILE_TYPE and CONTACT_TYPE\n\t\tawait migrateAllListElements(FileTypeRef, storage, [removeValue(\"_owner\"), removeValue(\"_area\")])\n\t\tawait migrateAllListElements(ContactTypeRef, storage, [\n\t\t\tremoveValue(\"_owner\"),\n\t\t\tremoveValue(\"_area\"),\n\t\t\tremoveValue(\"autoTransmitPassword\"), // autoTransmitPassword has been removed from ContactType\n\t\t])\n\t},\n}\n"]}