{"version":3,"file":"Switch.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/Switch.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { ClassComponent, Vnode, VnodeDOM } from \"mithril\"\nimport { Keys, TabIndex } from \"../../api/common/TutanotaConstants.js\"\nimport { isKeyPressed } from \"../../misc/KeyManager.js\"\nimport { AriaRole } from \"../AriaUtils.js\"\n\ntype SwitchVariant = \"normal\" | \"expanded\"\ntype TogglePillPosition = \"left\" | \"right\"\ntype HTMLElementWithAttrs = Partial<Pick<m.Attributes, \"class\"> & Omit<HTMLElement, \"style\"> & SwitchAttrs>\n\nexport interface SwitchAttrs {\n\tchecked: boolean\n\tonclick: (checked: boolean) => unknown\n\tariaLabel: string\n\tdisabled?: boolean\n\ttogglePillPosition?: TogglePillPosition\n\tclasses?: Array<string>\n\tvariant?: SwitchVariant\n}\n\n/**\n * Switch component with variants\n * @see Component attributes: {SwitchAttrs}\n * @example\n * m(Switch,\n *     {\n *         classes: [\"my-custom-switch-class\"],\n *         checked: this.checked,\n *         onclick: (checked: boolean) => {\n *             this.checked = checked\n *             console.log(this.checked)\n *         },\n *         togglePillPosition: \"right\",\n *         ariaLabel: \"Test Switch\",\n *         disabled: false,\n *         variant: \"normal\",\n *     },\n *     \"My label\",\n * ),\n */\nexport class Switch implements ClassComponent<SwitchAttrs> {\n\tprivate checkboxDom?: HTMLInputElement\n\n\tview({ attrs: { disabled, variant, ariaLabel, checked, onclick, togglePillPosition, classes }, children }: Vnode<SwitchAttrs>) {\n\t\tconst childrenArr = [children, this.buildTogglePillComponent(checked, onclick, disabled)]\n\t\tif (togglePillPosition === \"left\") {\n\t\t\tchildrenArr.reverse()\n\t\t}\n\n\t\treturn m(\n\t\t\t\"label.tutaui-switch.flash\",\n\t\t\t{\n\t\t\t\tclass: this.resolveClasses(classes, disabled, variant),\n\t\t\t\trole: AriaRole.Switch,\n\t\t\t\tariaLabel: ariaLabel,\n\t\t\t\tariaChecked: String(checked),\n\t\t\t\tariaDisabled: disabled ? \"true\" : undefined,\n\t\t\t\ttabIndex: Number(disabled ? TabIndex.Programmatic : TabIndex.Default),\n\t\t\t\tonkeydown: (e: KeyboardEvent) => {\n\t\t\t\t\tif (isKeyPressed(e.key, Keys.SPACE, Keys.RETURN)) {\n\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\tthis.checkboxDom?.click()\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t} satisfies HTMLElementWithAttrs,\n\t\t\tchildrenArr,\n\t\t)\n\t}\n\n\tprivate buildTogglePillComponent(checked: boolean = false, onclick: (checked: boolean) => unknown, disabled: boolean | undefined) {\n\t\treturn m(\n\t\t\t\"span.tutaui-toggle-pill\",\n\t\t\t{\n\t\t\t\tclass: this.checkboxDom?.checked ? \"checked\" : \"unchecked\",\n\t\t\t},\n\t\t\tm(\"input[type='checkbox']\", {\n\t\t\t\trole: AriaRole.Switch,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tonclick(this.checkboxDom?.checked ?? false)\n\t\t\t\t},\n\t\t\t\toncreate: ({ dom }: VnodeDOM<HTMLInputElement>) => {\n\t\t\t\t\tthis.checkboxDom = dom as HTMLInputElement\n\t\t\t\t\tthis.checkboxDom.checked = checked\n\t\t\t\t},\n\t\t\t\ttabIndex: TabIndex.Programmatic,\n\t\t\t\tdisabled: disabled ? true : undefined,\n\t\t\t}),\n\t\t)\n\t}\n\n\tprivate resolveClasses(classes: Array<string> = [], disabled: boolean = false, variant: SwitchVariant = \"normal\") {\n\t\tconst classList = [...classes]\n\n\t\tif (disabled) classList.push(\"disabled\", \"click-disabled\")\n\t\telse classList.push(\"click\")\n\n\t\tif (variant === \"expanded\") classList.push(\"justify-between\", \"full-width\")\n\t\telse classList.push(\"fit-content\")\n\n\t\treturn classList.join(\" \")\n\t}\n}\n"]}