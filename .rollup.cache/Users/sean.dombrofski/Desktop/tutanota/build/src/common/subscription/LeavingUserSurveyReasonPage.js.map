{"version":3,"file":"LeavingUserSurveyReasonPage.js","sourceRoot":"","sources":["../../../../src/common/subscription/LeavingUserSurveyReasonPage.ts"],"names":[],"mappings":"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","sourcesContent":["import { emitWizardEvent, WizardEventType, WizardPageAttrs, WizardPageN } from \"../gui/base/WizardDialog.js\"\nimport { LeavingUserSurveyData } from \"./LeavingUserSurveyWizard.js\"\nimport m, { Vnode, VnodeDOM } from \"mithril\"\nimport { DropDownSelector, type DropDownSelectorAttrs, SelectorItem, SelectorItemList } from \"../gui/base/DropDownSelector.js\"\nimport { HtmlEditor, HtmlEditorMode } from \"../gui/editor/HtmlEditor.js\"\nimport { theme } from \"../gui/theme.js\"\nimport { CATEGORY_TO_IMAGE, CATEGORY_TO_REASON, getCategoryType } from \"./LeavingUserSurveyConstants.js\"\nimport { lang } from \"../misc/LanguageViewModel.js\"\nimport { styles } from \"../gui/styles.js\"\nimport { SetupLeavingUserSurveyPage } from \"./SetupLeavingUserSurveyPage.js\"\n\nexport class LeavingUserSurveyReasonPage implements WizardPageN<LeavingUserSurveyData> {\n\tprivate _dom: HTMLElement | null = null\n\tprivate dropdownItemsFromCategory: SelectorItemList<NumberString | null> = []\n\tprivate readonly customReasonEditor: HtmlEditor\n\n\tconstructor() {\n\t\tlet NUMBER_OF_EDITOR_LINES = styles.isDesktopLayout() ? 5 : 1\n\t\tthis.customReasonEditor = new HtmlEditor()\n\t\t\t.setStaticNumberOfLines(NUMBER_OF_EDITOR_LINES)\n\t\t\t.showBorders()\n\t\t\t.setPlaceholderId(\"enterDetails_msg\")\n\t\t\t.setMode(HtmlEditorMode.HTML)\n\t\t\t.setHtmlMonospace(false)\n\t\t\t.setValue(\"\")\n\t}\n\n\toncreate(vnode: VnodeDOM<WizardPageAttrs<LeavingUserSurveyData>>) {\n\t\tthis._dom = vnode.dom as HTMLElement\n\t}\n\n\toninit(vnode: Vnode<WizardPageAttrs<LeavingUserSurveyData>>) {\n\t\tthis.dropdownItemsFromCategory = this.getDropdownItemsFromCategory(vnode.attrs.data.category!)\n\t\tvnode.attrs.data.reason = null\n\t}\n\n\tview(vnode: Vnode<WizardPageAttrs<LeavingUserSurveyData>>) {\n\t\treturn m(\n\t\t\tSetupLeavingUserSurveyPage,\n\t\t\t{\n\t\t\t\tcloseAction: () => {\n\t\t\t\t\tvnode.attrs.data.details = this.customReasonEditor.getValue()\n\t\t\t\t\tvnode.attrs.data.submitted = true\n\t\t\t\t\tthis.closeDialog()\n\t\t\t\t},\n\t\t\t\tnextButtonLabel: \"submit_action\",\n\t\t\t\tnextButtonEnabled: !vnode.attrs.data.reason,\n\t\t\t\timage: CATEGORY_TO_IMAGE.get(getCategoryType(vnode.attrs.data.category!))?.image!,\n\t\t\t\timageStyle: {\n\t\t\t\t\tpaddingBottom: \"60px\",\n\t\t\t\t},\n\t\t\t\tmainMessage: CATEGORY_TO_IMAGE.get(getCategoryType(vnode.attrs.data.category!))?.translationKey!,\n\t\t\t\tsecondaryMessage: \"surveyReasonSecondaryMessage_label\",\n\t\t\t},\n\t\t\t[\n\t\t\t\tm(DropDownSelector, {\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tborder: `2px solid ${theme.content_border}`,\n\t\t\t\t\t\tborderRadius: \"6px\",\n\t\t\t\t\t\tpadding: \"4px 8px\",\n\t\t\t\t\t},\n\t\t\t\t\tdoShowBorder: false,\n\t\t\t\t\tlabel: \"surveyChooseReason_label\",\n\t\t\t\t\titems: this.dropdownItemsFromCategory, // will never be null, as it has to be set to access this page\n\t\t\t\t\tselectedValue: vnode.attrs.data.reason,\n\t\t\t\t\tselectionChangedHandler: (reason) => {\n\t\t\t\t\t\tvnode.attrs.data.reason = reason\n\t\t\t\t\t},\n\t\t\t\t\tdropdownWidth: 350,\n\t\t\t\t} satisfies DropDownSelectorAttrs<NumberString | null>),\n\t\t\t\tm(\".pt\", m(this.customReasonEditor)),\n\t\t\t],\n\t\t)\n\t}\n\n\tcloseDialog(): void {\n\t\tif (this._dom) {\n\t\t\temitWizardEvent(this._dom, WizardEventType.CLOSE_DIALOG)\n\t\t}\n\t}\n\n\tgetDropdownItemsFromCategory(category: NumberString): SelectorItemList<NumberString | null> {\n\t\tconst categoryType = getCategoryType(category)\n\t\tconst reasonList = CATEGORY_TO_REASON.get(categoryType)\n\t\tconst unselected: SelectorItem<string | null>[] = [{ name: lang.get(\"experienceSamplingAnswer_label\"), value: null }]\n\n\t\tif (!reasonList) return []\n\t\treturn unselected.concat(reasonList.map((r) => ({ name: lang.get(r.translationKey), value: r.value })))\n\t}\n}\n"]}