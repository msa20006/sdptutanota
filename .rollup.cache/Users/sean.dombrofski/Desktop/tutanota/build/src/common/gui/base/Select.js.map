{"version":3,"file":"Select.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/Select.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, ClassComponent, Vnode, VnodeDOM } from \"mithril\"\nimport { modal, ModalComponent } from \"./Modal.js\"\nimport { assertNotNull } from \"@tutao/tutanota-utils\"\nimport { px, size } from \"../size.js\"\nimport { Keys, TabIndex } from \"../../api/common/TutanotaConstants.js\"\nimport { focusNext, focusPrevious, isKeyPressed, Shortcut } from \"../../misc/KeyManager.js\"\nimport { type PosRect, showDropdown } from \"./Dropdown.js\"\nimport { lang } from \"../../misc/LanguageViewModel.js\"\nimport { Icon, IconSize } from \"./Icon.js\"\nimport { ButtonColor, getColors } from \"./Button.js\"\nimport { AriaRole } from \"../AriaUtils.js\"\nimport Stream from \"mithril/stream\"\nimport { getSafeAreaInsetBottom, getSafeAreaInsetTop } from \"../HtmlUtils.js\"\nimport { theme } from \"../theme.js\"\nimport { BootIcons } from \"./icons/BootIcons.js\"\n\nexport interface SelectOption<T> {\n\t// Here we declare everything that is important to use at the select option\n\tvalue: T\n\tariaValue: string\n}\n\nexport interface SelectAttributes<U extends SelectOption<T>, T> {\n\tonchange: (newValue: U) => void\n\toptions: Stream<Array<U>>\n\t/**\n\t * This attribute is responsible to render the options inside the dropdown.\n\t * @example\n\t * const renderOption = (option: U) => m(\"span\", option.text);\n\t * ...\n\t * renderOption(currentOption)\n\t * ...\n\t * @param {U} option - Option to be rendered\n\t * @returns {Children} Returns the rendered option\n\t */\n\trenderOption: (option: U) => Children\n\t/**\n\t * This attribute is responsible to render the selected option inside the trigger.\n\t * @example\n\t * const renderSelected = (option: U) => m(\"span\", option.text);\n\t * ...\n\t * renderSelected(currentOption)\n\t * ...\n\t * @param {U} option - Option to be rendered\n\t * @returns {Children} Returns the rendered option\n\t */\n\trenderDisplay: (option: U) => Children\n\tariaLabel: string\n\tid?: string\n\tclasses?: Array<string>\n\tselected?: U\n\tplaceholder?: Children\n\texpanded?: boolean\n\tdisabled?: boolean\n\tnoIcon?: boolean\n\t/**\n\t * @example\n\t * const attrs = {\n\t *     ...\n\t *     iconColor: \"#202020\"\n\t *     ...\n\t * }\n\t */\n\ticonColor?: string\n\tkeepFocus?: boolean\n\ttabIndex?: number\n\tonclose?: () => void\n\toncreate?: (...args: any[]) => unknown\n\tdropdownPosition?: \"top\" | \"bottom\"\n}\n\ntype HTMLElementWithAttrs = Partial<Pick<m.Attributes, \"class\"> & Omit<HTMLButtonElement, \"style\"> & SelectAttributes<SelectOption<unknown>, unknown>>\n\nexport interface SelectState {\n\tdropdownContainer?: OptionListContainer\n}\n\n/**\n * Select component\n * @see Component attributes: {SelectAttributes}\n * @example\n *\n * interface CalendarSelectItem extends SelectOption<string> {\n *   color: string\n * \t name: string\n * }\n *\n * m(Select<CalendarSelectItem, string>, {\n *   classes: [\"custom-margins\"],\n *   onChange: (val) => {\n * \t   this.selected = val\n *   },\n * \t options: this.options,\n * \t expanded: true,\n * \t selected: this.selected,\n * \t renderOption: (option) => {\n * \t   return m(\".flex.items-center.gap-vpad-xs\", [\n * \t     m(\"div\", { style: { width: \"24px\", height: \"24px\", borderRadius: \"50%\", backgroundColor: option.color } }),\n *       m(\"span\", option.name),\n * \t   ])\n * \t },\n * \t renderDisplay: (option) => m(\"span\", { style: { color: \"red\" } }, option.name),\n * \t ariaLabel: \"Calendar\"\n * }),\n */\nexport class Select<U extends SelectOption<T>, T> implements ClassComponent<SelectAttributes<U, T>> {\n\tprivate isExpanded: boolean = false\n\tprivate dropdownContainer?: OptionListContainer\n\tprivate key: number = 0\n\n\tview({\n\t\tattrs: {\n\t\t\tonchange,\n\t\t\toptions,\n\t\t\trenderOption,\n\t\t\trenderDisplay,\n\t\t\tclasses,\n\t\t\tselected,\n\t\t\tplaceholder,\n\t\t\texpanded,\n\t\t\tdisabled,\n\t\t\tariaLabel,\n\t\t\ticonColor,\n\t\t\tid,\n\t\t\tnoIcon,\n\t\t\tkeepFocus,\n\t\t\ttabIndex,\n\t\t\tonclose,\n\t\t\tdropdownPosition,\n\t\t},\n\t}: Vnode<SelectAttributes<U, T>, this>) {\n\t\treturn m(\n\t\t\t\"button.tutaui-select-trigger.clickable\",\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\tclass: this.resolveClasses(classes, disabled, expanded),\n\t\t\t\tonclick: (event: MouseEvent) =>\n\t\t\t\t\tevent.currentTarget &&\n\t\t\t\t\tthis.renderDropdown(\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tevent.currentTarget as HTMLElement,\n\t\t\t\t\t\tonchange,\n\t\t\t\t\t\trenderOption,\n\t\t\t\t\t\tkeepFocus ?? false,\n\t\t\t\t\t\tselected?.value,\n\t\t\t\t\t\tonclose,\n\t\t\t\t\t\tdropdownPosition,\n\t\t\t\t\t),\n\t\t\t\trole: AriaRole.Combobox,\n\t\t\t\tariaLabel,\n\t\t\t\tdisabled: disabled,\n\t\t\t\tariaExpanded: String(this.isExpanded),\n\t\t\t\ttabIndex: tabIndex ?? Number(disabled ? TabIndex.Programmatic : TabIndex.Default),\n\t\t\t\tvalue: selected?.ariaValue,\n\t\t\t} satisfies HTMLElementWithAttrs,\n\t\t\t[\n\t\t\t\tselected != null ? renderDisplay(selected) : this.renderPlaceholder(placeholder),\n\t\t\t\tnoIcon !== true\n\t\t\t\t\t? m(Icon, {\n\t\t\t\t\t\t\ticon: BootIcons.Expand,\n\t\t\t\t\t\t\tcontainer: \"div\",\n\t\t\t\t\t\t\tclass: `fit-content transition-transform`,\n\t\t\t\t\t\t\tsize: IconSize.Medium,\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tfill: iconColor ?? getColors(ButtonColor.Content).button,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  })\n\t\t\t\t\t: null,\n\t\t\t],\n\t\t)\n\t}\n\n\tprivate resolveClasses(classes: Array<string> = [], disabled: boolean = false, expanded: boolean = false) {\n\t\tconst classList = [...classes]\n\t\tif (disabled) {\n\t\t\tclassList.push(\"disabled\", \"click-disabled\")\n\t\t} else {\n\t\t\tclassList.push(\"flash\")\n\t\t}\n\n\t\tif (expanded) {\n\t\t\tclassList.push(\"full-width\")\n\t\t} else {\n\t\t\tclassList.push(\"fit-content\")\n\t\t}\n\n\t\treturn classList.join(\" \")\n\t}\n\n\tprivate renderPlaceholder(placeholder?: Children): Children {\n\t\tif (placeholder == null || typeof placeholder === \"string\") {\n\t\t\treturn m(\"span.placeholder\", placeholder ?? lang.get(\"noSelection_msg\"))\n\t\t}\n\n\t\treturn placeholder\n\t}\n\n\tprivate renderDropdown(\n\t\toptions: Stream<Array<U>>,\n\t\tdom: HTMLElement,\n\t\tonSelect: (option: U) => void,\n\t\trenderOptions: (option: U) => Children,\n\t\tkeepFocus: boolean,\n\t\tselected?: T,\n\t\tonClose?: () => void,\n\t\tdropdownPosition?: \"top\" | \"bottom\",\n\t) {\n\t\tconst optionListContainer: OptionListContainer = new OptionListContainer(\n\t\t\toptions,\n\t\t\t(option: U) => {\n\t\t\t\treturn m.fragment(\n\t\t\t\t\t{\n\t\t\t\t\t\tkey: ++this.key,\n\t\t\t\t\t\toncreate: ({ dom }: VnodeDOM<U>) => this.setupOption(dom as HTMLElement, onSelect, option, optionListContainer, selected),\n\t\t\t\t\t},\n\t\t\t\t\t[renderOptions(option)],\n\t\t\t\t)\n\t\t\t},\n\t\t\tdom.getBoundingClientRect().width,\n\t\t\tkeepFocus,\n\t\t\tdropdownPosition,\n\t\t)\n\n\t\toptionListContainer.onClose = () => {\n\t\t\toptionListContainer.close()\n\t\t\tonClose?.()\n\t\t\tthis.isExpanded = false\n\t\t}\n\n\t\toptionListContainer.setOrigin(dom.getBoundingClientRect())\n\n\t\tthis.isExpanded = true\n\t\tthis.dropdownContainer = optionListContainer\n\t\tmodal.displayUnique(optionListContainer, false)\n\t}\n\n\tprivate setupOption(dom: HTMLElement, onSelect: (option: U) => void, option: U, optionListContainer: OptionListContainer, selected: T | undefined) {\n\t\tdom.onclick = this.wrapOnChange.bind(this, onSelect, option, optionListContainer)\n\n\t\tif (!(\"disabled\" in dom)) {\n\t\t\t// We have to set the tabIndex to make sure that it'll be focusable by tabbing\n\t\t\tdom.tabIndex = Number(TabIndex.Default)\n\n\t\t\t// We have to set the cursor pointer as a fallback of renderOptions that doesn't set it\n\t\t\tif (!dom.style.cursor) {\n\t\t\t\tdom.style.cursor = \"pointer\"\n\t\t\t}\n\n\t\t\tif (!dom.role) {\n\t\t\t\tdom.role = AriaRole.Option\n\t\t\t}\n\n\t\t\tdom.ariaSelected = `${selected === option.value}`\n\t\t}\n\n\t\tdom.onkeydown = (e: KeyboardEvent) => {\n\t\t\tif (isKeyPressed(e.key, Keys.SPACE, Keys.RETURN)) {\n\t\t\t\te.preventDefault()\n\t\t\t\tthis.wrapOnChange(onSelect, option, optionListContainer)\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate wrapOnChange(callback: (option: U) => void, option: U, container: OptionListContainer) {\n\t\tcallback(option)\n\t\tcontainer.onClose()\n\t}\n}\n\nclass OptionListContainer implements ModalComponent {\n\tprivate domDropdown: HTMLElement | null = null\n\tview: ModalComponent[\"view\"]\n\torigin: PosRect | null = null\n\tshortcuts: (...args: Array<any>) => any\n\tprivate readonly width: number\n\tprivate domContents: HTMLElement | null = null\n\tprivate maxHeight: number | null = null\n\tprivate focusedBeforeShown: HTMLElement | null = document.activeElement as HTMLElement\n\tprivate children: Children[] = []\n\n\tconstructor(\n\t\tprivate readonly items: Stream<Array<unknown>>,\n\t\tprivate readonly buildFunction: (option: unknown) => Children,\n\t\twidth: number,\n\t\tkeepFocus: boolean,\n\t\tdropdownPosition?: \"top\" | \"bottom\",\n\t) {\n\t\tthis.width = width\n\t\tthis.shortcuts = this.buildShortcuts\n\n\t\tthis.items.map((newItems) => {\n\t\t\tthis.children = []\n\t\t\tthis.children.push(newItems.length === 0 ? this.renderNoItem() : newItems.map((item) => this.buildFunction(item)))\n\t\t})\n\n\t\tthis.view = () => {\n\t\t\treturn m(\n\t\t\t\t\".dropdown-panel-scrollable.elevated-bg.border-radius.dropdown-shadow.fit-content\",\n\t\t\t\t{\n\t\t\t\t\toncreate: (vnode: VnodeDOM<HTMLElement>) => {\n\t\t\t\t\t\tthis.domDropdown = vnode.dom as HTMLElement\n\t\t\t\t\t\t// It is important to set initial opacity so that user doesn't see it with full opacity before animating.\n\t\t\t\t\t\tthis.domDropdown.style.opacity = \"0\"\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tm(\n\t\t\t\t\t\".dropdown-content.scroll.flex.flex-column\",\n\t\t\t\t\t{\n\t\t\t\t\t\trole: AriaRole.Listbox,\n\t\t\t\t\t\ttabindex: TabIndex.Programmatic,\n\t\t\t\t\t\toncreate: (vnode: VnodeDOM<HTMLElement>) => {\n\t\t\t\t\t\t\tthis.domContents = vnode.dom as HTMLElement\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonupdate: (vnode: VnodeDOM<HTMLElement>) => {\n\t\t\t\t\t\t\tif (this.maxHeight == null) {\n\t\t\t\t\t\t\t\tconst children = Array.from(vnode.dom.children) as Array<HTMLElement>\n\t\t\t\t\t\t\t\tthis.maxHeight = Math.min(\n\t\t\t\t\t\t\t\t\t400 + size.vpad,\n\t\t\t\t\t\t\t\t\tchildren.reduce((accumulator, children) => accumulator + children.offsetHeight, 0) + size.vpad,\n\t\t\t\t\t\t\t\t) // size.pad accounts for top and bottom padding\n\n\t\t\t\t\t\t\t\tif (this.origin) {\n\t\t\t\t\t\t\t\t\t// The dropdown-content element is added to the dom has a hidden element first.\n\t\t\t\t\t\t\t\t\t// The maxHeight is available after the first onupdate call. Then this promise will resolve and we can safely\n\t\t\t\t\t\t\t\t\t// show the dropdown.\n\t\t\t\t\t\t\t\t\t// Modal always schedules redraw in oncreate() of a component so we are guaranteed to have onupdate() call.\n\t\t\t\t\t\t\t\t\tshowDropdown(this.origin, assertNotNull(this.domDropdown), this.maxHeight, this.width, dropdownPosition).then(() => {\n\t\t\t\t\t\t\t\t\t\tconst selectedOption = vnode.dom.querySelector(\"[aria-selected='true']\") as HTMLElement | null\n\t\t\t\t\t\t\t\t\t\tif (selectedOption && !keepFocus) {\n\t\t\t\t\t\t\t\t\t\t\tselectedOption.focus()\n\t\t\t\t\t\t\t\t\t\t} else if (!keepFocus && (!this.domDropdown || focusNext(this.domDropdown))) {\n\t\t\t\t\t\t\t\t\t\t\tthis.domContents?.focus()\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.updateDropdownSize(vnode)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonscroll: (ev: EventRedraw<Event>) => {\n\t\t\t\t\t\t\tconst target = ev.target as HTMLElement\n\t\t\t\t\t\t\t// needed here to prevent flickering on ios\n\t\t\t\t\t\t\tev.redraw =\n\t\t\t\t\t\t\t\tthis.domContents != null && target.scrollTop < 0 && target.scrollTop + this.domContents.offsetHeight > target.scrollHeight\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tthis.children,\n\t\t\t\t),\n\t\t\t)\n\t\t}\n\t}\n\n\tprivate updateDropdownSize(vnode: VnodeDOM<HTMLElement>) {\n\t\tif (!(this.origin && this.domDropdown)) {\n\t\t\treturn\n\t\t}\n\n\t\tconst upperSpace = this.origin.top - getSafeAreaInsetTop()\n\t\tconst lowerSpace = window.innerHeight - this.origin.bottom - getSafeAreaInsetBottom()\n\n\t\tconst children = Array.from(vnode.dom.children) as Array<HTMLElement>\n\t\tconst contentHeight = Math.min(400 + size.vpad, children.reduce((accumulator, children) => accumulator + children.offsetHeight, 0) + size.vpad)\n\n\t\tthis.maxHeight = lowerSpace > upperSpace ? Math.min(contentHeight, lowerSpace) : Math.min(contentHeight, upperSpace)\n\t\tconst newHeight = px(this.maxHeight)\n\t\tif (this.domDropdown.style.height !== newHeight) this.domDropdown.style.height = newHeight\n\t}\n\n\tprivate renderNoItem(): Children {\n\t\treturn m(\"span.placeholder.text-center\", { color: theme.list_message_bg }, lang.get(\"noEntries_msg\"))\n\t}\n\n\tbackgroundClick = (e: MouseEvent) => {\n\t\tif (\n\t\t\tthis.domDropdown &&\n\t\t\t!(e.target as HTMLElement).classList.contains(\"doNotClose\") &&\n\t\t\t(this.domDropdown.contains(e.target as HTMLElement) || this.domDropdown.parentNode === e.target)\n\t\t) {\n\t\t\tthis.onClose()\n\t\t}\n\t}\n\n\tbuildShortcuts(): Array<Shortcut> {\n\t\treturn [\n\t\t\t{\n\t\t\t\tkey: Keys.ESC,\n\t\t\t\texec: () => this.onClose(),\n\t\t\t\thelp: \"close_alt\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: Keys.TAB,\n\t\t\t\tshift: true,\n\t\t\t\texec: () => (this.domDropdown ? focusPrevious(this.domDropdown) : false),\n\t\t\t\thelp: \"selectPrevious_action\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: Keys.TAB,\n\t\t\t\tshift: false,\n\t\t\t\texec: () => (this.domDropdown ? focusNext(this.domDropdown) : false),\n\t\t\t\thelp: \"selectNext_action\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: Keys.UP,\n\t\t\t\texec: () => (this.domDropdown ? focusPrevious(this.domDropdown) : false),\n\t\t\t\thelp: \"selectPrevious_action\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: Keys.DOWN,\n\t\t\t\texec: () => (this.domDropdown ? focusNext(this.domDropdown) : false),\n\t\t\t\thelp: \"selectNext_action\",\n\t\t\t},\n\t\t]\n\t}\n\n\tsetOrigin(origin: PosRect): this {\n\t\tthis.origin = origin\n\t\treturn this\n\t}\n\n\tclose(): void {\n\t\tmodal.remove(this)\n\t}\n\n\thideAnimation(): Promise<void> {\n\t\treturn Promise.resolve()\n\t}\n\n\tonClose(): void {\n\t\tthis.close()\n\t}\n\n\tpopState(e: Event): boolean {\n\t\tthis.onClose()\n\t\treturn false\n\t}\n\n\tcallingElement(): HTMLElement | null {\n\t\treturn this.focusedBeforeShown\n\t}\n}\n"]}