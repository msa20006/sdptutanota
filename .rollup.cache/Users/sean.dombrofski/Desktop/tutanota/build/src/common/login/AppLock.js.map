{"version":3,"file":"AppLock.js","sourceRoot":"","sources":["../../../../src/common/login/AppLock.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,wBAAwB,EAAE,MAAM,iDAAiD,CAAA;AAU1F,MAAM,OAAO,WAAW;IACvB,KAAK,CAAC,OAAO,KAAmB,CAAC;CACjC;AAED,MAAM,OAAO,aAAa;IACI;IAAyD;IAAtF,YAA6B,kBAAsC,EAAmB,iBAA0C;QAAnG,uBAAkB,GAAlB,kBAAkB,CAAoB;QAAmB,sBAAiB,GAAjB,iBAAiB,CAAyB;IAAG,CAAC;IAEpI,KAAK,CAAC,OAAO;QACZ,IAAI,CAAC,MAAM,IAAI,CAAC,iBAAiB,CAAC,2BAA2B,EAAE,CAAC,IAAI,wBAAwB,CAAC,WAAW,EAAE,CAAC;YAC1G,+CAA+C;YAC/C,OAAM;QACP,CAAC;QACD,OAAO,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,MAAM,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,EAAE,CAAC,CAAA;IAChG,CAAC;CACD","sourcesContent":["import { MobileSystemFacade } from \"../native/common/generatedipc/MobileSystemFacade.js\"\nimport { NativeCredentialsFacade } from \"../native/common/generatedipc/NativeCredentialsFacade.js\"\nimport { CredentialEncryptionMode } from \"../misc/credentials/CredentialEncryptionMode.js\"\n\n/**\n * Enforces app authentication via system mechanism e.g. system password or biometrics.\n */\nexport interface AppLock {\n\t/** @throws CredentialAuthenticationError */\n\tenforce(): Promise<void>\n}\n\nexport class NoOpAppLock implements AppLock {\n\tasync enforce(): Promise<void> {}\n}\n\nexport class MobileAppLock implements AppLock {\n\tconstructor(private readonly mobileSystemFacade: MobileSystemFacade, private readonly credentialsFacade: NativeCredentialsFacade) {}\n\n\tasync enforce(): Promise<void> {\n\t\tif ((await this.credentialsFacade.getCredentialEncryptionMode()) != CredentialEncryptionMode.DEVICE_LOCK) {\n\t\t\t// for migration: do not display the lock twice\n\t\t\treturn\n\t\t}\n\t\treturn this.mobileSystemFacade.enforceAppLock(await this.mobileSystemFacade.getAppLockMethod())\n\t}\n}\n"]}