{"version":3,"file":"WebDesktopFacade.js","sourceRoot":"","sources":["../../../../../src/common/native/main/WebDesktopFacade.ts"],"names":[],"mappings":"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","sourcesContent":["import { DesktopFacade } from \"../common/generatedipc/DesktopFacade\"\nimport { showSpellcheckLanguageDialog } from \"../../gui/dialogs/SpellcheckLanguageDialog\"\nimport { ElectronResult } from \"../common/generatedipc/ElectronResult.js\"\nimport { ErrorInfo } from \"../common/generatedipc/ErrorInfo.js\"\nimport { NativeShortcut } from \"../common/generatedipc/NativeShortcut.js\"\nimport { Shortcut } from \"../../misc/KeyManager.js\"\nimport { Keys } from \"../../api/common/TutanotaConstants.js\"\nimport { LoginController } from \"../../api/main/LoginController.js\"\nimport { lazyAsync } from \"@tutao/tutanota-utils\"\nimport { NativeInterfaceMain } from \"./NativeInterfaceMain.js\"\n\nexport class WebDesktopFacade implements DesktopFacade {\n\tconstructor(private logins: LoginController, private nativeInterface: lazyAsync<NativeInterfaceMain>) {}\n\n\tprint(): Promise<void> {\n\t\twindow.print()\n\t\treturn Promise.resolve()\n\t}\n\n\tasync showSpellcheckDropdown(): Promise<void> {\n\t\tawait showSpellcheckLanguageDialog()\n\t}\n\n\tasync applySearchResultToOverlay(result: ElectronResult | null): Promise<void> {\n\t\tconst { searchInPageOverlay } = await import(\"../../gui/SearchInPageOverlay.js\")\n\t\tsearchInPageOverlay.applyNextResult(result)\n\t\treturn Promise.resolve()\n\t}\n\n\tasync openFindInPage(): Promise<void> {\n\t\tconst { searchInPageOverlay } = await import(\"../../gui/SearchInPageOverlay.js\")\n\t\tsearchInPageOverlay.open()\n\t\treturn Promise.resolve()\n\t}\n\n\tasync reportError(errorInfo: ErrorInfo): Promise<void> {\n\t\tconst { showErrorNotification } = await import(\"../../misc/ErrorReporter.js\")\n\t\tawait this.logins.waitForPartialLogin()\n\t\tawait showErrorNotification(errorInfo)\n\t}\n\n\t/**\n\t * Updates the link-reveal on hover when the main thread detects that\n\t * the hovered url changed. Will _not_ update if hovering a in link app (starts with 2nd argument)\n\t */\n\tasync updateTargetUrl(url: string, appPath: string): Promise<void> {\n\t\tlet linkToolTip = document.getElementById(\"link-tt\")\n\n\t\tif (!linkToolTip) {\n\t\t\tlinkToolTip = document.createElement(\"DIV\")\n\t\t\tlinkToolTip.id = \"link-tt\"\n\t\t\t;(document.body as any).appendChild(linkToolTip)\n\t\t}\n\n\t\tif (url === \"\" || url.startsWith(appPath)) {\n\t\t\tlinkToolTip.className = \"\"\n\t\t} else {\n\t\t\tlinkToolTip.innerText = url\n\t\t\tlinkToolTip.className = \"reveal\"\n\t\t}\n\n\t\treturn Promise.resolve()\n\t}\n\n\t/**\n\t * this is only used in the admin client to sync the DB view with the inbox\n\t */\n\tasync openCustomer(mailAddress: string | null): Promise<void> {\n\t\tconst m = await import(\"mithril\")\n\n\t\tif (typeof mailAddress === \"string\" && m.route.get().startsWith(\"/customer\")) {\n\t\t\tm.route.set(`/customer?query=${encodeURIComponent(mailAddress)}`)\n\t\t\tconsole.log(\"switching to customer\", mailAddress)\n\t\t}\n\t}\n\n\tasync addShortcuts(shortcuts: Array<NativeShortcut>): Promise<void> {\n\t\tconst baseShortcut: Shortcut = {\n\t\t\texec: () => true,\n\t\t\tctrlOrCmd: false,\n\t\t\talt: false,\n\t\t\tmeta: false,\n\t\t\thelp: \"emptyString_msg\",\n\t\t\tkey: Keys.F,\n\t\t}\n\t\tconst fixedShortcuts: Array<Shortcut> = shortcuts.map((nsc) => Object.assign({}, baseShortcut, nsc))\n\t\tconst { keyManager } = await import(\"../../misc/KeyManager.js\")\n\t\tkeyManager.registerDesktopShortcuts(fixedShortcuts)\n\t}\n\n\tasync appUpdateDownloaded(): Promise<void> {\n\t\tconst native = await this.nativeInterface()\n\t\tnative.handleUpdateDownload()\n\t}\n}\n"]}