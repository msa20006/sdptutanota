{"version":3,"file":"ListUtils.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/ListUtils.ts"],"names":[],"mappings":"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","sourcesContent":["import { ListElement } from \"../../api/common/utils/EntityUtils.js\"\nimport { Shortcut } from \"../../misc/KeyManager.js\"\nimport { Keys } from \"../../api/common/TutanotaConstants.js\"\nimport { mapLazily } from \"@tutao/tutanota-utils\"\nimport { ListState, MultiselectMode } from \"./List.js\"\nimport { Children } from \"mithril\"\nimport { isBrowser } from \"../../api/common/Env.js\"\nimport { ListElementListModel } from \"../../misc/ListElementListModel\"\n\nexport const ACTION_DISTANCE = 150\nexport const PageSize = 100\n\n/**\n * 1:1 mapping to DOM elements. Displays a single list entry.\n */\nexport interface VirtualRow<ElementType> {\n\trender(): Children\n\n\tupdate(listEntry: ElementType, selected: boolean, isInMultiSelect: boolean): void\n\n\tentity: ElementType | null\n\ttop: number\n\tdomElement: HTMLElement | null\n}\n\nexport interface ListFetchResult<ElementType> {\n\titems: Array<ElementType>\n\t/** Complete means that we loaded the whole list and additional requests will not yield any results. */\n\tcomplete: boolean\n}\n\nexport type ListSelectionCallbacks = Pick<ListElementListModel<ListElement>, \"selectPrevious\" | \"selectNext\" | \"areAllSelected\" | \"selectAll\" | \"selectNone\">\n\nexport function listSelectionKeyboardShortcuts(multiselectMode: MultiselectMode, callbacks: () => ListSelectionCallbacks | null): Array<Shortcut> {\n\tconst multiselectionEnabled = multiselectMode == MultiselectMode.Enabled ? () => true : () => false\n\treturn [\n\t\t{\n\t\t\tkey: Keys.UP,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectPrevious(false)),\n\t\t\thelp: \"selectPrevious_action\",\n\t\t},\n\t\t{\n\t\t\tkey: Keys.K,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectPrevious(false)),\n\t\t\thelp: \"selectPrevious_action\",\n\t\t},\n\t\t{\n\t\t\tkey: Keys.UP,\n\t\t\tshift: true,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectPrevious(true)),\n\t\t\thelp: \"addPrevious_action\",\n\t\t\tenabled: multiselectionEnabled,\n\t\t},\n\t\t{\n\t\t\tkey: Keys.K,\n\t\t\tshift: true,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectPrevious(true)),\n\t\t\thelp: \"addPrevious_action\",\n\t\t\tenabled: multiselectionEnabled,\n\t\t},\n\t\t{\n\t\t\tkey: Keys.DOWN,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectNext(false)),\n\t\t\thelp: \"selectNext_action\",\n\t\t},\n\t\t{\n\t\t\tkey: Keys.J,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectNext(false)),\n\t\t\thelp: \"selectNext_action\",\n\t\t},\n\t\t{\n\t\t\tkey: Keys.DOWN,\n\t\t\tshift: true,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectNext(true)),\n\t\t\thelp: \"addNext_action\",\n\t\t\tenabled: multiselectionEnabled,\n\t\t},\n\t\t{\n\t\t\tkey: Keys.J,\n\t\t\tshift: true,\n\t\t\texec: mapLazily(callbacks, (list) => list?.selectNext(true)),\n\t\t\thelp: \"addNext_action\",\n\t\t\tenabled: multiselectionEnabled,\n\t\t},\n\t\t{\n\t\t\tkey: Keys.A,\n\t\t\tctrlOrCmd: true,\n\t\t\tshift: true,\n\t\t\texec: mapLazily(callbacks, (list) => (list?.areAllSelected() ? list.selectNone() : list?.selectAll())),\n\t\t\thelp: \"selectAllLoaded_action\",\n\t\t\t// this specific shortcut conflicts with a chrome shortcut. it was chosen because it's adjacent to ctrl + A\n\t\t\t// for select all.\n\t\t\tenabled: () => multiselectionEnabled() && !isBrowser(),\n\t\t},\n\t]\n}\n\nexport function onlySingleSelection<T>(state: ListState<T>): T | null {\n\tif (state.selectedItems.size === 1) {\n\t\treturn state.selectedItems.values().next().value\n\t} else {\n\t\treturn null\n\t}\n}\n"]}