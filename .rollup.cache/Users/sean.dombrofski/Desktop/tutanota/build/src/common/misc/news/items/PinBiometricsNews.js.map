{"version":3,"file":"PinBiometricsNews.js","sourceRoot":"","sources":["../../../../../../src/common/misc/news/items/PinBiometricsNews.ts"],"names":[],"mappings":"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","sourcesContent":["import { NewsListItem } from \"../NewsListItem.js\"\nimport { NewsId } from \"../../../api/entities/tutanota/TypeRefs.js\"\nimport Mithril from \"mithril\"\nimport m from \"mithril\"\nimport { isAndroidApp, isIOSApp } from \"../../../api/common/Env.js\"\nimport { lang } from \"../../LanguageViewModel.js\"\nimport { Button, ButtonType } from \"../../../gui/base/Button.js\"\nimport { NewsModel } from \"../NewsModel.js\"\nimport { showCredentialsEncryptionModeDialog } from \"../../../gui/dialogs/SelectCredentialsEncryptionModeDialog.js\"\nimport { CredentialsProvider } from \"../../credentials/CredentialsProvider.js\"\nimport { Dialog } from \"../../../gui/base/Dialog.js\"\nimport { ExternalLink } from \"../../../gui/base/ExternalLink.js\"\n\nconst playstoreLink = \"https://play.google.com/store/apps/details?id=de.tutao.tutanota\"\nconst appstoreLink = \"https://apps.apple.com/app/tutanota/id922429609\"\n\n/**\n * News item that reminds the user of configuring pin/ biometrics\n */\nexport class PinBiometricsNews implements NewsListItem {\n\tconstructor(private readonly newsModel: NewsModel, private readonly credentialsProvider: CredentialsProvider, private readonly userId: Id) {}\n\n\tisShown(newsId: NewsId): Promise<boolean> {\n\t\treturn Promise.resolve((isIOSApp() || isAndroidApp()) && !this.newsModel.hasAcknowledgedNewsForDevice(newsId.newsItemId))\n\t}\n\n\trender(newsId: NewsId): Mithril.Children {\n\t\tconst displayedLink = isAndroidApp() ? playstoreLink : appstoreLink\n\t\treturn m(\".full-width\", [\n\t\t\tm(\".h4\", { style: { \"text-transform\": \"capitalize\" } }, lang.get(\"pinBiometrics_action\")),\n\t\t\tm(\"p\", lang.get(\"pinBiometrics1_msg\", { \"{secureNowAction}\": lang.get(\"secureNow_action\") })),\n\t\t\tm(\"p\", lang.get(\"pinBiometrics2_msg\")),\n\t\t\tm(\"p\", [m(\".text-break\", [m(ExternalLink, { href: displayedLink, isCompanySite: false })])]),\n\t\t\tm(\"p\", lang.get(\"pinBiometrics3_msg\")),\n\t\t\tm(\".flex-end.flex-no-grow-no-shrink-auto.flex-wrap\", [\n\t\t\t\tthis.renderLaterButton(newsId),\n\t\t\t\tthis.renderDismissButton(newsId),\n\t\t\t\tthis.renderConfirmButton(newsId),\n\t\t\t]),\n\t\t])\n\t}\n\n\tprivate renderLaterButton(newsId: NewsId) {\n\t\treturn m(Button, {\n\t\t\tlabel: \"decideLater_action\",\n\t\t\ttype: ButtonType.Secondary,\n\t\t\tclick: async () => {\n\t\t\t\tawait this.newsModel.acknowledgeNews(newsId.newsItemId)\n\t\t\t\tm.redraw()\n\t\t\t},\n\t\t})\n\t}\n\n\tprivate renderDismissButton(newsId: NewsId) {\n\t\treturn m(Button, {\n\t\t\tlabel: \"noThanks_action\",\n\t\t\ttype: ButtonType.Secondary,\n\t\t\tclick: async () => {\n\t\t\t\tthis.newsModel.acknowledgeNewsForDevice(newsId.newsItemId)\n\t\t\t\tawait this.newsModel.acknowledgeNews(newsId.newsItemId)\n\t\t\t\tm.redraw()\n\t\t\t},\n\t\t})\n\t}\n\n\tprivate renderConfirmButton(newsId: NewsId) {\n\t\treturn m(Button, {\n\t\t\tlabel: \"secureNow_action\",\n\t\t\tclick: async () => {\n\t\t\t\tif ((await this.credentialsProvider.getCredentialsInfoByUserId(this.userId)) === null) {\n\t\t\t\t\tawait Dialog.message(lang.getTranslation(\"needSavedCredentials_msg\", { \"{storePasswordAction}\": lang.get(\"storePassword_action\") }))\n\t\t\t\t} else {\n\t\t\t\t\tawait showCredentialsEncryptionModeDialog(this.credentialsProvider)\n\n\t\t\t\t\tthis.newsModel.acknowledgeNewsForDevice(newsId.newsItemId)\n\t\t\t\t\tawait this.newsModel.acknowledgeNews(newsId.newsItemId)\n\t\t\t\t\tm.redraw()\n\t\t\t\t}\n\t\t\t},\n\t\t\ttype: ButtonType.Primary,\n\t\t})\n\t}\n}\n"]}