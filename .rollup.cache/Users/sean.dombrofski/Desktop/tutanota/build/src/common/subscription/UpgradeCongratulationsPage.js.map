{"version":3,"file":"UpgradeCongratulationsPage.js","sourceRoot":"","sources":["../../../../src/common/subscription/UpgradeCongratulationsPage.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Vnode, VnodeDOM } from \"mithril\"\nimport { lang, type TranslationKey } from \"../misc/LanguageViewModel\"\nimport type { UpgradeSubscriptionData } from \"./UpgradeSubscriptionWizard\"\nimport type { WizardPageAttrs, WizardPageN } from \"../gui/base/WizardDialog.js\"\nimport { emitWizardEvent, WizardEventType } from \"../gui/base/WizardDialog.js\"\nimport { locator } from \"../api/main/CommonLocator\"\nimport { UsageTest } from \"@tutao/tutanota-usagetests\"\nimport { RecoverCodeField } from \"../settings/login/RecoverCodeDialog.js\"\nimport { VisSignupImage } from \"../gui/base/icons/Icons.js\"\nimport { PlanType } from \"../api/common/TutanotaConstants.js\"\nimport { LoginButton } from \"../gui/base/buttons/LoginButton.js\"\n\nexport class UpgradeCongratulationsPage implements WizardPageN<UpgradeSubscriptionData> {\n\tprivate dom!: HTMLElement\n\tprivate __signupPaidTest?: UsageTest\n\tprivate __signupFreeTest?: UsageTest\n\n\toncreate(vnode: VnodeDOM<WizardPageAttrs<UpgradeSubscriptionData>>) {\n\t\tthis.__signupPaidTest = locator.usageTestController.getTest(\"signup.paid\")\n\t\tthis.__signupFreeTest = locator.usageTestController.getTest(\"signup.free\")\n\n\t\tthis.dom = vnode.dom as HTMLElement\n\t}\n\n\tview({ attrs }: Vnode<WizardPageAttrs<UpgradeSubscriptionData>>): Children {\n\t\tconst { newAccountData } = attrs.data\n\n\t\treturn [\n\t\t\tm(\".center.h4.pt\", lang.get(\"accountCreationCongratulation_msg\")),\n\t\t\tnewAccountData\n\t\t\t\t? m(\".plr-l\", [\n\t\t\t\t\t\tm(RecoverCodeField, {\n\t\t\t\t\t\t\tshowMessage: true,\n\t\t\t\t\t\t\trecoverCode: newAccountData.recoverCode,\n\t\t\t\t\t\t\timage: {\n\t\t\t\t\t\t\t\tsrc: VisSignupImage,\n\t\t\t\t\t\t\t\talt: \"vitor_alt\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t  ])\n\t\t\t\t: null,\n\t\t\tm(\n\t\t\t\t\".flex-center.full-width.pt-l\",\n\t\t\t\tm(LoginButton, {\n\t\t\t\t\tlabel: \"ok_action\",\n\t\t\t\t\tclass: \"small-login-button\",\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tif (attrs.data.type === PlanType.Free) {\n\t\t\t\t\t\t\tconst recoveryConfirmationStageFree = this.__signupFreeTest?.getStage(5)\n\n\t\t\t\t\t\t\trecoveryConfirmationStageFree?.setMetric({\n\t\t\t\t\t\t\t\tname: \"switchedFromPaid\",\n\t\t\t\t\t\t\t\tvalue: (this.__signupPaidTest?.isStarted() ?? false).toString(),\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\trecoveryConfirmationStageFree?.complete()\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.close(attrs.data, this.dom)\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t),\n\t\t]\n\t}\n\n\tprivate close(data: UpgradeSubscriptionData, dom: HTMLElement) {\n\t\tlet promise = Promise.resolve()\n\n\t\tif (data.newAccountData && locator.logins.isUserLoggedIn()) {\n\t\t\tpromise = locator.logins.logout(false)\n\t\t}\n\n\t\tpromise.then(() => {\n\t\t\temitWizardEvent(dom, WizardEventType.SHOW_NEXT_PAGE)\n\t\t})\n\t}\n}\n\nexport class UpgradeCongratulationsPageAttrs implements WizardPageAttrs<UpgradeSubscriptionData> {\n\tdata: UpgradeSubscriptionData\n\tpreventGoBack = true\n\thidePagingButtonForPage = true\n\n\tconstructor(upgradeData: UpgradeSubscriptionData) {\n\t\tthis.data = upgradeData\n\t}\n\n\theaderTitle(): TranslationKey {\n\t\treturn \"accountCongratulations_msg\"\n\t}\n\n\tnextAction(showDialogs: boolean): Promise<boolean> {\n\t\t// next action not available for this page\n\t\treturn Promise.resolve(true)\n\t}\n\n\tisSkipAvailable(): boolean {\n\t\treturn false\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn true\n\t}\n}\n"]}