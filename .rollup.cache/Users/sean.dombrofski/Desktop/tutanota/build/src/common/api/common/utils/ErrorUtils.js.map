{"version":3,"file":"ErrorUtils.js","sourceRoot":"","sources":["../../../../../../src/common/api/common/utils/ErrorUtils.ts"],"names":[],"mappings":"AAAA,qBAAqB;AAErB,OAAO,EAAE,QAAQ,EAAE,MAAM,uBAAuB,CAAA;AAEhD,OAAO,EACN,kBAAkB,EAClB,sBAAsB,EACtB,kBAAkB,EAClB,eAAe,EACf,eAAe,EACf,eAAe,EACf,wBAAwB,EACxB,mBAAmB,EACnB,gBAAgB,EAChB,2BAA2B,EAC3B,iBAAiB,EACjB,WAAW,EACX,qBAAqB,EACrB,qBAAqB,EACrB,kBAAkB,EAClB,aAAa,EACb,oBAAoB,EACpB,uBAAuB,EACvB,mBAAmB,EACnB,aAAa,EACb,uBAAuB,EACvB,mBAAmB,EACnB,oBAAoB,GACpB,MAAM,uBAAuB,CAAA;AAC9B,OAAO,EAAE,eAAe,EAAE,MAAM,6BAA6B,CAAA;AAC7D,OAAO,EAAE,oBAAoB,EAAE,MAAM,kCAAkC,CAAA;AACvE,OAAO,EAAE,WAAW,EAAE,MAAM,iCAAiC,CAAA;AAC7D,OAAO,EAAE,uBAAuB,EAAE,MAAM,qCAAqC,CAAA;AAC7E,OAAO,EAAE,QAAQ,EAAE,MAAM,sBAAsB,CAAA;AAC/C,OAAO,EAAE,gBAAgB,EAAE,MAAM,8BAA8B,CAAA;AAC/D,OAAO,EAAE,uBAAuB,EAAE,MAAM,qCAAqC,CAAA;AAC7E,OAAO,EAAE,yBAAyB,EAAE,MAAM,uCAAuC,CAAA;AACjF,OAAO,EAAE,oBAAoB,EAAE,MAAM,kCAAkC,CAAA;AACvE,OAAO,EAAE,cAAc,EAAE,MAAM,4BAA4B,CAAA;AAC3D,OAAO,EAAE,OAAO,EAAE,MAAM,qBAAqB,CAAA;AAC7C,OAAO,EAAE,yBAAyB,EAAE,MAAM,uCAAuC,CAAA;AACjF,OAAO,EAAE,kBAAkB,EAAE,MAAM,gCAAgC,CAAA;AACnE,OAAO,EAAE,cAAc,EAAE,MAAM,4BAA4B,CAAA;AAC3D,OAAO,EAAE,aAAa,EAAE,MAAM,2BAA2B,CAAA;AACzD,OAAO,EAAE,6BAA6B,EAAE,MAAM,2CAA2C,CAAA;AACzF,OAAO,EAAE,qBAAqB,EAAE,MAAM,mCAAmC,CAAA;AACzE,OAAO,EAAE,WAAW,EAAE,MAAM,yBAAyB,CAAA;AACrD,OAAO,EAAE,aAAa,EAAE,MAAM,2BAA2B,CAAA;AACzD,OAAO,EAAE,eAAe,EAAE,MAAM,6BAA6B,CAAA;AAC7D,OAAO,EAAE,iBAAiB,EAAE,MAAM,+BAA+B,CAAA;AACjE,OAAO,EAAE,6BAA6B,EAAE,MAAM,2CAA2C,CAAA;AACzF,OAAO,EAAE,8BAA8B,EAAE,MAAM,4CAA4C,CAAA;AAC3F,OAAO,EAAE,WAAW,EAAE,MAAM,2CAA2C,CAAA;AACvE,OAAO,EAAE,iBAAiB,EAAE,MAAM,+BAA+B,CAAA;AACjE,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAA;AAChE,OAAO,EAAE,eAAe,EAAE,MAAM,6BAA6B,CAAA;AAC7D,OAAO,EAAE,WAAW,EAAE,MAAM,sBAAsB,CAAA;AAElD;;;;;;GAMG;AACH,MAAM,UAAU,QAAQ,CAAI,QAAgB,EAAE,GAAO;IACpD,MAAM,kBAAkB,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAA;IAC7C,OAAO,CAAC,QAAQ,IAAI,CAAC,CAAC,CAAC,kBAAkB,CAAC,OAAO,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,kBAAkB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAA;AACjG,CAAC;AAED,0JAA0J;AAC1J;;GAEG;AACH,MAAM,UAAU,cAAc,CAAC,CAAQ;IACtC,OAAO,CAAC,YAAY,eAAe,IAAI,CAAC,YAAY,oBAAoB,CAAA;AACzE,CAAC;AAED,8FAA8F;AAE9F;;;;;;GAMG;AACH,MAAM,eAAe,GAAG;IACvB,eAAe;IACf,eAAe;IACf,qBAAqB;IACrB,mBAAmB;IACnB,kBAAkB;IAClB,aAAa;IACb,qBAAqB;IACrB,uBAAuB;IACvB,WAAW;IACX,oBAAoB;IACpB,sBAAsB;IACtB,kBAAkB;IAClB,kBAAkB;IAClB,gBAAgB;IAChB,2BAA2B;IAC3B,iBAAiB;IACjB,mBAAmB;IACnB,eAAe;IACf,aAAa;IACb,mBAAmB;IACnB,wBAAwB;IACxB,WAAW;IACX,uBAAuB;IACvB,QAAQ;IACR,gBAAgB;IAChB,uBAAuB;IACvB,yBAAyB;IACzB,oBAAoB;IACpB,cAAc;IACd,uBAAuB;IACvB,OAAO;IACP,yBAAyB;IACzB,kBAAkB;IAClB,cAAc;IACd,aAAa;IACb,oBAAoB;IACpB,6BAA6B;IAC7B,qBAAqB;IACrB,WAAW;IACX,WAAW;IACX,aAAa;IACb,eAAe;IACf,oBAAoB;IACpB,WAAW;IACX,8BAA8B;IAC9B,eAAe;IACf,KAAK;IACL,iCAAiC,EAAE,eAAe;IAClD,0BAA0B,EAAE,eAAe;IAC3C,2BAA2B,EAAE,eAAe;IAC5C,4BAA4B,EAAE,eAAe;IAC7C,qCAAqC,EAAE,eAAe;IACtD,sBAAsB,EAAE,eAAe;IACvC,+BAA+B,EAAE,eAAe;IAChD,6BAA6B,EAAE,eAAe;IAC9C,+BAA+B,EAAE,iBAAiB;IAClD,iCAAiC,EAAE,WAAW;IAC9C,mCAAmC;IACnC,+BAA+B,EAAE,WAAW;IAC5C,8BAA8B;IAC9B,2CAA2C,EAAE,aAAa;IAC1D,mCAAmC,EAAE,aAAa;IAClD,gBAAgB,EAAE,eAAe;IACjC,uDAAuD,EAAE,6BAA6B;IACtF,8DAA8D,EAAE,8BAA8B;IAC9F,oDAAoD,EAAE,8BAA8B;IACpF,mDAAmD,EAAE,6BAA6B;IAClF,kDAAkD,EAAE,oBAAoB;IACxE,oCAAoC,EAAE,cAAc;IACpD,0CAA0C,EAAE,aAAa;IACzD,4BAA4B,EAAE,aAAa;IAC3C,qCAAqC,EAAE,eAAe;IACtD,uCAAuC,EAAE,iBAAiB;IAC1D,iCAAiC,EAAE,kBAAkB;CACrD,CAAA;AAED,MAAM,UAAU,eAAe,CAAC,CAAM;IACrC,OAAO,CAAC,YAAY,YAAY,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,eAAe,IAAI,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,YAAY,CAAC,CAAA;AAC9F,CAAC;AAED,MAAM,UAAU,mBAAmB,CAAC,CAAM;IACzC,OAAO,CAAC,YAAY,YAAY,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,mBAAmB,IAAI,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAA;AACvG,CAAC;AAED;;GAEG;AACH,MAAM,UAAU,UAAU,CAAC,CAAsB;IAChD,aAAa;IACb,IAAI,SAAS,GAAG,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;IACvC,IAAI,CAAC,GAAG,CAAC,SAAS,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,CAAQ,CAAA;IACpF,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,CAAA;IACf,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,CAAA;IAC5B,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,CAAA;IACf,OAAO,CAAC,CAAA;AACT,CAAC","sourcesContent":["// @bundleInto:common\n\nimport { downcast } from \"@tutao/tutanota-utils\"\nimport { Entity } from \"../EntityTypes\"\nimport {\n\tAccessBlockedError,\n\tAccessDeactivatedError,\n\tAccessExpiredError,\n\tBadGatewayError,\n\tBadRequestError,\n\tConnectionError,\n\tInsufficientStorageError,\n\tInternalServerError,\n\tInvalidDataError,\n\tInvalidSoftwareVersionError,\n\tLimitReachedError,\n\tLockedError,\n\tMethodNotAllowedError,\n\tNotAuthenticatedError,\n\tNotAuthorizedError,\n\tNotFoundError,\n\tPayloadTooLargeError,\n\tPreconditionFailedError,\n\tRequestTimeoutError,\n\tResourceError,\n\tServiceUnavailableError,\n\tSessionExpiredError,\n\tTooManyRequestsError,\n} from \"../error/RestError.js\"\nimport { SuspensionError } from \"../error/SuspensionError.js\"\nimport { LoginIncompleteError } from \"../error/LoginIncompleteError.js\"\nimport { CryptoError } from \"@tutao/tutanota-crypto/error.js\"\nimport { SessionKeyNotFoundError } from \"../error/SessionKeyNotFoundError.js\"\nimport { SseError } from \"../error/SseError.js\"\nimport { ProgrammingError } from \"../error/ProgrammingError.js\"\nimport { RecipientsNotFoundError } from \"../error/RecipientsNotFoundError.js\"\nimport { RecipientNotResolvedError } from \"../error/RecipientNotResolvedError.js\"\nimport { OfflineDbClosedError } from \"../error/OfflineDbClosedError.js\"\nimport { OutOfSyncError } from \"../error/OutOfSyncError.js\"\nimport { DbError } from \"../error/DbError.js\"\nimport { IndexingNotSupportedError } from \"../error/IndexingNotSupportedError.js\"\nimport { QuotaExceededError } from \"../error/QuotaExceededError.js\"\nimport { CancelledError } from \"../error/CancelledError.js\"\nimport { FileOpenError } from \"../error/FileOpenError.js\"\nimport { DeviceStorageUnavailableError } from \"../error/DeviceStorageUnavailableError.js\"\nimport { MailBodyTooLargeError } from \"../error/MailBodyTooLargeError.js\"\nimport { ImportError } from \"../error/ImportError.js\"\nimport { WebauthnError } from \"../error/WebauthnError.js\"\nimport { PermissionError } from \"../error/PermissionError.js\"\nimport { FileNotFoundError } from \"../error/FileNotFoundError.js\"\nimport { CredentialAuthenticationError } from \"../error/CredentialAuthenticationError.js\"\nimport { KeyPermanentlyInvalidatedError } from \"../error/KeyPermanentlyInvalidatedError.js\"\nimport { ParserError } from \"../../../misc/parsing/ParserCombinator.js\"\nimport { ContactStoreError } from \"../error/ContactStoreError.js\"\nimport { MobilePaymentError } from \"../error/MobilePaymentError\"\nimport { MailImportError } from \"../error/MailImportError.js\"\nimport { ExportError } from \"../error/ExportError\"\n\n/**\n * Checks if the given instance has an error in the _errors property which is usually written\n * if decryption fails for some reason in InstanceMapper.\n * @param instance the instance to check for errors.\n * @param key only returns true if there is an error for this key. Other errors will be ignored if the key is defined.\n * @returns {boolean} true if error was found (for the given key).\n */\nexport function hasError<K>(instance: Entity, key?: K): boolean {\n\tconst downCastedInstance = downcast(instance)\n\treturn !instance || (!!downCastedInstance._errors && (!key || !!downCastedInstance._errors.key))\n}\n\n//If importing fails it is a good idea to bundle the error into common-min which can be achieved by annotating the module with \"<at>bundleInto:common-min\"\n/**\n * Checks whether {@param e} is an error that can error before we are fully logged in and connected.\n */\nexport function isOfflineError(e: Error) {\n\treturn e instanceof ConnectionError || e instanceof LoginIncompleteError\n}\n\n// If importing fails it is a good idea to adjust the chunking to bundle the error into common\n\n/**\n * This maps the errors from their names to their constructors.\n * This is needed generally when errors cross IPC boundaries and more specifically when we want to map native errors to\n * our error classes.\n *\n * All errors that cross IPC boundaries should be added here.\n */\nconst ErrorNameToType = {\n\tConnectionError,\n\tBadRequestError,\n\tNotAuthenticatedError,\n\tSessionExpiredError,\n\tNotAuthorizedError,\n\tNotFoundError,\n\tMethodNotAllowedError,\n\tPreconditionFailedError,\n\tLockedError,\n\tTooManyRequestsError,\n\tAccessDeactivatedError,\n\tAccessExpiredError,\n\tAccessBlockedError,\n\tInvalidDataError,\n\tInvalidSoftwareVersionError,\n\tLimitReachedError,\n\tInternalServerError,\n\tBadGatewayError,\n\tResourceError,\n\tRequestTimeoutError,\n\tInsufficientStorageError,\n\tCryptoError,\n\tSessionKeyNotFoundError,\n\tSseError,\n\tProgrammingError,\n\tRecipientsNotFoundError,\n\tRecipientNotResolvedError,\n\tOfflineDbClosedError,\n\tOutOfSyncError,\n\tServiceUnavailableError,\n\tDbError,\n\tIndexingNotSupportedError,\n\tQuotaExceededError,\n\tCancelledError,\n\tFileOpenError,\n\tPayloadTooLargeError,\n\tDeviceStorageUnavailableError,\n\tMailBodyTooLargeError,\n\tImportError,\n\tExportError,\n\tWebauthnError,\n\tSuspensionError,\n\tLoginIncompleteError,\n\tParserError,\n\tKeyPermanentlyInvalidatedError,\n\tMailImportError,\n\tError,\n\t\"java.net.SocketTimeoutException\": ConnectionError,\n\t\"java.net.SocketException\": ConnectionError,\n\t\"java.net.ConnectException\": ConnectionError,\n\t\"javax.net.ssl.SSLException\": ConnectionError,\n\t\"javax.net.ssl.SSLHandshakeException\": ConnectionError,\n\t\"java.io.EOFException\": ConnectionError,\n\t\"java.net.UnknownHostException\": ConnectionError,\n\t\"java.lang.SecurityException\": PermissionError,\n\t\"java.io.FileNotFoundException\": FileNotFoundError,\n\t\"de.tutao.tutashared.CryptoError\": CryptoError,\n\t// Android app exception class name\n\t\"de.tutao.tutashared.TutCrypto\": CryptoError,\n\t// iOS app crypto error domain\n\t\"android.content.ActivityNotFoundException\": FileOpenError,\n\t\"de.tutao.tutashared.TutFileViewer\": FileOpenError,\n\tNSURLErrorDomain: ConnectionError,\n\t\"de.tutao.tutashared.CredentialAuthenticationException\": CredentialAuthenticationError,\n\t\"android.security.keystore.KeyPermanentlyInvalidatedException\": KeyPermanentlyInvalidatedError,\n\t\"de.tutao.tutashared.KeyPermanentlyInvalidatedError\": KeyPermanentlyInvalidatedError,\n\t\"de.tutao.tutashared.CredentialAuthenticationError\": CredentialAuthenticationError,\n\t\"de.tutao.tutashared.offline.OfflineDbClosedError\": OfflineDbClosedError,\n\t\"de.tutao.tutashared.CancelledError\": CancelledError,\n\t\"de.tutao.tutanota.webauthn.WebauthnError\": WebauthnError,\n\t\"de.tutao.tutanota.Webauthn\": WebauthnError,\n\t\"de.tutao.tutashared.PermissionError\": PermissionError,\n\t\"de.tutao.tutashared.ContactStoreError\": ContactStoreError,\n\t\"de.tutao.tutanota.MobilePayment\": MobilePaymentError,\n}\n\nexport function isSecurityError(e: any): boolean {\n\treturn e instanceof DOMException && (e.name === \"SecurityError\" || e.code === e.SECURITY_ERR)\n}\n\nexport function isNotSupportedError(e: any): boolean {\n\treturn e instanceof DOMException && (e.name === \"NotSupportedError\" || e.code === e.NOT_SUPPORTED_ERR)\n}\n\n/**\n * Convert a plain object to a class matching it's {@code name} field.\n */\nexport function objToError(o: Record<string, any>): Error {\n\t// @ts-ignore\n\tlet errorType = ErrorNameToType[o.name]\n\tlet e = (errorType != null ? new errorType(o.message) : new Error(o.message)) as any\n\te.name = o.name\n\te.stack = o.stack || e.stack\n\te.data = o.data\n\treturn e\n}\n"]}