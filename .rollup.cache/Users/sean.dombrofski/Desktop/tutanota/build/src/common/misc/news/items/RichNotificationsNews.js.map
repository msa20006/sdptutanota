{"version":3,"file":"RichNotificationsNews.js","sourceRoot":"","sources":["../../../../../../src/common/misc/news/items/RichNotificationsNews.ts"],"names":[],"mappings":"AAEA,OAAO,CAAe,MAAM,SAAS,CAAA;AAIrC,OAAO,EAAE,aAAa,EAAE,MAAM,uBAAuB,CAAA;AACrD,OAAO,EAAE,MAAM,EAAc,MAAM,6BAA6B,CAAA;AAChE,OAAO,EAAE,IAAI,EAAE,MAAM,4BAA4B,CAAA;AACjD,OAAO,EAAE,2BAA2B,EAAE,MAAM,8DAA8D,CAAA;AAC1G,OAAO,EAAE,KAAK,EAAE,MAAM,4BAA4B,CAAA;AAElD,MAAM,OAAO,qBAAqB;IAGJ;IAAuC;IAF5D,gBAAgB,GAAoC,IAAI,CAAA;IAEhE,YAA6B,SAAoB,EAAmB,OAAoC;QAA3E,cAAS,GAAT,SAAS,CAAW;QAAmB,YAAO,GAAP,OAAO,CAA6B;IAAG,CAAC;IAE5G,KAAK,CAAC,OAAO,CAAC,OAAe;QAC5B,OAAO,CACN,KAAK,EAAE;YACP,IAAI,CAAC,OAAO,IAAI,IAAI;YACpB,CAAC,IAAI,CAAC,gBAAgB,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,2BAA2B,EAAE,CAAC,uDAA6C,CACvH,CAAA;IACF,CAAC;IAED,MAAM,CAAC,MAAc;QACpB,sCAAsC;QACtC,MAAM,OAAO,GAAG,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;QAC3C,OAAO,CAAC,CAAC,aAAa,EAAE;YACvB,CAAC,CAAC,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,gBAAgB,EAAE,YAAY,EAAE,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;YAC5F,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;YACjD,CAAC,CACA,cAAc,EACd,CAAC,CAAC,2BAA2B,EAAE;gBAC9B,wBAAwB,EAAE,IAAI,CAAC,gBAAgB,wDAA8C;gBAC7F,QAAQ,EAAE,CAAC,IAAI,EAAE,EAAE;oBAClB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAA;oBAC5B,OAAO,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAA;gBAC1C,CAAC;aACD,CAAC,CACF;YACD,CAAC,CACA,WAAW,EACX,CAAC,CAAC,MAAM,EAAE;gBACT,KAAK,EAAE,WAAW;gBAClB,KAAK,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;gBACrC,IAAI,wCAAsB;aAC1B,CAAC,CACF;SACD,CAAC,CAAA;IACH,CAAC;IAEO,KAAK,CAAC,WAAW,CAAC,MAAc;QACvC,MAAM,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,MAAM,CAAC,UAAU,CAAC,CAAA;QACvD,CAAC,CAAC,MAAM,EAAE,CAAA;IACX,CAAC;CACD","sourcesContent":["import { NewsListItem } from \"../NewsListItem.js\"\nimport { NewsId } from \"../../../api/entities/tutanota/TypeRefs.js\"\nimport m, { Children } from \"mithril\"\nimport { NewsModel } from \"../NewsModel.js\"\nimport { NativePushServiceApp } from \"../../../native/main/NativePushServiceApp.js\"\nimport { ExtendedNotificationMode } from \"../../../native/common/generatedipc/ExtendedNotificationMode.js\"\nimport { assertNotNull } from \"@tutao/tutanota-utils\"\nimport { Button, ButtonType } from \"../../../gui/base/Button.js\"\nimport { lang } from \"../../LanguageViewModel.js\"\nimport { NotificationContentSelector } from \"../../../../mail-app/settings/NotificationContentSelector.js\"\nimport { isApp } from \"../../../api/common/Env.js\"\n\nexport class RichNotificationsNews implements NewsListItem {\n\tprivate notificationMode: ExtendedNotificationMode | null = null\n\n\tconstructor(private readonly newsModel: NewsModel, private readonly pushApp: NativePushServiceApp | null) {}\n\n\tasync isShown(_newsId: NewsId): Promise<boolean> {\n\t\treturn (\n\t\t\tisApp() &&\n\t\t\tthis.pushApp != null &&\n\t\t\t(this.notificationMode = await this.pushApp.getExtendedNotificationMode()) != ExtendedNotificationMode.SenderAndSubject\n\t\t)\n\t}\n\n\trender(newsId: NewsId): Children {\n\t\t// if we got here then we must have it\n\t\tconst pushApp = assertNotNull(this.pushApp)\n\t\treturn m(\".full-width\", [\n\t\t\tm(\".h4\", { style: { \"text-transform\": \"capitalize\" } }, lang.get(\"richNotifications_title\")),\n\t\t\tm(\"p\", lang.get(\"richNotificationsNewsItem_msg\")),\n\t\t\tm(\n\t\t\t\t\".max-width-s\",\n\t\t\t\tm(NotificationContentSelector, {\n\t\t\t\t\textendedNotificationMode: this.notificationMode ?? ExtendedNotificationMode.NoSenderOrSubject,\n\t\t\t\t\tonChange: (mode) => {\n\t\t\t\t\t\tthis.notificationMode = mode\n\t\t\t\t\t\tpushApp.setExtendedNotificationMode(mode)\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t),\n\t\t\tm(\n\t\t\t\t\".flex-end\",\n\t\t\t\tm(Button, {\n\t\t\t\t\tlabel: \"close_alt\",\n\t\t\t\t\tclick: () => this.acknowledge(newsId),\n\t\t\t\t\ttype: ButtonType.Secondary,\n\t\t\t\t}),\n\t\t\t),\n\t\t])\n\t}\n\n\tprivate async acknowledge(newsId: NewsId) {\n\t\tawait this.newsModel.acknowledgeNews(newsId.newsItemId)\n\t\tm.redraw()\n\t}\n}\n"]}