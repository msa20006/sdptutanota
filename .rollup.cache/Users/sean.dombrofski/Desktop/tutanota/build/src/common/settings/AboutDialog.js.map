{"version":3,"file":"AboutDialog.js","sourceRoot":"","sources":["../../../../src/common/settings/AboutDialog.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component, Vnode } from \"mithril\"\nimport { Button, ButtonType } from \"../gui/base/Button.js\"\nimport { getLightOrDarkTutaLogo } from \"../gui/theme.js\"\nimport { showUserError } from \"../misc/ErrorHandlerImpl.js\"\nimport { locator } from \"../api/main/CommonLocator.js\"\nimport { InfoLink } from \"../misc/LanguageViewModel.js\"\nimport { newMailEditorFromTemplate } from \"../../mail-app/mail/editor/MailEditor.js\"\nimport { UserError } from \"../api/main/UserError.js\"\nimport { clientInfoString, getLogAttachments } from \"../misc/ErrorReporter.js\"\nimport { ExternalLink } from \"../gui/base/ExternalLink.js\"\nimport { isApp } from \"../api/common/Env.js\"\nimport { px, size } from \"../gui/size.js\"\nimport { client } from \"../misc/ClientDetector.js\"\n\ninterface AboutDialogAttrs {\n\tonShowSetupWizard: () => unknown\n}\n\nexport class AboutDialog implements Component<AboutDialogAttrs> {\n\tview(vnode: Vnode<AboutDialogAttrs>): Children {\n\t\treturn m(\".flex.col\", [\n\t\t\tm(\".center.mt\", \"Powered by\"),\n\t\t\tm(\n\t\t\t\t\".center\",\n\t\t\t\t// Our logo must be padded but at least a certain amount.\n\t\t\t\t// This might be a bit more than needed but it's safe.\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tmargin: px(size.vpad_xl),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tm.trust(getLightOrDarkTutaLogo(client.isCalendarApp())),\n\t\t\t),\n\t\t\tm(\".flex.justify-center.flex-wrap\", [\n\t\t\t\tm(ExternalLink, {\n\t\t\t\t\thref: InfoLink.HomePage,\n\t\t\t\t\ttext: \"Website\",\n\t\t\t\t\tisCompanySite: true,\n\t\t\t\t\tspecialType: \"me\",\n\t\t\t\t\tclass: \"mlr mt\",\n\t\t\t\t}),\n\t\t\t\tm(ExternalLink, {\n\t\t\t\t\thref: \"https://github.com/tutao/tutanota/releases\",\n\t\t\t\t\ttext: \"Releases\",\n\t\t\t\t\tisCompanySite: false,\n\t\t\t\t\tclass: \"mlr mt\",\n\t\t\t\t}),\n\t\t\t]),\n\t\t\tm(\".flex.justify-center.selectable.flex-wrap\", [\n\t\t\t\tm(\"p.center.mt.mlr\", `v${env.versionNumber}`),\n\t\t\t\tm(\"p.text-center.mlr\", \"GPL-v3\"),\n\t\t\t\tm(\"p\", \"Â© 2024 Tutao GmbH\"),\n\t\t\t]),\n\t\t\tthis._sendLogsLink(),\n\t\t\t// wrap it in a div so that it's not filling the whole width\n\t\t\tisApp()\n\t\t\t\t? m(\n\t\t\t\t\t\t\"\",\n\t\t\t\t\t\tm(Button, {\n\t\t\t\t\t\t\tlabel: \"showWelcomeDialog_action\",\n\t\t\t\t\t\t\ttype: ButtonType.Primary,\n\t\t\t\t\t\t\tclick: vnode.attrs.onShowSetupWizard,\n\t\t\t\t\t\t}),\n\t\t\t\t  )\n\t\t\t\t: null,\n\t\t])\n\t}\n\n\t_sendLogsLink(): Children {\n\t\treturn m(\n\t\t\t\".mt\",\n\t\t\tm(Button, {\n\t\t\t\tlabel: \"sendLogs_action\",\n\t\t\t\tclick: () => this._sendDeviceLogs(),\n\t\t\t\ttype: ButtonType.Primary,\n\t\t\t}),\n\t\t)\n\t}\n\n\tasync _sendDeviceLogs(): Promise<void> {\n\t\tconst timestamp = new Date()\n\t\tconst attachments = await getLogAttachments(timestamp)\n\t\tconst mailboxDetails = await locator.mailboxModel.getUserMailboxDetails()\n\t\tlet { message, type, client } = clientInfoString(timestamp, true)\n\t\tmessage = message\n\t\t\t.split(\"\\n\")\n\t\t\t.filter(Boolean)\n\t\t\t.map((l) => `<div>${l}<br></div>`)\n\t\t\t.join(\"\")\n\n\t\ttry {\n\t\t\tconst editor = await newMailEditorFromTemplate(\n\t\t\t\tmailboxDetails,\n\t\t\t\t{},\n\t\t\t\t`Device logs v${env.versionNumber} - ${type} - ${client}`,\n\t\t\t\tmessage,\n\t\t\t\tattachments,\n\t\t\t\ttrue,\n\t\t\t)\n\t\t\teditor.show()\n\t\t} catch (e) {\n\t\t\tif (e instanceof UserError) {\n\t\t\t\tawait showUserError(e)\n\t\t\t} else {\n\t\t\t\tthrow e\n\t\t\t}\n\t\t}\n\t}\n}\n"]}