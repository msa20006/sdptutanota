{"version":3,"file":"Modal.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/Modal.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component } from \"mithril\"\nimport { alpha, AlphaEnum, animations } from \"./../animation/Animations\"\nimport { theme } from \"../theme\"\nimport type { Shortcut } from \"../../misc/KeyManager\"\nimport { keyManager } from \"../../misc/KeyManager\"\nimport { windowFacade } from \"../../misc/WindowFacade\"\nimport { insideRect, remove } from \"@tutao/tutanota-utils\"\nimport { LayerType } from \"../../../RootView\"\nimport { assertMainOrNodeBoot } from \"../../api/common/Env\"\n\nassertMainOrNodeBoot()\n\ntype ModalComponentWrapper = {\n\tkey: number\n\tcomponent: ModalComponent\n\tneedsBg: boolean\n}\n\nclass Modal implements Component {\n\tcomponents: Array<ModalComponentWrapper>\n\tprivate uniqueComponent: ModalComponent | null\n\tview: Component[\"view\"]\n\tvisible: boolean\n\tcurrentKey: number\n\tprivate closingComponents: Array<ModalComponent>\n\tprivate readonly historyEventListener = (e: Event) => this.popState(e)\n\n\tconstructor() {\n\t\tthis.currentKey = 0\n\t\tthis.components = []\n\t\tthis.visible = false\n\t\tthis.uniqueComponent = null\n\t\tthis.closingComponents = []\n\n\t\tthis.view = (): Children => {\n\t\t\treturn m(\n\t\t\t\t\"#modal.fill-absolute\",\n\t\t\t\t{\n\t\t\t\t\toncreate: (_) => {\n\t\t\t\t\t\t// const lastComponent = last(this.components)\n\t\t\t\t\t\t// if (lastComponent) {\n\t\t\t\t\t\t// \tlastComponent.component.backgroundClick(e)\n\t\t\t\t\t\t// }\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\"z-index\": LayerType.Modal,\n\t\t\t\t\t\tdisplay: this.visible ? \"\" : \"none\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.components.map((wrapper, i, array) => {\n\t\t\t\t\treturn m(\n\t\t\t\t\t\t\".fill-absolute\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkey: wrapper.key,\n\t\t\t\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\t\t\t\t// do not set visible=true already in display() because it leads to modal staying open in a second window in Chrome\n\t\t\t\t\t\t\t\t// because onbeforeremove is not called in that case to set visible=false. this is probably an optimization in Chrome to reduce\n\t\t\t\t\t\t\t\t// UI updates if the window is not visible. setting visible=true here is fine because this code is not even called then\n\t\t\t\t\t\t\t\tthis.visible = true\n\t\t\t\t\t\t\t\tm.redraw()\n\t\t\t\t\t\t\t\tif (wrapper.needsBg) this.addAnimation(vnode.dom as HTMLElement, true)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonclick: (event: MouseEvent) => {\n\t\t\t\t\t\t\t\tconst element = event.currentTarget as HTMLElement\n\t\t\t\t\t\t\t\t// This layer div has a single child, the modal component\n\t\t\t\t\t\t\t\tconst child = element.firstElementChild\n\n\t\t\t\t\t\t\t\t// child shouldn't be null but maybe the user click fast idk\n\t\t\t\t\t\t\t\tif (child) {\n\t\t\t\t\t\t\t\t\tconst childRect = child.getBoundingClientRect()\n\n\t\t\t\t\t\t\t\t\tif (!insideRect(event, childRect)) {\n\t\t\t\t\t\t\t\t\t\twrapper.component.backgroundClick(event)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tzIndex: LayerType.Modal + 1 + i,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonbeforeremove: (vnode) => {\n\t\t\t\t\t\t\t\tif (wrapper.needsBg) {\n\t\t\t\t\t\t\t\t\tthis.closingComponents.push(wrapper.component)\n\n\t\t\t\t\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\t\t\t\t\tthis.addAnimation(vnode.dom as HTMLElement, false).then(() => {\n\t\t\t\t\t\t\t\t\t\t\tremove(this.closingComponents, wrapper.component)\n\n\t\t\t\t\t\t\t\t\t\t\tif (this.components.length === 0 && this.closingComponents.length === 0) {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.visible = false\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\twrapper.component.hideAnimation(),\n\t\t\t\t\t\t\t\t\t]).then(() => {\n\t\t\t\t\t\t\t\t\t\tm.redraw()\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (this.components.length === 0 && this.closingComponents.length === 0) {\n\t\t\t\t\t\t\t\t\t\tthis.visible = false\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturn wrapper.component.hideAnimation().then(() => m.redraw())\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tm(wrapper.component),\n\t\t\t\t\t)\n\t\t\t\t}),\n\t\t\t)\n\t\t}\n\t}\n\n\tdisplay(component: ModalComponent, needsBg: boolean = true) {\n\t\t// move the handler to the top of the handler stack\n\t\twindowFacade.removeHistoryEventListener(this.historyEventListener)\n\t\twindowFacade.addHistoryEventListener(this.historyEventListener)\n\t\tif (this.components.length > 0) {\n\t\t\tkeyManager.unregisterModalShortcuts(this.components[this.components.length - 1].component.shortcuts())\n\t\t}\n\n\t\tconst existingIndex = this.components.findIndex((shownComponent) => shownComponent.component === component)\n\n\t\tif (existingIndex !== -1) {\n\t\t\tconsole.warn(\"Attempting to display the same modal component multiple times!\")\n\t\t\tthis.components.splice(existingIndex, 1)\n\t\t}\n\n\t\tthis.components.push({\n\t\t\tkey: this.currentKey++,\n\t\t\tcomponent: component,\n\t\t\tneedsBg,\n\t\t})\n\t\tm.redraw()\n\t\tkeyManager.registerModalShortcuts(component.shortcuts())\n\t}\n\n\t/**\n\t * notify components that a history state was popped. The Component Stack is notified from the top and the first\n\t * Component to return false will stop underlying components from receiving the notification.\n\t * Components that return true are expected to remove themselves from the Modal stack, eg dropdowns.\n\t * @param e: the DOM Event\n\t * @private\n\t */\n\tprivate popState(e: Event): boolean {\n\t\tconsole.log(\"modal popstate\")\n\t\tconst len = this.components.length\n\n\t\tif (len === 0) {\n\t\t\tconsole.log(\"no modals to close\")\n\t\t\treturn true\n\t\t}\n\n\t\t// get the keys because we're going to modify the component stack during iteration\n\t\tconst keys = this.components.map((c) => c.key)\n\n\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\tconst component = this.getComponentByKey(keys[i])\n\n\t\t\tif (!component) {\n\t\t\t\tconsole.log(\"component went AWOL, continuing\")\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (!component.popState(e)) {\n\t\t\t\tconsole.log(\"component handled popstate\")\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\treturn true\n\t}\n\n\t/**\n\t * used for modal components that should only be opened once\n\t * multiple calls will be ignored if the first component is still visible\n\t * @param component\n\t */\n\tdisplayUnique(component: ModalComponent, needsBg: boolean = true) {\n\t\tif (this.uniqueComponent) {\n\t\t\tconsole.log(\"tried to open unique component while another was open!\")\n\t\t\treturn\n\t\t}\n\n\t\tthis.display(component, needsBg)\n\t\tthis.uniqueComponent = component\n\t}\n\n\tprivate getComponentByKey(key: number): ModalComponent | null {\n\t\tconst entry = this.components.find((c) => c.key === key)\n\t\treturn entry?.component ?? null\n\t}\n\n\tremove(component: ModalComponent): void {\n\t\tconst componentIndex = this.components.findIndex((wrapper) => wrapper.component === component)\n\n\t\tif (componentIndex === -1) {\n\t\t\tconsole.log(\"can't remove non existing component from modal\")\n\t\t\treturn\n\t\t}\n\n\t\tconst componentIsTopmostComponent = componentIndex === this.components.length - 1\n\n\t\tif (componentIsTopmostComponent) {\n\t\t\tconsole.log(\"removed topmost modal component\")\n\t\t\tkeyManager.unregisterModalShortcuts(component.shortcuts())\n\t\t}\n\n\t\tthis.components.splice(componentIndex, 1)\n\n\t\tif (this.uniqueComponent === component) {\n\t\t\tthis.uniqueComponent = null\n\t\t}\n\n\t\tm.redraw()\n\n\t\tif (this.components.length > 0 && componentIsTopmostComponent) {\n\t\t\t// the removed component was the last component, so we can now register the shortcuts of the now last component\n\t\t\tkeyManager.registerModalShortcuts(this.components[this.components.length - 1].component.shortcuts())\n\t\t}\n\n\t\t// Return the focus back to it's calling element.\n\t\tcomponent.callingElement()?.focus()\n\t}\n\n\t/**\n\t * adds an animation to the topmost component\n\t */\n\taddAnimation(domLayer: HTMLElement, fadein: boolean): Promise<unknown> {\n\t\tconst start = 0\n\t\tconst end = 0.5\n\t\treturn animations.add(domLayer, alpha(AlphaEnum.BackgroundColor, theme.modal_bg, fadein ? start : end, fadein ? end : start))\n\t}\n}\n\nexport const modal: Modal = new Modal()\n\nexport interface ModalComponent extends Component {\n\thideAnimation(): Promise<void>\n\n\tonClose(): void\n\n\tshortcuts(): Shortcut[]\n\n\tbackgroundClick(e: MouseEvent): void\n\n\t/**\n\t * will be called by the main modal if no other component above this one blocked the event (previous components returned true)\n\t * return false if the event was handled and lower components shouldn't be notified, true otherwise\n\t * @param e\n\t */\n\tpopState(e: Event): boolean\n\n\t// The element that was interacted with to show the modal.\n\tcallingElement(): HTMLElement | null\n}\n"]}