{"version":3,"file":"SetupWizard.js","sourceRoot":"","sources":["../../../../../../src/common/native/main/wizard/SetupWizard.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAqB,iBAAiB,EAAE,MAAM,mCAAmC,CAAA;AAC5G,OAAO,EAAE,KAAK,EAAE,MAAM,uBAAuB,CAAA;AAC7C,OAAO,EAAE,wBAAwB,EAAE,6BAA6B,EAAE,MAAM,+CAA+C,CAAA;AAEvH,OAAO,EAAE,sBAAsB,EAAE,2BAA2B,EAAE,MAAM,8CAA8C,CAAA;AAElH,OAAO,EAAE,cAAc,EAAE,mBAAmB,EAAE,MAAM,sCAAsC,CAAA;AAC1F,OAAO,EAAE,iBAAiB,EAAE,sBAAsB,EAAE,MAAM,yCAAyC,CAAA;AACnG,OAAO,EAAE,aAAa,EAAE,kBAAkB,EAAE,MAAM,qCAAqC,CAAA;AAMvF,OAAO,EAAE,OAAO,EAAE,MAAM,oCAAoC,CAAA;AAI5D,MAAM,CAAC,KAAK,UAAU,eAAe,CACpC,uBAAgD,EAChD,eAAgC,EAChC,eAAuC,EACvC,YAAgC,EAChC,mBAAwC,EACxC,kBAAoD,EACpD,YAA0B,EAC1B,yBAAkC;IAElC,MAAM,gBAAgB,GAAG,MAAM,uBAAuB,CAAC,qBAAqB,CAAC;;;;KAI5E,CAAC,CAAA;IAEF,IAAI,WAAW,GAA6B,EAAE,CAAA;IAC9C,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,wBAAwB,EAAE,IAAI,6BAA6B,EAAE,CAAC,CAAC,CAAA;IAClG,WAAW,CAAC,IAAI,CACf,iBAAiB,CAChB,sBAAsB,EACtB,IAAI,2BAA2B,CAC9B;QACC,+BAA+B,EAAE,gBAAgB,CAAC,GAAG,uCAA6B,IAAI,KAAK;QAC3F,0BAA0B,EAAE,gBAAgB,CAAC,GAAG,oDAA0C,IAAI,KAAK;KACnG,EACD,eAAe,CAAC,eAAe,EAAE,EACjC,uBAAuB,CACvB,CACD,CACD,CAAA;IACD,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE,IAAI,mBAAmB,EAAE,CAAC,CAAC,CAAA;IAC9E,IAAI,yBAAyB,IAAI,kBAAkB,IAAI,eAAe,EAAE,CAAC;QACxE,WAAW,CAAC,IAAI,CACf,iBAAiB,CAAC,iBAAiB,EAAE,IAAI,sBAAsB,CAAC,kBAAkB,EAAE,eAAe,EAAE,YAAY,EAAE,yBAAyB,CAAC,CAAC,CAC9I,CAAA;IACF,CAAC;IACD,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,IAAI,kBAAkB,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,CAAA;IAEhG,MAAM,QAAQ,GAAG,KAAK,EAAQ,CAAA;IAE9B,MAAM,aAAa,GAAG,kBAAkB,CACvC,IAAI,EACJ,WAAW,EACX,KAAK,IAAI,EAAE;QACV,YAAY,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAA;QACrC,QAAQ,CAAC,OAAO,EAAE,CAAA;IACnB,CAAC,yCAED,CAAA;IAED,aAAa,CAAC,MAAM,CAAC,IAAI,EAAE,CAAA;IAC3B,OAAO,QAAQ,CAAC,OAAO,CAAA;AACxB,CAAC","sourcesContent":["import { createWizardDialog, WizardPageWrapper, wizardPageWrapper } from \"../../../gui/base/WizardDialog.js\"\nimport { defer } from \"@tutao/tutanota-utils\"\nimport { SetupCongratulationsPage, SetupCongratulationsPageAttrs } from \"./setupwizardpages/SetupCongraulationsPage.js\"\nimport { DeviceConfig } from \"../../../misc/DeviceConfig.js\"\nimport { SetupNotificationsPage, SetupNotificationsPageAttrs } from \"./setupwizardpages/SetupNotificationsPage.js\"\nimport { DialogType } from \"../../../gui/base/Dialog.js\"\nimport { SetupThemePage, SetupThemePageAttrs } from \"./setupwizardpages/SetupThemePage.js\"\nimport { SetupContactsPage, SetupContactsPageAttrs } from \"./setupwizardpages/SetupContactsPage.js\"\nimport { SetupLockPage, SetupLockPageAttrs } from \"./setupwizardpages/SetupLockPage.js\"\nimport { SystemPermissionHandler } from \"../SystemPermissionHandler.js\"\nimport { WebMobileFacade } from \"../WebMobileFacade.js\"\nimport { ContactImporter } from \"../../../../mail-app/contacts/ContactImporter.js\"\nimport { MobileSystemFacade } from \"../../common/generatedipc/MobileSystemFacade.js\"\nimport { NativeContactsSyncManager } from \"../../../../mail-app/contacts/model/NativeContactsSyncManager.js\"\nimport { locator } from \"../../../api/main/CommonLocator.js\"\nimport { PermissionType } from \"../../common/generatedipc/PermissionType.js\"\nimport { CredentialsProvider } from \"../../../misc/credentials/CredentialsProvider.js\"\n\nexport async function showSetupWizard(\n\tsystemPermissionHandler: SystemPermissionHandler,\n\twebMobileFacade: WebMobileFacade,\n\tcontactImporter: ContactImporter | null,\n\tsystemFacade: MobileSystemFacade,\n\tcredentialsProvider: CredentialsProvider,\n\tcontactSyncManager: NativeContactsSyncManager | null,\n\tdeviceConfig: DeviceConfig,\n\tallowContactSyncAndImport: boolean,\n): Promise<void> {\n\tconst permissionStatus = await systemPermissionHandler.queryPermissionsState([\n\t\tPermissionType.Contacts,\n\t\tPermissionType.Notification,\n\t\tPermissionType.IgnoreBatteryOptimization,\n\t])\n\n\tlet wizardPages: WizardPageWrapper<any>[] = []\n\twizardPages.push(wizardPageWrapper(SetupCongratulationsPage, new SetupCongratulationsPageAttrs()))\n\twizardPages.push(\n\t\twizardPageWrapper(\n\t\t\tSetupNotificationsPage,\n\t\t\tnew SetupNotificationsPageAttrs(\n\t\t\t\t{\n\t\t\t\t\tisNotificationPermissionGranted: permissionStatus.get(PermissionType.Notification) ?? false,\n\t\t\t\t\tisBatteryPermissionGranted: permissionStatus.get(PermissionType.IgnoreBatteryOptimization) ?? false,\n\t\t\t\t},\n\t\t\t\twebMobileFacade.getIsAppVisible(),\n\t\t\t\tsystemPermissionHandler,\n\t\t\t),\n\t\t),\n\t)\n\twizardPages.push(wizardPageWrapper(SetupThemePage, new SetupThemePageAttrs()))\n\tif (allowContactSyncAndImport && contactSyncManager && contactImporter) {\n\t\twizardPages.push(\n\t\t\twizardPageWrapper(SetupContactsPage, new SetupContactsPageAttrs(contactSyncManager, contactImporter, systemFacade, allowContactSyncAndImport)),\n\t\t)\n\t}\n\twizardPages.push(wizardPageWrapper(SetupLockPage, new SetupLockPageAttrs(locator.systemFacade)))\n\n\tconst deferred = defer<void>()\n\n\tconst wizardBuilder = createWizardDialog(\n\t\tnull,\n\t\twizardPages,\n\t\tasync () => {\n\t\t\tdeviceConfig.setIsSetupComplete(true)\n\t\t\tdeferred.resolve()\n\t\t},\n\t\tDialogType.EditSmall,\n\t)\n\n\twizardBuilder.dialog.show()\n\treturn deferred.promise\n}\n"]}