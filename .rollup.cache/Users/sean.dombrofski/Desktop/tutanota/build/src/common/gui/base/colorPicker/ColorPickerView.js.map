{"version":3,"file":"ColorPickerView.js","sourceRoot":"","sources":["../../../../../../src/common/gui/base/colorPicker/ColorPickerView.ts"],"names":[],"mappings":"AAAA,OAAO,CAAiC,MAAM,SAAS,CAAA;AACvD,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,eAAe,CAAA;AACxC,OAAO,EAAE,cAAc,EAAE,aAAa,EAAE,MAAM,gBAAgB,CAAA;AAC9D,OAAO,EAAE,SAAS,EAAE,MAAM,iBAAiB,CAAA;AAC3C,OAAO,EAAE,IAAI,EAAE,MAAM,oCAAoC,CAAA;AACzD,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,YAAY,EAAE,kBAAkB,EAAE,aAAa,EAAE,iBAAiB,EAAE,MAAM,aAAa,CAAA;AACpH,OAAO,EAAE,gBAAgB,EAAE,MAAM,uBAAuB,CAAA;AACxD,OAAO,EAAE,MAAM,EAAE,MAAM,iCAAiC,CAAA;AACxD,OAAO,EAAE,KAAK,EAAE,MAAM,gBAAgB,CAAA;AACtC,OAAO,EAAE,aAAa,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,uBAAuB,CAAA;AACvE,OAAO,EAAE,IAAI,EAAY,MAAM,uCAAuC,CAAA;AACtE,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAA;AAEvD,MAAM,yBAAyB,GAAG,CAAC,CAAA;AACnC,MAAM,mBAAmB,GAAG,EAAE,CAAA;AAkB9B,MAAM,OAAO,eAAe;IACV,OAAO,GAAG,KAAK,CAAgB,gBAAgB,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;IACxE,KAAK,GAAqB,IAAI,gBAAgB,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAA;IACxF,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,aAAa,CAAC,CAAA;IAC5D,oBAAoB,uCAAsC;IAC1D,UAAU,GAAG,KAAK,CAAA;IAClB,cAAc,GAAG,EAAE,CAAA;IAEnB,YAAY,GAAuB,IAAI,CAAA;IACvC,SAAS,GAAuB,IAAI,CAAA;IACpC,YAAY,GAAuB,IAAI,CAAA;IACvC,YAAY,GAAuB,IAAI,CAAA;IAE/C,YAAY,KAAkC;QAC7C,MAAM,EAAE,KAAK,EAAE,aAAa,EAAE,QAAQ,EAAE,GAAG,KAAK,CAAC,KAAK,CAAA;QAEtD,IAAI,aAAa,EAAE,CAAC;YACnB,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,CAAA;YAC3C,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;YAEzD,8FAA8F;YAC9F,IAAI,CAAC,gBAAgB,GAAG,YAAY,IAAI,IAAI,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAA;YACzH,IAAI,CAAC,eAAe,EAAE,CAAA;YACtB,IAAI,CAAC,cAAc,GAAG,aAAa,CAAA;YACnC,IAAI,YAAY,IAAI,IAAI,EAAE,CAAC;gBAC1B,IAAI,CAAC,oBAAoB,GAAG,YAAY,CAAA;YACzC,CAAC;YAED,IAAI,CAAC,UAAU,GAAG,YAAY,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,aAAa,CAAA;QACvF,CAAC;aAAM,CAAC;YACP,IAAI,CAAC,eAAe,EAAE,CAAA;YACtB,MAAM,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC,OAAO,qCAA6B,EAAE,kCAAkC,CAAC,CAAA;YACjH,IAAI,CAAC,cAAc,GAAG,YAAY,CAAA;YAClC,QAAQ,CAAC,YAAY,CAAC,CAAA;QACvB,CAAC;IACF,CAAC;IAED,IAAI,CAAC,KAAkC;QACtC,MAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAA;QAEzB,OAAO,CAAC,CAAC,eAAe,EAAE;YACzB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,QAAQ,CAAC;YACpC,CAAC,CACA,6DAA6D,EAC7D;gBACC,KAAK,EAAE;oBACN,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC;oBACxB,SAAS,EAAE,EAAE,CAAC,EAAE,CAAC;iBACjB;aACD,EACD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAC7B,IAAI,CAAC,iBAAiB,CAAC;gBACtB,KAAK,EAAE,aAAa,CAAC,KAAK,EAAE,iBAAiB,CAAC,gBAAgB,CAAC;gBAC/D,KAAK,EAAE,CAAC;gBACR,aAAa,EAAE,KAAK,CAAC,KAAK;gBAC1B,QAAQ,EAAE,KAAK,CAAC,QAAQ;gBACxB,0CAA0C;gBAC1C,SAAS,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,CAAC,SAAS;gBAC3D,KAAK,EACJ,CAAC,KAAK,CAAC;oBACN,CAAC,CAAC;wBACA,WAAW,EAAE,aAAa,KAAK,CAAC,cAAc,EAAE;qBAC/C;oBACH,CAAC,CAAC,SAAS;aACb,CAAC,CACF,CACD;YACD,CAAC,CAAC,EAAE,EAAE;gBACL,CAAC,CAAC,cAAc,EAAE;oBACjB,KAAK,EAAE,gBAAgB;oBACvB,QAAQ,EAAE,IAAI,CAAC,UAAU;oBACzB,gBAAgB,EAAE,CAAC,QAAQ,EAAE,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,QAAQ,EAAE,KAAK,CAAC;oBAC5E,KAAK,EAAE;wBACN,UAAU,EAAE,MAAM;qBAClB;iBACD,CAAC;gBACF,CAAC,CACA,aAAa,EACb;oBACC,QAAQ,EAAE,IAAI,CAAC,UAAU;iBACzB,EACD,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,CACtC;aACD,CAAC;SACF,CAAC,CAAA;IACH,CAAC;IAEO,sBAAsB,CAAC,QAAiB,EAAE,KAA2B;QAC5E,IAAI,QAAQ,IAAI,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC;YACzD,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;QACpC,CAAC;aAAM,CAAC;YACP,IAAI,YAAY,GAAuB,SAAS,CAAA;YAChD,IAAI,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC;gBAC7C,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAA;gBAC9C,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;YACpD,CAAC;YAED,MAAM,aAAa,GAAG,aAAa,CAClC,IAAI,CAAC,OAAO,CAAC,YAAY,IAAI,IAAI,CAAC,oBAAoB,CAAC,EACvD,yBAAyB,YAAY,OAAO,IAAI,CAAC,oBAAoB,GAAG,CACxE,CAAA;YACD,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAA;QAC9B,CAAC;QACD,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAA;IAC3B,CAAC;IAEO,0BAA0B,CAAC,KAA2B;QAC7D,OAAO,CAAC,CAAC,mDAAmD,EAAE;YAC7D,CAAC,CAAC,EAAE,EAAE;gBACL,CAAC,CAAC,SAAS,EAAE;oBACZ,KAAK,EAAE,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC;oBAC3C,KAAK,EAAE,eAAe;oBACtB,OAAO,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC,EAAE,KAAK,CAAC;iBACnD,CAAC;gBACF,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;aAC3F,CAAC;YACF,IAAI,CAAC,iBAAiB,CAAC;gBACtB,KAAK,EAAE,IAAI,CAAC,cAAc;gBAC1B,KAAK,qCAA4B;gBACjC,aAAa,EAAE,KAAK,CAAC,KAAK;gBAC1B,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;oBACnB,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAA;oBACxF,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;gBACtB,CAAC;gBACD,SAAS,EAAE,OAAO;aAClB,CAAC;SACF,CAAC,CAAA;IACH,CAAC;IAEO,oBAAoB,CAAC,UAAkB,EAAE,KAA2B;QAC3E,MAAM,QAAQ,GAAG,UAAU,CAAC,IAAI,EAAE,CAAC,UAAU,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;QAClE,MAAM,OAAO,GAAG,GAAG,GAAG,QAAQ,CAAA;QAC9B,IAAI,CAAC,cAAc,GAAG,OAAO,CAAA;QAE7B,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,EAAE,CAAC;YAClC,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,EAAE,wBAAwB,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAA;YAC3H,OAAM;QACP,CAAC;QAED,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAA;QACrC,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;QAEzD,IAAI,YAAY,IAAI,IAAI,EAAE,CAAC;YAC1B,IAAI,CAAC,oBAAoB,GAAG,YAAY,CAAA;QACzC,CAAC;QAED,IAAI,CAAC,gBAAgB,GAAG,YAAY,IAAI,IAAI,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAA;QACzH,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAA;QACxF,IAAI,CAAC,eAAe,EAAE,CAAA;QACtB,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAA;IACxB,CAAC;IAEO,iBAAiB,CAAC,KAOzB;QACA,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,aAAa,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,KAAK,CAAA;QAE/D,MAAM,gBAAgB,GAAG,KAAK,KAAK,aAAa,CAAA;QAChD,IAAI,YAAY,GAAG,IAAI,CAAA;QACvB,IAAI,KAAK,wCAA+B,EAAE,CAAC;YAC1C,YAAY,GAAG,kBAAkB,CAAC,KAAK,CAAC,CAAA;QACzC,CAAC;QAED,MAAM,eAAe,GAAG,GAAG,EAAE;YAC5B,IAAI,CAAC,YAAY,EAAE,CAAC;gBACnB,OAAM;YACP,CAAC;YAED,IAAI,KAAK,wCAA+B,IAAI,YAAY,EAAE,CAAC;gBAC1D,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAA;gBACnC,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;gBAEzD,IAAI,CAAC,gBAAgB,GAAG,YAAY,IAAI,IAAI,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAA;gBACzH,IAAI,CAAC,eAAe,EAAE,CAAA;YACvB,CAAC;iBAAM,CAAC;gBACP,IAAI,CAAC,oBAAoB,GAAG,KAAK,CAAA;gBACjC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAA;YAC5B,CAAC;YAED,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;QACtB,CAAC,CAAA;QAED,OAAO,CAAC,CACP,gBAAgB,SAAS,IAAI,EAAE,EAAE,EACjC;YACC,SAAS,EAAE,gBAAgB,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;YAC7C,KAAK;SACL,EACD,CAAC,CACA,kBAAkB,EAClB;YACC,KAAK,EAAE;gBACN,OAAO,EAAE,KAAK;gBACd,WAAW,EAAE,KAAK;gBAClB,WAAW,EAAE,OAAO;gBACpB,WAAW,EAAE,gBAAgB,CAAC,CAAC,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAAC,aAAa;aAC7E;SACD,EACD,CAAC,CAAC,gBAAgB,EAAE;YACnB,QAAQ,4BAAkB;YAC1B,IAAI,EAAE,OAAO;YACb,SAAS,EAAE,KAAK,wCAA+B,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,KAAK,EAAE;YACzH,WAAW,EAAE,gBAAgB;YAC7B,KAAK,EAAE;gBACN,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC;gBACb,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;gBACd,WAAW,EAAE,KAAK;gBAClB,WAAW,EAAE,OAAO;gBACpB,WAAW,EAAE,gBAAgB,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,CAAC,cAAc;gBACpE,eAAe,EAAE,YAAY,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,cAAc;aAC5D;YACD,SAAS,EAAE,CAAC,CAAgB,EAAE,EAAE;gBAC/B,IAAI,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;oBACrC,CAAC,CAAC,cAAc,EAAE,CAAA;oBAClB,eAAe,EAAE,CAAA;gBAClB,CAAC;YACF,CAAC;YACD,OAAO,EAAE,eAAe;SACxB,CAAC,CACF,CACD,CAAA;IACF,CAAC;IAEO,eAAe,CAAC,QAA0C;QACjE,MAAM,gBAAgB,GAAG,CAAC,CAAA;QAE1B,OAAO,CAAC,CACP,sBAAsB,EACtB;YACC,KAAK,EAAE;gBACN,QAAQ,EAAE,UAAU;aACpB;YACD,SAAS,EAAE,CAAC,CAAgB,EAAE,EAAE;gBAC/B,CAAC,CAAC,cAAc,EAAE,CAAA;gBAClB,MAAM,WAAW,GAAG,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;gBACnD,MAAM,UAAU,GAAG,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,CAAA;gBACjD,MAAM,OAAO,GAAG,UAAU,IAAI,WAAW,CAAA;gBAEzC,IAAI,CAAC,OAAO,IAAI,CAAC,WAAW,IAAI,UAAU,CAAC,EAAE,CAAC;oBAC7C,iDAAiD;oBACjD,MAAM,IAAI,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAA;oBAC9C,IAAI,OAAO,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAA;oBACvC,IAAI,CAAC,gBAAgB,GAAG,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,GAAG,OAAO,CAAC,CAAA;oBAE1E,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAA;oBACxF,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAA;oBAC1B,IAAI,CAAC,eAAe,EAAE,CAAA;oBAEtB,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC;wBAClE,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,EAAE,wBAAwB,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAA;oBACtH,CAAC;gBACF,CAAC;YACF,CAAC;YACD,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC;YAC1C,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;gBACnB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,GAAkB,CAAA;YAC7C,CAAC;SACD,EACD;YACC,wEAAwE;YACxE,CAAC,CAAC,8BAA8B,EAAE;gBACjC,IAAI,EAAE,OAAO;gBACb,GAAG,EAAE,CAAC;gBACN,GAAG,EAAE,aAAa;gBAClB,IAAI,EAAE,gBAAgB;gBACtB,QAAQ,4BAAkB;gBAC1B,IAAI,EAAE,QAAQ;gBACd,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;gBAChC,KAAK,EAAE;oBACN,OAAO,EAAE,CAAC;iBACV;gBACD,KAAK,EAAE,GAAG,IAAI,CAAC,gBAAgB,EAAE;gBACjC,OAAO,EAAE,CAAC,CAAa,EAAE,EAAE;oBAC1B,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAE,CAAC,CAAC,MAA2B,CAAC,KAAK,CAAC,CAAA;oBAEvE,IAAI,CAAC,kBAAkB,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAA;oBACxF,IAAI,CAAC,eAAe,EAAE,CAAA;oBACtB,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC;wBAClE,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,EAAE,wBAAwB,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAA;oBACtH,CAAC;gBACF,CAAC;aACD,CAAC;YACF,cAAc;YACd,CAAC,CACA,2CAA2C,EAC3C;gBACC,KAAK,EAAE;oBACN,WAAW,EAAE,OAAO;oBACpB,WAAW,EAAE,KAAK,CAAC,cAAc;oBACjC,eAAe,EAAE,KAAK,CAAC,cAAc;oBACrC,WAAW,EAAE,EAAE,CAAC,yBAAyB,CAAC;oBAC1C,MAAM,EAAE,EAAE,CAAC,mBAAmB,CAAC;iBAC/B;aACD,EACD,CAAC,CAAC,sBAAsB,EAAE;gBACzB,GAAG,EAAE,GAAG,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,iBAAiB,yCAC9C,CAAC,YAAY,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,OAC5C,MAAM;gBACN,GAAG,EAAE,EAAE;gBACP,SAAS,EAAE,KAAK;gBAChB,KAAK,EAAE;oBACN,MAAM,EAAE,EAAE,CAAC,mBAAmB,CAAC;iBAC/B;gBACD,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;oBACnB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,GAAkB,CAAA;gBAC1C,CAAC;gBACD,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;oBACnB,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;wBAChE,yFAAyF;wBACzF,MAAM,SAAS,GAAG,KAAK,CAAC,GAAkB,CAAA;wBAC1C,IAAI,CAAC,kBAAkB,CAAC,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,CAAA;oBACtD,CAAC;gBACF,CAAC;gBACD,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,eAAe,CAAC,EAAE,CAAC,CAA4B,EAAE,EAAE;oBAChG,MAAM,eAAe,GAAG,IAAI,eAAe,EAAE,CAAA;oBAC7C,MAAM,SAAS,GAAG,CAAC,CAAC,MAAqB,CAAA;oBAEzC,SAAS,CAAC,gBAAgB,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,aAAa,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,EAAE,SAAS,CAAC,EAAE;wBAC9H,MAAM,EAAE,eAAe,CAAC,MAAM;qBAC9B,CAAC,CAAA;oBAEF,MAAM,WAAW,GAAG,GAAG,EAAE;wBACxB,eAAe,CAAC,KAAK,EAAE,CAAA;wBACvB,IAAI,CAAC,eAAe,EAAE,CAAA;wBACtB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAA;wBAE3B,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC;4BAClE,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,EAAE,wBAAwB,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAA;wBACtH,CAAC;wBACD,CAAC,CAAC,MAAM,EAAE,CAAA;oBACX,CAAC,CAAA;oBAED,SAAS,CAAC,gBAAgB,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,eAAe,EAAE,WAAW,EAAE;wBACpG,MAAM,EAAE,eAAe,CAAC,MAAM;qBAC9B,CAAC,CAAA;oBACF,QAAQ,CAAC,gBAAgB,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,WAAW,EAAE,WAAW,EAAE,EAAE,MAAM,EAAE,eAAe,CAAC,MAAM,EAAE,CAAC,CAAA;oBAEhI,IAAI,CAAC,eAAe,CAAC,CAAC,EAAE,SAAS,CAAC,CAAA;oBAClC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAA;gBAC3B,CAAC;aACD,CAAC,CACF;YACD,YAAY;YACZ,CAAC,CACA,MAAM,EACN;gBACC,KAAK,EAAE;oBACN,KAAK,EAAE,KAAK;oBACZ,MAAM,EAAE,EAAE,CAAC,yBAAyB,CAAC;iBACrC;gBACD,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;oBACnB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,GAAkB,CAAA;gBAC7C,CAAC;aACD,EACD;gBACC,YAAY;gBACZ,CAAC,CAAC,gBAAgB,EAAE;oBACnB,KAAK,EAAE;wBACN,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC;wBACb,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC;wBACd,SAAS,EAAE,kBAAkB;wBAC7B,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,KAAK,CAAC,cAAc;qBAC5F;oBACD,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;wBACnB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,GAAkB,CAAA;oBAC7C,CAAC;iBACD,CAAC;gBACF,UAAU;gBACV,CAAC,CAAC,EAAE,EAAE;oBACL,KAAK,EAAE;wBACN,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC;wBACZ,MAAM,EAAE,EAAE,CAAC,mBAAmB,CAAC;wBAC/B,SAAS,EAAE,kBAAkB;wBAC7B,eAAe,EAAE,KAAK,CAAC,cAAc;qBACrC;iBACD,CAAC;aACF,CACD;SACD,CACD,CAAA;IACF,CAAC;IAEO,eAAe,CAAC,IAAa;QACpC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAA;IAC9E,CAAC;IAEO,kBAAkB,CAAC,SAAsB,EAAE,YAAyB;QAC3E,MAAM,gBAAgB,GAAG,SAAS,CAAC,qBAAqB,EAAE,CAAC,KAAK,CAAA;QAChE,YAAY,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,gBAAgB,GAAG,aAAa,CAAC,GAAG,gBAAgB,CAAC,GAAG,yBAAyB,IAAI,CAAA;QACnI,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;IAC7G,CAAC;IAEO,eAAe,GAAG,CAAC,CAA4B,EAAE,SAAsB,EAAE,EAAE;QAClF,MAAM,aAAa,GAAG,SAAS,CAAC,qBAAqB,EAAE,CAAA;QACvD,MAAM,QAAQ,GAAG,SAAS,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAA;QAClE,MAAM,IAAI,GAAG,KAAK,CAAC,QAAQ,GAAG,aAAa,CAAC,IAAI,GAAG,yBAAyB,EAAE,yBAAyB,EAAE,aAAa,CAAC,KAAK,CAAC,CAAA;QAC7H,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,aAAa,CAAC,KAAK,CAAC,GAAG,aAAa,CAAC,CAAA;QAEhF,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACvB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,IAAI,IAAI,CAAA;QAC3C,CAAC;QACD,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACvB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA;QAC9F,CAAC;IACF,CAAC,CAAA;IAEO,eAAe;QACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,CAAC,YAAY,EAAE,CAAC,EAAE,EAAE,CAAC;YACxD,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC,CAAA;QAC1E,CAAC;IACF,CAAC;CACD","sourcesContent":["import m, { Children, Component, Vnode } from \"mithril\"\nimport { px, size } from \"../../size.js\"\nimport { ExpanderButton, ExpanderPanel } from \"../Expander.js\"\nimport { TextField } from \"../TextField.js\"\nimport { lang } from \"../../../misc/LanguageViewModel.js\"\nimport { hexToHSL, hslToHex, isColorLight, isValidCSSHexColor, MAX_HUE_ANGLE, normalizeHueAngle } from \"../Color.js\"\nimport { ColorPickerModel } from \"./ColorPickerModel.js\"\nimport { client } from \"../../../misc/ClientDetector.js\"\nimport { theme } from \"../../theme.js\"\nimport { assertNotNull, clamp, filterInt } from \"@tutao/tutanota-utils\"\nimport { Keys, TabIndex } from \"../../../api/common/TutanotaConstants\"\nimport { isKeyPressed } from \"../../../misc/KeyManager\"\n\nconst HUE_GRADIENT_BORDER_WIDTH = 1\nconst HUE_GRADIENT_HEIGHT = 40\n\nconst enum PaletteIndex {\n\tdefaultVariant = 2,\n\tcustomVariant = -1,\n}\n\nexport type ColorPickerViewAttrs = {\n\t/**\n\t * Initial value can be empty, a random color will be generated by the ColorPicker\n\t * */\n\tvalue: string\n\t/**\n\t * Called whenever the selected color changes\n\t */\n\tonselect: (color: string) => void\n}\n\nexport class ColorPickerView implements Component<ColorPickerViewAttrs> {\n\tprivate readonly palette = Array<string | null>(ColorPickerModel.PALETTE_SIZE).fill(null)\n\tprivate readonly model: ColorPickerModel = new ColorPickerModel(!isColorLight(theme.content_bg))\n\tprivate selectedHueAngle = Math.floor(Math.random() * MAX_HUE_ANGLE)\n\tprivate fallbackVariantIndex: number = PaletteIndex.defaultVariant\n\tprivate isAdvanced = false\n\tprivate customColorHex = \"\"\n\n\tprivate huePickerDom: HTMLElement | null = null\n\tprivate hueImgDom: HTMLElement | null = null\n\tprivate hueSliderDom: HTMLElement | null = null\n\tprivate hueWindowDom: HTMLElement | null = null\n\n\tconstructor(vnode: Vnode<ColorPickerViewAttrs>) {\n\t\tconst { value: selectedColor, onselect } = vnode.attrs\n\n\t\tif (selectedColor) {\n\t\t\tconst { h, s, l } = hexToHSL(selectedColor)\n\t\t\tconst variantIndex = this.model.getVariantIndexBySL(s, l)\n\n\t\t\t// in case of palette color, selectedHueAngle is the one that was used to generate the palette\n\t\t\tthis.selectedHueAngle = variantIndex != null ? normalizeHueAngle(h - this.model.paletteSchema.hueShift[variantIndex]) : h\n\t\t\tthis.generatePalette()\n\t\t\tthis.customColorHex = selectedColor\n\t\t\tif (variantIndex != null) {\n\t\t\t\tthis.fallbackVariantIndex = variantIndex\n\t\t\t}\n\n\t\t\tthis.isAdvanced = variantIndex == null || this.palette[variantIndex] !== selectedColor\n\t\t} else {\n\t\t\tthis.generatePalette()\n\t\t\tconst defaultColor = assertNotNull(this.palette[PaletteIndex.defaultVariant], \"no default palette color variant\")\n\t\t\tthis.customColorHex = defaultColor\n\t\t\tonselect(defaultColor)\n\t\t}\n\t}\n\n\tview(vnode: Vnode<ColorPickerViewAttrs>): Children {\n\t\tconst attrs = vnode.attrs\n\n\t\treturn m(\".color-picker\", [\n\t\t\tthis.renderHuePicker(attrs.onselect),\n\t\t\tm(\n\t\t\t\t\".flex.wrap.full-width.items-center.justify-between.p0.plr-s\",\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\trowGap: px(size.vpad_xs),\n\t\t\t\t\t\tmarginTop: px(12),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.palette.map((color, i) =>\n\t\t\t\t\tthis.renderColorOption({\n\t\t\t\t\t\tcolor: assertNotNull(color, `palette color ${i} not generated`),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tselectedColor: attrs.value,\n\t\t\t\t\t\tonselect: attrs.onselect,\n\t\t\t\t\t\t// add right divider to first color option\n\t\t\t\t\t\tclassName: i === 0 ? \".pr-vpad-s.mr-hpad-small\" : undefined,\n\t\t\t\t\t\tstyle:\n\t\t\t\t\t\t\ti === 0\n\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\tborderRight: `2px solid ${theme.content_border}`,\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t),\n\t\t\tm(\"\", [\n\t\t\t\tm(ExpanderButton, {\n\t\t\t\t\tlabel: \"advanced_label\",\n\t\t\t\t\texpanded: this.isAdvanced,\n\t\t\t\t\tonExpandedChange: (expanded) => this.handleOnExpandedChange(expanded, attrs),\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tmarginLeft: \"auto\",\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tm(\n\t\t\t\t\tExpanderPanel,\n\t\t\t\t\t{\n\t\t\t\t\t\texpanded: this.isAdvanced,\n\t\t\t\t\t},\n\t\t\t\t\tthis.renderCustomColorContainer(attrs),\n\t\t\t\t),\n\t\t\t]),\n\t\t])\n\t}\n\n\tprivate handleOnExpandedChange(expanded: boolean, attrs: ColorPickerViewAttrs) {\n\t\tif (expanded && isValidCSSHexColor(this.customColorHex)) {\n\t\t\tattrs.onselect(this.customColorHex)\n\t\t} else {\n\t\t\tlet variantIndex: number | undefined = undefined\n\t\t\tif (isValidCSSHexColor(this.customColorHex)) {\n\t\t\t\tconst { s, l } = hexToHSL(this.customColorHex)\n\t\t\t\tvariantIndex = this.model.getVariantIndexBySL(s, l)\n\t\t\t}\n\n\t\t\tconst fallbackColor = assertNotNull(\n\t\t\t\tthis.palette[variantIndex ?? this.fallbackVariantIndex],\n\t\t\t\t`no fallback color at [${variantIndex} ?? ${this.fallbackVariantIndex}]`,\n\t\t\t)\n\t\t\tattrs.onselect(fallbackColor)\n\t\t}\n\t\tthis.isAdvanced = expanded\n\t}\n\n\tprivate renderCustomColorContainer(attrs: ColorPickerViewAttrs) {\n\t\treturn m(\".custom-color-container.flex.items-start.gap-hpad\", [\n\t\t\tm(\"\", [\n\t\t\t\tm(TextField, {\n\t\t\t\t\tvalue: this.customColorHex.replace(\"#\", \"\"),\n\t\t\t\t\tlabel: \"hexCode_label\",\n\t\t\t\t\toninput: (v) => this.handleCustomHexInput(v, attrs),\n\t\t\t\t}),\n\t\t\t\t!isValidCSSHexColor(this.customColorHex) && m(\".small\", lang.get(\"invalidInputFormat_msg\")),\n\t\t\t]),\n\t\t\tthis.renderColorOption({\n\t\t\t\tcolor: this.customColorHex,\n\t\t\t\tindex: PaletteIndex.customVariant,\n\t\t\t\tselectedColor: attrs.value,\n\t\t\t\tonselect: (color) => {\n\t\t\t\t\tthis.postionSliderOnHue(assertNotNull(this.hueImgDom), assertNotNull(this.hueSliderDom))\n\t\t\t\t\tattrs.onselect(color)\n\t\t\t\t},\n\t\t\t\tclassName: \".mt-m\",\n\t\t\t}),\n\t\t])\n\t}\n\n\tprivate handleCustomHexInput(inputValue: string, attrs: ColorPickerViewAttrs) {\n\t\tconst newValue = inputValue.trim().replaceAll(\"#\", \"\").slice(0, 6)\n\t\tconst hexCode = \"#\" + newValue\n\t\tthis.customColorHex = hexCode\n\n\t\tif (!isValidCSSHexColor(hexCode)) {\n\t\t\tattrs.onselect(assertNotNull(this.palette[this.fallbackVariantIndex], `no fallback color at ${this.fallbackVariantIndex}`))\n\t\t\treturn\n\t\t}\n\n\t\tconst { h, s, l } = hexToHSL(hexCode)\n\t\tconst variantIndex = this.model.getVariantIndexBySL(s, l)\n\n\t\tif (variantIndex != null) {\n\t\t\tthis.fallbackVariantIndex = variantIndex\n\t\t}\n\n\t\tthis.selectedHueAngle = variantIndex != null ? normalizeHueAngle(h - this.model.paletteSchema.hueShift[variantIndex]) : h\n\t\tthis.postionSliderOnHue(assertNotNull(this.hueImgDom), assertNotNull(this.hueSliderDom))\n\t\tthis.generatePalette()\n\t\tattrs.onselect(hexCode)\n\t}\n\n\tprivate renderColorOption(attrs: {\n\t\tcolor: string\n\t\tindex: number\n\t\tselectedColor: ColorPickerViewAttrs[\"value\"]\n\t\tonselect: ColorPickerViewAttrs[\"onselect\"]\n\t\tclassName?: string\n\t\tstyle?: Record<string, string>\n\t}): Children {\n\t\tconst { color, index, selectedColor, className, style } = attrs\n\n\t\tconst isOptionSelected = color === selectedColor\n\t\tlet isColorValid = true\n\t\tif (index === PaletteIndex.customVariant) {\n\t\t\tisColorValid = isValidCSSHexColor(color)\n\t\t}\n\n\t\tconst handleSelection = () => {\n\t\t\tif (!isColorValid) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (index === PaletteIndex.customVariant && isColorValid) {\n\t\t\t\tconst { h, s, l } = hexToHSL(color)\n\t\t\t\tconst variantIndex = this.model.getVariantIndexBySL(s, l)\n\n\t\t\t\tthis.selectedHueAngle = variantIndex != null ? normalizeHueAngle(h - this.model.paletteSchema.hueShift[variantIndex]) : h\n\t\t\t\tthis.generatePalette()\n\t\t\t} else {\n\t\t\t\tthis.fallbackVariantIndex = index\n\t\t\t\tthis.customColorHex = color\n\t\t\t}\n\n\t\t\tattrs.onselect(color)\n\t\t}\n\n\t\treturn m(\n\t\t\t`.color-option${className ?? \"\"}`,\n\t\t\t{\n\t\t\t\tclassName: isOptionSelected ? \"selected\" : \"\",\n\t\t\t\tstyle,\n\t\t\t},\n\t\t\tm(\n\t\t\t\t\".border-radius-m\",\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tpadding: \"1px\",\n\t\t\t\t\t\tborderWidth: \"2px\",\n\t\t\t\t\t\tborderStyle: \"solid\",\n\t\t\t\t\t\tborderColor: isOptionSelected ? theme.content_button_selected : \"transparent\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tm(\".border-radius\", {\n\t\t\t\t\ttabIndex: TabIndex.Default,\n\t\t\t\t\trole: \"radio\",\n\t\t\t\t\tariaLabel: index === PaletteIndex.customVariant ? lang.get(\"customColor_label\") : `${lang.get(\"variant_label\")} ${index}`,\n\t\t\t\t\tariaChecked: isOptionSelected,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth: px(30),\n\t\t\t\t\t\theight: px(30),\n\t\t\t\t\t\tborderWidth: \"1px\",\n\t\t\t\t\t\tborderStyle: \"solid\",\n\t\t\t\t\t\tborderColor: isOptionSelected ? \"transparent\" : theme.content_border,\n\t\t\t\t\t\tbackgroundColor: isColorValid ? color : theme.content_border,\n\t\t\t\t\t},\n\t\t\t\t\tonkeydown: (e: KeyboardEvent) => {\n\t\t\t\t\t\tif (isKeyPressed(e.key, Keys.SPACE)) {\n\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t\thandleSelection()\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonclick: handleSelection,\n\t\t\t\t}),\n\t\t\t),\n\t\t)\n\t}\n\n\tprivate renderHuePicker(onselect: ColorPickerViewAttrs[\"onselect\"]): Children {\n\t\tconst a11yHueShiftStep = 5\n\n\t\treturn m(\n\t\t\t\".rel.overflow-hidden\",\n\t\t\t{\n\t\t\t\tstyle: {\n\t\t\t\t\tposition: \"relative\",\n\t\t\t\t},\n\t\t\t\tonkeydown: (e: KeyboardEvent) => {\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\tconst isRightMove = isKeyPressed(e.key, Keys.RIGHT)\n\t\t\t\t\tconst isLeftMove = isKeyPressed(e.key, Keys.LEFT)\n\t\t\t\t\tconst isStill = isLeftMove && isRightMove\n\n\t\t\t\t\tif (!isStill && (isRightMove || isLeftMove)) {\n\t\t\t\t\t\t// holding down shift allows finer hue adjustment\n\t\t\t\t\t\tconst step = e.shiftKey ? 1 : a11yHueShiftStep\n\t\t\t\t\t\tlet hueStep = isLeftMove ? -step : step\n\t\t\t\t\t\tthis.selectedHueAngle = normalizeHueAngle(this.selectedHueAngle + hueStep)\n\n\t\t\t\t\t\tthis.postionSliderOnHue(assertNotNull(this.hueImgDom), assertNotNull(this.hueSliderDom))\n\t\t\t\t\t\tthis.toggleHueWindow(true)\n\t\t\t\t\t\tthis.generatePalette()\n\n\t\t\t\t\t\tif (!this.isAdvanced || !isValidCSSHexColor(this.customColorHex)) {\n\t\t\t\t\t\t\tonselect(assertNotNull(this.palette[this.fallbackVariantIndex], `no fallback color at ${this.fallbackVariantIndex}`))\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonkeyup: () => this.toggleHueWindow(false),\n\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\tthis.huePickerDom = vnode.dom as HTMLElement\n\t\t\t\t},\n\t\t\t},\n\t\t\t[\n\t\t\t\t// range input used to allow hue to be easily changed on a screen reader\n\t\t\t\tm(\"input.fill-absolute.no-hover\", {\n\t\t\t\t\ttype: \"range\",\n\t\t\t\t\tmin: 0,\n\t\t\t\t\tmax: MAX_HUE_ANGLE,\n\t\t\t\t\tstep: a11yHueShiftStep,\n\t\t\t\t\ttabIndex: TabIndex.Default,\n\t\t\t\t\trole: \"slider\",\n\t\t\t\t\tariaLabel: lang.get(\"hue_label\"),\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t},\n\t\t\t\t\tvalue: `${this.selectedHueAngle}`,\n\t\t\t\t\toninput: (e: InputEvent) => {\n\t\t\t\t\t\tthis.selectedHueAngle = filterInt((e.target as HTMLInputElement).value)\n\n\t\t\t\t\t\tthis.postionSliderOnHue(assertNotNull(this.hueImgDom), assertNotNull(this.hueSliderDom))\n\t\t\t\t\t\tthis.generatePalette()\n\t\t\t\t\t\tif (!this.isAdvanced || !isValidCSSHexColor(this.customColorHex)) {\n\t\t\t\t\t\t\tonselect(assertNotNull(this.palette[this.fallbackVariantIndex], `no fallback color at ${this.fallbackVariantIndex}`))\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\t// hueGradient\n\t\t\t\tm(\n\t\t\t\t\t\".full-width.border-radius.overflow-hidden\",\n\t\t\t\t\t{\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tborderStyle: \"solid\",\n\t\t\t\t\t\t\tborderColor: theme.content_border,\n\t\t\t\t\t\t\tbackgroundColor: theme.content_border,\n\t\t\t\t\t\t\tborderWidth: px(HUE_GRADIENT_BORDER_WIDTH),\n\t\t\t\t\t\t\theight: px(HUE_GRADIENT_HEIGHT),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tm(\"img.block.full-width\", {\n\t\t\t\t\t\tsrc: `${window.tutao.appState.prefixWithoutFile}/images/color-hue-picker/hue-gradient-${\n\t\t\t\t\t\t\t!isColorLight(theme.content_bg) ? \"dark\" : \"light\"\n\t\t\t\t\t\t}.png`,\n\t\t\t\t\t\talt: \"\",\n\t\t\t\t\t\tdraggable: false,\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\theight: px(HUE_GRADIENT_HEIGHT),\n\t\t\t\t\t\t},\n\t\t\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\t\t\tthis.hueImgDom = vnode.dom as HTMLElement\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonupdate: (vnode) => {\n\t\t\t\t\t\t\tif (this.hueSliderDom != null && !this.hueSliderDom.style.left) {\n\t\t\t\t\t\t\t\t// sets the position of the hueSlider on first render. to do it we need hueImgDom's width\n\t\t\t\t\t\t\t\tconst hueImgDom = vnode.dom as HTMLElement\n\t\t\t\t\t\t\t\tthis.postionSliderOnHue(hueImgDom, this.hueSliderDom)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t[client.isTouchSupported() ? \"ontouchstart\" : \"onpointerdown\"]: (e: PointerEvent | TouchEvent) => {\n\t\t\t\t\t\t\tconst abortController = new AbortController()\n\t\t\t\t\t\t\tconst hueImgDom = e.target as HTMLElement\n\n\t\t\t\t\t\t\thueImgDom.addEventListener(client.isTouchSupported() ? \"touchmove\" : \"pointermove\", (e) => this.handleHueChange(e, hueImgDom), {\n\t\t\t\t\t\t\t\tsignal: abortController.signal,\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\tconst endListener = () => {\n\t\t\t\t\t\t\t\tabortController.abort()\n\t\t\t\t\t\t\t\tthis.generatePalette()\n\t\t\t\t\t\t\t\tthis.toggleHueWindow(false)\n\n\t\t\t\t\t\t\t\tif (!this.isAdvanced || !isValidCSSHexColor(this.customColorHex)) {\n\t\t\t\t\t\t\t\t\tonselect(assertNotNull(this.palette[this.fallbackVariantIndex], `no fallback color at ${this.fallbackVariantIndex}`))\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tm.redraw()\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\thueImgDom.addEventListener(client.isTouchSupported() ? \"touchcancel\" : \"pointercancel\", endListener, {\n\t\t\t\t\t\t\t\tsignal: abortController.signal,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tdocument.addEventListener(client.isTouchSupported() ? \"touchend\" : \"pointerup\", endListener, { signal: abortController.signal })\n\n\t\t\t\t\t\t\tthis.handleHueChange(e, hueImgDom)\n\t\t\t\t\t\t\tthis.toggleHueWindow(true)\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t\t// hueSlider\n\t\t\t\tm(\n\t\t\t\t\t\".abs\",\n\t\t\t\t\t{\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\twidth: \"0px\",\n\t\t\t\t\t\t\tbottom: px(HUE_GRADIENT_BORDER_WIDTH),\n\t\t\t\t\t\t},\n\t\t\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\t\t\tthis.hueSliderDom = vnode.dom as HTMLElement\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t[\n\t\t\t\t\t\t// hueWindow\n\t\t\t\t\t\tm(\".border.circle\", {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\twidth: px(24),\n\t\t\t\t\t\t\t\theight: px(24),\n\t\t\t\t\t\t\t\ttransform: \"translateX(-50%)\",\n\t\t\t\t\t\t\t\tbackgroundColor: this.model.getHueWindowColor(this.selectedHueAngle) ?? theme.content_border,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\toncreate: (vnode) => {\n\t\t\t\t\t\t\t\tthis.hueWindowDom = vnode.dom as HTMLElement\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t// hueStem\n\t\t\t\t\t\tm(\"\", {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\twidth: px(2),\n\t\t\t\t\t\t\t\theight: px(HUE_GRADIENT_HEIGHT),\n\t\t\t\t\t\t\t\ttransform: \"translateX(-50%)\",\n\t\t\t\t\t\t\t\tbackgroundColor: theme.content_border,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t),\n\t\t\t],\n\t\t)\n\t}\n\n\tprivate toggleHueWindow(show: boolean) {\n\t\tassertNotNull(this.huePickerDom).style.overflow = show ? \"visible\" : \"hidden\"\n\t}\n\n\tprivate postionSliderOnHue(hueImgDom: HTMLElement, hueSliderDom: HTMLElement) {\n\t\tconst hueGradientWidth = hueImgDom.getBoundingClientRect().width\n\t\thueSliderDom.style.left = `${Math.floor((this.selectedHueAngle / MAX_HUE_ANGLE) * hueGradientWidth) + HUE_GRADIENT_BORDER_WIDTH}px`\n\t\tassertNotNull(this.hueWindowDom).style.backgroundColor = this.model.getHueWindowColor(this.selectedHueAngle)\n\t}\n\n\tprivate handleHueChange = (e: PointerEvent | TouchEvent, hueImgDom: HTMLElement) => {\n\t\tconst hueImgDomRect = hueImgDom.getBoundingClientRect()\n\t\tconst eClientX = \"clientX\" in e ? e.clientX : e.touches[0].clientX\n\t\tconst posX = clamp(eClientX - hueImgDomRect.left + HUE_GRADIENT_BORDER_WIDTH, HUE_GRADIENT_BORDER_WIDTH, hueImgDomRect.width)\n\t\tthis.selectedHueAngle = Math.floor((posX / hueImgDomRect.width) * MAX_HUE_ANGLE)\n\n\t\tif (this.hueSliderDom) {\n\t\t\tthis.hueSliderDom.style.left = `${posX}px`\n\t\t}\n\t\tif (this.hueWindowDom) {\n\t\t\tthis.hueWindowDom.style.backgroundColor = this.model.getHueWindowColor(this.selectedHueAngle)\n\t\t}\n\t}\n\n\tprivate generatePalette() {\n\t\tfor (let i = 0; i < ColorPickerModel.PALETTE_SIZE; i++) {\n\t\t\tthis.palette[i] = hslToHex(this.model.getColor(this.selectedHueAngle, i))\n\t\t}\n\t}\n}\n"]}