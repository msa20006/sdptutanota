{"version":3,"file":"DrawerMenu.js","sourceRoot":"","sources":["../../../../../src/common/gui/nav/DrawerMenu.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component, Vnode } from \"mithril\"\nimport { ButtonColor } from \"../base/Button.js\"\nimport { BootIcons } from \"../base/icons/BootIcons\"\nimport { showSupportDialog, showUpgradeDialog } from \"./NavFunctions\"\nimport { isIOSApp } from \"../../api/common/Env\"\nimport { LogoutUrl, SETTINGS_PREFIX } from \"../../misc/RouteChange\"\nimport { getSafeAreaInsetLeft } from \"../HtmlUtils\"\nimport { Icons } from \"../base/icons/Icons\"\nimport { AriaLandmarks, landmarkAttrs } from \"../AriaUtils\"\nimport { createDropdown } from \"../base/Dropdown.js\"\nimport { keyManager } from \"../../misc/KeyManager\"\nimport { CounterBadge } from \"../base/CounterBadge.js\"\nimport { px, size } from \"../size.js\"\nimport { theme } from \"../theme.js\"\nimport { showNewsDialog } from \"../../misc/news/NewsDialog.js\"\nimport { LoginController } from \"../../api/main/LoginController.js\"\nimport { NewsModel } from \"../../misc/news/NewsModel.js\"\nimport { DesktopSystemFacade } from \"../../native/common/generatedipc/DesktopSystemFacade.js\"\nimport { styles } from \"../styles.js\"\nimport { IconButton } from \"../base/IconButton.js\"\n\nexport interface DrawerMenuAttrs {\n\tlogins: LoginController\n\tnewsModel: NewsModel\n\tdesktopSystemFacade: DesktopSystemFacade | null\n}\n\nexport class DrawerMenu implements Component<DrawerMenuAttrs> {\n\tview(vnode: Vnode<DrawerMenuAttrs>): Children {\n\t\tconst { logins, newsModel, desktopSystemFacade } = vnode.attrs\n\t\tconst liveNewsCount = newsModel.liveNewsIds.length\n\n\t\tconst isInternalUser = logins.isInternalUserLoggedIn()\n\t\tconst isLoggedIn = logins.isUserLoggedIn()\n\t\tconst userController = logins.getUserController()\n\n\t\treturn m(\n\t\t\t\"drawer-menu.flex.col.items-center.pt.pb\",\n\t\t\t{\n\t\t\t\t...landmarkAttrs(AriaLandmarks.Contentinfo, \"drawer menu\"),\n\t\t\t\tstyle: {\n\t\t\t\t\t\"padding-left\": getSafeAreaInsetLeft(),\n\t\t\t\t\t\"border-top-right-radius\": styles.isDesktopLayout() ? px(size.border_radius_larger) : \"\",\n\t\t\t\t},\n\t\t\t},\n\t\t\t[\n\t\t\t\tm(\".flex-grow\"),\n\t\t\t\tisInternalUser && isLoggedIn\n\t\t\t\t\t? m(\".news-button\", [\n\t\t\t\t\t\t\tm(IconButton, {\n\t\t\t\t\t\t\t\ticon: Icons.Bulb,\n\t\t\t\t\t\t\t\ttitle: \"news_label\",\n\t\t\t\t\t\t\t\tclick: () => showNewsDialog(newsModel),\n\t\t\t\t\t\t\t\tcolors: ButtonColor.DrawerNav,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tliveNewsCount > 0\n\t\t\t\t\t\t\t\t? m(CounterBadge, {\n\t\t\t\t\t\t\t\t\t\tcount: liveNewsCount,\n\t\t\t\t\t\t\t\t\t\tposition: {\n\t\t\t\t\t\t\t\t\t\t\ttop: px(0),\n\t\t\t\t\t\t\t\t\t\t\tright: px(3),\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tcolor: \"white\",\n\t\t\t\t\t\t\t\t\t\tbackground: theme.list_accent_fg,\n\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t  ])\n\t\t\t\t\t: null,\n\t\t\t\tlogins.isGlobalAdminUserLoggedIn() && userController.isPaidAccount()\n\t\t\t\t\t? m(IconButton, {\n\t\t\t\t\t\t\ticon: Icons.Gift,\n\t\t\t\t\t\t\ttitle: \"buyGiftCard_label\",\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tm.route.set(\"/settings/subscription\")\n\t\t\t\t\t\t\t\timport(\"../../subscription/giftcards/PurchaseGiftCardDialog\").then(({ showPurchaseGiftCardDialog }) => {\n\t\t\t\t\t\t\t\t\treturn showPurchaseGiftCardDialog()\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcolors: ButtonColor.DrawerNav,\n\t\t\t\t\t  })\n\t\t\t\t\t: null,\n\t\t\t\tdesktopSystemFacade\n\t\t\t\t\t? m(IconButton, {\n\t\t\t\t\t\t\ticon: Icons.NewWindow,\n\t\t\t\t\t\t\ttitle: \"openNewWindow_action\",\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tdesktopSystemFacade.openNewWindow()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcolors: ButtonColor.DrawerNav,\n\t\t\t\t\t  })\n\t\t\t\t\t: null,\n\t\t\t\t!isIOSApp() && isLoggedIn && userController.isFreeAccount()\n\t\t\t\t\t? m(IconButton, {\n\t\t\t\t\t\t\ticon: BootIcons.Premium,\n\t\t\t\t\t\t\ttitle: \"upgradePremium_label\",\n\t\t\t\t\t\t\tclick: () => showUpgradeDialog(),\n\t\t\t\t\t\t\tcolors: ButtonColor.DrawerNav,\n\t\t\t\t\t  })\n\t\t\t\t\t: null,\n\t\t\t\tm(IconButton, {\n\t\t\t\t\ttitle: \"showHelp_action\",\n\t\t\t\t\ticon: BootIcons.Help,\n\t\t\t\t\tclick: (e, dom) =>\n\t\t\t\t\t\tcreateDropdown({\n\t\t\t\t\t\t\twidth: 300,\n\t\t\t\t\t\t\tlazyButtons: () => [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ticon: Icons.SpeechBubbleFill,\n\t\t\t\t\t\t\t\t\tlabel: \"supportMenu_label\",\n\t\t\t\t\t\t\t\t\tclick: () => showSupportDialog(logins),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ticon: Icons.KeyboardFill,\n\t\t\t\t\t\t\t\t\tlabel: \"keyboardShortcuts_title\",\n\t\t\t\t\t\t\t\t\tclick: () => keyManager.openF1Help(true),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t})(e, dom),\n\t\t\t\t\tcolors: ButtonColor.DrawerNav,\n\t\t\t\t}),\n\t\t\t\tisInternalUser\n\t\t\t\t\t? m(IconButton, {\n\t\t\t\t\t\t\ticon: BootIcons.Settings,\n\t\t\t\t\t\t\ttitle: \"settings_label\",\n\t\t\t\t\t\t\tclick: () => m.route.set(SETTINGS_PREFIX),\n\t\t\t\t\t\t\tcolors: ButtonColor.DrawerNav,\n\t\t\t\t\t  })\n\t\t\t\t\t: null,\n\t\t\t\tm(IconButton, {\n\t\t\t\t\ticon: BootIcons.Logout,\n\t\t\t\t\ttitle: \"switchAccount_action\",\n\t\t\t\t\tclick: () => m.route.set(LogoutUrl),\n\t\t\t\t\tcolors: ButtonColor.DrawerNav,\n\t\t\t\t}),\n\t\t\t],\n\t\t)\n\t}\n}\n"]}