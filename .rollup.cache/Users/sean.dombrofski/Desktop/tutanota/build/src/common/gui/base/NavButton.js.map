{"version":3,"file":"NavButton.js","sourceRoot":"","sources":["../../../../../src/common/gui/base/NavButton.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component, RouteLinkAttrs, Vnode } from \"mithril\"\nimport { handleUncaughtError } from \"../../misc/ErrorHandler\"\nimport { px, size } from \"../size\"\nimport type { lazy } from \"@tutao/tutanota-utils\"\nimport { lazyStringValue, neverNull } from \"@tutao/tutanota-utils\"\nimport type { lazyIcon } from \"./Icon\"\nimport { Icon } from \"./Icon\"\nimport { theme } from \"../theme\"\nimport { styles } from \"../styles\"\nimport type { MaybeTranslation } from \"../../misc/LanguageViewModel\"\nimport { lang } from \"../../misc/LanguageViewModel\"\nimport { Keys } from \"../../api/common/TutanotaConstants\"\nimport { isKeyPressed } from \"../../misc/KeyManager\"\nimport { DropData, DropHandler, DropType } from \"./GuiUtils\"\nimport { assertMainOrNode, isDesktop } from \"../../api/common/Env\"\nimport { stateBgHover } from \"../builtinThemes.js\"\nimport { fileListToArray } from \"../../api/common/utils/FileUtils.js\"\n\nassertMainOrNode()\nexport type NavButtonAttrs = {\n\tlabel: MaybeTranslation\n\ticon?: lazyIcon\n\thref: string | lazy<string>\n\tisSelectedPrefix?: string | boolean\n\tclick?: (event: Event, dom: HTMLElement) => unknown\n\tcolors?: NavButtonColor\n\tdropHandler?: DropHandler\n\thideLabel?: boolean\n\tvertical?: boolean\n\tfontSize?: number\n\tsmall?: boolean\n\tcentred?: boolean\n\tleftInjection?: () => Children\n\tdisableHoverBackground?: boolean\n\tdisabled?: boolean\n\tpersistentBackground?: boolean\n\tonfocus?: () => unknown\n\tonblur?: () => unknown\n\tonkeydown?: (event: KeyboardEvent) => unknown\n\tfillSpaceAround?: boolean\n}\n\nexport class NavButton implements Component<NavButtonAttrs> {\n\tprivate _domButton!: HTMLElement\n\tprivate _draggedOver: boolean\n\tprivate _dropCounter: number // we also get drag enter/leave events from subelements, so we need to count to know when the drag leaves this button\n\n\tconstructor() {\n\t\tthis._draggedOver = false\n\t\tthis._dropCounter = 0\n\t}\n\n\tview(vnode: Vnode<NavButtonAttrs>): Children {\n\t\tconst a = vnode.attrs\n\n\t\tconst linkAttrs = this.createButtonAttributes(a)\n\t\tconst icon = a.icon?.()\n\t\tconst children = [\n\t\t\ta.leftInjection?.() ?? null,\n\t\t\ticon\n\t\t\t\t? m(Icon, {\n\t\t\t\t\t\ticon,\n\t\t\t\t\t\tclass: this._getIconClass(a),\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tfill: isNavButtonSelected(a) || this._draggedOver ? getColors(a.colors).button_selected : getColors(a.colors).button,\n\t\t\t\t\t\t},\n\t\t\t\t  })\n\t\t\t\t: null,\n\t\t\t!a.hideLabel ? m(\"span.label.click.text-ellipsis\" + (!a.vertical && icon ? \".pl-m\" : \"\"), lang.getTranslationText(a.label)) : null,\n\t\t]\n\n\t\t// allow nav button without label for registration button on mobile devices\n\t\tif (this._isExternalUrl(a.href)) {\n\t\t\treturn m(this._getNavButtonClass(a), linkAttrs, children)\n\t\t} else {\n\t\t\treturn m(m.route.Link, linkAttrs, children)\n\t\t}\n\t}\n\n\t_getUrl(href: string | lazy<string>): string {\n\t\treturn lazyStringValue(href)\n\t}\n\n\t_getNavButtonClass(a: NavButtonAttrs): string {\n\t\treturn (\n\t\t\t\"a.nav-button.noselect.items-center.click.plr-button.no-text-decoration.button-height.border-radius\" +\n\t\t\t(a.vertical ? \".col\" : \"\") +\n\t\t\t(!a.centred ? \".flex-start\" : \".flex-center\") +\n\t\t\t(a.disableHoverBackground ? \"\" : \".state-bg\") +\n\t\t\t(a.disabled ? \".no-hover\" : \"\") +\n\t\t\t(a.fillSpaceAround ?? true ? \".flex-no-shrink\" : \"\")\n\t\t)\n\t}\n\n\t_getIconClass(a: NavButtonAttrs): string {\n\t\tconst isSelected = isNavButtonSelected(a)\n\n\t\tif (a.colors === NavButtonColor.Header && !styles.isDesktopLayout()) {\n\t\t\treturn \"flex-end items-center icon-xl\" + (isSelected ? \" selected\" : \"\")\n\t\t} else if (a.small === true) {\n\t\t\treturn \"flex-center items-center icon\" + (isSelected ? \" selected\" : \"\")\n\t\t} else {\n\t\t\treturn \"flex-center items-center icon-large\" + (isSelected ? \" selected\" : \"\")\n\t\t}\n\t}\n\n\t_isExternalUrl(href: string | lazy<string>): boolean {\n\t\tlet url = this._getUrl(href)\n\n\t\treturn url != null ? url.indexOf(\"http\") === 0 : false\n\t}\n\n\tcreateButtonAttributes(a: NavButtonAttrs): RouteLinkAttrs {\n\t\tlet attr: RouteLinkAttrs = {\n\t\t\trole: \"button\",\n\t\t\t// role button for screen readers\n\t\t\thref: this._getUrl(a.href),\n\t\t\tstyle: {\n\t\t\t\tcolor: isNavButtonSelected(a) || this._draggedOver ? getColors(a.colors).button_selected : getColors(a.colors).button,\n\t\t\t\t\"font-size\": a.fontSize ? px(a.fontSize) : \"\",\n\t\t\t\tbackground: (isNavButtonSelected(a) && a.persistentBackground) || this._draggedOver ? stateBgHover : \"\",\n\t\t\t},\n\t\t\ttitle: lang.getTranslationText(a.label),\n\t\t\ttarget: this._isExternalUrl(a.href) ? \"_blank\" : undefined,\n\t\t\tselector: this._getNavButtonClass(a),\n\t\t\tonclick: (e: MouseEvent) => this.click(e, a, e.target as HTMLElement),\n\t\t\tonkeyup: (e: KeyboardEvent, dom: HTMLElement) => {\n\t\t\t\tif (isKeyPressed(e.key, Keys.SPACE)) {\n\t\t\t\t\tthis.click(e, a, dom)\n\t\t\t\t}\n\t\t\t},\n\t\t\tonfocus: a.onfocus,\n\t\t\tonblur: a.onblur,\n\t\t\tonkeydown: a.onkeydown,\n\t\t\t\"data-testid\": `btn:${lang.getTestId(a.label)}`,\n\t\t}\n\n\t\tif (a.dropHandler) {\n\t\t\tattr.ondragenter = (ev: DragEvent) => {\n\t\t\t\tthis._dropCounter++\n\t\t\t\tthis._draggedOver = true\n\t\t\t\tev.preventDefault()\n\t\t\t}\n\n\t\t\tattr.ondragleave = (ev: DragEvent) => {\n\t\t\t\tthis._dropCounter--\n\n\t\t\t\tif (this._dropCounter === 0) {\n\t\t\t\t\tthis._draggedOver = false\n\t\t\t\t}\n\n\t\t\t\tev.preventDefault()\n\t\t\t}\n\n\t\t\tattr.ondragover = (ev: DragEvent) => {\n\t\t\t\t// needed to allow dropping\n\t\t\t\tev.preventDefault()\n\t\t\t}\n\n\t\t\tattr.ondrop = (ev: DragEvent) => {\n\t\t\t\tthis._dropCounter = 0\n\t\t\t\tthis._draggedOver = false\n\t\t\t\tev.preventDefault()\n\t\t\t\tev.stopPropagation()\n\n\t\t\t\tif (ev.dataTransfer?.getData(DropType.Mail)) {\n\t\t\t\t\tlet dropData: DropData = {\n\t\t\t\t\t\tdropType: DropType.Mail,\n\t\t\t\t\t\tmailId: ev.dataTransfer.getData(DropType.Mail),\n\t\t\t\t\t}\n\t\t\t\t\tneverNull(a.dropHandler)(dropData)\n\t\t\t\t} else if (isDesktop() && ev.dataTransfer?.files && ev.dataTransfer.files.length > 0) {\n\t\t\t\t\tneverNull(a.dropHandler)({\n\t\t\t\t\t\tdropType: DropType.ExternalFile,\n\t\t\t\t\t\tfiles: fileListToArray(ev.dataTransfer.files),\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(\"received onDrop DragEvent has invalid DropType or is unsupported on this platform!\")\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn attr\n\t}\n\n\tclick(event: Event, a: NavButtonAttrs, dom: HTMLElement) {\n\t\tif (!this._isExternalUrl(a.href)) {\n\t\t\tm.route.set(this._getUrl(a.href))\n\n\t\t\ttry {\n\t\t\t\tif (a.click != null) {\n\t\t\t\t\ta.click(event, dom)\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault()\n\t\t\t} catch (e) {\n\t\t\t\thandleUncaughtError(e)\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHeight(): number {\n\t\treturn size.button_height\n\t}\n}\n\nexport const enum NavButtonColor {\n\tHeader = \"header\",\n\tNav = \"nav\",\n\tContent = \"content\",\n}\n\nfunction getColors(buttonColors: NavButtonColor | null | undefined) {\n\tswitch (buttonColors) {\n\t\tcase NavButtonColor.Header:\n\t\t\treturn {\n\t\t\t\tbutton: styles.isDesktopLayout() ? theme.header_button : theme.content_accent,\n\t\t\t\tbutton_selected: styles.isDesktopLayout() ? theme.header_button_selected : theme.content_accent,\n\t\t\t}\n\n\t\tcase NavButtonColor.Nav:\n\t\t\treturn {\n\t\t\t\tbutton: theme.navigation_button,\n\t\t\t\tbutton_selected: theme.navigation_button_selected,\n\t\t\t}\n\n\t\tdefault:\n\t\t\t// for nav buttons in the more dropdown menu\n\t\t\treturn {\n\t\t\t\tbutton: theme.content_button,\n\t\t\t\tbutton_selected: theme.content_button_selected,\n\t\t\t}\n\t}\n}\n\nexport function isNavButtonSelected(a: NavButtonAttrs): boolean {\n\tif (typeof a.isSelectedPrefix === \"boolean\") {\n\t\treturn a.isSelectedPrefix\n\t}\n\n\tconst selectedPrefix = a.isSelectedPrefix || lazyStringValue(a.href)\n\treturn isSelectedPrefix(selectedPrefix)\n}\n\nexport function isSelectedPrefix(href: string): boolean {\n\tconst current = m.route.get()\n\t// don't just check current.indexOf(buttonHref) because other buttons may also start with this href\n\treturn href !== \"\" && (current === href || current.indexOf(href + \"/\") === 0 || current.indexOf(href + \"?\") === 0)\n}\n"]}