{"version":3,"file":"CalendarSearchView.js","sourceRoot":"","sources":["../../../../../../src/calendar-app/calendar/search/view/CalendarSearchView.ts"],"names":[],"mappings":"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","sourcesContent":["import { TopLevelAttrs, TopLevelView } from \"../../../../TopLevelView.js\"\nimport { AppHeaderAttrs, Header } from \"../../../../common/gui/Header.js\"\nimport { CalendarSearchViewModel, PaidFunctionResult } from \"./CalendarSearchViewModel.js\"\nimport { BaseTopLevelView } from \"../../../../common/gui/BaseTopLevelView.js\"\nimport { ColumnType, ViewColumn } from \"../../../../common/gui/base/ViewColumn.js\"\nimport { ViewSlider } from \"../../../../common/gui/nav/ViewSlider.js\"\nimport { CalendarEvent, Contact } from \"../../../../common/api/entities/tutanota/TypeRefs.js\"\nimport { assertNotNull, last, LazyLoaded, lazyMemoized, memoized, noOp, stringToBase64 } from \"@tutao/tutanota-utils\"\nimport { CalendarEventPreviewViewModel } from \"../../gui/eventpopup/CalendarEventPreviewViewModel.js\"\nimport m, { Children, Vnode } from \"mithril\"\nimport { SidebarSection } from \"../../../../common/gui/SidebarSection.js\"\nimport { NavButton } from \"../../../../common/gui/base/NavButton.js\"\nimport { BootIcons } from \"../../../../common/gui/base/icons/BootIcons.js\"\nimport { px, size } from \"../../../../common/gui/size.js\"\nimport { lang, type MaybeTranslation } from \"../../../../common/misc/LanguageViewModel.js\"\nimport { BackgroundColumnLayout } from \"../../../../common/gui/BackgroundColumnLayout.js\"\nimport { theme } from \"../../../../common/gui/theme.js\"\nimport { DesktopListToolbar, DesktopViewerToolbar } from \"../../../../common/gui/DesktopToolbars.js\"\nimport { CalendarSearchListView, CalendarSearchListViewAttrs } from \"./CalendarSearchListView.js\"\nimport { isSameId } from \"../../../../common/api/common/utils/EntityUtils.js\"\nimport { keyManager, Shortcut } from \"../../../../common/misc/KeyManager.js\"\nimport { styles } from \"../../../../common/gui/styles.js\"\nimport { BaseMobileHeader } from \"../../../../common/gui/BaseMobileHeader.js\"\nimport { MobileHeader } from \"../../../../common/gui/MobileHeader.js\"\nimport { searchBar } from \"../CalendarSearchBar.js\"\nimport { ProgressBar } from \"../../../../common/gui/base/ProgressBar.js\"\nimport ColumnEmptyMessageBox from \"../../../../common/gui/base/ColumnEmptyMessageBox.js\"\nimport {\n\tEventDetailsView,\n\tEventDetailsViewAttrs,\n\thandleEventDeleteButtonClick,\n\thandleEventEditButtonClick,\n\thandleSendUpdatesClick,\n} from \"../../view/EventDetailsView.js\"\nimport { Icons } from \"../../../../common/gui/base/icons/Icons.js\"\nimport { DropDownSelector, DropDownSelectorAttrs } from \"../../../../common/gui/base/DropDownSelector.js\"\nimport { FeatureType, Keys } from \"../../../../common/api/common/TutanotaConstants.js\"\nimport { IconButton } from \"../../../../common/gui/base/IconButton.js\"\nimport { showNotAvailableForFreeDialog } from \"../../../../common/misc/SubscriptionDialogs.js\"\nimport { listSelectionKeyboardShortcuts } from \"../../../../common/gui/base/ListUtils.js\"\nimport { MultiselectMode } from \"../../../../common/gui/base/List.js\"\nimport { showProgressDialog } from \"../../../../common/gui/dialogs/ProgressDialog.js\"\nimport { CalendarOperation } from \"../../gui/eventeditor-model/CalendarEventModel.js\"\nimport { getEventWithDefaultTimes, setNextHalfHour } from \"../../../../common/api/common/utils/CommonCalendarUtils.js\"\nimport { getSharedGroupName } from \"../../../../common/sharing/GroupUtils.js\"\nimport { CalendarInfo } from \"../../model/CalendarModel.js\"\nimport { Checkbox, CheckboxAttrs } from \"../../../../common/gui/base/Checkbox.js\"\nimport { MobileActionAttrs, MobileActionBar } from \"../../../../common/gui/MobileActionBar.js\"\nimport { assertMainOrNode } from \"../../../../common/api/common/Env.js\"\nimport { calendarLocator } from \"../../../calendarLocator.js\"\nimport { client } from \"../../../../common/misc/ClientDetector.js\"\nimport { CALENDAR_PREFIX } from \"../../../../common/misc/RouteChange.js\"\nimport { Dialog } from \"../../../../common/gui/base/Dialog.js\"\nimport { ButtonType } from \"../../../../common/gui/base/Button.js\"\nimport { locator } from \"../../../../common/api/main/CommonLocator.js\"\nimport { extractContactIdFromEvent, isBirthdayEvent } from \"../../../../common/calendar/date/CalendarUtils.js\"\nimport { ContactCardViewer } from \"../../../../mail-app/contacts/view/ContactCardViewer.js\"\nimport { ContactModel } from \"../../../../common/contactsFunctionality/ContactModel.js\"\nimport { PartialRecipient } from \"../../../../common/api/common/recipients/Recipient.js\"\nimport { simulateMailToClick } from \"../../gui/eventpopup/ContactPreviewView.js\"\nimport { DatePicker, DatePickerAttrs } from \"../../gui/pickers/DatePicker.js\"\nimport { EventEditorDialog } from \"../../gui/eventeditor-view/CalendarEventEditDialog.js\"\n\nassertMainOrNode()\n\nexport interface CalendarSearchViewAttrs extends TopLevelAttrs {\n\theader: AppHeaderAttrs\n\tmakeViewModel: () => CalendarSearchViewModel\n\tcontactModel: ContactModel\n}\n\nexport class CalendarSearchView extends BaseTopLevelView implements TopLevelView<CalendarSearchViewAttrs> {\n\tprivate readonly resultListColumn: ViewColumn\n\tprivate readonly resultDetailsColumn: ViewColumn\n\tprivate readonly viewSlider: ViewSlider\n\tprivate readonly searchViewModel: CalendarSearchViewModel\n\tprivate readonly contactModel: ContactModel\n\tprivate readonly startOfTheWeekOffset: number\n\tprivate datePickerWarning: MaybeTranslation | null = null\n\n\tprivate getSanitizedPreviewData: (event: CalendarEvent) => LazyLoaded<CalendarEventPreviewViewModel> = memoized((event: CalendarEvent) =>\n\t\tnew LazyLoaded(async () => {\n\t\t\tconst calendars = await this.searchViewModel.getLazyCalendarInfos().getAsync()\n\t\t\tconst eventPreviewModel = await calendarLocator.calendarEventPreviewModel(event, calendars)\n\t\t\teventPreviewModel.sanitizeDescription().then(() => m.redraw())\n\t\t\treturn eventPreviewModel\n\t\t}).load(),\n\t)\n\n\tprivate getContactPreviewData = memoized((id: string) =>\n\t\tnew LazyLoaded(async () => {\n\t\t\tconst idParts = id.split(\"/\")\n\t\t\tconst contact = await this.contactModel.loadContactFromId([idParts[0], idParts[1]])\n\t\t\tm.redraw()\n\t\t\treturn contact\n\t\t}).load(),\n\t)\n\n\tconstructor(vnode: Vnode<CalendarSearchViewAttrs>) {\n\t\tsuper()\n\t\tthis.searchViewModel = vnode.attrs.makeViewModel()\n\t\tthis.contactModel = vnode.attrs.contactModel\n\t\tthis.startOfTheWeekOffset = this.searchViewModel.getStartOfTheWeekOffset()\n\n\t\tthis.resultListColumn = new ViewColumn(\n\t\t\t{\n\t\t\t\tview: () => {\n\t\t\t\t\treturn m(BackgroundColumnLayout, {\n\t\t\t\t\t\tbackgroundColor: theme.navigation_bg,\n\t\t\t\t\t\tdesktopToolbar: () => m(DesktopListToolbar, [m(\".button-height\")]),\n\t\t\t\t\t\tmobileHeader: () => this.renderMobileListHeader(vnode.attrs.header),\n\t\t\t\t\t\tcolumnLayout: this.getResultColumnLayout(),\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t},\n\t\t\tColumnType.Background,\n\t\t\t{\n\t\t\t\tminWidth: size.second_col_min_width,\n\t\t\t\tmaxWidth: size.second_col_max_width,\n\t\t\t\theaderCenter: \"searchResult_label\",\n\t\t\t},\n\t\t)\n\t\tthis.resultDetailsColumn = new ViewColumn(\n\t\t\t{\n\t\t\t\tview: () => this.renderDetailsView(vnode.attrs.header),\n\t\t\t},\n\t\t\tColumnType.Background,\n\t\t\t{\n\t\t\t\tminWidth: size.third_col_min_width,\n\t\t\t\tmaxWidth: size.third_col_max_width,\n\t\t\t},\n\t\t)\n\t\tthis.viewSlider = new ViewSlider([this.resultListColumn, this.resultDetailsColumn], false)\n\t}\n\n\tprivate getResultColumnLayout() {\n\t\treturn m(CalendarSearchListView, {\n\t\t\tlistModel: this.searchViewModel.listModel,\n\t\t\tonSingleSelection: (item) => {\n\t\t\t\tthis.viewSlider.focus(this.resultDetailsColumn)\n\t\t\t},\n\t\t\tcancelCallback: () => {\n\t\t\t\tthis.searchViewModel.sendStopLoadingSignal()\n\t\t\t},\n\t\t\tisFreeAccount: calendarLocator.logins.getUserController().isFreeAccount(),\n\t\t} satisfies CalendarSearchListViewAttrs)\n\t}\n\n\tprivate renderFilterSection(): Children {\n\t\treturn m(SidebarSection, { name: \"filter_label\" }, this.renderCalendarFilterSection())\n\t}\n\n\toncreate(): void {\n\t\tthis.searchViewModel.init()\n\n\t\tkeyManager.registerShortcuts(this.shortcuts())\n\t}\n\n\tonremove(): void {\n\t\tthis.searchViewModel.dispose()\n\n\t\tkeyManager.unregisterShortcuts(this.shortcuts())\n\t}\n\n\tprivate renderMobileListHeader(header: AppHeaderAttrs) {\n\t\treturn this.renderMobileListActionsHeader(header)\n\t}\n\n\tprivate renderMobileListActionsHeader(header: AppHeaderAttrs) {\n\t\tconst rightActions = []\n\n\t\tif (styles.isSingleColumnLayout()) {\n\t\t\trightActions.push(this.renderHeaderRightView())\n\t\t}\n\n\t\treturn m(BaseMobileHeader, {\n\t\t\tleft: m(\n\t\t\t\t\".icon-button\",\n\t\t\t\tm(NavButton, {\n\t\t\t\t\tlabel: \"back_action\",\n\t\t\t\t\thideLabel: true,\n\t\t\t\t\ticon: () => BootIcons.Back,\n\t\t\t\t\thref: CALENDAR_PREFIX,\n\t\t\t\t\tcentred: true,\n\t\t\t\t\tfillSpaceAround: false,\n\t\t\t\t}),\n\t\t\t),\n\t\t\tright: rightActions,\n\t\t\tcenter: m(\n\t\t\t\t\".flex-grow.flex.justify-center\",\n\t\t\t\tm(searchBar, {\n\t\t\t\t\tplaceholder: this.searchBarPlaceholder(),\n\t\t\t\t\treturnListener: () => this.resultListColumn.focus(),\n\t\t\t\t}),\n\t\t\t),\n\t\t\tinjections: m(ProgressBar, { progress: header.offlineIndicatorModel.getProgress() }),\n\t\t})\n\t}\n\n\t/** depending on the search and selection state we want to render a\n\t * (multi) mail viewer or a (multi) contact viewer or an event preview\n\t */\n\tprivate renderDetailsView(header: AppHeaderAttrs): Children {\n\t\tif (this.searchViewModel.listModel.isSelectionEmpty() && this.viewSlider.focusedColumn === this.resultDetailsColumn) {\n\t\t\tthis.viewSlider.focus(this.resultListColumn)\n\t\t\treturn null\n\t\t}\n\n\t\tconst selectedEvent = this.searchViewModel.getSelectedEvents()[0]\n\t\treturn m(BackgroundColumnLayout, {\n\t\t\tbackgroundColor: theme.navigation_bg,\n\t\t\tdesktopToolbar: () => m(DesktopViewerToolbar, []),\n\t\t\tmobileHeader: () =>\n\t\t\t\tm(MobileHeader, {\n\t\t\t\t\t...header,\n\t\t\t\t\tbackAction: () => this.viewSlider.focusPreviousColumn(),\n\t\t\t\t\tcolumnType: \"other\",\n\t\t\t\t\ttitle: \"search_label\",\n\t\t\t\t\tactions: null,\n\t\t\t\t\tmulticolumnActions: () => [],\n\t\t\t\t\tprimaryAction: () => this.renderHeaderRightView(),\n\t\t\t\t}),\n\t\t\tcolumnLayout:\n\t\t\t\tselectedEvent == null\n\t\t\t\t\t? m(ColumnEmptyMessageBox, {\n\t\t\t\t\t\t\tmessage: \"noEventSelect_msg\",\n\t\t\t\t\t\t\ticon: BootIcons.Calendar,\n\t\t\t\t\t\t\tcolor: theme.content_message_bg,\n\t\t\t\t\t\t\tbackgroundColor: theme.navigation_bg,\n\t\t\t\t\t  })\n\t\t\t\t\t: !this.getSanitizedPreviewData(selectedEvent).isLoaded()\n\t\t\t\t\t? null\n\t\t\t\t\t: this.renderEventPreview(selectedEvent),\n\t\t})\n\t}\n\n\tprivate renderEventPreview(event: CalendarEvent) {\n\t\tif (isBirthdayEvent(event.uid)) {\n\t\t\tconst idParts = event._id[1].split(\"#\")\n\n\t\t\tconst contactId = extractContactIdFromEvent(last(idParts))\n\t\t\tif (contactId != null && this.getContactPreviewData(contactId).isLoaded()) {\n\t\t\t\treturn this.renderContactPreview(this.getContactPreviewData(contactId).getSync()!)\n\t\t\t}\n\n\t\t\treturn null\n\t\t} else if (this.getSanitizedPreviewData(event).isLoaded()) {\n\t\t\treturn this.renderEventDetails(event)\n\t\t}\n\n\t\treturn null\n\t}\n\n\tprivate renderContactPreview(contact: Contact) {\n\t\treturn m(\n\t\t\t\".fill-absolute.flex.col.overflow-y-scroll\",\n\t\t\tm(ContactCardViewer, {\n\t\t\t\tcontact: contact,\n\t\t\t\teditAction: async (contact) => {\n\t\t\t\t\tif (!(await Dialog.confirm(\"openMailApp_msg\", \"yes_label\"))) return\n\n\t\t\t\t\tconst query = `contactId=${stringToBase64(contact._id.join(\"/\"))}`\n\t\t\t\t\tcalendarLocator.systemFacade.openMailApp(stringToBase64(query))\n\t\t\t\t},\n\t\t\t\tonWriteMail: (to: PartialRecipient) => simulateMailToClick(to.address),\n\t\t\t\textendedActions: true,\n\t\t\t}),\n\t\t)\n\t}\n\n\tprivate renderEventDetails(selectedEvent: CalendarEvent) {\n\t\treturn m(\n\t\t\t\".height-100p.overflow-y-scroll.mb-l.fill-absolute.pb-l\",\n\t\t\tm(\n\t\t\t\t\".border-radius-big.flex.col.flex-grow.content-bg\",\n\t\t\t\t{\n\t\t\t\t\tclass: styles.isDesktopLayout() ? \"mlr-l\" : \"mlr\",\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\"min-width\": styles.isDesktopLayout() ? px(size.third_col_min_width) : null,\n\t\t\t\t\t\t\"max-width\": styles.isDesktopLayout() ? px(size.third_col_max_width) : null,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tm(EventDetailsView, {\n\t\t\t\t\teventPreviewModel: assertNotNull(this.getSanitizedPreviewData(selectedEvent).getSync()),\n\t\t\t\t} satisfies EventDetailsViewAttrs),\n\t\t\t),\n\t\t)\n\t}\n\n\tprivate renderSearchResultActions() {\n\t\tif (this.viewSlider.focusedColumn !== this.resultDetailsColumn) return null\n\n\t\tconst selectedEvent = this.searchViewModel.getSelectedEvents()[0]\n\t\tif (!selectedEvent) {\n\t\t\tthis.viewSlider.focus(this.resultListColumn)\n\t\t\treturn m(MobileActionBar, { actions: [] })\n\t\t}\n\t\tconst previewModel = this.getSanitizedPreviewData(selectedEvent).getSync()\n\t\tconst actions: Array<MobileActionAttrs> = []\n\t\tif (previewModel) {\n\t\t\tif (previewModel.canSendUpdates) {\n\t\t\t\tactions.push({\n\t\t\t\t\ticon: BootIcons.Mail,\n\t\t\t\t\ttitle: \"sendUpdates_label\",\n\t\t\t\t\taction: () => handleSendUpdatesClick(previewModel),\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (previewModel.canEdit) {\n\t\t\t\tactions.push({\n\t\t\t\t\ticon: Icons.Edit,\n\t\t\t\t\ttitle: \"edit_action\",\n\t\t\t\t\taction: (ev: MouseEvent, receiver: HTMLElement) => handleEventEditButtonClick(previewModel, ev, receiver),\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (previewModel.canDelete) {\n\t\t\t\tactions.push({\n\t\t\t\t\ticon: Icons.Trash,\n\t\t\t\t\ttitle: \"delete_action\",\n\t\t\t\t\taction: (ev: MouseEvent, receiver: HTMLElement) => handleEventDeleteButtonClick(previewModel, ev, receiver),\n\t\t\t\t})\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getSanitizedPreviewData(selectedEvent).load()\n\t\t}\n\n\t\treturn actions.map((action) =>\n\t\t\tm(IconButton, {\n\t\t\t\ttitle: action.title,\n\t\t\t\ticon: action.icon,\n\t\t\t\tclick: action.action,\n\t\t\t}),\n\t\t)\n\t}\n\n\tprivate searchBarPlaceholder() {\n\t\treturn lang.get(\"searchCalendar_placeholder\")\n\t}\n\n\tprivate renderCalendarFilterSection(): Children {\n\t\treturn [this.renderDateRangeSelection(), this.renderCalendarFilter(), this.renderRepeatingFilter()].map((row) =>\n\t\t\tm(\".folder-row.plr-button.content-fg\", row),\n\t\t)\n\t}\n\n\tgetViewSlider(): ViewSlider | null {\n\t\treturn this.viewSlider\n\t}\n\n\tprivate renderHeaderRightView(): Children {\n\t\tif (styles.isUsingBottomNavigation() && !client.isCalendarApp()) {\n\t\t\treturn m(IconButton, {\n\t\t\t\tclick: () => this.createNewEventDialog(),\n\t\t\t\ttitle: \"newEvent_action\",\n\t\t\t\ticon: Icons.Add,\n\t\t\t})\n\t\t} else if (client.isCalendarApp()) {\n\t\t\treturn m.fragment({}, [\n\t\t\t\tthis.renderSearchResultActions(),\n\t\t\t\tm(IconButton, {\n\t\t\t\t\ticon: Icons.Filter,\n\t\t\t\t\ttitle: \"filter_label\",\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tconst dialog = Dialog.editSmallDialog(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmiddle: \"filter_label\",\n\t\t\t\t\t\t\t\tright: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: \"ok_action\",\n\t\t\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\t\t\tdialog.close()\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\ttype: ButtonType.Primary,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t() => m(\".pt-m.pb-ml\", this.renderCalendarFilterSection()),\n\t\t\t\t\t\t)\n\t\t\t\t\t\tdialog.setFocusOnLoadFunction(noOp)\n\t\t\t\t\t\tdialog.show()\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t])\n\t\t}\n\t}\n\n\tprivate renderDateRangeSelection(): Children {\n\t\tconst renderedHelpText: MaybeTranslation | undefined =\n\t\t\tthis.searchViewModel.warning === \"startafterend\"\n\t\t\t\t? \"startAfterEnd_label\"\n\t\t\t\t: this.searchViewModel.warning === \"long\"\n\t\t\t\t? \"longSearchRange_msg\"\n\t\t\t\t: this.searchViewModel.startDate == null\n\t\t\t\t? \"unlimited_label\"\n\t\t\t\t: undefined\n\t\treturn m(\n\t\t\t\".flex.col\",\n\t\t\tm(\n\t\t\t\t\".pl-s.flex-grow.flex-space-between.flex-column\",\n\t\t\t\tm(DatePicker, {\n\t\t\t\t\tdate: this.searchViewModel.startDate ?? undefined,\n\t\t\t\t\tonDateSelected: (date) => {\n\t\t\t\t\t\tif (this.searchViewModel.selectStartDate(date) != PaidFunctionResult.Success) {\n\t\t\t\t\t\t\tshowNotAvailableForFreeDialog()\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tstartOfTheWeekOffset: this.startOfTheWeekOffset,\n\t\t\t\t\tlabel: \"dateFrom_label\",\n\t\t\t\t\tnullSelectionText: renderedHelpText,\n\t\t\t\t\trightAlignDropdown: true,\n\t\t\t\t} satisfies DatePickerAttrs),\n\t\t\t),\n\t\t\tm(\n\t\t\t\t\".pl-s.flex-grow.flex-space-between.flex-column\",\n\t\t\t\tm(DatePicker, {\n\t\t\t\t\tdate: this.searchViewModel.endDate,\n\t\t\t\t\tonDateSelected: (date) => {\n\t\t\t\t\t\tif (this.searchViewModel.selectEndDate(date) != PaidFunctionResult.Success) {\n\t\t\t\t\t\t\tshowNotAvailableForFreeDialog()\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tstartOfTheWeekOffset: this.startOfTheWeekOffset,\n\t\t\t\t\tlabel: \"dateTo_label\",\n\t\t\t\t\trightAlignDropdown: true,\n\t\t\t\t} satisfies DatePickerAttrs),\n\t\t\t),\n\t\t)\n\t}\n\n\tprivate readonly shortcuts = lazyMemoized<ReadonlyArray<Shortcut>>(() => [\n\t\t...listSelectionKeyboardShortcuts(MultiselectMode.Enabled, () => this.searchViewModel.listModel),\n\t\t{\n\t\t\tkey: Keys.N,\n\t\t\texec: () => {\n\t\t\t\tthis.createNewEventDialog()\n\t\t\t},\n\t\t\tenabled: () => calendarLocator.logins.isInternalUserLoggedIn() && !calendarLocator.logins.isEnabled(FeatureType.ReplyOnly),\n\t\t\thelp: \"newMail_action\",\n\t\t},\n\t])\n\n\tasync onNewUrl(args: Record<string, any>, requestedPath: string) {\n\t\t// calling init here too because this is called very early in the lifecycle and onNewUrl won't work properly if init is called\n\t\t// afterwords\n\t\tawait this.searchViewModel.init()\n\t\tthis.searchViewModel.onNewUrl(args, requestedPath)\n\t\tthis.invalidateBirthdayPreview()\n\t\t// redraw because init() is async\n\t\tm.redraw()\n\t}\n\n\tprivate invalidateBirthdayPreview() {\n\t\tconst selectedEvent = this.searchViewModel.getSelectedEvents()[0]\n\t\tif (!selectedEvent || !isBirthdayEvent(selectedEvent.uid)) {\n\t\t\treturn\n\t\t}\n\n\t\tconst idParts = selectedEvent._id[1].split(\"#\")\n\t\tconst contactId = extractContactIdFromEvent(last(idParts))\n\t\tif (!contactId) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.getContactPreviewData(contactId).reload().then(m.redraw)\n\t}\n\n\tprivate async createNewEventDialog(): Promise<void> {\n\t\tconst dateToUse = this.searchViewModel.startDate ? setNextHalfHour(new Date(this.searchViewModel.startDate)) : setNextHalfHour(new Date())\n\n\t\t// Disallow creation of events when there is no existing calendar\n\t\tconst lazyCalendarInfo = this.searchViewModel.getLazyCalendarInfos()\n\t\tconst calendarInfos = lazyCalendarInfo.isLoaded() ? lazyCalendarInfo.getSync() : lazyCalendarInfo.getAsync()\n\n\t\tif (calendarInfos instanceof Promise) {\n\t\t\tawait showProgressDialog(\"pleaseWait_msg\", calendarInfos)\n\t\t}\n\n\t\tconst mailboxDetails = await calendarLocator.mailboxModel.getUserMailboxDetails()\n\t\tconst mailboxProperties = await calendarLocator.mailboxModel.getMailboxProperties(mailboxDetails.mailboxGroupRoot)\n\t\tconst model = await calendarLocator.calendarEventModel(\n\t\t\tCalendarOperation.Create,\n\t\t\tgetEventWithDefaultTimes(dateToUse),\n\t\t\tmailboxDetails,\n\t\t\tmailboxProperties,\n\t\t\tnull,\n\t\t)\n\n\t\tif (model) {\n\t\t\tconst eventEditor = new EventEditorDialog()\n\t\t\tawait eventEditor.showNewCalendarEventEditDialog(model)\n\t\t}\n\t}\n\n\tprivate renderCalendarFilter(): Children {\n\t\tif (this.searchViewModel.getLazyCalendarInfos().isLoaded() && this.searchViewModel.getUserHasNewPaidPlan().isLoaded()) {\n\t\t\tconst calendarInfos = this.searchViewModel.getLazyCalendarInfos().getSync() ?? []\n\n\t\t\t// Load user's calendar list\n\t\t\tconst items: {\n\t\t\t\tname: string\n\t\t\t\tvalue: CalendarInfo | string\n\t\t\t}[] = Array.from(calendarInfos.values()).map((ci) => ({\n\t\t\t\tname: getSharedGroupName(ci.groupInfo, locator.logins.getUserController(), true),\n\t\t\t\tvalue: ci,\n\t\t\t}))\n\n\t\t\tif (this.searchViewModel.getUserHasNewPaidPlan().getSync()) {\n\t\t\t\tconst localCalendars = this.searchViewModel.getLocalCalendars().map((cal) => ({\n\t\t\t\t\tname: cal.name,\n\t\t\t\t\tvalue: cal.id,\n\t\t\t\t}))\n\n\t\t\t\titems.push(...localCalendars)\n\t\t\t}\n\n\t\t\t// Find the selected value after loading the available calendars\n\t\t\tconst selectedValue =\n\t\t\t\titems.find((calendar) => {\n\t\t\t\t\tif (!calendar.value) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof calendar.value === \"string\") {\n\t\t\t\t\t\treturn calendar.value === this.searchViewModel.selectedCalendar\n\t\t\t\t\t}\n\n\t\t\t\t\t// It isn't a string, so it can be only a Calendar Info\n\t\t\t\t\tconst calendarValue = calendar.value\n\t\t\t\t\treturn isSameId([calendarValue.groupRoot.longEvents, calendarValue.groupRoot.shortEvents], this.searchViewModel.selectedCalendar)\n\t\t\t\t})?.value ?? null\n\n\t\t\treturn m(\n\t\t\t\t\".ml-button\",\n\t\t\t\tm(DropDownSelector, {\n\t\t\t\t\tlabel: \"calendar_label\",\n\t\t\t\t\titems: [{ name: lang.get(\"all_label\"), value: null }, ...items],\n\t\t\t\t\tselectedValue,\n\t\t\t\t\tselectionChangedHandler: (value: CalendarInfo | string | null) => {\n\t\t\t\t\t\t// value can be null if default option has been selected\n\t\t\t\t\t\tthis.searchViewModel.selectCalendar(value)\n\t\t\t\t\t},\n\t\t\t\t} satisfies DropDownSelectorAttrs<CalendarInfo | string | null>),\n\t\t\t)\n\t\t} else {\n\t\t\treturn null\n\t\t}\n\t}\n\n\tprivate renderRepeatingFilter(): Children {\n\t\treturn m(\n\t\t\t\".mlr-button\",\n\t\t\tm(Checkbox, {\n\t\t\t\tlabel: () => lang.get(\"includeRepeatingEvents_action\"),\n\t\t\t\tchecked: this.searchViewModel.includeRepeatingEvents,\n\t\t\t\tonChecked: (value: boolean) => {\n\t\t\t\t\tthis.searchViewModel.selectIncludeRepeatingEvents(value)\n\t\t\t\t},\n\t\t\t} satisfies CheckboxAttrs),\n\t\t)\n\t}\n\n\tview({ attrs }: Vnode<CalendarSearchViewAttrs>): Children {\n\t\treturn m(\n\t\t\t\"#search.main-view\",\n\t\t\tm(this.viewSlider, {\n\t\t\t\theader: m(Header, {\n\t\t\t\t\tsearchBar: () =>\n\t\t\t\t\t\tm(searchBar, {\n\t\t\t\t\t\t\tplaceholder: this.searchBarPlaceholder(),\n\t\t\t\t\t\t\treturnListener: () => this.resultListColumn.focus(),\n\t\t\t\t\t\t}),\n\t\t\t\t\t...attrs.header,\n\t\t\t\t}),\n\t\t\t}),\n\t\t)\n\t}\n}\n"]}