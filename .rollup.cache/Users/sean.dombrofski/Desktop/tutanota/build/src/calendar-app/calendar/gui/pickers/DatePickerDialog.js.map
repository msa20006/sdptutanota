{"version":3,"file":"DatePickerDialog.js","sourceRoot":"","sources":["../../../../../../src/calendar-app/calendar/gui/pickers/DatePickerDialog.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Component } from \"mithril\"\nimport { Dialog, DialogType } from \"../../../../common/gui/base/Dialog.js\"\nimport { lang, Translation } from \"../../../../common/misc/LanguageViewModel.js\"\nimport { DatePicker } from \"./DatePicker.js\"\nimport { px, size } from \"../../../../common/gui/size.js\"\nimport { client } from \"../../../../common/misc/ClientDetector.js\"\nimport { formatDateWithWeekdayAndYear } from \"../../../../common/misc/Formatter.js\"\nimport { assertMainOrNode } from \"../../../../common/api/common/Env.js\"\nimport { debounceStart, NBSP, noOp } from \"@tutao/tutanota-utils\"\n\nassertMainOrNode()\n\n/**\n * Shows a dialog in which the user can select a start date and an end date. Start and end date does not need to be selected, then they are null and regarded as unlimited.\n */\nexport function showDateRangeSelectionDialog<T>(\n\tstartOfTheWeekOffset: number,\n\tstart: Date,\n\tend: Date,\n\tdateValidator: (startDate: Date | null, endDate: Date | null) => string | null = () => null,\n): Promise<{\n\tstart: Date\n\tend: Date\n}> {\n\tconst helpLabel = (date: Date | null): Translation =>\n\t\tdate != null ? lang.makeTranslation(\"date\", formatDateWithWeekdayAndYear(date)) : lang.getTranslation(\"unlimited_label\")\n\n\tconst validateDates = debounceStart(750, (startDate, endDate) => {\n\t\twarning = dateValidator(startDate, endDate)\n\t\tm.redraw()\n\t})\n\n\tlet startDate = start\n\tlet endDate = end\n\tlet warning: string | null = null\n\tconst form: Component = {\n\t\tview: () =>\n\t\t\tm(\n\t\t\t\t\".flex.col\",\n\t\t\t\tm(\".flex-space-between\", [\n\t\t\t\t\tm(\n\t\t\t\t\t\t\".pr-s.flex-grow.max-width-200.flex-space-between.flex-column\",\n\t\t\t\t\t\tm(DatePicker, {\n\t\t\t\t\t\t\tdate: startDate,\n\t\t\t\t\t\t\tonDateSelected: (date) => {\n\t\t\t\t\t\t\t\twarning = null\n\t\t\t\t\t\t\t\tstartDate = date\n\t\t\t\t\t\t\t\tvalidateDates(startDate, endDate)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstartOfTheWeekOffset,\n\t\t\t\t\t\t\tlabel: \"dateFrom_label\",\n\t\t\t\t\t\t\tnullSelectionText: helpLabel(start),\n\t\t\t\t\t\t}),\n\t\t\t\t\t),\n\t\t\t\t\tm(\n\t\t\t\t\t\t\".pl-s.flex-grow.max-width-200.flex-space-between.flex-column\",\n\t\t\t\t\t\tm(DatePicker, {\n\t\t\t\t\t\t\tdate: endDate,\n\t\t\t\t\t\t\tonDateSelected: (date) => {\n\t\t\t\t\t\t\t\twarning = null\n\t\t\t\t\t\t\t\tendDate = date\n\t\t\t\t\t\t\t\tvalidateDates(startDate, endDate)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstartOfTheWeekOffset,\n\t\t\t\t\t\t\tlabel: \"dateTo_label\",\n\t\t\t\t\t\t\tnullSelectionText: helpLabel(end),\n\t\t\t\t\t\t}),\n\t\t\t\t\t),\n\t\t\t\t]),\n\t\t\t\tm(\".mt\", { style: { minHeight: px(2 * size.font_size_base * size.line_height) } }, warning ?? NBSP),\n\t\t\t),\n\t}\n\treturn new Promise((resolve) => {\n\t\tlet dialog = Dialog.showActionDialog({\n\t\t\ttitle: \"selectPeriodOfTime_label\",\n\t\t\tchild: form,\n\t\t\tallowOkWithReturn: true,\n\t\t\tokAction: () =>\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tconst start = startDate\n\t\t\t\t\tconst end = endDate\n\n\t\t\t\t\tif (start.getTime() > end.getTime()) {\n\t\t\t\t\t\tDialog.message(\"startAfterEnd_label\")\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdialog.close()\n\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\tend,\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\ttype: DialogType.EditMedium,\n\t\t})\n\t\tif (client.isMobileDevice()) {\n\t\t\t// Prevent focusing text field automatically on mobile. It opens keyboard and you don't see all details.\n\t\t\tdialog.setFocusOnLoadFunction(noOp)\n\t\t}\n\t})\n}\n"]}