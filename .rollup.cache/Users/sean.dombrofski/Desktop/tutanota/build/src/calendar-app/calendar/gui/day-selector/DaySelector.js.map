{"version":3,"file":"DaySelector.js","sourceRoot":"","sources":["../../../../../../src/calendar-app/calendar/gui/day-selector/DaySelector.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component, Vnode } from \"mithril\"\nimport { assertNotNull, getStartOfDay, incrementDate, isSameDayOfDate, isToday } from \"@tutao/tutanota-utils\"\nimport { DateTime } from \"luxon\"\nimport { Carousel } from \"../../../../common/gui/base/Carousel.js\"\nimport { changePeriodOnWheel, getCalendarMonth } from \"../CalendarGuiUtils.js\"\nimport { CalendarDay, CalendarMonth } from \"../../../../common/calendar/date/CalendarUtils.js\"\nimport { DefaultAnimationTime } from \"../../../../common/gui/animation/Animations.js\"\nimport { ExpanderPanel } from \"../../../../common/gui/base/Expander.js\"\nimport { theme } from \"../../../../common/gui/theme.js\"\nimport { px, size } from \"../../../../common/gui/size.js\"\nimport { styles } from \"../../../../common/gui/styles.js\"\nimport { hexToRGBAString } from \"../../../../common/gui/base/Color.js\"\n\nexport interface DaySelectorAttrs {\n\tselectedDate: Date | null\n\tonDateSelected?: (date: Date, dayClick: boolean) => unknown\n\twide: boolean\n\tstartOfTheWeekOffset: number\n\tisDaySelectorExpanded: boolean\n\thandleDayPickerSwipe: (isNext: boolean) => void\n\tshowDaySelection: boolean\n\thighlightToday: boolean\n\thighlightSelectedWeek: boolean\n\tuseNarrowWeekName: boolean\n\thasEventOn: (date: Date) => boolean\n}\n\n/**\n *  Expandable Date picker used on single/two column layouts.\n * Displays the week, and if expanded displays the month.\n */\nexport class DaySelector implements Component<DaySelectorAttrs> {\n\tprivate displayingDate: Date\n\tprivate lastSelectedDate: Date | null = null\n\tprivate handleDayPickerSwipe: DaySelectorAttrs[\"handleDayPickerSwipe\"]\n\n\tconstructor(vnode: Vnode<DaySelectorAttrs>) {\n\t\tthis.handleDayPickerSwipe = vnode.attrs.handleDayPickerSwipe\n\t\tthis.displayingDate = vnode.attrs.selectedDate || getStartOfDay(new Date())\n\t}\n\n\tview(vnode: Vnode<DaySelectorAttrs>): Children {\n\t\tthis.handleDayPickerSwipe = vnode.attrs.handleDayPickerSwipe\n\t\tconst selectedDate = vnode.attrs.selectedDate\n\n\t\tif (selectedDate && !isSameDayOfDate(this.lastSelectedDate, selectedDate)) {\n\t\t\tthis.lastSelectedDate = selectedDate\n\t\t\tthis.displayingDate = new Date(selectedDate)\n\n\t\t\tthis.displayingDate.setDate(1)\n\t\t}\n\n\t\tlet { weeks, weekdays } = getCalendarMonth(this.displayingDate, vnode.attrs.startOfTheWeekOffset, vnode.attrs.useNarrowWeekName)\n\t\treturn m(\n\t\t\t\".flex.flex-column\",\n\t\t\t{\n\t\t\t\tonwheel: changePeriodOnWheel(this.handleDayPickerSwipe),\n\t\t\t},\n\t\t\t[m(\".flex-space-around\", this.renderWeekDays(vnode.attrs.wide, weekdays)), this.renderDayPickerCarousel(vnode)],\n\t\t)\n\t}\n\n\tprivate renderDayPickerCarousel(vnode: Vnode<DaySelectorAttrs>) {\n\t\tconst isExpanded = vnode.attrs.isDaySelectorExpanded ?? true\n\t\tconst date = vnode.attrs.selectedDate ?? new Date()\n\t\t// We need current/last/next month for the expanded date picker\n\t\tconst currentMonth = getCalendarMonth(date, vnode.attrs.startOfTheWeekOffset, true)\n\t\tconst lastMonth = getCalendarMonthShiftedBy(currentMonth, vnode.attrs.startOfTheWeekOffset, -1)\n\t\tconst nextMonth = getCalendarMonthShiftedBy(currentMonth, vnode.attrs.startOfTheWeekOffset, 1)\n\t\t// We need current/last/next week for the collapsed date picker.\n\t\t// The week that we want to get depends on the month layout, so we are looking for it in the already computed months.\n\t\tconst currentWeek = assertNotNull(findWeek(currentMonth, date))\n\t\tconst beginningOfLastWeek = incrementDate(new Date(date), -7)\n\t\t// The week that we are looking for can be in both current month or the last/next one\n\t\tconst lastWeek =\n\t\t\tbeginningOfLastWeek < currentMonth.beginningOfMonth ? findWeek(lastMonth, beginningOfLastWeek) : findWeek(currentMonth, beginningOfLastWeek)\n\t\tconst beginningOfNextWeek = incrementDate(new Date(date), 7)\n\t\tconst nextWeek =\n\t\t\tbeginningOfNextWeek < nextMonth.beginningOfMonth ? findWeek(currentMonth, beginningOfNextWeek) : findWeek(nextMonth, beginningOfNextWeek)\n\n\t\treturn m(Carousel, {\n\t\t\tlabel: \"date_label\",\n\t\t\tclass: \"center-horizontally\",\n\t\t\tstyle: {\n\t\t\t\tfontSize: px(14),\n\t\t\t\tlineHeight: px(this.getElementSize(vnode.attrs)),\n\t\t\t},\n\t\t\tslides: [\n\t\t\t\t{\n\t\t\t\t\tlabel: isExpanded ? \"prevMonth_label\" : \"prevWeek_label\",\n\t\t\t\t\telement: this.renderCarouselPage(isExpanded, vnode.attrs, lastWeek, lastMonth, true),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: isExpanded ? \"month_label\" : \"week_label\",\n\t\t\t\t\telement: this.renderCarouselPage(isExpanded, vnode.attrs, currentWeek, currentMonth, false),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: isExpanded ? \"nextMonth_label\" : \"nextWeek_label\",\n\t\t\t\t\telement: this.renderCarouselPage(isExpanded, vnode.attrs, nextWeek, nextMonth, true),\n\t\t\t\t},\n\t\t\t],\n\t\t\tonSwipe: (isNext: boolean) => this.handleDayPickerSwipe?.(isNext),\n\t\t})\n\t}\n\n\tprivate renderCarouselPage(isExpanded: boolean, attrs: DaySelectorAttrs, week: readonly CalendarDay[], month: CalendarMonth, hidden: boolean) {\n\t\treturn [\n\t\t\tm(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\t\"aria-hidden\": `${isExpanded}`,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tdisplay: isExpanded ? \"none\" : \"block\",\n\t\t\t\t\t\theight: isExpanded ? 0 : undefined,\n\t\t\t\t\t\topacity: isExpanded ? 0 : 1,\n\t\t\t\t\t\toverflow: \"clip\",\n\t\t\t\t\t\ttransition: `opacity ${1.5 * DefaultAnimationTime}ms ease-in-out`,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.renderExpandableWeek(week, attrs, false, attrs.isDaySelectorExpanded || hidden),\n\t\t\t),\n\t\t\tm(\n\t\t\t\tExpanderPanel,\n\t\t\t\t{\n\t\t\t\t\texpanded: isExpanded,\n\t\t\t\t},\n\t\t\t\tthis.renderExpandedMonth(month, attrs, hidden),\n\t\t\t),\n\t\t]\n\t}\n\n\tprivate renderExpandedMonth(calendarMonth: CalendarMonth, attrs: DaySelectorAttrs, hidden: boolean) {\n\t\tconst { weeks } = calendarMonth\n\t\tlet weekToHighlight = -1\n\n\t\tif (attrs.highlightSelectedWeek) {\n\t\t\tweekToHighlight = weeks.findIndex((week) => week.find((day) => day.date.getTime() === attrs.selectedDate?.getTime()))\n\t\t}\n\n\t\treturn weeks.map((w, index) => this.renderExpandableWeek(w, attrs, weekToHighlight === index, attrs.isDaySelectorExpanded && hidden))\n\t}\n\n\tprivate renderDay({ date, day, isPaddingDay }: CalendarDay, attrs: DaySelectorAttrs, hidden: boolean): Children {\n\t\tconst isSelectedDay = isSameDayOfDate(date, attrs.selectedDate)\n\t\tlet circleClass = \"\"\n\t\tlet textClass = \"\"\n\t\tif (isSelectedDay && attrs.showDaySelection) {\n\t\t\tcircleClass = \"calendar-selected-day-circle\"\n\t\t\ttextClass = \"calendar-selected-day-text\"\n\t\t} else if (isToday(date) && attrs.highlightToday) {\n\t\t\tcircleClass = \"calendar-current-day-circle\"\n\t\t\ttextClass = \"calendar-current-day-text\"\n\t\t}\n\n\t\tconst size = this.getElementSize(attrs)\n\n\t\treturn m(\n\t\t\t\"button.rel.click.flex.items-center.justify-center.rel\" + (isPaddingDay && attrs.isDaySelectorExpanded ? \".faded-day\" : \"\"),\n\t\t\t{\n\t\t\t\tclass: \"flex-grow-shrink-0\",\n\t\t\t\t\"aria-hidden\": `${isPaddingDay && attrs.isDaySelectorExpanded}`,\n\t\t\t\t\"aria-label\": date.toLocaleDateString(),\n\t\t\t\t\"aria-selected\": `${isSelectedDay}`,\n\t\t\t\trole: \"option\",\n\t\t\t\ttabIndex: hidden ? -1 : 0,\n\t\t\t\tonclick: () => attrs.onDateSelected?.(date, true),\n\t\t\t},\n\t\t\t[\n\t\t\t\tm(\".abs.z1.circle\", {\n\t\t\t\t\tclass: circleClass,\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\twidth: px(size * 0.625),\n\t\t\t\t\t\theight: px(size * 0.625),\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tm(\n\t\t\t\t\t\".full-width.height-100p.center.z2\",\n\t\t\t\t\t{\n\t\t\t\t\t\tclass: textClass,\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tfontSize: px(attrs.wide ? 14 : 12),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tday,\n\t\t\t\t),\n\t\t\t\tattrs.hasEventOn(date) ? m(\".day-events-indicator\", { style: styles.isDesktopLayout() ? { width: \"3px\", height: \"3px\" } : {} }) : null,\n\t\t\t],\n\t\t)\n\t}\n\n\tprivate getElementSize(attrs: DaySelectorAttrs): number {\n\t\treturn attrs.wide ? 40 : 30\n\t}\n\n\tprivate renderExpandableWeek(week: ReadonlyArray<CalendarDay>, attrs: DaySelectorAttrs, highlight: boolean, hidden: boolean): Children {\n\t\tlet style\n\n\t\tif (highlight) {\n\t\t\tstyle = {\n\t\t\t\tbackgroundColor: hexToRGBAString(theme.content_accent, 0.2),\n\t\t\t\theight: px(styles.isDesktopLayout() ? 19 : 25),\n\t\t\t\tborderRadius: px(styles.isDesktopLayout() ? 6 : 25),\n\t\t\t\twidth: `calc(100% - ${px(size.hpad_small)})`,\n\t\t\t}\n\t\t} else {\n\t\t\tstyle = {}\n\t\t}\n\n\t\treturn m(\".flex-space-around.rel.items-center\", [\n\t\t\tm(\".abs\", {\n\t\t\t\tstyle,\n\t\t\t}),\n\t\t\t...week.map((d) => this.renderDay(d, attrs, hidden)),\n\t\t])\n\t}\n\n\tprivate renderWeekDays(wide: boolean, weekdays: readonly string[]): Children {\n\t\tconst size = px(wide ? 40 : 24)\n\t\tconst fontSize = px(14)\n\t\treturn weekdays.map((wd) =>\n\t\t\tm(\n\t\t\t\t\".center\",\n\t\t\t\t{\n\t\t\t\t\t\"aria-hidden\": \"true\",\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tfontSize,\n\t\t\t\t\t\tfontWeight: \"bold\",\n\t\t\t\t\t\theight: \"20px\",\n\t\t\t\t\t\twidth: size,\n\t\t\t\t\t\tlineHeight: \"20px\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\twd,\n\t\t\t),\n\t\t)\n\t}\n}\n\nfunction findWeek(currentMonth: CalendarMonth, date: Date): readonly CalendarDay[] {\n\treturn assertNotNull(currentMonth.weeks.find((w) => w.some((calendarDay) => date.getTime() === calendarDay.date.getTime())))\n}\n\nfunction getCalendarMonthShiftedBy(currentMonth: CalendarMonth, firstDayOfWeekFromOffset: number, plusMonths: number): CalendarMonth {\n\tconst date = DateTime.fromJSDate(currentMonth.beginningOfMonth).plus({ month: plusMonths }).toJSDate()\n\treturn getCalendarMonth(date, firstDayOfWeekFromOffset, true)\n}\n"]}