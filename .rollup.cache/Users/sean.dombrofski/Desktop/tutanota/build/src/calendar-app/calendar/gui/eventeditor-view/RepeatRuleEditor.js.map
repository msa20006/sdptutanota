{"version":3,"file":"RepeatRuleEditor.js","sourceRoot":"","sources":["../../../../../../src/calendar-app/calendar/gui/eventeditor-view/RepeatRuleEditor.ts"],"names":[],"mappings":"AAAA,OAAO,CAAwC,MAAM,SAAS,CAAA;AAG9D,OAAO,EAAE,IAAI,EAAE,MAAM,8CAA8C,CAAA;AACnE,OAAO,EAAW,YAAY,EAAY,MAAM,oDAAoD,CAAA;AACpG,OAAO,EAAE,UAAU,EAAmB,cAAc,EAAE,MAAM,0BAA0B,CAAA;AAEtF,OAAO,EAAE,0BAA0B,EAAE,oBAAoB,EAAE,uBAAuB,EAAE,wBAAwB,EAAkB,MAAM,wBAAwB,CAAA;AAC5J,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,gCAAgC,CAAA;AACzD,OAAO,EAAE,IAAI,EAAE,MAAM,qCAAqC,CAAA;AAC1D,OAAO,EAAE,UAAU,EAAqC,MAAM,2CAA2C,CAAA;AACzG,OAAO,EAAE,SAAS,EAAE,mBAAmB,EAAE,MAAM,oDAAoD,CAAA;AACnG,OAAO,EAAE,MAAM,EAAoB,MAAM,uCAAuC,CAAA;AAChF,OAAO,MAAM,MAAM,gBAAgB,CAAA;AACnC,OAAO,EAAE,OAAO,EAAE,MAAM,mCAAmC,CAAA;AAC3D,OAAO,EAAE,KAAK,EAAE,MAAM,iCAAiC,CAAA;AACvD,OAAO,EAAE,KAAK,EAAE,MAAM,sCAAsC,CAAA;AAW5D,MAAM,OAAO,gBAAgB;IACpB,cAAc,GAA4B,IAAI,CAAA;IAC9C,cAAc,GAAW,CAAC,CAAA;IAC1B,eAAe,GAA6B,MAAM,CAAC,EAAE,CAAC,CAAA;IACtD,gBAAgB,GAAY,KAAK,CAAA;IAEjC,YAAY,GAAqB,oBAAoB,EAAE,CAAA;IAEvD,kBAAkB,GAA6B,MAAM,CAAC,EAAE,CAAC,CAAA;IACzD,mBAAmB,GAAY,KAAK,CAAA;IACpC,iBAAiB,CAAQ;IAEjC,YAAY,EAAE,KAAK,EAAgC;QAClD,IAAI,KAAK,CAAC,KAAK,CAAC,YAAY,IAAI,IAAI,EAAE,CAAC;YACtC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,YAAY,EAAE,KAAK,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;QAC1H,CAAC;QAED,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;QACvC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;QAE1C,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC,KAAK,CAAC,cAAc,CAAA;QAChD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC,KAAK,CAAC,oBAAoB,CAAA;IAC1D,CAAC;IAEO,aAAa,CAAC,MAAoB,EAAE,QAAgB,EAAE,OAAgB;QAC7E,IAAI,QAAQ,GAAG,CAAC,IAAI,OAAO,4BAAkB,EAAE,CAAC;YAC/C,OAAO,QAAQ,CAAA;QAChB,CAAC;QAED,OAAO,MAAM,CAAA;IACd,CAAC;IAED,IAAI,CAAC,EAAE,KAAK,EAAgC;QAC3C,MAAM,iBAAiB,GAAG,wBAAwB,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YACnE,GAAG,MAAM;YACT,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ;SAChF,CAAC,CAAqC,CAAA;QAEvC,OAAO,CAAC,CACP,qCAAqC,EACrC;YACC,KAAK,EAAE,IAAI,CAAC,cAAc,KAAK,QAAQ,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE;YAC5D,KAAK,EAAE;gBACN,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;aACtB;SACD,EACD;YACC,CAAC,CACA,IAAI,EACJ;gBACC,KAAK,EAAE;oBACN,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,IAAI;iBACzB;aACD,EACD,CAAC,CAAC,UAAU,EAAE;gBACb,SAAS,EAAE,yBAAyB;gBACpC,IAAI,EAAE,yBAAyB;gBAC/B,OAAO,EAAE,uBAAuB,EAAE;gBAClC,cAAc,EAAE,IAAI,CAAC,cAAc;gBACnC,gBAAgB,EAAE,CAAC,MAAwB,EAAE,EAAE;oBAC9C,IAAI,CAAC,cAAc,GAAG,MAAM,CAAA;oBAC5B,IAAI,MAAM,KAAK,QAAQ,EAAE,CAAC;wBACzB,KAAK,CAAC,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,YAAY,IAAI,YAAY,CAAC,KAAK,CAAA;oBAC1E,CAAC;yBAAM,CAAC;wBACP,KAAK,CAAC,KAAK,CAAC,cAAc,GAAG,CAAC,CAAA;wBAC9B,KAAK,CAAC,KAAK,CAAC,aAAa,0BAAgB,CAAA;wBACzC,KAAK,CAAC,KAAK,CAAC,YAAY,GAAG,MAAsB,CAAA;wBACjD,KAAK,CAAC,UAAU,EAAE,CAAA;oBACnB,CAAC;gBACF,CAAC;gBACD,OAAO,EAAE,CAAC,gBAAgB,CAAC;aACiB,CAAC,CAC9C;YACD,IAAI,CAAC,sBAAsB,CAAC,KAAK,EAAE,iBAAiB,CAAC;YACrD,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC;SAC5B,CACD,CAAA;IACF,CAAC;IAEO,gBAAgB,CAAC,KAA4B;QACpD,IAAI,IAAI,CAAC,cAAc,KAAK,QAAQ,EAAE,CAAC;YACtC,OAAO,IAAI,CAAA;QACZ,CAAC;QAED,OAAO,CAAC,CAAC,WAAW,EAAE;YACrB,CAAC,CAAC,sCAAsC,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,iBAAiB,EAAE,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;YACvI,CAAC,CACA,IAAI,EACJ;gBACC,KAAK,EAAE;oBACN,OAAO,EAAE,GAAG,IAAI,CAAC,IAAI,IAAI;iBACzB;gBACD,OAAO,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,YAAY,CAAC;aACtC,EACD;gBACC,CAAC,CAAC,UAAU,EAAE;oBACb,SAAS,EAAE,mCAAmC;oBAC9C,IAAI,EAAE,mCAAmC;oBACzC,OAAO,EAAE,0BAA0B,EAAE;oBACrC,cAAc,EAAE,KAAK,CAAC,KAAK,CAAC,aAAa;oBACzC,gBAAgB,EAAE,CAAC,MAAe,EAAE,EAAE;wBACrC,KAAK,CAAC,KAAK,CAAC,aAAa,GAAG,MAAM,CAAA;oBACnC,CAAC;oBACD,OAAO,EAAE,CAAC,gBAAgB,CAAC;oBAC3B,YAAY,EAAE,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC;iBACN,CAAC;aACrC,CACD;SACD,CAAC,CAAA;IACH,CAAC;IAEO,sBAAsB,CAAC,KAA4B,EAAE,iBAAmD;QAC/G,IAAI,IAAI,CAAC,cAAc,KAAK,QAAQ,EAAE,CAAC;YACtC,OAAO,IAAI,CAAA;QACZ,CAAC;QAED,OAAO,CAAC,CAAC,WAAW,EAAE;YACrB,CAAC,CAAC,sCAAsC,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,iBAAiB,EAAE,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;YAC7H,CAAC,CACA,IAAI,EACJ;gBACC,KAAK,EAAE;oBACN,OAAO,EAAE,OAAO,IAAI,CAAC,IAAI,IAAI;iBAC7B;gBACD,OAAO,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC;aACxB,EACD;gBACC,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC;gBAChC,CAAC,CAAC,OAAO,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,gBAAgB,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,OAAO,IAAI,CAAC,IAAI,IAAI,EAAE,EAAE,CAAC;gBACtF,CAAC,CAAC,UAAU,EAAE;oBACb,SAAS,EAAE,yBAAyB;oBACpC,IAAI,EAAE,yBAAyB;oBAC/B,OAAO,EAAE,iBAAiB;oBAC1B,cAAc,EAAE,KAAK,CAAC,KAAK,CAAC,YAAY;oBACxC,gBAAgB,EAAE,CAAC,MAAoB,EAAE,EAAE;wBAC1C,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,iBAAiB,EAAE,MAAM,EAAE,CAAC,CAAA;oBAClE,CAAC;oBACD,OAAO,EAAE,CAAC,gBAAgB,EAAE,YAAY,EAAE,WAAW,EAAE,WAAW,CAAC;iBAC3B,CAAC;aAC1C,CACD;SACD,CAAC,CAAA;IACH,CAAC;IAEO,eAAe,CAAC,KAA4B;QACnD,MAAM,YAAY,GAAG,IAAI,GAAG,EAAiB,CAAA;QAC7C,YAAY,CAAC,GAAG,0BAAgB,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAA;QAE7D,YAAY,CAAC,GAAG,8BAEf,CAAC,CAAC,UAAU,EAAE;YACb,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,uBAAuB;YACzC,cAAc,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,uBAAuB,GAAG,IAAI,CAAC;YAC9E,KAAK,EAAE,eAAe;YACtB,cAAc,EAAE,IAAI;YACpB,oBAAoB,EAAE,KAAK,CAAC,oBAAoB;YAChD,QAAQ,EAAE,cAAc,CAAC,GAAG;YAC5B,OAAO,EAAE,CAAC,YAAY,EAAE,WAAW,EAAE,KAAK,CAAC,KAAK,CAAC,aAAa,gCAAsB,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC;SAC7E,CAAC,CAC5B,CAAA;QAED,OAAO,YAAY,CAAA;IACpB,CAAC;IAEO,gBAAgB,CAAC,SAAiC,EAAE,UAA0E;QACrI,MAAM,EAAE,QAAQ,EAAE,iBAAiB,EAAE,GAAG,UAAU,CAAA;QAElD,IAAI,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC;YAClC,SAAS,CAAC,cAAc,GAAG,QAAQ,CAAA;QACpC,CAAC;QAED,IAAI,iBAAiB,EAAE,CAAC;YACvB,SAAS,CAAC,YAAY,GAAG,iBAAiB,CAAA;QAC3C,CAAC;IACF,CAAC;IAEO,oBAAoB,CAAC,KAA4B;QACxD,OAAO,CAAC,CAAC,CAAA,MAA8B,CAAA,EAAE;YACxC,QAAQ,EAAE,CAAC,QAAQ,EAAE,EAAE;gBACtB,IAAI,IAAI,CAAC,cAAc,KAAK,QAAQ,CAAC,KAAK,EAAE,CAAC;oBAC5C,OAAM;gBACP,CAAC;gBAED,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC,KAAK,CAAA;gBACpC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAA;gBACrE,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,CAAA;YAChB,CAAC;YACD,OAAO,EAAE,GAAG,EAAE;gBACb,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAA;gBAC7B,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;YACxC,CAAC;YACD,QAAQ,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,EAAE;YACzH,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,oBAAoB,CAAC;YACzC,OAAO,EAAE,IAAI,CAAC,eAAe;YAC7B,MAAM,EAAE,IAAI;YACZ,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,MAAM,4BAAkB,CAAC,CAAC,CAAC,MAAM,kCAAuB;YAC5E,OAAO,EAAE,CAAC,eAAe,CAAC;YAC1B,aAAa,EAAE,GAAG,EAAE,CACnB,CAAC,CAAC,mBAAmB,EAAE;gBACtB,OAAO,EAAE,CAAC,wBAAwB,CAAC;gBACnC,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE;gBACvE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI;gBACpD,QAAQ,EAAE,KAAK,EAAE;gBACjB,OAAO,EAAE,CAAC,GAAW,EAAE,EAAE;oBACxB,IAAI,GAAG,KAAK,EAAE,IAAI,IAAI,CAAC,cAAc,KAAK,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC;wBACvD,OAAM;oBACP,CAAC;oBAED,IAAI,CAAC,cAAc,GAAG,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;oBACpD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC;wBACjC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;wBAC7F,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAA;oBACtE,CAAC;yBAAM,CAAC;wBACP,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;oBACxC,CAAC;gBACF,CAAC;gBACD,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,oBAAoB,CAAC;gBACzC,OAAO,EAAE,CAAC,CAAa,EAAE,EAAE;oBAC1B,CAAC,CAAC,wBAAwB,EAAE,CAAA;oBAC5B,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC;wBAC5B,CAAC;wBAAC,CAAC,CAAC,MAAsB,CAAC,aAAa,EAAE,KAAK,EAAE,CAAA;wBACjD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAA;oBAC7B,CAAC;gBACF,CAAC;gBACD,OAAO,EAAE,CAAC,KAAiB,EAAE,EAAE;oBAC9B,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC;wBAC5B,CAAC;wBAAC,KAAK,CAAC,MAAsB,CAAC,aAAa,EAAE,KAAK,EAAE,CAAA;wBACrD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAA;oBAC7B,CAAC;gBACF,CAAC;gBACD,MAAM,EAAE,CAAC,KAAiB,EAAE,EAAE;oBAC7B,IAAI,KAAK,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC;wBAChC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK,CAAA;wBAChD,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAA;oBACtE,CAAC;yBAAM,IAAI,IAAI,CAAC,cAAc,KAAK,CAAC,EAAE,CAAC;wBACtC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK,CAAA;wBAChD,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAA;oBACtE,CAAC;gBACF,CAAC;gBACD,KAAK,EAAE;oBACN,SAAS,EAAE,QAAQ;iBACnB;gBACD,GAAG,EAAE,GAAG;gBACR,GAAG,EAAE,CAAC;gBACN,IAAI,qCAAsB;aAC1B,CAAC;YACH,YAAY,EAAE,CAAC,MAAM,EAAE,EAAE,CACxB,CAAC,CACA,+BAA+B,EAC/B;gBACC,KAAK,EAAE,qEAAqE;aAC5E,EACD,MAAM,CAAC,IAAI,CACX;YACF,SAAS,EAAE,IAAI;SACoC,CAAC,CAAA;IACtD,CAAC;IAEO,gBAAgB,CAAC,KAA4B;QACpD,OAAO,CAAC,CAAC,CAAA,MAA8B,CAAA,EAAE;YACxC,QAAQ,EAAE,CAAC,QAAQ,EAAE,EAAE;gBACtB,IAAI,IAAI,CAAC,iBAAiB,KAAK,QAAQ,CAAC,KAAK,EAAE,CAAC;oBAC/C,OAAM;gBACP,CAAC;gBAED,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,KAAK,CAAA;gBACvC,KAAK,CAAC,KAAK,CAAC,oBAAoB,GAAG,QAAQ,CAAC,KAAK,CAAA;YAClD,CAAC;YACD,OAAO,EAAE,GAAG,EAAE;gBACb,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAA;gBAChC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;YAC3C,CAAC;YACD,QAAQ,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,EAAE,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,EAAE;YAClI,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,wBAAwB,CAAC;YAC7C,OAAO,EAAE,IAAI,CAAC,kBAAkB;YAChC,MAAM,EAAE,IAAI;YACZ,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,MAAM,4BAAkB,CAAC,CAAC,CAAC,MAAM,kCAAuB;YAC5E,OAAO,EAAE,CAAC,eAAe,CAAC;YAC1B,aAAa,EAAE,GAAG,EAAE,CACnB,CAAC,CAAC,mBAAmB,EAAE;gBACtB,OAAO,EAAE,CAAC,uBAAuB,EAAE,aAAa,EAAE,2BAA2B,CAAC;gBAC9E,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE;gBAC7E,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI;gBACpD,QAAQ,EAAE,KAAK,EAAE;gBACjB,OAAO,EAAE,CAAC,GAAW,EAAE,EAAE;oBACxB,IAAI,GAAG,KAAK,EAAE,IAAI,IAAI,CAAC,iBAAiB,KAAK,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC;wBAC1D,OAAM;oBACP,CAAC;oBAED,IAAI,CAAC,iBAAiB,GAAG,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;oBAEvD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;wBACpC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;wBAChG,KAAK,CAAC,KAAK,CAAC,oBAAoB,GAAG,IAAI,CAAC,iBAAiB,CAAA;oBAC1D,CAAC;yBAAM,CAAC;wBACP,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;oBAC3C,CAAC;gBACF,CAAC;gBACD,SAAS,EAAE,IAAI,CAAC,GAAG,CAAC,wBAAwB,CAAC;gBAC7C,KAAK,EAAE;oBACN,SAAS,EAAE,QAAQ;iBACnB;gBACD,OAAO,EAAE,CAAC,CAAa,EAAE,EAAE;oBAC1B,CAAC,CAAC,wBAAwB,EAAE,CAAA;oBAC5B,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;wBAC/B,CAAC;wBAAC,CAAC,CAAC,MAAsB,CAAC,aAAa,EAAE,KAAK,EAAE,CAAA;wBACjD,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAA;oBAChC,CAAC;gBACF,CAAC;gBACD,OAAO,EAAE,CAAC,KAAiB,EAAE,EAAE;oBAC9B,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;wBAC/B,CAAC;wBAAC,KAAK,CAAC,MAAsB,CAAC,aAAa,EAAE,KAAK,EAAE,CAAA;wBACrD,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAA;oBAChC,CAAC;gBACF,CAAC;gBACD,MAAM,EAAE,CAAC,KAAiB,EAAE,EAAE;oBAC7B,IAAI,KAAK,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;wBACnC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK,CAAA;wBACnD,KAAK,CAAC,KAAK,CAAC,oBAAoB,GAAG,IAAI,CAAC,iBAAiB,CAAA;oBAC1D,CAAC;yBAAM,IAAI,IAAI,CAAC,iBAAiB,KAAK,CAAC,EAAE,CAAC;wBACzC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK,CAAA;wBACnD,KAAK,CAAC,KAAK,CAAC,oBAAoB,GAAG,IAAI,CAAC,iBAAiB,CAAA;oBAC1D,CAAC;gBACF,CAAC;gBACD,GAAG,EAAE,GAAG;gBACR,GAAG,EAAE,CAAC;gBACN,IAAI,qCAAsB;aAC1B,CAAC;YACH,YAAY,EAAE,CAAC,MAAM,EAAE,EAAE,CACxB,CAAC,CACA,+BAA+B,EAC/B;gBACC,KAAK,EAAE,qEAAqE;aAC5E,EACD,MAAM,CAAC,IAAI,CACX;YACF,SAAS,EAAE,IAAI;SACoC,CAAC,CAAA;IACtD,CAAC;CACD","sourcesContent":["import m, { Child, Children, Component, Vnode } from \"mithril\"\nimport { CalendarEventWhenModel } from \"../eventeditor-model/CalendarEventWhenModel.js\"\nimport { TextFieldType } from \"../../../../common/gui/base/TextField.js\"\nimport { lang } from \"../../../../common/misc/LanguageViewModel.js\"\nimport { EndType, RepeatPeriod, TabIndex } from \"../../../../common/api/common/TutanotaConstants.js\"\nimport { DatePicker, DatePickerAttrs, PickerPosition } from \"../pickers/DatePicker.js\"\n\nimport { createCustomEndTypeOptions, createIntervalValues, createRepeatRuleOptions, customFrequenciesOptions, IntervalOption } from \"../CalendarGuiUtils.js\"\nimport { px, size } from \"../../../../common/gui/size.js\"\nimport { Card } from \"../../../../common/gui/base/Card.js\"\nimport { RadioGroup, RadioGroupAttrs, RadioGroupOption } from \"../../../../common/gui/base/RadioGroup.js\"\nimport { InputMode, SingleLineTextField } from \"../../../../common/gui/base/SingleLineTextField.js\"\nimport { Select, SelectAttributes } from \"../../../../common/gui/base/Select.js\"\nimport stream from \"mithril/stream\"\nimport { Divider } from \"../../../../common/gui/Divider.js\"\nimport { theme } from \"../../../../common/gui/theme.js\"\nimport { isApp } from \"../../../../common/api/common/Env.js\"\n\nexport type RepeatRuleEditorAttrs = {\n\tmodel: CalendarEventWhenModel\n\tstartOfTheWeekOffset: number\n\twidth: number\n\tbackAction: () => void\n}\n\ntype RepeatRuleOption = RepeatPeriod | \"CUSTOM\" | null\n\nexport class RepeatRuleEditor implements Component<RepeatRuleEditorAttrs> {\n\tprivate repeatRuleType: RepeatRuleOption | null = null\n\tprivate repeatInterval: number = 0\n\tprivate intervalOptions: stream<IntervalOption[]> = stream([])\n\tprivate intervalExpanded: boolean = false\n\n\tprivate numberValues: IntervalOption[] = createIntervalValues()\n\n\tprivate occurrencesOptions: stream<IntervalOption[]> = stream([])\n\tprivate occurrencesExpanded: boolean = false\n\tprivate repeatOccurrences: number\n\n\tconstructor({ attrs }: Vnode<RepeatRuleEditorAttrs>) {\n\t\tif (attrs.model.repeatPeriod != null) {\n\t\t\tthis.repeatRuleType = this.getRepeatType(attrs.model.repeatPeriod, attrs.model.repeatInterval, attrs.model.repeatEndType)\n\t\t}\n\n\t\tthis.intervalOptions(this.numberValues)\n\t\tthis.occurrencesOptions(this.numberValues)\n\n\t\tthis.repeatInterval = attrs.model.repeatInterval\n\t\tthis.repeatOccurrences = attrs.model.repeatEndOccurrences\n\t}\n\n\tprivate getRepeatType(period: RepeatPeriod, interval: number, endTime: EndType) {\n\t\tif (interval > 1 || endTime !== EndType.Never) {\n\t\t\treturn \"CUSTOM\"\n\t\t}\n\n\t\treturn period\n\t}\n\n\tview({ attrs }: Vnode<RepeatRuleEditorAttrs>): Children {\n\t\tconst customRuleOptions = customFrequenciesOptions.map((option) => ({\n\t\t\t...option,\n\t\t\tname: attrs.model.repeatInterval > 1 ? option.name.plural : option.name.singular,\n\t\t})) as RadioGroupOption<RepeatPeriod>[]\n\n\t\treturn m(\n\t\t\t\".pb.pt.flex.col.gap-vpad.fit-height\",\n\t\t\t{\n\t\t\t\tclass: this.repeatRuleType === \"CUSTOM\" ? \"box-content\" : \"\",\n\t\t\t\tstyle: {\n\t\t\t\t\twidth: px(attrs.width),\n\t\t\t\t},\n\t\t\t},\n\t\t\t[\n\t\t\t\tm(\n\t\t\t\t\tCard,\n\t\t\t\t\t{\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tpadding: `${size.vpad}px`,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tm(RadioGroup, {\n\t\t\t\t\t\tariaLabel: \"calendarRepeating_label\",\n\t\t\t\t\t\tname: \"calendarRepeating_label\",\n\t\t\t\t\t\toptions: createRepeatRuleOptions(),\n\t\t\t\t\t\tselectedOption: this.repeatRuleType,\n\t\t\t\t\t\tonOptionSelected: (option: RepeatRuleOption) => {\n\t\t\t\t\t\t\tthis.repeatRuleType = option\n\t\t\t\t\t\t\tif (option === \"CUSTOM\") {\n\t\t\t\t\t\t\t\tattrs.model.repeatPeriod = attrs.model.repeatPeriod ?? RepeatPeriod.DAILY\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tattrs.model.repeatInterval = 1\n\t\t\t\t\t\t\t\tattrs.model.repeatEndType = EndType.Never\n\t\t\t\t\t\t\t\tattrs.model.repeatPeriod = option as RepeatPeriod\n\t\t\t\t\t\t\t\tattrs.backAction()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclasses: [\"cursor-pointer\"],\n\t\t\t\t\t} satisfies RadioGroupAttrs<RepeatRuleOption>),\n\t\t\t\t),\n\t\t\t\tthis.renderFrequencyOptions(attrs, customRuleOptions),\n\t\t\t\tthis.renderEndOptions(attrs),\n\t\t\t],\n\t\t)\n\t}\n\n\tprivate renderEndOptions(attrs: RepeatRuleEditorAttrs) {\n\t\tif (this.repeatRuleType !== \"CUSTOM\") {\n\t\t\treturn null\n\t\t}\n\n\t\treturn m(\".flex.col\", [\n\t\t\tm(\"small.uppercase.pb-s.b.text-ellipsis\", { style: { color: theme.navigation_button } }, lang.get(\"calendarRepeatStopCondition_label\")),\n\t\t\tm(\n\t\t\t\tCard,\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tpadding: `${size.vpad}px`,\n\t\t\t\t\t},\n\t\t\t\t\tclasses: [\"flex\", \"col\", \"gap-vpad-s\"],\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\tm(RadioGroup, {\n\t\t\t\t\t\tariaLabel: \"calendarRepeatStopCondition_label\",\n\t\t\t\t\t\tname: \"calendarRepeatStopCondition_label\",\n\t\t\t\t\t\toptions: createCustomEndTypeOptions(),\n\t\t\t\t\t\tselectedOption: attrs.model.repeatEndType,\n\t\t\t\t\t\tonOptionSelected: (option: EndType) => {\n\t\t\t\t\t\t\tattrs.model.repeatEndType = option\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclasses: [\"cursor-pointer\"],\n\t\t\t\t\t\tinjectionMap: this.buildInjections(attrs),\n\t\t\t\t\t} satisfies RadioGroupAttrs<EndType>),\n\t\t\t\t],\n\t\t\t),\n\t\t])\n\t}\n\n\tprivate renderFrequencyOptions(attrs: RepeatRuleEditorAttrs, customRuleOptions: RadioGroupOption<RepeatPeriod>[]) {\n\t\tif (this.repeatRuleType !== \"CUSTOM\") {\n\t\t\treturn null\n\t\t}\n\n\t\treturn m(\".flex.col\", [\n\t\t\tm(\"small.uppercase.pb-s.b.text-ellipsis\", { style: { color: theme.navigation_button } }, lang.get(\"intervalFrequency_label\")),\n\t\t\tm(\n\t\t\t\tCard,\n\t\t\t\t{\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tpadding: `0 0 ${size.vpad}px`,\n\t\t\t\t\t},\n\t\t\t\t\tclasses: [\"flex\", \"col\"],\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\tthis.renderIntervalPicker(attrs),\n\t\t\t\t\tm(Divider, { color: theme.button_bubble_bg, style: { margin: `0 0 ${size.vpad}px` } }),\n\t\t\t\t\tm(RadioGroup, {\n\t\t\t\t\t\tariaLabel: \"intervalFrequency_label\",\n\t\t\t\t\t\tname: \"intervalFrequency_label\",\n\t\t\t\t\t\toptions: customRuleOptions,\n\t\t\t\t\t\tselectedOption: attrs.model.repeatPeriod,\n\t\t\t\t\t\tonOptionSelected: (option: RepeatPeriod) => {\n\t\t\t\t\t\t\tthis.updateCustomRule(attrs.model, { intervalFrequency: option })\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclasses: [\"cursor-pointer\", \"capitalize\", \"pl-vpad-m\", \"pr-vpad-m\"],\n\t\t\t\t\t} satisfies RadioGroupAttrs<RepeatPeriod>),\n\t\t\t\t],\n\t\t\t),\n\t\t])\n\t}\n\n\tprivate buildInjections(attrs: RepeatRuleEditorAttrs) {\n\t\tconst injectionMap = new Map<string, Child>()\n\t\tinjectionMap.set(EndType.Count, this.renderEndsPicker(attrs))\n\n\t\tinjectionMap.set(\n\t\t\tEndType.UntilDate,\n\t\t\tm(DatePicker, {\n\t\t\t\tdate: attrs.model.repeatEndDateForDisplay,\n\t\t\t\tonDateSelected: (date) => date && (attrs.model.repeatEndDateForDisplay = date),\n\t\t\t\tlabel: \"endDate_label\",\n\t\t\t\tuseInputButton: true,\n\t\t\t\tstartOfTheWeekOffset: attrs.startOfTheWeekOffset,\n\t\t\t\tposition: PickerPosition.TOP,\n\t\t\t\tclasses: [\"full-width\", \"flex-grow\", attrs.model.repeatEndType !== EndType.UntilDate ? \"disabled\" : \"\"],\n\t\t\t} satisfies DatePickerAttrs),\n\t\t)\n\n\t\treturn injectionMap\n\t}\n\n\tprivate updateCustomRule(whenModel: CalendarEventWhenModel, customRule: Partial<{ interval: number; intervalFrequency: RepeatPeriod }>) {\n\t\tconst { interval, intervalFrequency } = customRule\n\n\t\tif (interval && !isNaN(interval)) {\n\t\t\twhenModel.repeatInterval = interval\n\t\t}\n\n\t\tif (intervalFrequency) {\n\t\t\twhenModel.repeatPeriod = intervalFrequency\n\t\t}\n\t}\n\n\tprivate renderIntervalPicker(attrs: RepeatRuleEditorAttrs): Children {\n\t\treturn m(Select<IntervalOption, number>, {\n\t\t\tonchange: (newValue) => {\n\t\t\t\tif (this.repeatInterval === newValue.value) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tthis.repeatInterval = newValue.value\n\t\t\t\tthis.updateCustomRule(attrs.model, { interval: this.repeatInterval })\n\t\t\t\tm.redraw.sync()\n\t\t\t},\n\t\t\tonclose: () => {\n\t\t\t\tthis.intervalExpanded = false\n\t\t\t\tthis.intervalOptions(this.numberValues)\n\t\t\t},\n\t\t\tselected: { value: this.repeatInterval, name: this.repeatInterval.toString(), ariaValue: this.repeatInterval.toString() },\n\t\t\tariaLabel: lang.get(\"repeatsEvery_label\"),\n\t\t\toptions: this.intervalOptions,\n\t\t\tnoIcon: true,\n\t\t\texpanded: true,\n\t\t\ttabIndex: isApp() ? Number(TabIndex.Default) : Number(TabIndex.Programmatic),\n\t\t\tclasses: [\"no-appearance\"],\n\t\t\trenderDisplay: () =>\n\t\t\t\tm(SingleLineTextField, {\n\t\t\t\t\tclasses: [\"border-radius-bottom-0\"],\n\t\t\t\t\tvalue: isNaN(this.repeatInterval) ? \"\" : this.repeatInterval.toString(),\n\t\t\t\t\tinputMode: isApp() ? InputMode.NONE : InputMode.TEXT,\n\t\t\t\t\treadonly: isApp(),\n\t\t\t\t\toninput: (val: string) => {\n\t\t\t\t\t\tif (val !== \"\" && this.repeatInterval === Number(val)) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.repeatInterval = val === \"\" ? NaN : Number(val)\n\t\t\t\t\t\tif (!isNaN(this.repeatInterval)) {\n\t\t\t\t\t\t\tthis.intervalOptions(this.numberValues.filter((opt) => opt.value.toString().startsWith(val)))\n\t\t\t\t\t\t\tthis.updateCustomRule(attrs.model, { interval: this.repeatInterval })\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.intervalOptions(this.numberValues)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tariaLabel: lang.get(\"repeatsEvery_label\"),\n\t\t\t\t\tonclick: (e: MouseEvent) => {\n\t\t\t\t\t\te.stopImmediatePropagation()\n\t\t\t\t\t\tif (!this.intervalExpanded) {\n\t\t\t\t\t\t\t;(e.target as HTMLElement).parentElement?.click()\n\t\t\t\t\t\t\tthis.intervalExpanded = true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonfocus: (event: FocusEvent) => {\n\t\t\t\t\t\tif (!this.intervalExpanded) {\n\t\t\t\t\t\t\t;(event.target as HTMLElement).parentElement?.click()\n\t\t\t\t\t\t\tthis.intervalExpanded = true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonblur: (event: FocusEvent) => {\n\t\t\t\t\t\tif (isNaN(this.repeatInterval)) {\n\t\t\t\t\t\t\tthis.repeatInterval = this.numberValues[0].value\n\t\t\t\t\t\t\tthis.updateCustomRule(attrs.model, { interval: this.repeatInterval })\n\t\t\t\t\t\t} else if (this.repeatInterval === 0) {\n\t\t\t\t\t\t\tthis.repeatInterval = this.numberValues[0].value\n\t\t\t\t\t\t\tthis.updateCustomRule(attrs.model, { interval: this.repeatInterval })\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\ttextAlign: \"center\",\n\t\t\t\t\t},\n\t\t\t\t\tmax: 256,\n\t\t\t\t\tmin: 1,\n\t\t\t\t\ttype: TextFieldType.Number,\n\t\t\t\t}),\n\t\t\trenderOption: (option) =>\n\t\t\t\tm(\n\t\t\t\t\t\"button.items-center.flex-grow\",\n\t\t\t\t\t{\n\t\t\t\t\t\tclass: \"state-bg button-content dropdown-button pt-s pb-s button-min-height\",\n\t\t\t\t\t},\n\t\t\t\t\toption.name,\n\t\t\t\t),\n\t\t\tkeepFocus: true,\n\t\t} satisfies SelectAttributes<IntervalOption, number>)\n\t}\n\n\tprivate renderEndsPicker(attrs: RepeatRuleEditorAttrs): Child {\n\t\treturn m(Select<IntervalOption, number>, {\n\t\t\tonchange: (newValue) => {\n\t\t\t\tif (this.repeatOccurrences === newValue.value) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tthis.repeatOccurrences = newValue.value\n\t\t\t\tattrs.model.repeatEndOccurrences = newValue.value\n\t\t\t},\n\t\t\tonclose: () => {\n\t\t\t\tthis.occurrencesExpanded = false\n\t\t\t\tthis.occurrencesOptions(this.numberValues)\n\t\t\t},\n\t\t\tselected: { value: this.repeatOccurrences, name: this.repeatOccurrences.toString(), ariaValue: this.repeatOccurrences.toString() },\n\t\t\tariaLabel: lang.get(\"occurrencesCount_label\"),\n\t\t\toptions: this.occurrencesOptions,\n\t\t\tnoIcon: true,\n\t\t\texpanded: true,\n\t\t\ttabIndex: isApp() ? Number(TabIndex.Default) : Number(TabIndex.Programmatic),\n\t\t\tclasses: [\"no-appearance\"],\n\t\t\trenderDisplay: () =>\n\t\t\t\tm(SingleLineTextField, {\n\t\t\t\t\tclasses: [\"tutaui-button-outline\", \"text-center\", \"border-content-message-bg\"],\n\t\t\t\t\tvalue: isNaN(this.repeatOccurrences) ? \"\" : this.repeatOccurrences.toString(),\n\t\t\t\t\tinputMode: isApp() ? InputMode.NONE : InputMode.TEXT,\n\t\t\t\t\treadonly: isApp(),\n\t\t\t\t\toninput: (val: string) => {\n\t\t\t\t\t\tif (val !== \"\" && this.repeatOccurrences === Number(val)) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.repeatOccurrences = val === \"\" ? NaN : Number(val)\n\n\t\t\t\t\t\tif (!isNaN(this.repeatOccurrences)) {\n\t\t\t\t\t\t\tthis.occurrencesOptions(this.numberValues.filter((opt) => opt.value.toString().startsWith(val)))\n\t\t\t\t\t\t\tattrs.model.repeatEndOccurrences = this.repeatOccurrences\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.occurrencesOptions(this.numberValues)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tariaLabel: lang.get(\"occurrencesCount_label\"),\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\ttextAlign: \"center\",\n\t\t\t\t\t},\n\t\t\t\t\tonclick: (e: MouseEvent) => {\n\t\t\t\t\t\te.stopImmediatePropagation()\n\t\t\t\t\t\tif (!this.occurrencesExpanded) {\n\t\t\t\t\t\t\t;(e.target as HTMLElement).parentElement?.click()\n\t\t\t\t\t\t\tthis.occurrencesExpanded = true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonfocus: (event: FocusEvent) => {\n\t\t\t\t\t\tif (!this.occurrencesExpanded) {\n\t\t\t\t\t\t\t;(event.target as HTMLElement).parentElement?.click()\n\t\t\t\t\t\t\tthis.occurrencesExpanded = true\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonblur: (event: FocusEvent) => {\n\t\t\t\t\t\tif (isNaN(this.repeatOccurrences)) {\n\t\t\t\t\t\t\tthis.repeatOccurrences = this.numberValues[0].value\n\t\t\t\t\t\t\tattrs.model.repeatEndOccurrences = this.repeatOccurrences\n\t\t\t\t\t\t} else if (this.repeatOccurrences === 0) {\n\t\t\t\t\t\t\tthis.repeatOccurrences = this.numberValues[0].value\n\t\t\t\t\t\t\tattrs.model.repeatEndOccurrences = this.repeatOccurrences\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmax: 256,\n\t\t\t\t\tmin: 1,\n\t\t\t\t\ttype: TextFieldType.Number,\n\t\t\t\t}),\n\t\t\trenderOption: (option) =>\n\t\t\t\tm(\n\t\t\t\t\t\"button.items-center.flex-grow\",\n\t\t\t\t\t{\n\t\t\t\t\t\tclass: \"state-bg button-content dropdown-button pt-s pb-s button-min-height\",\n\t\t\t\t\t},\n\t\t\t\t\toption.name,\n\t\t\t\t),\n\t\t\tkeepFocus: true,\n\t\t} satisfies SelectAttributes<IntervalOption, number>)\n\t}\n}\n"]}