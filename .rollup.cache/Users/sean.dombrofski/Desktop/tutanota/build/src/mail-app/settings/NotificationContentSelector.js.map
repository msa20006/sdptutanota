{"version":3,"file":"NotificationContentSelector.js","sourceRoot":"","sources":["../../../../src/mail-app/settings/NotificationContentSelector.ts"],"names":[],"mappings":"AAAA,OAAO,CAAuB,MAAM,SAAS,CAAA;AAC7C,OAAO,EAAE,gBAAgB,EAAyB,MAAM,2CAA2C,CAAA;AACnG,OAAO,EAAE,IAAI,EAAE,MAAM,wCAAwC,CAAA;AAE7D,OAAO,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,gCAAgC,CAAA;AAEjE,OAAO,EAAE,OAAO,EAAE,MAAM,wCAAwC,CAAA;AAChE,OAAO,EAAE,mCAAmC,EAAE,MAAM,wDAAwD,CAAA;AAO5G,MAAM,OAAO,2BAA2B;IACvC,IAAI,CAAC,KAA8C;QAClD,OAAO,CAAC,CAAC,gBAAgB,EAAE;YAC1B,KAAK,EAAE,2BAA2B;YAClC,qDAAqD;YACrD,KAAK,EAAE,SAAS,EAAE;gBACjB,CAAC,CAAC;oBACA;wBACC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,gDAAgD,CAAC;wBAChE,KAAK,sDAA4C;qBACjD;oBACD;wBACC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,yCAAyC,CAAC;wBACzD,KAAK,+CAAqC;qBAC1C;iBACA;gBACH,CAAC,CAAC;oBACA;wBACC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,gDAAgD,CAAC;wBAChE,KAAK,sDAA4C;qBACjD;oBACD;wBACC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,yCAAyC,CAAC;wBACzD,KAAK,+CAAqC;qBAC1C;oBACD;wBACC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,+CAA+C,CAAC;wBAC/D,KAAK,qDAA2C;qBAChD;iBACA;YACJ,aAAa,EAAE,KAAK,CAAC,KAAK,CAAC,wBAAwB;YACnD,uBAAuB,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE;gBAC3C,8EAA8E;gBAC9E,IAAI,KAAK,EAAE,EAAE,CAAC;oBACb,MAAM,+BAA+B,GAAG,MAAM,OAAO,CAAC,uBAAuB,CAAC,aAAa,uCAA6B,CAAA;oBACxH,IAAI,+BAA+B,EAAE,CAAC;wBACrC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;oBAC/B,CAAC;yBAAM,CAAC;wBACP,MAAM,mCAAmC,CAAC,GAAG,EAAE;4BAC9C,kFAAkF;4BAClF,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;wBAC/B,CAAC,CAAC,CAAA;oBACH,CAAC;gBACF,CAAC;qBAAM,CAAC;oBACP,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;gBAC/B,CAAC;YACF,CAAC;YACD,aAAa,EAAE,GAAG;SACwC,CAAC,CAAA;IAC7D,CAAC;CACD","sourcesContent":["import m, { Component, Vnode } from \"mithril\"\nimport { DropDownSelector, DropDownSelectorAttrs } from \"../../common/gui/base/DropDownSelector.js\"\nimport { lang } from \"../../common/misc/LanguageViewModel.js\"\nimport { ExtendedNotificationMode } from \"../../common/native/common/generatedipc/ExtendedNotificationMode.js\"\nimport { isApp, isDesktop } from \"../../common/api/common/Env.js\"\nimport { PermissionType } from \"../../common/native/common/generatedipc/PermissionType.js\"\nimport { locator } from \"../../common/api/main/CommonLocator.js\"\nimport { renderNotificationPermissionsDialog } from \"../../common/settings/NotificationPermissionsDialog.js\"\n\nexport interface NotificationContentSelectorAttrs {\n\textendedNotificationMode: ExtendedNotificationMode\n\tonChange: (value: ExtendedNotificationMode) => void\n}\n\nexport class NotificationContentSelector implements Component<NotificationContentSelectorAttrs> {\n\tview(vnode: Vnode<NotificationContentSelectorAttrs>) {\n\t\treturn m(DropDownSelector, {\n\t\t\tlabel: \"notificationContent_label\",\n\t\t\t// Subject is not available on desktop at the moment.\n\t\t\titems: isDesktop()\n\t\t\t\t? [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: lang.get(\"notificationPreferenceNoSenderOrSubject_action\"),\n\t\t\t\t\t\t\tvalue: ExtendedNotificationMode.NoSenderOrSubject,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: lang.get(\"notificationPreferenceOnlySender_action\"),\n\t\t\t\t\t\t\tvalue: ExtendedNotificationMode.OnlySender,\n\t\t\t\t\t\t},\n\t\t\t\t  ]\n\t\t\t\t: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: lang.get(\"notificationPreferenceNoSenderOrSubject_action\"),\n\t\t\t\t\t\t\tvalue: ExtendedNotificationMode.NoSenderOrSubject,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: lang.get(\"notificationPreferenceOnlySender_action\"),\n\t\t\t\t\t\t\tvalue: ExtendedNotificationMode.OnlySender,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: lang.get(\"notificationPreferenceSenderAndSubject_action\"),\n\t\t\t\t\t\t\tvalue: ExtendedNotificationMode.SenderAndSubject,\n\t\t\t\t\t\t},\n\t\t\t\t  ],\n\t\t\tselectedValue: vnode.attrs.extendedNotificationMode,\n\t\t\tselectionChangedHandler: async (newValue) => {\n\t\t\t\t// Permissions only exist on mobile, so we should not check on other platforms\n\t\t\t\tif (isApp()) {\n\t\t\t\t\tconst isNotificationPermissionGranted = await locator.systemPermissionHandler.hasPermission(PermissionType.Notification)\n\t\t\t\t\tif (isNotificationPermissionGranted) {\n\t\t\t\t\t\tvnode.attrs.onChange(newValue)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tawait renderNotificationPermissionsDialog(() => {\n\t\t\t\t\t\t\t// Switch to the targeted setting regardless of whether the permission was granted\n\t\t\t\t\t\t\tvnode.attrs.onChange(newValue)\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvnode.attrs.onChange(newValue)\n\t\t\t\t}\n\t\t\t},\n\t\t\tdropdownWidth: 250,\n\t\t} satisfies DropDownSelectorAttrs<ExtendedNotificationMode>)\n\t}\n}\n"]}