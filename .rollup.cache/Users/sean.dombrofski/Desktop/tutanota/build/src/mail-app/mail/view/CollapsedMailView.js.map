{"version":3,"file":"CollapsedMailView.js","sourceRoot":"","sources":["../../../../../src/mail-app/mail/view/CollapsedMailView.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component, Vnode } from \"mithril\"\nimport { formatDateWithWeekday, formatTime } from \"../../../common/misc/Formatter.js\"\nimport { MailViewerViewModel } from \"./MailViewerViewModel.js\"\nimport { theme } from \"../../../common/gui/theme.js\"\nimport { AllIcons, Icon } from \"../../../common/gui/base/Icon.js\"\nimport { Icons } from \"../../../common/gui/base/icons/Icons.js\"\nimport { responsiveCardHPadding } from \"../../../common/gui/cards.js\"\nimport { Keys, TabIndex } from \"../../../common/api/common/TutanotaConstants.js\"\nimport { isKeyPressed } from \"../../../common/misc/KeyManager.js\"\nimport { lang } from \"../../../common/misc/LanguageViewModel.js\"\nimport { getMailAddressDisplayText } from \"../../../common/mailFunctionality/SharedMailUtils.js\"\nimport { getConfidentialIcon, getFolderIconByType } from \"./MailGuiUtils.js\"\n\nexport interface CollapsedMailViewAttrs {\n\tviewModel: MailViewerViewModel\n}\n\nexport class CollapsedMailView implements Component<CollapsedMailViewAttrs> {\n\tview({ attrs }: Vnode<CollapsedMailViewAttrs>): Children {\n\t\tconst { viewModel } = attrs\n\t\tconst { mail } = viewModel\n\t\tconst dateTime = formatDateWithWeekday(mail.receivedDate) + \" â€¢ \" + formatTime(mail.receivedDate)\n\t\tconst folderInfo = viewModel.getFolderInfo()\n\t\tif (!folderInfo) return null\n\n\t\treturn m(\n\t\t\t\".flex.items-center.pt.pb.click.no-wrap\",\n\t\t\t{\n\t\t\t\tclass: responsiveCardHPadding(),\n\t\t\t\trole: \"button\",\n\t\t\t\t\"aria-expanded\": \"false\",\n\t\t\t\tstyle: {\n\t\t\t\t\tcolor: theme.content_button,\n\t\t\t\t},\n\t\t\t\tonclick: () => viewModel.expandMail(Promise.resolve()),\n\t\t\t\tonkeyup: (e: KeyboardEvent) => {\n\t\t\t\t\tif (isKeyPressed(e.key, Keys.SPACE)) {\n\t\t\t\t\t\tviewModel.expandMail(Promise.resolve())\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttabindex: TabIndex.Default,\n\t\t\t},\n\t\t\t[\n\t\t\t\tviewModel.isUnread() ? this.renderUnreadDot() : null,\n\t\t\t\tviewModel.isDraftMail() ? m(\".mr-xs\", this.renderIcon(Icons.Edit, lang.get(\"draft_label\"))) : null,\n\t\t\t\tthis.renderSender(viewModel),\n\t\t\t\tm(\".flex.ml-between-s.items-center\", [\n\t\t\t\t\tmail.attachments.length > 0 ? this.renderIcon(Icons.Attachment, lang.get(\"attachment_label\")) : null,\n\t\t\t\t\tviewModel.isConfidential() ? this.renderIcon(getConfidentialIcon(mail), lang.get(\"confidential_label\")) : null,\n\t\t\t\t\tthis.renderIcon(getFolderIconByType(folderInfo.folderType), folderInfo.name),\n\t\t\t\t\tm(\".small.font-weight-600\", dateTime),\n\t\t\t\t]),\n\t\t\t],\n\t\t)\n\t}\n\n\tprivate renderSender(viewModel: MailViewerViewModel) {\n\t\tconst sender = viewModel.getDisplayedSender()\n\t\treturn m(this.getMailAddressDisplayClasses(viewModel), sender == null ? \"\" : getMailAddressDisplayText(sender.name, sender.address, true))\n\t}\n\n\tprivate getMailAddressDisplayClasses(viewModel: MailViewerViewModel): string {\n\t\tlet classes = \".flex-grow.text-ellipsis\"\n\t\tif (viewModel.isUnread()) {\n\t\t\tclasses += \".font-weight-600\"\n\t\t}\n\t\treturn classes\n\t}\n\n\tprivate renderUnreadDot(): Children {\n\t\treturn m(\n\t\t\t\".flex.flex-no-grow.no-shrink.pr-s\",\n\t\t\tm(\".dot.bg-accent-fg\", {\n\t\t\t\tstyle: {\n\t\t\t\t\tmarginTop: 0,\n\t\t\t\t},\n\t\t\t}),\n\t\t)\n\t}\n\n\tprivate renderIcon(icon: AllIcons, hoverText: string | null = null) {\n\t\treturn m(Icon, {\n\t\t\ticon,\n\t\t\tcontainer: \"div\",\n\t\t\tstyle: {\n\t\t\t\tfill: theme.content_button,\n\t\t\t},\n\t\t\thoverText: hoverText,\n\t\t})\n\t}\n}\n"]}