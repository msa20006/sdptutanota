{"version":3,"file":"MailExportViewer.js","sourceRoot":"","sources":["../../../../src/mail-app/settings/MailExportViewer.ts"],"names":[],"mappings":"AAAA,OAAO,CAAe,MAAM,SAAS,CAAA;AACrC,OAAO,EAAE,gBAAgB,EAAE,SAAS,EAAE,WAAW,EAAE,MAAM,6BAA6B,CAAA;AACtF,OAAO,EAAE,IAAI,EAAE,MAAM,qCAAqC,CAAA;AAE1D,OAAO,EAAE,WAAW,EAAE,MAAM,mBAAmB,CAAA;AAC/C,OAAO,EAAE,kBAAkB,EAAE,MAAM,sBAAsB,CAAA;AAEzD,OAAO,EAAE,WAAW,EAAmB,MAAM,2CAA2C,CAAA;AAExF,gBAAgB,EAAE,CAAA;AAElB,MAAM,OAAO,gBAAgB;IACpB,oBAAoB,GAAgC,IAAI,CAAA;IAEhE;QACC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;QAEhC,IAAI,SAAS,EAAE,EAAE,CAAC;YACjB,sCAAsC;YACtC,WAAW,CAAC,oBAAoB,EAAE,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,EAAE;gBACtD,IAAI,CAAC,oBAAoB,GAAG,UAAU,CAAA;gBACtC,CAAC,CAAC,MAAM,EAAE,CAAA;YACX,CAAC,CAAC,CAAA;QACH,CAAC;IACF,CAAC;IAED,IAAI;QACH,OAAO;YACN,CAAC,CACA,mCAAmC,EACnC,CAAC,CAAC,UAAU,EAAE,IAAI,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC,EACnD,SAAS,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,wBAAwB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,6BAA6B,EAAE,CACpF;SACD,CAAA;IACF,CAAC;IAEO,wBAAwB;QAC/B,OAAO,IAAI,CAAC,oBAAoB,IAAI,IAAI;YACvC,CAAC,CAAC,CAAC,CAAC,kBAAkB,EAAE;gBACtB,cAAc,EAAE,WAAW,CAAC,YAAY,CAAC,cAAc,EAAE;gBACzD,MAAM,EAAE,WAAW,CAAC,MAAM;gBAC1B,oBAAoB,EAAE,IAAI,CAAC,oBAAoB;aAC9C,CAAC;YACJ,CAAC,CAAC,IAAI,CAAA;IACR,CAAC;IAEO,6BAA6B;QACpC,OAAO;YACN,CAAC,CACA,iBAAiB,EACjB,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC,EAClD,CAAC,CACA,kBAAkB,EAClB,CAAC,CAAC,WAAW,EAAE;gBACd,IAAI,6CAA2B;gBAC/B,KAAK,EAAE,6BAA6B;gBACpC,OAAO,EAAE,GAAG,EAAE;oBACb,MAAM,wBAAwB,GAAG,2BAA2B,CAAA;oBAC5D,IAAI,WAAW,EAAE,EAAE,CAAC;wBACnB,IAAI,CAAC,wBAAwB,CAAC,CAAA;oBAC/B,CAAC;yBAAM,CAAC;wBACP,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,wBAAwB,CAAC,CAAA;oBAC5D,CAAC;gBACF,CAAC;aACD,CAAC,CACF,EACD,CAAC,CACA,iCAAiC,EACjC,CAAC,CAAC,KAAK,EAAE;gBACR,GAAG,EAAE,GAAG,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,iBAAiB,6CAA6C;gBAC5F,GAAG,EAAE,EAAE;gBACP,GAAG,EAAE,YAAY;gBACjB,OAAO,EAAE,MAAM;gBACf,QAAQ,EAAE,OAAO;gBACjB,KAAK,EAAE,6BAA6B;aACpC,CAAC,CACF,CACD;SACD,CAAA;IACF,CAAC;IAED,KAAK,CAAC,oBAAoB;QACzB,OAAO,OAAO,CAAC,OAAO,EAAE,CAAA;IACzB,CAAC;CACD","sourcesContent":["import m, { Children } from \"mithril\"\nimport { assertMainOrNode, isDesktop, isWebClient } from \"../../common/api/common/Env\"\nimport { lang } from \"../../common/misc/LanguageViewModel\"\nimport { UpdatableSettingsViewer } from \"../../common/settings/Interfaces.js\"\nimport { mailLocator } from \"../mailLocator.js\"\nimport { MailExportSettings } from \"./MailExportSettings\"\nimport { MailExportController } from \"../native/main/MailExportController.js\"\nimport { LoginButton, LoginButtonType } from \"../../common/gui/base/buttons/LoginButton\"\n\nassertMainOrNode()\n\nexport class MailExportViewer implements UpdatableSettingsViewer {\n\tprivate mailExportController: MailExportController | null = null\n\n\tconstructor() {\n\t\tthis.view = this.view.bind(this)\n\n\t\tif (isDesktop()) {\n\t\t\t// export is only available on desktop\n\t\t\tmailLocator.mailExportController().then((controller) => {\n\t\t\t\tthis.mailExportController = controller\n\t\t\t\tm.redraw()\n\t\t\t})\n\t\t}\n\t}\n\n\tview(): Children {\n\t\treturn [\n\t\t\tm(\n\t\t\t\t\".fill-absolute.scroll.plr-l.pb-xl\",\n\t\t\t\tm(\".h4.mt-l\", lang.get(\"mailExportSettings_label\")),\n\t\t\t\tisDesktop() ? this.renderMailExportSettings() : this.renderExportOnlyOnDesktopText(),\n\t\t\t),\n\t\t]\n\t}\n\n\tprivate renderMailExportSettings() {\n\t\treturn this.mailExportController != null\n\t\t\t? m(MailExportSettings, {\n\t\t\t\t\tmailboxDetails: mailLocator.mailboxModel.mailboxDetails(),\n\t\t\t\t\tlogins: mailLocator.logins,\n\t\t\t\t\tmailExportController: this.mailExportController,\n\t\t\t  })\n\t\t\t: null\n\t}\n\n\tprivate renderExportOnlyOnDesktopText() {\n\t\treturn [\n\t\t\tm(\n\t\t\t\t\".flex-column.mt\",\n\t\t\t\tm(\".p\", lang.get(\"mailExportOnlyOnDesktop_label\")),\n\t\t\t\tm(\n\t\t\t\t\t\".flex-start.mt-l\",\n\t\t\t\t\tm(LoginButton, {\n\t\t\t\t\t\ttype: LoginButtonType.FlexWidth,\n\t\t\t\t\t\tlabel: \"downloadDesktopClient_label\",\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tconst desktopClientDownloadUri = \"https://tuta.com#download\"\n\t\t\t\t\t\t\tif (isWebClient()) {\n\t\t\t\t\t\t\t\topen(desktopClientDownloadUri)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmailLocator.systemFacade.openLink(desktopClientDownloadUri)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t\tm(\n\t\t\t\t\t\".flex-v-center.full-width.mt-xl\",\n\t\t\t\t\tm(\"img\", {\n\t\t\t\t\t\tsrc: `${window.tutao.appState.prefixWithoutFile}/images/mail-import/email-import-webapp.svg`,\n\t\t\t\t\t\talt: \"\",\n\t\t\t\t\t\trel: \"noreferrer\",\n\t\t\t\t\t\tloading: \"lazy\",\n\t\t\t\t\t\tdecoding: \"async\",\n\t\t\t\t\t\tclass: \"settings-illustration-large\",\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t),\n\t\t]\n\t}\n\n\tasync entityEventsReceived(): Promise<void> {\n\t\treturn Promise.resolve()\n\t}\n}\n"]}