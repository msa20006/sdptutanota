{"version":3,"file":"mailLocator.js","sourceRoot":"","sources":["../../../src/mail-app/mailLocator.ts"],"names":[],"mappings":"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","sourcesContent":["import { assertMainOrNode, isAndroidApp, isApp, isBrowser, isDesktop, isElectronClient, isIOSApp, isTest } from \"../common/api/common/Env.js\"\nimport { EventController } from \"../common/api/main/EventController.js\"\nimport { SearchModel } from \"./search/model/SearchModel.js\"\nimport { type MailboxDetail, MailboxModel } from \"../common/mailFunctionality/MailboxModel.js\"\nimport { MinimizedMailEditorViewModel } from \"./mail/model/MinimizedMailEditorViewModel.js\"\nimport { ContactModel } from \"../common/contactsFunctionality/ContactModel.js\"\nimport { EntityClient } from \"../common/api/common/EntityClient.js\"\nimport { ProgressTracker } from \"../common/api/main/ProgressTracker.js\"\nimport { CredentialsProvider } from \"../common/misc/credentials/CredentialsProvider.js\"\nimport { bootstrapWorker, WorkerClient } from \"../common/api/main/WorkerClient.js\"\nimport { CALENDAR_MIME_TYPE, FileController, guiDownload, MAIL_MIME_TYPES, VCARD_MIME_TYPES } from \"../common/file/FileController.js\"\nimport { SecondFactorHandler } from \"../common/misc/2fa/SecondFactorHandler.js\"\nimport { WebauthnClient } from \"../common/misc/2fa/webauthn/WebauthnClient.js\"\nimport { LoginFacade } from \"../common/api/worker/facades/LoginFacade.js\"\nimport { LoginController } from \"../common/api/main/LoginController.js\"\nimport { AppHeaderAttrs, Header } from \"../common/gui/Header.js\"\nimport { CustomerFacade } from \"../common/api/worker/facades/lazy/CustomerFacade.js\"\nimport { GiftCardFacade } from \"../common/api/worker/facades/lazy/GiftCardFacade.js\"\nimport { GroupManagementFacade } from \"../common/api/worker/facades/lazy/GroupManagementFacade.js\"\nimport { ConfigurationDatabase } from \"../common/api/worker/facades/lazy/ConfigurationDatabase.js\"\nimport { CalendarFacade } from \"../common/api/worker/facades/lazy/CalendarFacade.js\"\nimport { MailFacade } from \"../common/api/worker/facades/lazy/MailFacade.js\"\nimport { ShareFacade } from \"../common/api/worker/facades/lazy/ShareFacade.js\"\nimport { CounterFacade } from \"../common/api/worker/facades/lazy/CounterFacade.js\"\nimport { Indexer } from \"./workerUtils/index/Indexer.js\"\nimport { SearchFacade } from \"./workerUtils/index/SearchFacade.js\"\nimport { BookingFacade } from \"../common/api/worker/facades/lazy/BookingFacade.js\"\nimport { MailAddressFacade } from \"../common/api/worker/facades/lazy/MailAddressFacade.js\"\nimport { BlobFacade } from \"../common/api/worker/facades/lazy/BlobFacade.js\"\nimport { UserManagementFacade } from \"../common/api/worker/facades/lazy/UserManagementFacade.js\"\nimport { RecoverCodeFacade } from \"../common/api/worker/facades/lazy/RecoverCodeFacade.js\"\nimport { ContactFacade } from \"../common/api/worker/facades/lazy/ContactFacade.js\"\nimport { UsageTestController } from \"@tutao/tutanota-usagetests\"\nimport { EphemeralUsageTestStorage, StorageBehavior, UsageTestModel } from \"../common/misc/UsageTestModel.js\"\nimport { NewsModel } from \"../common/misc/news/NewsModel.js\"\nimport { IServiceExecutor } from \"../common/api/common/ServiceRequest.js\"\nimport { CryptoFacade } from \"../common/api/worker/crypto/CryptoFacade.js\"\nimport { SearchTextInAppFacade } from \"../common/native/common/generatedipc/SearchTextInAppFacade.js\"\nimport { SettingsFacade } from \"../common/native/common/generatedipc/SettingsFacade.js\"\nimport { DesktopSystemFacade } from \"../common/native/common/generatedipc/DesktopSystemFacade.js\"\nimport { WebMobileFacade } from \"../common/native/main/WebMobileFacade.js\"\nimport { SystemPermissionHandler } from \"../common/native/main/SystemPermissionHandler.js\"\nimport { InterWindowEventFacadeSendDispatcher } from \"../common/native/common/generatedipc/InterWindowEventFacadeSendDispatcher.js\"\nimport { ExposedCacheStorage } from \"../common/api/worker/rest/DefaultEntityRestCache.js\"\nimport { WorkerFacade } from \"../common/api/worker/facades/WorkerFacade.js\"\nimport { PageContextLoginListener } from \"../common/api/main/PageContextLoginListener.js\"\nimport { WebsocketConnectivityModel } from \"../common/misc/WebsocketConnectivityModel.js\"\nimport { OperationProgressTracker } from \"../common/api/main/OperationProgressTracker.js\"\nimport { InfoMessageHandler } from \"../common/gui/InfoMessageHandler.js\"\nimport { NativeInterfaces } from \"../common/native/main/NativeInterfaceFactory.js\"\nimport { EntropyFacade } from \"../common/api/worker/facades/EntropyFacade.js\"\nimport { SqlCipherFacade } from \"../common/native/common/generatedipc/SqlCipherFacade.js\"\nimport { assert, assertNotNull, defer, DeferredObject, lazy, lazyAsync, LazyLoaded, lazyMemoized, noOp } from \"@tutao/tutanota-utils\"\nimport { RecipientsModel } from \"../common/api/main/RecipientsModel.js\"\nimport { NoZoneDateProvider } from \"../common/api/common/utils/NoZoneDateProvider.js\"\nimport { CalendarEvent, CalendarEventAttendee, Contact, Mail, MailboxProperties } from \"../common/api/entities/tutanota/TypeRefs.js\"\nimport { SendMailModel } from \"../common/mailFunctionality/SendMailModel.js\"\nimport { OfflineIndicatorViewModel } from \"../common/gui/base/OfflineIndicatorViewModel.js\"\nimport { Router, ScopedRouter, ThrottledRouter } from \"../common/gui/ScopedRouter.js\"\nimport { DeviceConfig, deviceConfig } from \"../common/misc/DeviceConfig.js\"\nimport { InboxRuleHandler } from \"./mail/model/InboxRuleHandler.js\"\nimport { SearchViewModel } from \"./search/view/SearchViewModel.js\"\nimport { SearchRouter } from \"../common/search/view/SearchRouter.js\"\nimport { MailOpenedListener } from \"./mail/view/MailViewModel.js\"\nimport { getEnabledMailAddressesWithUser } from \"../common/mailFunctionality/SharedMailUtils.js\"\nimport { CLIENT_ONLY_CALENDARS, Const, DEFAULT_CLIENT_ONLY_CALENDAR_COLORS, FeatureType, GroupType } from \"../common/api/common/TutanotaConstants.js\"\nimport { ShareableGroupType } from \"../common/sharing/GroupUtils.js\"\nimport { ReceivedGroupInvitationsModel } from \"../common/sharing/model/ReceivedGroupInvitationsModel.js\"\nimport { CalendarViewModel } from \"../calendar-app/calendar/view/CalendarViewModel.js\"\nimport { CalendarEventModel, CalendarOperation } from \"../calendar-app/calendar/gui/eventeditor-model/CalendarEventModel.js\"\nimport { CalendarEventsRepository } from \"../common/calendar/date/CalendarEventsRepository.js\"\nimport { showProgressDialog } from \"../common/gui/dialogs/ProgressDialog.js\"\nimport { ContactSuggestionProvider, RecipientsSearchModel } from \"../common/misc/RecipientsSearchModel.js\"\nimport { ConversationViewModel, ConversationViewModelFactory } from \"./mail/view/ConversationViewModel.js\"\nimport { CreateMailViewerOptions } from \"./mail/view/MailViewer.js\"\nimport { MailViewerViewModel } from \"./mail/view/MailViewerViewModel.js\"\nimport { ExternalLoginViewModel } from \"./mail/view/ExternalLoginView.js\"\nimport { NativeInterfaceMain } from \"../common/native/main/NativeInterfaceMain.js\"\nimport { NativeFileApp } from \"../common/native/common/FileApp.js\"\nimport type { NativePushServiceApp } from \"../common/native/main/NativePushServiceApp.js\"\nimport { CommonSystemFacade } from \"../common/native/common/generatedipc/CommonSystemFacade.js\"\nimport { ThemeFacade } from \"../common/native/common/generatedipc/ThemeFacade.js\"\nimport { MobileSystemFacade } from \"../common/native/common/generatedipc/MobileSystemFacade.js\"\nimport { MobileContactsFacade } from \"../common/native/common/generatedipc/MobileContactsFacade.js\"\nimport { NativeCredentialsFacade } from \"../common/native/common/generatedipc/NativeCredentialsFacade.js\"\nimport { MailAddressNameChanger, MailAddressTableModel } from \"../common/settings/mailaddress/MailAddressTableModel.js\"\nimport { GroupInfo } from \"../common/api/entities/sys/TypeRefs.js\"\nimport { DrawerMenuAttrs } from \"../common/gui/nav/DrawerMenu.js\"\nimport { DomainConfigProvider } from \"../common/api/common/DomainConfigProvider.js\"\nimport { CredentialRemovalHandler } from \"../common/login/CredentialRemovalHandler.js\"\nimport { LoginViewModel } from \"../common/login/LoginViewModel.js\"\nimport { ProgrammingError } from \"../common/api/common/error/ProgrammingError.js\"\nimport { EntropyCollector } from \"../common/api/main/EntropyCollector.js\"\nimport { notifications } from \"../common/gui/Notifications.js\"\nimport { windowFacade } from \"../common/misc/WindowFacade.js\"\nimport { BrowserWebauthn } from \"../common/misc/2fa/webauthn/BrowserWebauthn.js\"\nimport { FileControllerBrowser } from \"../common/file/FileControllerBrowser.js\"\nimport { FileControllerNative } from \"../common/file/FileControllerNative.js\"\nimport { CalendarInfo, CalendarModel } from \"../calendar-app/calendar/model/CalendarModel.js\"\nimport { CalendarInviteHandler } from \"../calendar-app/calendar/view/CalendarInvites.js\"\nimport { AlarmScheduler } from \"../common/calendar/date/AlarmScheduler.js\"\nimport { SchedulerImpl } from \"../common/api/common/utils/Scheduler.js\"\nimport type { CalendarEventPreviewViewModel } from \"../calendar-app/calendar/gui/eventpopup/CalendarEventPreviewViewModel.js\"\nimport { isCustomizationEnabledForCustomer } from \"../common/api/common/utils/CustomerUtils.js\"\nimport { NativeContactsSyncManager } from \"./contacts/model/NativeContactsSyncManager.js\"\nimport { PostLoginActions } from \"../common/login/PostLoginActions.js\"\nimport { CredentialFormatMigrator } from \"../common/misc/credentials/CredentialFormatMigrator.js\"\nimport { AddNotificationEmailDialog } from \"./settings/AddNotificationEmailDialog.js\"\nimport { NativeThemeFacade, ThemeController, WebThemeFacade } from \"../common/gui/ThemeController.js\"\nimport { HtmlSanitizer } from \"../common/misc/HtmlSanitizer.js\"\nimport { theme } from \"../common/gui/theme.js\"\nimport { SearchIndexStateInfo } from \"../common/api/worker/search/SearchTypes.js\"\nimport { MobilePaymentsFacade } from \"../common/native/common/generatedipc/MobilePaymentsFacade.js\"\nimport { MAIL_PREFIX } from \"../common/misc/RouteChange.js\"\nimport { getDisplayedSender } from \"../common/api/common/CommonMailUtils.js\"\nimport { MailModel } from \"./mail/model/MailModel.js\"\nimport { locator } from \"../common/api/main/CommonLocator.js\"\nimport { showSnackBar } from \"../common/gui/base/SnackBar.js\"\nimport { WorkerRandomizer } from \"../common/api/worker/workerInterfaces.js\"\nimport { SearchCategoryTypes } from \"./search/model/SearchUtils.js\"\nimport { WorkerInterface } from \"./workerUtils/worker/WorkerImpl.js\"\nimport { isMailInSpamOrTrash } from \"./mail/model/MailChecks.js\"\nimport type { ContactImporter } from \"./contacts/ContactImporter.js\"\nimport { ExternalCalendarFacade } from \"../common/native/common/generatedipc/ExternalCalendarFacade.js\"\nimport { AppType } from \"../common/misc/ClientConstants.js\"\nimport { ParsedEvent } from \"../common/calendar/import/CalendarImporter.js\"\nimport { lang } from \"../common/misc/LanguageViewModel.js\"\nimport type { CalendarContactPreviewViewModel } from \"../calendar-app/calendar/gui/eventpopup/CalendarContactPreviewViewModel.js\"\nimport { KeyLoaderFacade } from \"../common/api/worker/facades/KeyLoaderFacade.js\"\nimport { ContactSuggestion } from \"../common/native/common/generatedipc/ContactSuggestion\"\nimport { MailImporter } from \"./mail/import/MailImporter.js\"\nimport type { MailExportController } from \"./native/main/MailExportController.js\"\nimport { ExportFacade } from \"../common/native/common/generatedipc/ExportFacade.js\"\nimport { BulkMailLoader } from \"./workerUtils/index/BulkMailLoader.js\"\nimport { MailExportFacade } from \"../common/api/worker/facades/lazy/MailExportFacade.js\"\n\nassertMainOrNode()\n\nclass MailLocator {\n\teventController!: EventController\n\tsearch!: SearchModel\n\tmailboxModel!: MailboxModel\n\tmailModel!: MailModel\n\tminimizedMailModel!: MinimizedMailEditorViewModel\n\tcontactModel!: ContactModel\n\tentityClient!: EntityClient\n\tprogressTracker!: ProgressTracker\n\tcredentialsProvider!: CredentialsProvider\n\tworker!: WorkerClient\n\tfileController!: FileController\n\tsecondFactorHandler!: SecondFactorHandler\n\twebAuthn!: WebauthnClient\n\tloginFacade!: LoginFacade\n\tlogins!: LoginController\n\theader!: Header\n\tcustomerFacade!: CustomerFacade\n\tkeyLoaderFacade!: KeyLoaderFacade\n\tgiftCardFacade!: GiftCardFacade\n\tgroupManagementFacade!: GroupManagementFacade\n\tconfigFacade!: ConfigurationDatabase\n\tcalendarFacade!: CalendarFacade\n\tmailFacade!: MailFacade\n\tshareFacade!: ShareFacade\n\tcounterFacade!: CounterFacade\n\tindexerFacade!: Indexer\n\tsearchFacade!: SearchFacade\n\tbookingFacade!: BookingFacade\n\tmailAddressFacade!: MailAddressFacade\n\tblobFacade!: BlobFacade\n\tuserManagementFacade!: UserManagementFacade\n\trecoverCodeFacade!: RecoverCodeFacade\n\tcontactFacade!: ContactFacade\n\tusageTestController!: UsageTestController\n\tusageTestModel!: UsageTestModel\n\tnewsModel!: NewsModel\n\tserviceExecutor!: IServiceExecutor\n\tcryptoFacade!: CryptoFacade\n\tsearchTextFacade!: SearchTextInAppFacade\n\tdesktopSettingsFacade!: SettingsFacade\n\tdesktopSystemFacade!: DesktopSystemFacade\n\texportFacade!: ExportFacade\n\twebMobileFacade!: WebMobileFacade\n\tsystemPermissionHandler!: SystemPermissionHandler\n\tinterWindowEventSender!: InterWindowEventFacadeSendDispatcher\n\tcacheStorage!: ExposedCacheStorage\n\tworkerFacade!: WorkerFacade\n\tloginListener!: PageContextLoginListener\n\trandom!: WorkerRandomizer\n\tconnectivityModel!: WebsocketConnectivityModel\n\toperationProgressTracker!: OperationProgressTracker\n\tinfoMessageHandler!: InfoMessageHandler\n\tthemeController!: ThemeController\n\tConst!: Record<string, any>\n\tbulkMailLoader!: BulkMailLoader\n\tmailExportFacade!: MailExportFacade\n\n\tprivate nativeInterfaces: NativeInterfaces | null = null\n\tprivate mailImporter: MailImporter | null = null\n\tprivate entropyFacade!: EntropyFacade\n\tprivate sqlCipherFacade!: SqlCipherFacade\n\n\treadonly recipientsModel: lazyAsync<RecipientsModel> = lazyMemoized(async () => {\n\t\tconst { RecipientsModel } = await import(\"../common/api/main/RecipientsModel.js\")\n\t\treturn new RecipientsModel(this.contactModel, this.logins, this.mailFacade, this.entityClient)\n\t})\n\n\tasync noZoneDateProvider(): Promise<NoZoneDateProvider> {\n\t\treturn new NoZoneDateProvider()\n\t}\n\n\tasync sendMailModel(mailboxDetails: MailboxDetail, mailboxProperties: MailboxProperties): Promise<SendMailModel> {\n\t\tconst factory = await this.sendMailModelSyncFactory(mailboxDetails, mailboxProperties)\n\t\treturn factory()\n\t}\n\n\tprivate readonly redraw: lazyAsync<() => unknown> = lazyMemoized(async () => {\n\t\tconst m = await import(\"mithril\")\n\t\treturn m.redraw\n\t})\n\n\treadonly offlineIndicatorViewModel = lazyMemoized(async () => {\n\t\treturn new OfflineIndicatorViewModel(\n\t\t\tthis.cacheStorage,\n\t\t\tthis.loginListener,\n\t\t\tthis.connectivityModel,\n\t\t\tthis.logins,\n\t\t\tthis.progressTracker,\n\t\t\tawait this.redraw(),\n\t\t)\n\t})\n\n\tasync appHeaderAttrs(): Promise<AppHeaderAttrs> {\n\t\treturn {\n\t\t\tofflineIndicatorModel: await this.offlineIndicatorViewModel(),\n\t\t\tnewsModel: this.newsModel,\n\t\t}\n\t}\n\n\treadonly mailViewModel = lazyMemoized(async () => {\n\t\tconst { MailViewModel } = await import(\"../mail-app/mail/view/MailViewModel.js\")\n\t\tconst conversationViewModelFactory = await this.conversationViewModelFactory()\n\t\tconst router = new ScopedRouter(this.throttledRouter(), \"/mail\")\n\t\treturn new MailViewModel(\n\t\t\tthis.mailboxModel,\n\t\t\tthis.mailModel,\n\t\t\tthis.entityClient,\n\t\t\tthis.eventController,\n\t\t\tthis.connectivityModel,\n\t\t\tthis.cacheStorage,\n\t\t\tconversationViewModelFactory,\n\t\t\tthis.mailOpenedListener,\n\t\t\tdeviceConfig,\n\t\t\tthis.inboxRuleHanlder(),\n\t\t\trouter,\n\t\t\tawait this.redraw(),\n\t\t)\n\t})\n\n\treadonly affiliateViewModel = lazyMemoized(async () => {\n\t\tconst { AffiliateViewModel } = await import(\"../common/settings/AffiliateViewModel.js\")\n\t\treturn new AffiliateViewModel()\n\t})\n\n\tinboxRuleHanlder(): InboxRuleHandler {\n\t\treturn new InboxRuleHandler(this.mailFacade, this.logins)\n\t}\n\n\tasync searchViewModelFactory(): Promise<() => SearchViewModel> {\n\t\tconst { SearchViewModel } = await import(\"../mail-app/search/view/SearchViewModel.js\")\n\t\tconst conversationViewModelFactory = await this.conversationViewModelFactory()\n\t\tconst redraw = await this.redraw()\n\t\tconst searchRouter = await this.scopedSearchRouter()\n\t\tconst calendarEventsRepository = await this.calendarEventsRepository()\n\t\treturn () => {\n\t\t\treturn new SearchViewModel(\n\t\t\t\tsearchRouter,\n\t\t\t\tthis.search,\n\t\t\t\tthis.searchFacade,\n\t\t\t\tthis.mailboxModel,\n\t\t\t\tthis.logins,\n\t\t\t\tthis.indexerFacade,\n\t\t\t\tthis.entityClient,\n\t\t\t\tthis.eventController,\n\t\t\t\tthis.mailOpenedListener,\n\t\t\t\tthis.calendarFacade,\n\t\t\t\tthis.progressTracker,\n\t\t\t\tconversationViewModelFactory,\n\t\t\t\tcalendarEventsRepository,\n\t\t\t\tredraw,\n\t\t\t\tdeviceConfig.getMailAutoSelectBehavior(),\n\t\t\t\tdeviceConfig.getClientOnlyCalendars(),\n\t\t\t)\n\t\t}\n\t}\n\n\treadonly throttledRouter: lazy<Router> = lazyMemoized(() => new ThrottledRouter())\n\n\treadonly scopedSearchRouter: lazyAsync<SearchRouter> = lazyMemoized(async () => {\n\t\tconst { SearchRouter } = await import(\"../common/search/view/SearchRouter.js\")\n\t\treturn new SearchRouter(new ScopedRouter(this.throttledRouter(), \"/search\"))\n\t})\n\n\treadonly unscopedSearchRouter: lazyAsync<SearchRouter> = lazyMemoized(async () => {\n\t\tconst { SearchRouter } = await import(\"../common/search/view/SearchRouter.js\")\n\t\treturn new SearchRouter(this.throttledRouter())\n\t})\n\n\treadonly mailOpenedListener: MailOpenedListener = {\n\t\tonEmailOpened: isDesktop()\n\t\t\t? (mail) => {\n\t\t\t\t\tthis.desktopSystemFacade.sendSocketMessage(getDisplayedSender(mail).address)\n\t\t\t  }\n\t\t\t: noOp,\n\t}\n\n\treadonly contactViewModel = lazyMemoized(async () => {\n\t\tconst { ContactViewModel } = await import(\"../mail-app/contacts/view/ContactViewModel.js\")\n\t\tconst router = new ScopedRouter(this.throttledRouter(), \"/contact\")\n\t\treturn new ContactViewModel(this.contactModel, this.entityClient, this.eventController, router, await this.redraw())\n\t})\n\n\treadonly contactListViewModel = lazyMemoized(async () => {\n\t\tconst { ContactListViewModel } = await import(\"../mail-app/contacts/view/ContactListViewModel.js\")\n\t\tconst router = new ScopedRouter(this.throttledRouter(), \"/contactlist\")\n\t\treturn new ContactListViewModel(\n\t\t\tthis.entityClient,\n\t\t\tthis.groupManagementFacade,\n\t\t\tthis.logins,\n\t\t\tthis.eventController,\n\t\t\tthis.contactModel,\n\t\t\tawait this.receivedGroupInvitationsModel(GroupType.ContactList),\n\t\t\trouter,\n\t\t\tawait this.redraw(),\n\t\t)\n\t})\n\n\tasync receivedGroupInvitationsModel<TypeOfGroup extends ShareableGroupType>(groupType: TypeOfGroup): Promise<ReceivedGroupInvitationsModel<TypeOfGroup>> {\n\t\tconst { ReceivedGroupInvitationsModel } = await import(\"../common/sharing/model/ReceivedGroupInvitationsModel.js\")\n\t\treturn new ReceivedGroupInvitationsModel<TypeOfGroup>(groupType, this.eventController, this.entityClient, this.logins)\n\t}\n\n\treadonly calendarViewModel = lazyMemoized<Promise<CalendarViewModel>>(async () => {\n\t\tconst { CalendarViewModel } = await import(\"../calendar-app/calendar/view/CalendarViewModel.js\")\n\t\tconst { DefaultDateProvider } = await import(\"../common/calendar/date/CalendarUtils\")\n\t\tconst timeZone = new DefaultDateProvider().timeZone()\n\t\treturn new CalendarViewModel(\n\t\t\tthis.logins,\n\t\t\tasync (mode: CalendarOperation, event: CalendarEvent) => {\n\t\t\t\tconst mailboxDetail = await this.mailboxModel.getUserMailboxDetails()\n\t\t\t\tconst mailboxProperties = await this.mailboxModel.getMailboxProperties(mailboxDetail.mailboxGroupRoot)\n\t\t\t\treturn await this.calendarEventModel(mode, event, mailboxDetail, mailboxProperties, null)\n\t\t\t},\n\t\t\t(...args) => this.calendarEventPreviewModel(...args),\n\t\t\t(...args) => this.calendarContactPreviewModel(...args),\n\t\t\tawait this.calendarModel(),\n\t\t\tawait this.calendarEventsRepository(),\n\t\t\tthis.entityClient,\n\t\t\tthis.eventController,\n\t\t\tthis.progressTracker,\n\t\t\tdeviceConfig,\n\t\t\tawait this.receivedGroupInvitationsModel(GroupType.Calendar),\n\t\t\ttimeZone,\n\t\t\tthis.mailboxModel,\n\t\t\tthis.contactModel,\n\t\t)\n\t})\n\n\treadonly calendarEventsRepository: lazyAsync<CalendarEventsRepository> = lazyMemoized(async () => {\n\t\tconst { CalendarEventsRepository } = await import(\"../common/calendar/date/CalendarEventsRepository.js\")\n\t\tconst { DefaultDateProvider } = await import(\"../common/calendar/date/CalendarUtils\")\n\t\tconst timeZone = new DefaultDateProvider().timeZone()\n\t\treturn new CalendarEventsRepository(\n\t\t\tawait this.calendarModel(),\n\t\t\tthis.calendarFacade,\n\t\t\ttimeZone,\n\t\t\tthis.entityClient,\n\t\t\tthis.eventController,\n\t\t\tthis.contactModel,\n\t\t\tthis.logins,\n\t\t)\n\t})\n\n\t/** This ugly bit exists because CalendarEventWhoModel wants a sync factory. */\n\tprivate async sendMailModelSyncFactory(mailboxDetails: MailboxDetail, mailboxProperties: MailboxProperties): Promise<() => SendMailModel> {\n\t\tconst { SendMailModel } = await import(\"../common/mailFunctionality/SendMailModel.js\")\n\t\tconst recipientsModel = await this.recipientsModel()\n\t\tconst dateProvider = await this.noZoneDateProvider()\n\t\treturn () =>\n\t\t\tnew SendMailModel(\n\t\t\t\tthis.mailFacade,\n\t\t\t\tthis.entityClient,\n\t\t\t\tthis.logins,\n\t\t\t\tthis.mailboxModel,\n\t\t\t\tthis.contactModel,\n\t\t\t\tthis.eventController,\n\t\t\t\tmailboxDetails,\n\t\t\t\trecipientsModel,\n\t\t\t\tdateProvider,\n\t\t\t\tmailboxProperties,\n\t\t\t\tasync (mail: Mail) => {\n\t\t\t\t\treturn await isMailInSpamOrTrash(mail, mailLocator.mailModel)\n\t\t\t\t},\n\t\t\t)\n\t}\n\n\tasync calendarEventModel(\n\t\teditMode: CalendarOperation,\n\t\tevent: Partial<CalendarEvent>,\n\t\tmailboxDetail: MailboxDetail,\n\t\tmailboxProperties: MailboxProperties,\n\t\tresponseTo: Mail | null,\n\t): Promise<CalendarEventModel | null> {\n\t\tconst [{ makeCalendarEventModel }, { getTimeZone }, { calendarNotificationSender }] = await Promise.all([\n\t\t\timport(\"../calendar-app/calendar/gui/eventeditor-model/CalendarEventModel.js\"),\n\t\t\timport(\"../common/calendar/date/CalendarUtils.js\"),\n\t\t\timport(\"../calendar-app/calendar/view/CalendarNotificationSender.js\"),\n\t\t])\n\t\tconst sendMailModelFactory = await this.sendMailModelSyncFactory(mailboxDetail, mailboxProperties)\n\t\tconst showProgress = <T>(p: Promise<T>) => showProgressDialog(\"pleaseWait_msg\", p)\n\n\t\treturn await makeCalendarEventModel(\n\t\t\teditMode,\n\t\t\tevent,\n\t\t\tawait this.recipientsModel(),\n\t\t\tawait this.calendarModel(),\n\t\t\tthis.logins,\n\t\t\tmailboxDetail,\n\t\t\tmailboxProperties,\n\t\t\tsendMailModelFactory,\n\t\t\tcalendarNotificationSender,\n\t\t\tthis.entityClient,\n\t\t\tresponseTo,\n\t\t\tgetTimeZone(),\n\t\t\tshowProgress,\n\t\t)\n\t}\n\n\tasync recipientsSearchModel(): Promise<RecipientsSearchModel> {\n\t\tconst { RecipientsSearchModel } = await import(\"../common/misc/RecipientsSearchModel.js\")\n\t\tconst suggestionsProvider = await this.contactSuggestionProvider()\n\t\treturn new RecipientsSearchModel(await this.recipientsModel(), this.contactModel, suggestionsProvider, this.entityClient)\n\t}\n\n\tprivate async contactSuggestionProvider(): Promise<ContactSuggestionProvider> {\n\t\tif (isApp()) {\n\t\t\tconst { MobileContactSuggestionProvider } = await import(\"../common/native/main/MobileContactSuggestionProvider.js\")\n\t\t\treturn new MobileContactSuggestionProvider(this.mobileContactsFacade)\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tasync getContactSuggestions(_query: string): Promise<readonly ContactSuggestion[]> {\n\t\t\t\t\treturn []\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\t}\n\n\treadonly conversationViewModelFactory: lazyAsync<ConversationViewModelFactory> = async () => {\n\t\tconst { ConversationViewModel } = await import(\"../mail-app/mail/view/ConversationViewModel.js\")\n\t\tconst factory = await this.mailViewerViewModelFactory()\n\t\tconst m = await import(\"mithril\")\n\t\treturn (options: CreateMailViewerOptions) => {\n\t\t\treturn new ConversationViewModel(\n\t\t\t\toptions,\n\t\t\t\t(options) => factory(options),\n\t\t\t\tthis.entityClient,\n\t\t\t\tthis.eventController,\n\t\t\t\tdeviceConfig,\n\t\t\t\tthis.mailModel,\n\t\t\t\tm.redraw,\n\t\t\t)\n\t\t}\n\t}\n\n\tasync conversationViewModel(options: CreateMailViewerOptions): Promise<ConversationViewModel> {\n\t\tconst factory = await this.conversationViewModelFactory()\n\t\treturn factory(options)\n\t}\n\n\tcontactImporter = async (): Promise<ContactImporter> => {\n\t\tconst { ContactImporter } = await import(\"../mail-app/contacts/ContactImporter.js\")\n\t\treturn new ContactImporter(\n\t\t\tthis.contactFacade,\n\t\t\tthis.systemPermissionHandler,\n\t\t\tisApp() ? this.mobileContactsFacade : null,\n\t\t\tisApp() ? this.nativeContactsSyncManager() : null,\n\t\t)\n\t}\n\n\tasync mailViewerViewModelFactory(): Promise<(options: CreateMailViewerOptions) => MailViewerViewModel> {\n\t\tconst { MailViewerViewModel } = await import(\"../mail-app/mail/view/MailViewerViewModel.js\")\n\t\treturn ({ mail, showFolder }) =>\n\t\t\tnew MailViewerViewModel(\n\t\t\t\tmail,\n\t\t\t\tshowFolder,\n\t\t\t\tthis.entityClient,\n\t\t\t\tthis.mailboxModel,\n\t\t\t\tthis.mailModel,\n\t\t\t\tthis.contactModel,\n\t\t\t\tthis.configFacade,\n\t\t\t\tthis.fileController,\n\t\t\t\tthis.logins,\n\t\t\t\tasync (mailboxDetails) => {\n\t\t\t\t\tconst mailboxProperties = await this.mailboxModel.getMailboxProperties(mailboxDetails.mailboxGroupRoot)\n\t\t\t\t\treturn this.sendMailModel(mailboxDetails, mailboxProperties)\n\t\t\t\t},\n\t\t\t\tthis.eventController,\n\t\t\t\tthis.workerFacade,\n\t\t\t\tthis.search,\n\t\t\t\tthis.mailFacade,\n\t\t\t\tthis.cryptoFacade,\n\t\t\t\t() => this.contactImporter(),\n\t\t\t)\n\t}\n\n\tasync externalLoginViewModelFactory(): Promise<() => ExternalLoginViewModel> {\n\t\tconst { ExternalLoginViewModel } = await import(\"./mail/view/ExternalLoginView.js\")\n\t\treturn () => new ExternalLoginViewModel(this.credentialsProvider)\n\t}\n\n\tget deviceConfig(): DeviceConfig {\n\t\treturn deviceConfig\n\t}\n\n\tget native(): NativeInterfaceMain {\n\t\treturn this.getNativeInterface(\"native\")\n\t}\n\n\tget fileApp(): NativeFileApp {\n\t\treturn this.getNativeInterface(\"fileApp\")\n\t}\n\n\tget pushService(): NativePushServiceApp {\n\t\treturn this.getNativeInterface(\"pushService\")\n\t}\n\n\tget commonSystemFacade(): CommonSystemFacade {\n\t\treturn this.getNativeInterface(\"commonSystemFacade\")\n\t}\n\n\tget themeFacade(): ThemeFacade {\n\t\treturn this.getNativeInterface(\"themeFacade\")\n\t}\n\n\tget externalCalendarFacade(): ExternalCalendarFacade {\n\t\treturn this.getNativeInterface(\"externalCalendarFacade\")\n\t}\n\n\tget systemFacade(): MobileSystemFacade {\n\t\treturn this.getNativeInterface(\"mobileSystemFacade\")\n\t}\n\n\tget mobileContactsFacade(): MobileContactsFacade {\n\t\treturn this.getNativeInterface(\"mobileContactsFacade\")\n\t}\n\n\tget nativeCredentialsFacade(): NativeCredentialsFacade {\n\t\treturn this.getNativeInterface(\"nativeCredentialsFacade\")\n\t}\n\n\tget mobilePaymentsFacade(): MobilePaymentsFacade {\n\t\treturn this.getNativeInterface(\"mobilePaymentsFacade\")\n\t}\n\n\tasync mailAddressTableModelForOwnMailbox(): Promise<MailAddressTableModel> {\n\t\tconst { MailAddressTableModel } = await import(\"../common/settings/mailaddress/MailAddressTableModel.js\")\n\t\tconst nameChanger = await this.ownMailAddressNameChanger()\n\t\treturn new MailAddressTableModel(\n\t\t\tthis.entityClient,\n\t\t\tthis.serviceExecutor,\n\t\t\tthis.mailAddressFacade,\n\t\t\tthis.logins,\n\t\t\tthis.eventController,\n\t\t\tthis.logins.getUserController().userGroupInfo,\n\t\t\tnameChanger,\n\t\t\tawait this.redraw(),\n\t\t)\n\t}\n\n\tasync mailAddressTableModelForAdmin(mailGroupId: Id, userId: Id, userGroupInfo: GroupInfo): Promise<MailAddressTableModel> {\n\t\tconst { MailAddressTableModel } = await import(\"../common/settings/mailaddress/MailAddressTableModel.js\")\n\t\tconst nameChanger = await this.adminNameChanger(mailGroupId, userId)\n\t\treturn new MailAddressTableModel(\n\t\t\tthis.entityClient,\n\t\t\tthis.serviceExecutor,\n\t\t\tthis.mailAddressFacade,\n\t\t\tthis.logins,\n\t\t\tthis.eventController,\n\t\t\tuserGroupInfo,\n\t\t\tnameChanger,\n\t\t\tawait this.redraw(),\n\t\t)\n\t}\n\n\tasync ownMailAddressNameChanger(): Promise<MailAddressNameChanger> {\n\t\tconst { OwnMailAddressNameChanger } = await import(\"../common/settings/mailaddress/OwnMailAddressNameChanger.js\")\n\t\treturn new OwnMailAddressNameChanger(this.mailboxModel, this.entityClient)\n\t}\n\n\tasync adminNameChanger(mailGroupId: Id, userId: Id): Promise<MailAddressNameChanger> {\n\t\tconst { AnotherUserMailAddressNameChanger } = await import(\"../common/settings/mailaddress/AnotherUserMailAddressNameChanger.js\")\n\t\treturn new AnotherUserMailAddressNameChanger(this.mailAddressFacade, mailGroupId, userId)\n\t}\n\n\tasync drawerAttrsFactory(): Promise<() => DrawerMenuAttrs> {\n\t\treturn () => ({\n\t\t\tlogins: this.logins,\n\t\t\tnewsModel: this.newsModel,\n\t\t\tdesktopSystemFacade: this.desktopSystemFacade,\n\t\t})\n\t}\n\n\tdomainConfigProvider(): DomainConfigProvider {\n\t\treturn new DomainConfigProvider()\n\t}\n\n\tasync credentialsRemovalHandler(): Promise<CredentialRemovalHandler> {\n\t\tconst { NoopCredentialRemovalHandler, AppsCredentialRemovalHandler } = await import(\"../common/login/CredentialRemovalHandler.js\")\n\t\treturn isBrowser()\n\t\t\t? new NoopCredentialRemovalHandler()\n\t\t\t: new AppsCredentialRemovalHandler(this.pushService, this.configFacade, async (login, userId) => {\n\t\t\t\t\tif (isApp()) {\n\t\t\t\t\t\tawait mailLocator.nativeContactsSyncManager().disableSync(userId, login)\n\t\t\t\t\t}\n\t\t\t\t\tawait mailLocator.indexerFacade.deleteIndex(userId)\n\t\t\t\t\tif (isDesktop()) {\n\t\t\t\t\t\tawait mailLocator.exportFacade.clearExportState(userId)\n\t\t\t\t\t}\n\t\t\t  })\n\t}\n\n\tasync loginViewModelFactory(): Promise<lazy<LoginViewModel>> {\n\t\tconst { LoginViewModel } = await import(\"../common/login/LoginViewModel.js\")\n\t\tconst credentialsRemovalHandler = await mailLocator.credentialsRemovalHandler()\n\t\tconst { MobileAppLock, NoOpAppLock } = await import(\"../common/login/AppLock.js\")\n\t\tconst appLock = isApp()\n\t\t\t? new MobileAppLock(assertNotNull(this.nativeInterfaces).mobileSystemFacade, assertNotNull(this.nativeInterfaces).nativeCredentialsFacade)\n\t\t\t: new NoOpAppLock()\n\t\treturn () => {\n\t\t\tconst domainConfig = isBrowser()\n\t\t\t\t? mailLocator.domainConfigProvider().getDomainConfigForHostname(location.hostname, location.protocol, location.port)\n\t\t\t\t: // in this case, we know that we have a staticUrl set that we need to use\n\t\t\t\t  mailLocator.domainConfigProvider().getCurrentDomainConfig()\n\n\t\t\treturn new LoginViewModel(\n\t\t\t\tmailLocator.logins,\n\t\t\t\tmailLocator.credentialsProvider,\n\t\t\t\tmailLocator.secondFactorHandler,\n\t\t\t\tdeviceConfig,\n\t\t\t\tdomainConfig,\n\t\t\t\tcredentialsRemovalHandler,\n\t\t\t\tisBrowser() ? null : this.pushService,\n\t\t\t\tappLock,\n\t\t\t)\n\t\t}\n\t}\n\n\tprivate getNativeInterface<T extends keyof NativeInterfaces>(name: T): NativeInterfaces[T] {\n\t\tif (!this.nativeInterfaces) {\n\t\t\tthrow new ProgrammingError(`Tried to use ${name} in web`)\n\t\t}\n\n\t\treturn this.nativeInterfaces[name]\n\t}\n\n\tpublic getMailImporter(): MailImporter {\n\t\tif (this.mailImporter == null) {\n\t\t\tthrow new ProgrammingError(`Tried to use mail importer in web or mobile`)\n\t\t}\n\n\t\treturn this.mailImporter\n\t}\n\n\tprivate readonly _workerDeferred: DeferredObject<WorkerClient>\n\tprivate _entropyCollector!: EntropyCollector\n\tprivate _deferredInitialized: DeferredObject<void> = defer()\n\n\tget initialized(): Promise<void> {\n\t\treturn this._deferredInitialized.promise\n\t}\n\n\tconstructor() {\n\t\tthis._workerDeferred = defer()\n\t}\n\n\tasync init(): Promise<void> {\n\t\t// Split init in two separate parts: creating modules and causing side effects.\n\t\t// We would like to do both on normal init but on HMR we just want to replace modules without a new worker. If we create a new\n\t\t// worker we end up losing state on the worker side (including our session).\n\t\tthis.worker = bootstrapWorker(this)\n\t\tawait this._createInstances()\n\t\tthis._entropyCollector = new EntropyCollector(this.entropyFacade, await this.scheduler(), window)\n\n\t\tthis._entropyCollector.start()\n\n\t\tthis._deferredInitialized.resolve()\n\t}\n\n\tasync _createInstances() {\n\t\tconst {\n\t\t\tloginFacade,\n\t\t\tcustomerFacade,\n\t\t\tgiftCardFacade,\n\t\t\tgroupManagementFacade,\n\t\t\tconfigFacade,\n\t\t\tcalendarFacade,\n\t\t\tmailFacade,\n\t\t\tshareFacade,\n\t\t\tcounterFacade,\n\t\t\tindexerFacade,\n\t\t\tsearchFacade,\n\t\t\tbookingFacade,\n\t\t\tmailAddressFacade,\n\t\t\tblobFacade,\n\t\t\tuserManagementFacade,\n\t\t\trecoverCodeFacade,\n\t\t\trestInterface,\n\t\t\tserviceExecutor,\n\t\t\tcryptoFacade,\n\t\t\tcacheStorage,\n\t\t\trandom,\n\t\t\teventBus,\n\t\t\tentropyFacade,\n\t\t\tworkerFacade,\n\t\t\tsqlCipherFacade,\n\t\t\tcontactFacade,\n\t\t\tbulkMailLoader,\n\t\t\tmailExportFacade,\n\t\t} = this.worker.getWorkerInterface() as WorkerInterface\n\t\tthis.loginFacade = loginFacade\n\t\tthis.customerFacade = customerFacade\n\t\tthis.giftCardFacade = giftCardFacade\n\t\tthis.groupManagementFacade = groupManagementFacade\n\t\tthis.configFacade = configFacade\n\t\tthis.calendarFacade = calendarFacade\n\t\tthis.mailFacade = mailFacade\n\t\tthis.shareFacade = shareFacade\n\t\tthis.counterFacade = counterFacade\n\t\tthis.indexerFacade = indexerFacade\n\t\tthis.searchFacade = searchFacade\n\t\tthis.bookingFacade = bookingFacade\n\t\tthis.mailAddressFacade = mailAddressFacade\n\t\tthis.blobFacade = blobFacade\n\t\tthis.userManagementFacade = userManagementFacade\n\t\tthis.recoverCodeFacade = recoverCodeFacade\n\t\tthis.contactFacade = contactFacade\n\t\tthis.serviceExecutor = serviceExecutor\n\t\tthis.sqlCipherFacade = sqlCipherFacade\n\t\tthis.logins = new LoginController(\n\t\t\tthis.loginFacade,\n\t\t\tasync () => this.loginListener,\n\t\t\t() => this.worker.reset(),\n\t\t)\n\t\t// Should be called elsewhere later e.g. in CommonLocator\n\t\tthis.logins.init()\n\t\tthis.eventController = new EventController(mailLocator.logins)\n\t\tthis.progressTracker = new ProgressTracker()\n\t\tthis.search = new SearchModel(this.searchFacade, () => this.calendarEventsRepository())\n\t\tthis.entityClient = new EntityClient(restInterface)\n\t\tthis.cryptoFacade = cryptoFacade\n\t\tthis.cacheStorage = cacheStorage\n\t\tthis.entropyFacade = entropyFacade\n\t\tthis.workerFacade = workerFacade\n\t\tthis.bulkMailLoader = bulkMailLoader\n\t\tthis.mailExportFacade = mailExportFacade\n\t\tthis.connectivityModel = new WebsocketConnectivityModel(eventBus)\n\t\tthis.mailboxModel = new MailboxModel(this.eventController, this.entityClient, this.logins)\n\t\tthis.mailModel = new MailModel(\n\t\t\tnotifications,\n\t\t\tthis.mailboxModel,\n\t\t\tthis.eventController,\n\t\t\tthis.entityClient,\n\t\t\tthis.logins,\n\t\t\tthis.mailFacade,\n\t\t\tthis.connectivityModel,\n\t\t\tthis.inboxRuleHanlder(),\n\t\t)\n\t\tthis.operationProgressTracker = new OperationProgressTracker()\n\t\tthis.infoMessageHandler = new InfoMessageHandler((state: SearchIndexStateInfo) => {\n\t\t\tmailLocator.search.indexState(state)\n\t\t})\n\n\t\tthis.usageTestModel = new UsageTestModel(\n\t\t\t{\n\t\t\t\t[StorageBehavior.Persist]: deviceConfig,\n\t\t\t\t[StorageBehavior.Ephemeral]: new EphemeralUsageTestStorage(),\n\t\t\t},\n\t\t\t{\n\t\t\t\tnow(): number {\n\t\t\t\t\treturn Date.now()\n\t\t\t\t},\n\t\t\t\ttimeZone(): string {\n\t\t\t\t\tthrow new Error(\"Not implemented by this provider\")\n\t\t\t\t},\n\t\t\t},\n\t\t\tthis.serviceExecutor,\n\t\t\tthis.entityClient,\n\t\t\tthis.logins,\n\t\t\tthis.eventController,\n\t\t\t() => this.usageTestController,\n\t\t)\n\t\tthis.usageTestController = new UsageTestController(this.usageTestModel)\n\n\t\tthis.Const = Const\n\t\tif (!isBrowser()) {\n\t\t\tconst { WebDesktopFacade } = await import(\"../common/native/main/WebDesktopFacade\")\n\t\t\tconst { WebMobileFacade } = await import(\"../common/native/main/WebMobileFacade.js\")\n\t\t\tconst { WebCommonNativeFacade } = await import(\"../common/native/main/WebCommonNativeFacade.js\")\n\t\t\tconst { WebInterWindowEventFacade } = await import(\"../common/native/main/WebInterWindowEventFacade.js\")\n\t\t\tconst { WebAuthnFacadeSendDispatcher } = await import(\"../common/native/common/generatedipc/WebAuthnFacadeSendDispatcher.js\")\n\t\t\tconst { OpenMailboxHandler } = await import(\"./native/main/OpenMailboxHandler.js\")\n\t\t\tconst { createNativeInterfaces, createDesktopInterfaces } = await import(\"../common/native/main/NativeInterfaceFactory.js\")\n\t\t\tconst openMailboxHandler = new OpenMailboxHandler(this.logins, this.mailModel, this.mailboxModel)\n\t\t\tconst { OpenCalendarHandler } = await import(\"../common/native/main/OpenCalendarHandler.js\")\n\t\t\tconst openCalendarHandler = new OpenCalendarHandler(this.logins)\n\t\t\tconst { OpenSettingsHandler } = await import(\"../common/native/main/OpenSettingsHandler.js\")\n\t\t\tconst openSettingsHandler = new OpenSettingsHandler(this.logins)\n\n\t\t\tthis.webMobileFacade = new WebMobileFacade(this.connectivityModel, MAIL_PREFIX)\n\n\t\t\tthis.nativeInterfaces = createNativeInterfaces(\n\t\t\t\tthis.webMobileFacade,\n\t\t\t\tnew WebDesktopFacade(this.logins, async () => this.native),\n\t\t\t\tnew WebInterWindowEventFacade(this.logins, windowFacade, deviceConfig),\n\t\t\t\tnew WebCommonNativeFacade(\n\t\t\t\t\tthis.logins,\n\t\t\t\t\tthis.mailboxModel,\n\t\t\t\t\tthis.usageTestController,\n\t\t\t\t\tasync () => this.fileApp,\n\t\t\t\t\tasync () => this.pushService,\n\t\t\t\t\tthis.handleFileImport.bind(this),\n\t\t\t\t\t(userId, address, requestedPath) => openMailboxHandler.openMailbox(userId, address, requestedPath),\n\t\t\t\t\t(userId) => openCalendarHandler.openCalendar(userId),\n\t\t\t\t\tAppType.Integrated,\n\t\t\t\t\t(path) => openSettingsHandler.openSettings(path),\n\t\t\t\t),\n\t\t\t\tcryptoFacade,\n\t\t\t\tcalendarFacade,\n\t\t\t\tthis.entityClient,\n\t\t\t\tthis.logins,\n\t\t\t\tAppType.Integrated,\n\t\t\t)\n\n\t\t\tthis.credentialsProvider = await this.createCredentialsProvider()\n\t\t\tif (isElectronClient()) {\n\t\t\t\tconst desktopInterfaces = createDesktopInterfaces(this.native)\n\t\t\t\tthis.searchTextFacade = desktopInterfaces.searchTextFacade\n\t\t\t\tthis.interWindowEventSender = desktopInterfaces.interWindowEventSender\n\t\t\t\tthis.webAuthn = new WebauthnClient(new WebAuthnFacadeSendDispatcher(this.native), this.domainConfigProvider(), isApp())\n\t\t\t\tif (isDesktop()) {\n\t\t\t\t\tthis.desktopSettingsFacade = desktopInterfaces.desktopSettingsFacade\n\t\t\t\t\tthis.desktopSystemFacade = desktopInterfaces.desktopSystemFacade\n\t\t\t\t\tthis.mailImporter = new MailImporter(\n\t\t\t\t\t\tthis.domainConfigProvider(),\n\t\t\t\t\t\tthis.logins,\n\t\t\t\t\t\tthis.mailboxModel,\n\t\t\t\t\t\tthis.entityClient,\n\t\t\t\t\t\tthis.eventController,\n\t\t\t\t\t\tthis.credentialsProvider,\n\t\t\t\t\t\tdesktopInterfaces.nativeMailImportFacade,\n\t\t\t\t\t\topenSettingsHandler,\n\t\t\t\t\t)\n\t\t\t\t\tthis.exportFacade = desktopInterfaces.exportFacade\n\t\t\t\t}\n\t\t\t} else if (isAndroidApp() || isIOSApp()) {\n\t\t\t\tconst { SystemPermissionHandler } = await import(\"../common/native/main/SystemPermissionHandler.js\")\n\t\t\t\tthis.systemPermissionHandler = new SystemPermissionHandler(this.systemFacade)\n\t\t\t\tthis.webAuthn = new WebauthnClient(new WebAuthnFacadeSendDispatcher(this.native), this.domainConfigProvider(), isApp())\n\t\t\t}\n\t\t} else {\n\t\t\tthis.credentialsProvider = await this.createCredentialsProvider()\n\t\t}\n\n\t\tif (this.webAuthn == null) {\n\t\t\tthis.webAuthn = new WebauthnClient(\n\t\t\t\tnew BrowserWebauthn(navigator.credentials, this.domainConfigProvider().getCurrentDomainConfig()),\n\t\t\t\tthis.domainConfigProvider(),\n\t\t\t\tisApp(),\n\t\t\t)\n\t\t}\n\t\tthis.secondFactorHandler = new SecondFactorHandler(\n\t\t\tthis.eventController,\n\t\t\tthis.entityClient,\n\t\t\tthis.webAuthn,\n\t\t\tthis.loginFacade,\n\t\t\tthis.domainConfigProvider(),\n\t\t)\n\n\t\tthis.loginListener = new PageContextLoginListener(this.secondFactorHandler, this.credentialsProvider)\n\t\tthis.random = random\n\n\t\tthis.newsModel = new NewsModel(this.serviceExecutor, deviceConfig, async (name: string) => {\n\t\t\tswitch (name) {\n\t\t\t\tcase \"usageOptIn\": {\n\t\t\t\t\tconst { UsageOptInNews } = await import(\"../common/misc/news/items/UsageOptInNews.js\")\n\t\t\t\t\treturn new UsageOptInNews(this.newsModel, this.usageTestModel)\n\t\t\t\t}\n\t\t\t\tcase \"recoveryCode\": {\n\t\t\t\t\tconst { RecoveryCodeNews } = await import(\"../common/misc/news/items/RecoveryCodeNews.js\")\n\t\t\t\t\treturn new RecoveryCodeNews(this.newsModel, this.logins.getUserController(), this.recoverCodeFacade)\n\t\t\t\t}\n\t\t\t\tcase \"pinBiometrics\": {\n\t\t\t\t\tconst { PinBiometricsNews } = await import(\"../common/misc/news/items/PinBiometricsNews.js\")\n\t\t\t\t\treturn new PinBiometricsNews(this.newsModel, this.credentialsProvider, this.logins.getUserController().userId)\n\t\t\t\t}\n\t\t\t\tcase \"referralLink\": {\n\t\t\t\t\tconst { ReferralLinkNews } = await import(\"../common/misc/news/items/ReferralLinkNews.js\")\n\t\t\t\t\tconst dateProvider = await this.noZoneDateProvider()\n\t\t\t\t\treturn new ReferralLinkNews(this.newsModel, dateProvider, this.logins.getUserController())\n\t\t\t\t}\n\t\t\t\tcase \"richNotifications\": {\n\t\t\t\t\tconst { RichNotificationsNews } = await import(\"../common/misc/news/items/RichNotificationsNews.js\")\n\t\t\t\t\treturn new RichNotificationsNews(this.newsModel, isApp() || isDesktop() ? this.pushService : null)\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(`No implementation for news named '${name}'`)\n\t\t\t\t\treturn null\n\t\t\t}\n\t\t})\n\n\t\tthis.fileController =\n\t\t\tthis.nativeInterfaces == null\n\t\t\t\t? new FileControllerBrowser(blobFacade, guiDownload)\n\t\t\t\t: new FileControllerNative(blobFacade, guiDownload, this.nativeInterfaces.fileApp)\n\n\t\tconst { ContactModel } = await import(\"../common/contactsFunctionality/ContactModel.js\")\n\t\tthis.contactModel = new ContactModel(\n\t\t\tthis.entityClient,\n\t\t\tthis.logins,\n\t\t\tthis.eventController,\n\t\t\tasync (query: string, field: string, minSuggestionCount: number, maxResults?: number) => {\n\t\t\t\tconst { createRestriction } = await import(\"./search/model/SearchUtils.js\")\n\t\t\t\treturn mailLocator.searchFacade.search(\n\t\t\t\t\tquery,\n\t\t\t\t\tcreateRestriction(SearchCategoryTypes.contact, null, null, field, [], null),\n\t\t\t\t\tminSuggestionCount,\n\t\t\t\t\tmaxResults,\n\t\t\t\t)\n\t\t\t},\n\t\t)\n\t\tthis.minimizedMailModel = new MinimizedMailEditorViewModel()\n\n\t\t// THEME\n\t\t// We need it because we want to run tests in node and real HTMLSanitizer does not work there.\n\t\tconst sanitizerStub: Partial<HtmlSanitizer> = {\n\t\t\tsanitizeHTML: () => {\n\t\t\t\treturn {\n\t\t\t\t\thtml: \"\",\n\t\t\t\t\tblockedExternalContent: 0,\n\t\t\t\t\tinlineImageCids: [],\n\t\t\t\t\tlinks: [],\n\t\t\t\t}\n\t\t\t},\n\t\t\tsanitizeSVG(svg, configExtra?) {\n\t\t\t\tthrow new Error(\"stub!\")\n\t\t\t},\n\t\t\tsanitizeFragment(html, configExtra?) {\n\t\t\t\tthrow new Error(\"stub!\")\n\t\t\t},\n\t\t}\n\t\tconst selectedThemeFacade =\n\t\t\tisApp() || isDesktop() ? new NativeThemeFacade(new LazyLoaded<ThemeFacade>(async () => mailLocator.themeFacade)) : new WebThemeFacade(deviceConfig)\n\t\tconst lazySanitizer = isTest()\n\t\t\t? () => Promise.resolve(sanitizerStub as HtmlSanitizer)\n\t\t\t: () => import(\"../common/misc/HtmlSanitizer\").then(({ htmlSanitizer }) => htmlSanitizer)\n\n\t\tthis.themeController = new ThemeController(theme, selectedThemeFacade, lazySanitizer, AppType.Mail)\n\n\t\t// For native targets WebCommonNativeFacade notifies themeController because Android and Desktop do not seem to work reliably via media queries\n\t\tif (selectedThemeFacade instanceof WebThemeFacade) {\n\t\t\tselectedThemeFacade.addDarkListener(() => mailLocator.themeController.reloadTheme())\n\t\t}\n\t}\n\n\treadonly calendarModel: () => Promise<CalendarModel> = lazyMemoized(async () => {\n\t\tconst { DefaultDateProvider } = await import(\"../common/calendar/date/CalendarUtils\")\n\t\tconst { CalendarModel } = await import(\"../calendar-app/calendar/model/CalendarModel\")\n\t\tconst timeZone = new DefaultDateProvider().timeZone()\n\t\treturn new CalendarModel(\n\t\t\tnotifications,\n\t\t\tthis.alarmScheduler,\n\t\t\tthis.eventController,\n\t\t\tthis.serviceExecutor,\n\t\t\tthis.logins,\n\t\t\tthis.progressTracker,\n\t\t\tthis.entityClient,\n\t\t\tthis.mailboxModel,\n\t\t\tthis.calendarFacade,\n\t\t\tthis.fileController,\n\t\t\ttimeZone,\n\t\t\t!isBrowser() ? this.externalCalendarFacade : null,\n\t\t\tdeviceConfig,\n\t\t\t!isBrowser() ? this.pushService : null,\n\t\t)\n\t})\n\n\treadonly calendarInviteHandler: () => Promise<CalendarInviteHandler> = lazyMemoized(async () => {\n\t\tconst { CalendarInviteHandler } = await import(\"../calendar-app/calendar/view/CalendarInvites.js\")\n\t\tconst { calendarNotificationSender } = await import(\"../calendar-app/calendar/view/CalendarNotificationSender.js\")\n\t\treturn new CalendarInviteHandler(this.mailboxModel, await this.calendarModel(), this.logins, calendarNotificationSender, (...arg) =>\n\t\t\tthis.sendMailModel(...arg),\n\t\t)\n\t})\n\n\tprivate async handleFileImport(filesUris: ReadonlyArray<string>) {\n\t\tconst files = await this.fileApp.getFilesMetaData(filesUris)\n\t\tconst areAllFilesVCard = files.every((file) => file.mimeType === VCARD_MIME_TYPES.X_VCARD || file.mimeType === VCARD_MIME_TYPES.VCARD)\n\t\tconst areAllFilesICS = files.every((file) => file.mimeType === CALENDAR_MIME_TYPE)\n\t\tconst areAllFilesMail = files.every((file) => file.mimeType === MAIL_MIME_TYPES.EML || file.mimeType === MAIL_MIME_TYPES.MBOX)\n\n\t\tif (areAllFilesVCard) {\n\t\t\tconst importer = await this.contactImporter()\n\t\t\tconst { parseContacts } = await import(\"../mail-app/contacts/ContactImporter.js\")\n\t\t\t// For now, we just handle .vcf files, so we don't need to care about the file type\n\t\t\tconst contacts = await parseContacts(files, this.fileApp)\n\t\t\tconst vCardData = contacts.join(\"\\n\")\n\t\t\tconst contactListId = assertNotNull(await this.contactModel.getContactListId())\n\n\t\t\tawait importer.importContactsFromFile(vCardData, contactListId)\n\t\t} else if (areAllFilesICS) {\n\t\t\tconst calendarModel = await this.calendarModel()\n\t\t\tconst groupSettings = this.logins.getUserController().userSettingsGroupRoot.groupSettings\n\t\t\tconst calendarInfos = await calendarModel.getCalendarInfos()\n\t\t\tconst groupColors: Map<Id, string> = groupSettings.reduce((acc, gc) => {\n\t\t\t\tacc.set(gc.group, gc.color)\n\t\t\t\treturn acc\n\t\t\t}, new Map())\n\n\t\t\tconst { calendarSelectionDialog, parseCalendarFile } = await import(\"../common/calendar/import/CalendarImporter.js\")\n\t\t\tconst { handleCalendarImport } = await import(\"../common/calendar/import/CalendarImporterDialog.js\")\n\n\t\t\tlet parsedEvents: ParsedEvent[] = []\n\n\t\t\tfor (const fileRef of files) {\n\t\t\t\tconst dataFile = await this.fileApp.readDataFile(fileRef.location)\n\t\t\t\tif (dataFile == null) continue\n\n\t\t\t\tconst data = parseCalendarFile(dataFile)\n\t\t\t\tparsedEvents.push(...data.contents)\n\t\t\t}\n\n\t\t\tcalendarSelectionDialog(Array.from(calendarInfos.values()), this.logins.getUserController(), groupColors, (dialog, selectedCalendar) => {\n\t\t\t\tdialog.close()\n\t\t\t\thandleCalendarImport(selectedCalendar.groupRoot, parsedEvents)\n\t\t\t})\n\t\t}\n\t}\n\n\tprivate alarmScheduler: () => Promise<AlarmScheduler> = lazyMemoized(async () => {\n\t\tconst { AlarmScheduler } = await import(\"../common/calendar/date/AlarmScheduler\")\n\t\tconst { DefaultDateProvider } = await import(\"../common/calendar/date/CalendarUtils\")\n\t\tconst dateProvider = new DefaultDateProvider()\n\t\treturn new AlarmScheduler(dateProvider, await this.scheduler())\n\t})\n\n\tprivate async scheduler(): Promise<SchedulerImpl> {\n\t\tconst dateProvider = await this.noZoneDateProvider()\n\t\treturn new SchedulerImpl(dateProvider, window, window)\n\t}\n\n\tasync calendarEventPreviewModel(selectedEvent: CalendarEvent, calendars: ReadonlyMap<string, CalendarInfo>): Promise<CalendarEventPreviewViewModel> {\n\t\tconst { findAttendeeInAddresses } = await import(\"../common/api/common/utils/CommonCalendarUtils.js\")\n\t\tconst { getEventType } = await import(\"../calendar-app/calendar/gui/CalendarGuiUtils.js\")\n\t\tconst { CalendarEventPreviewViewModel } = await import(\"../calendar-app/calendar/gui/eventpopup/CalendarEventPreviewViewModel.js\")\n\n\t\tconst mailboxDetails = await this.mailboxModel.getUserMailboxDetails()\n\n\t\tconst mailboxProperties = await this.mailboxModel.getMailboxProperties(mailboxDetails.mailboxGroupRoot)\n\n\t\tconst userController = this.logins.getUserController()\n\t\tconst customer = await userController.loadCustomer()\n\t\tconst ownMailAddresses = getEnabledMailAddressesWithUser(mailboxDetails, userController.userGroupInfo)\n\t\tconst ownAttendee: CalendarEventAttendee | null = findAttendeeInAddresses(selectedEvent.attendees, ownMailAddresses)\n\t\tconst eventType = getEventType(selectedEvent, calendars, ownMailAddresses, userController)\n\t\tconst hasBusinessFeature = isCustomizationEnabledForCustomer(customer, FeatureType.BusinessFeatureEnabled) || (await userController.isNewPaidPlan())\n\t\tconst lazyIndexEntry = async () => (selectedEvent.uid != null ? this.calendarFacade.getEventsByUid(selectedEvent.uid) : null)\n\t\tconst popupModel = new CalendarEventPreviewViewModel(\n\t\t\tselectedEvent,\n\t\t\tawait this.calendarModel(),\n\t\t\teventType,\n\t\t\thasBusinessFeature,\n\t\t\townAttendee,\n\t\t\tlazyIndexEntry,\n\t\t\tasync (mode: CalendarOperation) => this.calendarEventModel(mode, selectedEvent, mailboxDetails, mailboxProperties, null),\n\t\t)\n\n\t\t// If we have a preview model we want to display the description\n\t\t// so makes sense to already sanitize it after building the event\n\t\tawait popupModel.sanitizeDescription()\n\n\t\treturn popupModel\n\t}\n\n\tasync calendarContactPreviewModel(event: CalendarEvent, contact: Contact, canEdit: boolean): Promise<CalendarContactPreviewViewModel> {\n\t\tconst { CalendarContactPreviewViewModel } = await import(\"../calendar-app/calendar/gui/eventpopup/CalendarContactPreviewViewModel.js\")\n\t\treturn new CalendarContactPreviewViewModel(event, contact, canEdit)\n\t}\n\n\treadonly nativeContactsSyncManager: () => NativeContactsSyncManager = lazyMemoized(() => {\n\t\tassert(isApp(), \"isApp\")\n\t\treturn new NativeContactsSyncManager(this.logins, this.mobileContactsFacade, this.entityClient, this.eventController, this.contactModel, deviceConfig)\n\t})\n\n\tpostLoginActions: () => Promise<PostLoginActions> = lazyMemoized(async () => {\n\t\tconst { PostLoginActions } = await import(\"../common/login/PostLoginActions\")\n\t\treturn new PostLoginActions(\n\t\t\tthis.credentialsProvider,\n\t\t\tthis.secondFactorHandler,\n\t\t\tthis.connectivityModel,\n\t\t\tthis.logins,\n\t\t\tawait this.noZoneDateProvider(),\n\t\t\tthis.entityClient,\n\t\t\tthis.userManagementFacade,\n\t\t\tthis.customerFacade,\n\t\t\tthis.themeController,\n\t\t\t() => this.showSetupWizard(),\n\t\t\t() => this.handleExternalSync(),\n\t\t\t() => this.setUpClientOnlyCalendars(),\n\t\t)\n\t})\n\n\tshowSetupWizard = async () => {\n\t\tif (isApp()) {\n\t\t\tconst { showSetupWizard } = await import(\"../common/native/main/wizard/SetupWizard.js\")\n\t\t\treturn showSetupWizard(\n\t\t\t\tthis.systemPermissionHandler,\n\t\t\t\tthis.webMobileFacade,\n\t\t\t\tawait this.contactImporter(),\n\t\t\t\tthis.systemFacade,\n\t\t\t\tthis.credentialsProvider,\n\t\t\t\tawait this.nativeContactsSyncManager(),\n\t\t\t\tdeviceConfig,\n\t\t\t\ttrue,\n\t\t\t)\n\t\t}\n\t}\n\n\tasync handleExternalSync() {\n\t\tconst calendarModel = await locator.calendarModel()\n\n\t\tif (isApp() || isDesktop()) {\n\t\t\tcalendarModel.syncExternalCalendars().catch(async (e) => {\n\t\t\t\tshowSnackBar({\n\t\t\t\t\tmessage: lang.makeTranslation(\"exception_msg\", e.message),\n\t\t\t\t\tbutton: {\n\t\t\t\t\t\tlabel: \"ok_action\",\n\t\t\t\t\t\tclick: noOp,\n\t\t\t\t\t},\n\t\t\t\t\twaitingTime: 1000,\n\t\t\t\t})\n\t\t\t})\n\t\t\tcalendarModel.scheduleExternalCalendarSync()\n\t\t}\n\t}\n\n\tsetUpClientOnlyCalendars() {\n\t\tlet configs = deviceConfig.getClientOnlyCalendars()\n\n\t\tfor (const [id, name] of CLIENT_ONLY_CALENDARS.entries()) {\n\t\t\tconst calendarId = `${this.logins.getUserController().userId}#${id}`\n\t\t\tconst config = configs.get(calendarId)\n\t\t\tif (!config)\n\t\t\t\tdeviceConfig.updateClientOnlyCalendars(calendarId, {\n\t\t\t\t\tname: lang.get(name),\n\t\t\t\t\tcolor: DEFAULT_CLIENT_ONLY_CALENDAR_COLORS.get(id)!,\n\t\t\t\t})\n\t\t}\n\t}\n\n\treadonly credentialFormatMigrator: () => Promise<CredentialFormatMigrator> = lazyMemoized(async () => {\n\t\tconst { CredentialFormatMigrator } = await import(\"../common/misc/credentials/CredentialFormatMigrator.js\")\n\t\tif (isDesktop()) {\n\t\t\treturn new CredentialFormatMigrator(deviceConfig, this.nativeCredentialsFacade, null)\n\t\t} else if (isApp()) {\n\t\t\treturn new CredentialFormatMigrator(deviceConfig, this.nativeCredentialsFacade, this.systemFacade)\n\t\t} else {\n\t\t\treturn new CredentialFormatMigrator(deviceConfig, null, null)\n\t\t}\n\t})\n\n\tasync addNotificationEmailDialog(): Promise<AddNotificationEmailDialog> {\n\t\tconst { AddNotificationEmailDialog } = await import(\"../mail-app/settings/AddNotificationEmailDialog.js\")\n\t\treturn new AddNotificationEmailDialog(this.logins, this.entityClient)\n\t}\n\n\treadonly mailExportController: () => Promise<MailExportController> = lazyMemoized(async () => {\n\t\tconst { htmlSanitizer } = await import(\"../common/misc/HtmlSanitizer\")\n\t\tconst { MailExportController } = await import(\"./native/main/MailExportController.js\")\n\t\treturn new MailExportController(this.mailExportFacade, htmlSanitizer, this.exportFacade, this.logins, this.mailboxModel, await this.scheduler())\n\t})\n\n\t/**\n\t * Factory method for credentials provider that will return an instance injected with the implementations appropriate for the platform.\n\t */\n\tprivate async createCredentialsProvider(): Promise<CredentialsProvider> {\n\t\tconst { CredentialsProvider } = await import(\"../common/misc/credentials/CredentialsProvider.js\")\n\t\tif (isDesktop() || isApp()) {\n\t\t\treturn new CredentialsProvider(this.nativeCredentialsFacade, this.sqlCipherFacade, isDesktop() ? this.interWindowEventSender : null)\n\t\t} else {\n\t\t\tconst { WebCredentialsFacade } = await import(\"../common/misc/credentials/WebCredentialsFacade.js\")\n\t\t\treturn new CredentialsProvider(new WebCredentialsFacade(deviceConfig), null, null)\n\t\t}\n\t}\n}\n\nexport type IMailLocator = Readonly<MailLocator>\n\nexport const mailLocator: IMailLocator = new MailLocator()\n\nif (typeof window !== \"undefined\") {\n\twindow.tutao.locator = mailLocator\n}\n"]}