{"version":3,"file":"ContactViewerActions.js","sourceRoot":"","sources":["../../../../../src/mail-app/contacts/view/ContactViewerActions.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Component, Vnode, VnodeDOM } from \"mithril\"\nimport { Contact } from \"../../../common/api/entities/tutanota/TypeRefs.js\"\nimport { IconButton } from \"../../../common/gui/base/IconButton.js\"\nimport { Icons } from \"../../../common/gui/base/icons/Icons.js\"\nimport { keyManager, Shortcut } from \"../../../common/misc/KeyManager.js\"\nimport { Keys } from \"../../../common/api/common/TutanotaConstants.js\"\n\nexport interface ContactViewToolbarAttrs {\n\tcontacts: Contact[]\n\tonEdit: (contact: Contact) => unknown\n\tonDelete: (contacts: Contact[]) => unknown\n\tonMerge: (left: Contact, right: Contact) => unknown\n\tonExport: (contacts: Contact[]) => unknown\n}\n\n/**\n * Displays actions for contact or multiple contacts.\n * Also registers shortcuts\n */\nexport class ContactViewerActions implements Component<ContactViewToolbarAttrs> {\n\tprivate shortcuts: Array<Shortcut> = []\n\n\tview({ attrs }: Vnode<ContactViewToolbarAttrs>): Children {\n\t\tconst { contacts, onDelete, onEdit, onMerge, onExport } = attrs\n\t\tconst actionButtons: Children[] = []\n\t\tif (this.canEdit(contacts)) {\n\t\t\tactionButtons.push(\n\t\t\t\tm(IconButton, {\n\t\t\t\t\ttitle: \"edit_action\",\n\t\t\t\t\tclick: () => onEdit(contacts[0]),\n\t\t\t\t\ticon: Icons.Edit,\n\t\t\t\t}),\n\t\t\t)\n\t\t} else if (this.canMerge(contacts)) {\n\t\t\tactionButtons.push(\n\t\t\t\tm(IconButton, {\n\t\t\t\t\ttitle: \"merge_action\",\n\t\t\t\t\tclick: () => onMerge(contacts[0], contacts[1]),\n\t\t\t\t\ticon: Icons.People,\n\t\t\t\t}),\n\t\t\t)\n\t\t}\n\n\t\tif (this.canExport(contacts)) {\n\t\t\tactionButtons.push(\n\t\t\t\tm(IconButton, {\n\t\t\t\t\ttitle: \"export_action\",\n\t\t\t\t\tclick: () => onExport(contacts),\n\t\t\t\t\ticon: Icons.Export,\n\t\t\t\t}),\n\t\t\t)\n\t\t}\n\t\tif (this.canDelete(contacts)) {\n\t\t\tactionButtons.push(\n\t\t\t\tm(IconButton, {\n\t\t\t\t\ttitle: \"delete_action\",\n\t\t\t\t\tclick: () => onDelete(contacts),\n\t\t\t\t\ticon: Icons.Trash,\n\t\t\t\t}),\n\t\t\t)\n\t\t}\n\t\treturn actionButtons\n\t}\n\n\tonupdate(vnode: VnodeDOM<ContactViewToolbarAttrs>) {\n\t\tkeyManager.unregisterShortcuts(this.shortcuts)\n\t\tthis.shortcuts.length = 0\n\t\tconst { contacts, onEdit, onDelete, onMerge, onExport } = vnode.attrs\n\t\tif (this.canEdit(contacts)) {\n\t\t\tthis.shortcuts.push({\n\t\t\t\tkey: Keys.E,\n\t\t\t\texec: () => {\n\t\t\t\t\tonEdit(contacts[0])\n\t\t\t\t},\n\t\t\t\thelp: \"edit_action\",\n\t\t\t})\n\t\t}\n\n\t\tif (this.canMerge(contacts)) {\n\t\t\tthis.shortcuts.push({\n\t\t\t\tkey: Keys.M,\n\t\t\t\tctrlOrCmd: true,\n\t\t\t\texec: () => {\n\t\t\t\t\tonMerge(contacts[0], contacts[1])\n\t\t\t\t},\n\t\t\t\thelp: \"merge_action\",\n\t\t\t})\n\t\t}\n\n\t\tif (this.canExport(contacts)) {\n\t\t\tthis.shortcuts.push({\n\t\t\t\tkey: Keys.E,\n\t\t\t\tctrlOrCmd: true,\n\t\t\t\texec: () => {\n\t\t\t\t\tonExport(contacts)\n\t\t\t\t},\n\t\t\t\thelp: \"export_action\",\n\t\t\t})\n\t\t}\n\t\tkeyManager.registerShortcuts(this.shortcuts)\n\t}\n\n\tonremove() {\n\t\tkeyManager.unregisterShortcuts(this.shortcuts)\n\t}\n\n\tprivate canExport(contacts: Contact[]) {\n\t\treturn contacts.length > 0\n\t}\n\n\tprivate canMerge(contacts: Contact[]) {\n\t\treturn contacts.length === 2\n\t}\n\n\tprivate canDelete(contacts: Contact[]) {\n\t\treturn contacts.length > 0\n\t}\n\n\tprivate canEdit(contacts: Contact[]) {\n\t\treturn contacts.length === 1\n\t}\n}\n"]}