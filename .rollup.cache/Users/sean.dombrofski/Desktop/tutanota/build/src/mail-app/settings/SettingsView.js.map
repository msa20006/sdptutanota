{"version":3,"file":"SettingsView.js","sourceRoot":"","sources":["../../../../src/mail-app/settings/SettingsView.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Vnode, VnodeDOM } from \"mithril\"\nimport stream from \"mithril/stream\"\nimport { assertMainOrNode, isApp, isDesktop, isIOSApp } from \"../../common/api/common/Env\"\nimport { ColumnType, ViewColumn } from \"../../common/gui/base/ViewColumn\"\nimport { ViewSlider } from \"../../common/gui/nav/ViewSlider.js\"\nimport { SettingsFolder } from \"../../common/settings/SettingsFolder.js\"\nimport { lang } from \"../../common/misc/LanguageViewModel\"\nimport { Header } from \"../../common/gui/Header.js\"\nimport { LoginSettingsViewer } from \"../../common/settings/login/LoginSettingsViewer.js\"\nimport { GlobalSettingsViewer } from \"./GlobalSettingsViewer\"\nimport { DesktopSettingsViewer } from \"./DesktopSettingsViewer\"\nimport { MailSettingsViewer } from \"./MailSettingsViewer\"\nimport { UserListView } from \"../../common/settings/UserListView.js\"\nimport type { ReceivedGroupInvitation, User } from \"../../common/api/entities/sys/TypeRefs.js\"\nimport { CustomerInfoTypeRef, CustomerTypeRef } from \"../../common/api/entities/sys/TypeRefs.js\"\nimport { GroupListView } from \"./groups/GroupListView.js\"\nimport { WhitelabelSettingsViewer } from \"../../common/settings/whitelabel/WhitelabelSettingsViewer\"\nimport { Icons } from \"../../common/gui/base/icons/Icons\"\nimport { theme } from \"../../common/gui/theme\"\nimport { FeatureType, GroupType, LegacyPlans } from \"../../common/api/common/TutanotaConstants\"\nimport { BootIcons } from \"../../common/gui/base/icons/BootIcons\"\nimport { locator } from \"../../common/api/main/CommonLocator\"\nimport { SubscriptionViewer } from \"../../common/subscription/SubscriptionViewer\"\nimport { PaymentViewer } from \"../../common/subscription/PaymentViewer\"\nimport { showUserImportDialog } from \"../../common/settings/UserViewer.js\"\nimport { first, LazyLoaded, partition, promiseMap } from \"@tutao/tutanota-utils\"\nimport { AppearanceSettingsViewer } from \"../../common/settings/AppearanceSettingsViewer.js\"\nimport type { NavButtonAttrs } from \"../../common/gui/base/NavButton.js\"\nimport { NavButtonColor } from \"../../common/gui/base/NavButton.js\"\nimport { SETTINGS_PREFIX } from \"../../common/misc/RouteChange\"\nimport { size } from \"../../common/gui/size\"\nimport { FolderColumnView } from \"../../common/gui/FolderColumnView.js\"\nimport { getEtId } from \"../../common/api/common/utils/EntityUtils\"\nimport { KnowledgeBaseListView } from \"./KnowledgeBaseListView\"\nimport type { TemplateGroupInstance } from \"../templates/model/TemplateGroupModel\"\nimport { showGroupSharingDialog } from \"../../common/sharing/view/GroupSharingDialog\"\nimport { createMoreActionButtonAttrs, getConfirmation } from \"../../common/gui/base/GuiUtils\"\nimport { SidebarSection } from \"../../common/gui/SidebarSection\"\nimport { ReceivedGroupInvitationsModel } from \"../../common/sharing/model/ReceivedGroupInvitationsModel\"\nimport { getNullableSharedGroupName, getSharedGroupName, isSharedGroupOwner } from \"../../common/sharing/GroupUtils\"\nimport { DummyTemplateListView } from \"./DummyTemplateListView\"\nimport { SettingsFolderRow } from \"../../common/settings/SettingsFolderRow.js\"\nimport { showProgressDialog } from \"../../common/gui/dialogs/ProgressDialog\"\nimport { createGroupSettings, createUserAreaGroupDeleteData, UserSettingsGroupRootTypeRef } from \"../../common/api/entities/tutanota/TypeRefs.js\"\nimport { GroupInvitationFolderRow } from \"../../common/sharing/view/GroupInvitationFolderRow\"\nimport { TemplateGroupService } from \"../../common/api/entities/tutanota/Services\"\nimport { exportUserCsv } from \"../../common/settings/UserDataExporter.js\"\nimport { IconButton } from \"../../common/gui/base/IconButton.js\"\nimport { BottomNav } from \"../gui/BottomNav.js\"\nimport { getAvailableDomains } from \"../../common/settings/mailaddress/MailAddressesUtils.js\"\nimport { BaseTopLevelView } from \"../../common/gui/BaseTopLevelView.js\"\nimport { TopLevelView } from \"../../TopLevelView.js\"\nimport { ReferralSettingsViewer } from \"../../common/settings/ReferralSettingsViewer.js\"\nimport { LoginController } from \"../../common/api/main/LoginController.js\"\nimport { BackgroundColumnLayout } from \"../../common/gui/BackgroundColumnLayout.js\"\nimport { styles } from \"../../common/gui/styles.js\"\nimport { MobileHeader } from \"../../common/gui/MobileHeader.js\"\nimport { isCustomizationEnabledForCustomer } from \"../../common/api/common/utils/CustomerUtils.js\"\nimport { EntityUpdateData, isUpdateForTypeRef } from \"../../common/api/common/utils/EntityUpdateUtils.js\"\nimport { Dialog } from \"../../common/gui/base/Dialog.js\"\nimport { AboutDialog } from \"../../common/settings/AboutDialog.js\"\nimport { loadTemplateGroupInstances } from \"../templates/model/TemplatePopupModel.js\"\nimport { TemplateListView } from \"./TemplateListView.js\"\nimport { TextField } from \"../../common/gui/base/TextField.js\"\nimport { ContactsSettingsViewer } from \"./ContactsSettingsViewer.js\"\nimport { NotificationSettingsViewer } from \"./NotificationSettingsViewer.js\"\nimport { SettingsViewAttrs, UpdatableSettingsDetailsViewer, UpdatableSettingsViewer } from \"../../common/settings/Interfaces.js\"\nimport { AffiliateSettingsViewer } from \"../../common/settings/AffiliateSettingsViewer.js\"\nimport { AffiliateKpisViewer } from \"../../common/settings/AffiliateKpisViewer.js\"\nimport { DesktopMailImportSettingsViewer } from \"./DesktopMailImportSettingsViewer.js\"\nimport { mailLocator } from \"../mailLocator\"\nimport { WebMailImportSettingsViewer } from \"./WebMailImportSettingsViewer.js\"\nimport { BaseButton } from \"../../common/gui/base/buttons/BaseButton\"\nimport { showSupportDialog } from \"../../common/support/SupportDialog\"\nimport { Icon, IconSize } from \"../../common/gui/base/Icon\"\nimport { MailExportViewer } from \"./MailExportViewer\"\n\nassertMainOrNode()\n\nexport class SettingsView extends BaseTopLevelView implements TopLevelView<SettingsViewAttrs> {\n\tviewSlider: ViewSlider\n\tprivate readonly _settingsFoldersColumn: ViewColumn\n\tprivate readonly _settingsColumn: ViewColumn\n\tprivate readonly _settingsDetailsColumn: ViewColumn\n\tprivate readonly _userFolders: SettingsFolder<unknown>[]\n\tprivate readonly _adminFolders: SettingsFolder<unknown>[]\n\tprivate readonly logins: LoginController\n\tprivate _templateFolders: SettingsFolder<TemplateGroupInstance>[]\n\tprivate readonly _dummyTemplateFolder: SettingsFolder<unknown>\n\tprivate _knowledgeBaseFolders: SettingsFolder<unknown>[]\n\tprivate _selectedFolder: SettingsFolder<unknown>\n\tprivate _currentViewer: UpdatableSettingsViewer | null = null\n\tprivate showBusinessSettings: stream<boolean> = stream(false)\n\tprivate showAffiliateSettings: boolean = false\n\tprivate readonly _targetFolder: string\n\tprivate readonly _targetRoute: string\n\tdetailsViewer: UpdatableSettingsDetailsViewer | null = null // the component for the details column. can be set by settings views\n\n\t_customDomains: LazyLoaded<string[]>\n\t_templateInvitations: ReceivedGroupInvitationsModel<GroupType.Template>\n\n\tconstructor(vnode: Vnode<SettingsViewAttrs>) {\n\t\tsuper()\n\t\tthis.logins = vnode.attrs.logins\n\t\tthis._userFolders = [\n\t\t\tnew SettingsFolder(\n\t\t\t\t() => \"login_label\",\n\t\t\t\t() => BootIcons.Contacts,\n\t\t\t\t\"login\",\n\t\t\t\t() => new LoginSettingsViewer(locator.credentialsProvider, isApp() ? locator.systemFacade : null),\n\t\t\t\tundefined,\n\t\t\t),\n\t\t\tnew SettingsFolder(\n\t\t\t\t() => \"email_label\",\n\t\t\t\t() => BootIcons.Mail,\n\t\t\t\t\"mail\",\n\t\t\t\t() => new MailSettingsViewer(),\n\t\t\t\tundefined,\n\t\t\t),\n\t\t\tnew SettingsFolder(\n\t\t\t\t() => \"contacts_label\",\n\t\t\t\t() => BootIcons.Contacts,\n\t\t\t\t\"contacts\",\n\t\t\t\t() => new ContactsSettingsViewer(),\n\t\t\t\tundefined,\n\t\t\t),\n\t\t\tnew SettingsFolder(\n\t\t\t\t() => \"appearanceSettings_label\",\n\t\t\t\t() => Icons.Palette,\n\t\t\t\t\"appearance\",\n\t\t\t\t() => new AppearanceSettingsViewer(),\n\t\t\t\tundefined,\n\t\t\t),\n\t\t\tnew SettingsFolder(\n\t\t\t\t() => \"notificationSettings_action\",\n\t\t\t\t() => Icons.Bell,\n\t\t\t\t\"notifications\",\n\t\t\t\t() => new NotificationSettingsViewer(),\n\t\t\t\tundefined,\n\t\t\t),\n\t\t]\n\n\t\tif (isDesktop()) {\n\t\t\tthis._userFolders.push(\n\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t() => \"desktop_label\",\n\t\t\t\t\t() => Icons.Desktop,\n\t\t\t\t\t\"desktop\",\n\t\t\t\t\t() => {\n\t\t\t\t\t\tconst desktopSettingsViewer = new DesktopSettingsViewer()\n\t\t\t\t\t\tlocator.initialized.then(() => {\n\t\t\t\t\t\t\tlocator.native.setAppUpdateListener(() => desktopSettingsViewer.onAppUpdateAvailable())\n\t\t\t\t\t\t})\n\t\t\t\t\t\treturn desktopSettingsViewer\n\t\t\t\t\t},\n\t\t\t\t\tundefined,\n\t\t\t\t),\n\t\t\t)\n\t\t}\n\n\t\tmailLocator.mailboxModel.getMailboxDetails().then((mailboxes) => {\n\t\t\tthis._userFolders.push(\n\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t() => \"mailImportSettings_label\",\n\t\t\t\t\t() => Icons.Import,\n\t\t\t\t\t\"mailImport\",\n\t\t\t\t\t() => {\n\t\t\t\t\t\tif (isDesktop()) {\n\t\t\t\t\t\t\treturn new DesktopMailImportSettingsViewer(() => mailLocator.getMailImporter())\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn new WebMailImportSettingsViewer()\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tundefined,\n\t\t\t\t),\n\t\t\t)\n\t\t})\n\n\t\tthis._userFolders.push(\n\t\t\tnew SettingsFolder(\n\t\t\t\t() => \"mailExportSettings_label\",\n\t\t\t\t() => Icons.Export,\n\t\t\t\t\"mailExport\",\n\t\t\t\t() => new MailExportViewer(),\n\t\t\t\tundefined,\n\t\t\t),\n\t\t)\n\n\t\tthis._adminFolders = []\n\t\tthis._templateFolders = []\n\n\t\tthis._makeTemplateFolders().then((folders) => {\n\t\t\tthis._templateFolders = folders\n\t\t\tm.redraw()\n\t\t})\n\n\t\tthis._dummyTemplateFolder = new SettingsFolder<void>(\n\t\t\t() => \"templateGroupDefaultName_label\",\n\t\t\t() => Icons.ListAlt,\n\t\t\t{\n\t\t\t\tfolder: \"templates\",\n\t\t\t\tid: \"init\",\n\t\t\t},\n\t\t\t() => {\n\t\t\t\treturn {\n\t\t\t\t\tview: () => {\n\t\t\t\t\t\treturn m(DummyTemplateListView)\n\t\t\t\t\t},\n\t\t\t\t\tentityEventsReceived: () => Promise.resolve(),\n\t\t\t\t}\n\t\t\t},\n\t\t\tundefined,\n\t\t)\n\t\tthis._knowledgeBaseFolders = []\n\n\t\tthis._makeKnowledgeBaseFolders().then((folders) => {\n\t\t\tthis._knowledgeBaseFolders = folders\n\t\t\tm.redraw()\n\t\t})\n\n\t\tthis._selectedFolder = this._userFolders[0]\n\t\tthis._templateInvitations = new ReceivedGroupInvitationsModel(GroupType.Template, locator.eventController, locator.entityClient, this.logins)\n\n\t\tthis._templateInvitations.invitations.map(() => m.redraw())\n\n\t\tthis._templateInvitations.init()\n\n\t\tthis._settingsFoldersColumn = new ViewColumn(\n\t\t\t{\n\t\t\t\tonbeforeremove: () => {\n\t\t\t\t\tthis._templateInvitations.dispose()\n\t\t\t\t},\n\t\t\t\tview: () => {\n\t\t\t\t\tconst [ownTemplates, sharedTemplates] = partition(this._templateFolders, (folder) =>\n\t\t\t\t\t\tisSharedGroupOwner(folder.data.group, this.logins.getUserController().user),\n\t\t\t\t\t)\n\n\t\t\t\t\tconst templateInvitations = this._templateInvitations.invitations()\n\n\t\t\t\t\treturn m(FolderColumnView, {\n\t\t\t\t\t\tdrawer: vnode.attrs.drawerAttrs,\n\t\t\t\t\t\tbutton: null,\n\t\t\t\t\t\tcontent: m(\".flex.flex-grow.col\", [\n\t\t\t\t\t\t\tm(\n\t\t\t\t\t\t\t\tSidebarSection,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tname: \"userSettings_label\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\tthis._renderSidebarSectionChildren(this._userFolders),\n\t\t\t\t\t\t\t\t\townTemplates.length > 0\n\t\t\t\t\t\t\t\t\t\t? ownTemplates.map((folder) => this._renderTemplateFolderRow(folder))\n\t\t\t\t\t\t\t\t\t\t: m(SettingsFolderRow, {\n\t\t\t\t\t\t\t\t\t\t\t\tmainButtonAttrs: this._createSettingsFolderNavButton(this._dummyTemplateFolder),\n\t\t\t\t\t\t\t\t\t\t  }),\n\t\t\t\t\t\t\t\t\tsharedTemplates.map((folder) => this._renderTemplateFolderRow(folder)),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.logins.isUserLoggedIn() && this.logins.getUserController().isGlobalAdmin()\n\t\t\t\t\t\t\t\t? m(\n\t\t\t\t\t\t\t\t\t\tSidebarSection,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tname: \"adminSettings_label\",\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tthis._renderSidebarSectionChildren(this._adminFolders),\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\ttemplateInvitations.length > 0\n\t\t\t\t\t\t\t\t? m(\n\t\t\t\t\t\t\t\t\t\tSidebarSection,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tname: \"templateGroupInvitations_label\",\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\ttemplateInvitations.map((invitation) => this._renderTemplateInvitationFolderRow(invitation)),\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\tthis._knowledgeBaseFolders.length > 0\n\t\t\t\t\t\t\t\t? m(\n\t\t\t\t\t\t\t\t\t\tSidebarSection,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tname: \"knowledgebase_label\",\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tthis._renderSidebarSectionChildren(this._knowledgeBaseFolders),\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\tthis._bottomSection(),\n\t\t\t\t\t\t]),\n\t\t\t\t\t\tariaLabel: \"settings_label\",\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t},\n\t\t\tColumnType.Foreground,\n\t\t\t{\n\t\t\t\tminWidth: size.first_col_min_width,\n\t\t\t\tmaxWidth: size.first_col_max_width,\n\t\t\t\theaderCenter: \"settings_label\",\n\t\t\t},\n\t\t)\n\t\tthis._settingsColumn = new ViewColumn(\n\t\t\t{\n\t\t\t\t// the CSS improves the situation on devices with notches (no control elements\n\t\t\t\t// are concealed), but there's still room for improvement for scrollbars\n\t\t\t\tview: () =>\n\t\t\t\t\tm(BackgroundColumnLayout, {\n\t\t\t\t\t\tbackgroundColor: theme.navigation_bg,\n\t\t\t\t\t\tcolumnLayout: m(\n\t\t\t\t\t\t\t\".mlr-safe-inset.fill-absolute.content-bg\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclass: styles.isUsingBottomNavigation() ? \"\" : \"border-radius-top-left-big\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tm(this._getCurrentViewer()!),\n\t\t\t\t\t\t),\n\t\t\t\t\t\tmobileHeader: () =>\n\t\t\t\t\t\t\tm(MobileHeader, {\n\t\t\t\t\t\t\t\t...vnode.attrs.header,\n\t\t\t\t\t\t\t\tbackAction: () => this.viewSlider.focusPreviousColumn(),\n\t\t\t\t\t\t\t\tcolumnType: \"first\",\n\t\t\t\t\t\t\t\ttitle: this._selectedFolder.name(),\n\t\t\t\t\t\t\t\tactions: [],\n\t\t\t\t\t\t\t\tprimaryAction: () => null,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\tdesktopToolbar: () => null,\n\t\t\t\t\t}),\n\t\t\t},\n\t\t\tColumnType.Background,\n\t\t\t{\n\t\t\t\tminWidth: 400,\n\t\t\t\tmaxWidth: 600,\n\t\t\t\theaderCenter: this._selectedFolder.name,\n\t\t\t},\n\t\t)\n\t\tthis._settingsDetailsColumn = new ViewColumn(\n\t\t\t{\n\t\t\t\tview: () =>\n\t\t\t\t\tm(BackgroundColumnLayout, {\n\t\t\t\t\t\tbackgroundColor: theme.navigation_bg,\n\t\t\t\t\t\tcolumnLayout: m(\".mlr-safe-inset.fill-absolute.content-bg\", this.detailsViewer ? this.detailsViewer.renderView() : m(\"\")),\n\t\t\t\t\t\tmobileHeader: () =>\n\t\t\t\t\t\t\tm(MobileHeader, {\n\t\t\t\t\t\t\t\t...vnode.attrs.header,\n\t\t\t\t\t\t\t\tbackAction: () => this.viewSlider.focusPreviousColumn(),\n\t\t\t\t\t\t\t\tcolumnType: \"other\",\n\t\t\t\t\t\t\t\ttitle: this._selectedFolder.name(),\n\t\t\t\t\t\t\t\tactions: [],\n\t\t\t\t\t\t\t\tprimaryAction: () => null,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\tdesktopToolbar: () => null,\n\t\t\t\t\t}),\n\t\t\t},\n\t\t\tColumnType.Background,\n\t\t\t{\n\t\t\t\tminWidth: 500,\n\t\t\t\tmaxWidth: 2400,\n\t\t\t\theaderCenter: \"settings_label\",\n\t\t\t},\n\t\t)\n\t\tthis.viewSlider = new ViewSlider([this._settingsFoldersColumn, this._settingsColumn, this._settingsDetailsColumn])\n\n\t\tthis._customDomains = new LazyLoaded(async () => {\n\t\t\tconst domainInfos = await getAvailableDomains(this.logins, true)\n\t\t\treturn domainInfos.map((info) => info.domain)\n\t\t})\n\n\t\tthis._customDomains.getAsync().then(() => m.redraw())\n\n\t\tthis._targetFolder = m.route.param(\"folder\")\n\t\tthis._targetRoute = m.route.get()\n\t}\n\n\tprivate async populateAdminFolders() {\n\t\tawait this.updateShowBusinessSettings()\n\t\tawait this.updateShowAffiliateSettings()\n\t\tconst currentPlanType = await this.logins.getUserController().getPlanType()\n\t\tconst isLegacyPlan = LegacyPlans.includes(currentPlanType)\n\n\t\tif (await this.logins.getUserController().canHaveUsers()) {\n\t\t\tthis._adminFolders.push(\n\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t() => \"adminUserList_action\",\n\t\t\t\t\t() => BootIcons.Contacts,\n\t\t\t\t\t\"users\",\n\t\t\t\t\t() =>\n\t\t\t\t\t\tnew UserListView(\n\t\t\t\t\t\t\t(viewer) => this.replaceDetailsViewer(viewer),\n\t\t\t\t\t\t\t() => this.focusSettingsDetailsColumn(),\n\t\t\t\t\t\t\t() => !isApp() && this._customDomains.isLoaded() && this._customDomains.getLoaded().length > 0,\n\t\t\t\t\t\t\t() => showUserImportDialog(this._customDomains.getLoaded()),\n\t\t\t\t\t\t\t() => exportUserCsv(locator.entityClient, this.logins, locator.fileController, locator.counterFacade),\n\t\t\t\t\t\t),\n\t\t\t\t\tundefined,\n\t\t\t\t),\n\t\t\t)\n\t\t\tif (!this.logins.isEnabled(FeatureType.WhitelabelChild)) {\n\t\t\t\tthis._adminFolders.push(\n\t\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t\t() => \"sharedMailboxes_label\",\n\t\t\t\t\t\t() => Icons.People,\n\t\t\t\t\t\t\"groups\",\n\t\t\t\t\t\t() =>\n\t\t\t\t\t\t\tnew GroupListView(\n\t\t\t\t\t\t\t\t(viewer) => this.replaceDetailsViewer(viewer),\n\t\t\t\t\t\t\t\t() => this.focusSettingsDetailsColumn(),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t),\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\tif (this.logins.getUserController().isGlobalAdmin()) {\n\t\t\tthis._adminFolders.push(\n\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t() => \"globalSettings_label\",\n\t\t\t\t\t() => BootIcons.Settings,\n\t\t\t\t\t\"global\",\n\t\t\t\t\t() => new GlobalSettingsViewer(),\n\t\t\t\t\tundefined,\n\t\t\t\t),\n\t\t\t)\n\n\t\t\tif (!this.logins.isEnabled(FeatureType.WhitelabelChild) && !isIOSApp()) {\n\t\t\t\tthis._adminFolders.push(\n\t\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t\t() => \"whitelabel_label\",\n\t\t\t\t\t\t() => Icons.Wand,\n\t\t\t\t\t\t\"whitelabel\",\n\t\t\t\t\t\t() => new WhitelabelSettingsViewer(locator.entityClient, this.logins),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t),\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\tif (!this.logins.isEnabled(FeatureType.WhitelabelChild)) {\n\t\t\tif (this.logins.getUserController().isGlobalAdmin()) {\n\t\t\t\tthis._adminFolders.push(\n\t\t\t\t\tnew SettingsFolder<void>(\n\t\t\t\t\t\t() => \"adminSubscription_action\",\n\t\t\t\t\t\t() => BootIcons.Premium,\n\t\t\t\t\t\t\"subscription\",\n\t\t\t\t\t\t() => new SubscriptionViewer(currentPlanType, isIOSApp() ? locator.mobilePaymentsFacade : null),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t),\n\t\t\t\t)\n\n\t\t\t\tthis._adminFolders.push(\n\t\t\t\t\tnew SettingsFolder<void>(\n\t\t\t\t\t\t() => \"adminPayment_action\",\n\t\t\t\t\t\t() => Icons.CreditCard,\n\t\t\t\t\t\t\"invoice\",\n\t\t\t\t\t\t() => new PaymentViewer(),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t),\n\t\t\t\t)\n\n\t\t\t\tthis._adminFolders.push(\n\t\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t\t() => \"referralSettings_label\",\n\t\t\t\t\t\t() => BootIcons.Share,\n\t\t\t\t\t\t\"referral\",\n\t\t\t\t\t\t() => new ReferralSettingsViewer(),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t).setIsVisibleHandler(() => !this.showBusinessSettings()),\n\t\t\t\t)\n\n\t\t\t\tthis._adminFolders.push(\n\t\t\t\t\tnew SettingsFolder(\n\t\t\t\t\t\t() => \"affiliateSettings_label\",\n\t\t\t\t\t\t() => BootIcons.Share,\n\t\t\t\t\t\t\"affiliate\",\n\t\t\t\t\t\t() =>\n\t\t\t\t\t\t\tnew AffiliateSettingsViewer(\n\t\t\t\t\t\t\t\t() => this.viewSlider.focusedColumn === this._settingsDetailsColumn,\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tif (this.viewSlider.focusedColumn !== this._settingsDetailsColumn) {\n\t\t\t\t\t\t\t\t\t\tthis.replaceDetailsViewer(new AffiliateKpisViewer())\n\t\t\t\t\t\t\t\t\t\tthis.focusSettingsDetailsColumn()\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthis.replaceDetailsViewer(null)\n\t\t\t\t\t\t\t\t\t\tthis.viewSlider.focus(this._settingsColumn)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t).setIsVisibleHandler(() => this.showAffiliateSettings),\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t\tm.redraw()\n\t}\n\n\tprivate replaceDetailsViewer(viewer: UpdatableSettingsDetailsViewer | null): UpdatableSettingsDetailsViewer | null {\n\t\treturn (this.detailsViewer = viewer)\n\t}\n\n\toncreate(vnode: Vnode<SettingsViewAttrs>) {\n\t\tlocator.eventController.addEntityListener(this.entityListener)\n\t\tthis.populateAdminFolders().then(() => {\n\t\t\t// We have to wait for the folders to be initialized before setting the URL,\n\t\t\t// otherwise we won't find the requested folder and will just pick the default folder\n\t\t\tconst stillAtDefaultUrl = m.route.get() === this._userFolders[0].url\n\t\t\tif (stillAtDefaultUrl) {\n\t\t\t\tthis.onNewUrl({ folder: this._targetFolder }, this._targetRoute)\n\t\t\t}\n\t\t})\n\t}\n\n\tonremove(vnode: VnodeDOM<SettingsViewAttrs>) {\n\t\tlocator.eventController.removeEntityListener(this.entityListener)\n\t}\n\n\tprivate entityListener = (updates: EntityUpdateData[], eventOwnerGroupId: Id) => {\n\t\treturn this.entityEventsReceived(updates, eventOwnerGroupId)\n\t}\n\n\tview({ attrs }: Vnode<SettingsViewAttrs>): Children {\n\t\treturn m(\n\t\t\t\"#settings.main-view\",\n\t\t\tm(this.viewSlider, {\n\t\t\t\theader: m(Header, {\n\t\t\t\t\t...attrs.header,\n\t\t\t\t}),\n\t\t\t\tbottomNav: m(BottomNav),\n\t\t\t}),\n\t\t)\n\t}\n\n\t_createSettingsFolderNavButton(folder: SettingsFolder<unknown>): NavButtonAttrs {\n\t\treturn {\n\t\t\tlabel: folder.name(),\n\t\t\ticon: folder.icon,\n\t\t\thref: folder.url,\n\t\t\tcolors: NavButtonColor.Nav,\n\t\t\tclick: () => this.viewSlider.focus(this._settingsColumn),\n\t\t\tpersistentBackground: true,\n\t\t}\n\t}\n\n\t_renderTemplateFolderRow(folder: SettingsFolder<TemplateGroupInstance>): Children {\n\t\tconst instance = folder.data\n\t\tconst isGroupOwner = isSharedGroupOwner(instance.group, getEtId(this.logins.getUserController().user))\n\t\treturn m(SettingsFolderRow, {\n\t\t\tmainButtonAttrs: this._createSettingsFolderNavButton(folder),\n\t\t\textraButton: m(\n\t\t\t\tIconButton,\n\t\t\t\tcreateMoreActionButtonAttrs(() => [\n\t\t\t\t\tisGroupOwner\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tlabel: \"delete_action\",\n\t\t\t\t\t\t\t\tclick: () => this._deleteTemplateGroup(folder.data),\n\t\t\t\t\t\t\t\ticon: Icons.Trash,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tlabel: \"leaveGroup_action\",\n\t\t\t\t\t\t\t\tclick: () => this._leaveTemplateGroup(folder.data),\n\t\t\t\t\t\t\t\ticon: Icons.Trash,\n\t\t\t\t\t\t  },\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"sharing_label\",\n\t\t\t\t\t\tclick: () => showGroupSharingDialog(folder.data.groupInfo, true),\n\t\t\t\t\t\ticon: Icons.ContactImport,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"rename_action\",\n\t\t\t\t\t\tclick: () => showRenameTemplateListDialog(folder.data),\n\t\t\t\t\t\ticon: Icons.Edit,\n\t\t\t\t\t},\n\t\t\t\t]),\n\t\t\t),\n\t\t})\n\t}\n\n\tprivate _leaveTemplateGroup(templateInfo: TemplateGroupInstance) {\n\t\treturn getConfirmation(\n\t\t\tlang.getTranslation(\"confirmLeaveSharedGroup_msg\", {\n\t\t\t\t\"{groupName}\": getSharedGroupName(templateInfo.groupInfo, this.logins.getUserController(), false),\n\t\t\t}),\n\t\t).confirmed(() => locator.groupManagementFacade.removeUserFromGroup(getEtId(this.logins.getUserController().user), templateInfo.groupInfo.group))\n\t}\n\n\tprivate _deleteTemplateGroup(templateInfo: TemplateGroupInstance) {\n\t\treturn getConfirmation(\"confirmDeleteTemplateGroup_msg\").confirmed(() =>\n\t\t\tshowProgressDialog(\n\t\t\t\t\"pleaseWait_msg\",\n\t\t\t\tlocator.serviceExecutor.delete(\n\t\t\t\t\tTemplateGroupService,\n\t\t\t\t\tcreateUserAreaGroupDeleteData({\n\t\t\t\t\t\tgroup: templateInfo.groupInfo.group,\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t),\n\t\t)\n\t}\n\n\t_renderTemplateInvitationFolderRow(invitation: ReceivedGroupInvitation): Children {\n\t\treturn m(GroupInvitationFolderRow, {\n\t\t\tinvitation: invitation,\n\t\t\ticon: BootIcons.Mail,\n\t\t})\n\t}\n\n\t_renderSidebarSectionChildren(folders: SettingsFolder<unknown>[]): Children {\n\t\treturn m(\n\t\t\t\"\",\n\t\t\tfolders\n\t\t\t\t.filter((folder) => folder.isVisible())\n\t\t\t\t.map((folder) => {\n\t\t\t\t\tconst buttonAttrs = this._createSettingsFolderNavButton(folder)\n\n\t\t\t\t\treturn m(SettingsFolderRow, {\n\t\t\t\t\t\tmainButtonAttrs: buttonAttrs,\n\t\t\t\t\t})\n\t\t\t\t}),\n\t\t)\n\t}\n\n\t_getCurrentViewer(): UpdatableSettingsViewer | null {\n\t\tif (!this._currentViewer) {\n\t\t\tthis.detailsViewer = null\n\t\t\tthis._currentViewer = this._selectedFolder.viewerCreator()\n\t\t}\n\n\t\treturn this._currentViewer\n\t}\n\n\t/**\n\t * Notifies the current view about changes of the url within its scope.\n\t */\n\tonNewUrl(args: Record<string, any>, requestedPath: string) {\n\t\tif (!args.folder) {\n\t\t\tthis._setUrl(this._userFolders[0].url)\n\t\t} else if (args.folder || !m.route.get().startsWith(\"/settings\")) {\n\t\t\t// ensure that current viewer will be reinitialized\n\t\t\tconst folder = this._allSettingsFolders().find((folder) => folder.url === requestedPath)\n\n\t\t\tif (!folder) {\n\t\t\t\tthis._setUrl(this._userFolders[0].url)\n\t\t\t} else if (this._selectedFolder.path === folder.path) {\n\t\t\t\t// folder path has not changed\n\t\t\t\tthis._selectedFolder = folder // instance of SettingsFolder might have been changed in membership update, so replace this instance\n\n\t\t\t\tm.redraw()\n\t\t\t} else {\n\t\t\t\t// folder path has changed\n\t\t\t\t// to avoid misleading information, set the url to the folder's url, so the browser url\n\t\t\t\t// is changed to correctly represents the displayed content\n\t\t\t\tthis._setUrl(folder.url)\n\t\t\t\tthis._selectedFolder = folder\n\t\t\t\tthis._currentViewer = null\n\t\t\t\tthis.detailsViewer = null\n\n\t\t\t\t// make sure the currentViewer is available\n\t\t\t\tthis._getCurrentViewer()\n\n\t\t\t\tm.redraw()\n\t\t\t}\n\t\t}\n\t}\n\n\t_getUserOwnedTemplateSettingsFolder(): SettingsFolder<unknown> {\n\t\treturn this._templateFolders.find((folder) => isSharedGroupOwner(folder.data.group, this.logins.getUserController().user)) || this._dummyTemplateFolder\n\t}\n\n\t_allSettingsFolders(): ReadonlyArray<SettingsFolder<unknown>> {\n\t\tconst hasOwnTemplates = this._templateFolders.some((folder) => isSharedGroupOwner(folder.data.group, this.logins.getUserController().user))\n\n\t\treturn [\n\t\t\t...this._userFolders,\n\t\t\t...this._adminFolders,\n\t\t\t...(!hasOwnTemplates ? [this._dummyTemplateFolder] : []),\n\t\t\t...this._templateFolders,\n\t\t\t...this._knowledgeBaseFolders,\n\t\t]\n\t}\n\n\t_setUrl(url: string) {\n\t\tm.route.set(url + location.hash)\n\t}\n\n\t_isGlobalAdmin(user: User): boolean {\n\t\treturn user.memberships.some((m) => m.groupType === GroupType.Admin)\n\t}\n\n\tfocusSettingsDetailsColumn() {\n\t\tvoid this.viewSlider.focus(this._settingsDetailsColumn)\n\t}\n\n\tprivate async updateShowBusinessSettings() {\n\t\tthis.showBusinessSettings((await this.logins.getUserController().loadCustomer()).businessUse === true)\n\t}\n\n\tasync entityEventsReceived<T>(updates: ReadonlyArray<EntityUpdateData>, eventOwnerGroupId: Id): Promise<void> {\n\t\tfor (const update of updates) {\n\t\t\tif (isUpdateForTypeRef(CustomerTypeRef, update)) {\n\t\t\t\tawait this.updateShowBusinessSettings()\n\t\t\t} else if (this.logins.getUserController().isUpdateForLoggedInUserInstance(update, eventOwnerGroupId)) {\n\t\t\t\tconst user = this.logins.getUserController().user\n\n\t\t\t\t// the user admin status might have changed\n\t\t\t\tif (!this._isGlobalAdmin(user) && this._currentViewer && this._adminFolders.some((f) => f.isActive())) {\n\t\t\t\t\tthis._setUrl(this._userFolders[0].url)\n\t\t\t\t}\n\n\t\t\t\t// template group memberships may have changed\n\t\t\t\tif (this._templateFolders.length !== this.logins.getUserController().getTemplateMemberships().length) {\n\t\t\t\t\tconst templates = await this.reloadTemplateData()\n\t\t\t\t\tconst currentRoute = m.route.get()\n\n\t\t\t\t\tif (currentRoute.startsWith(SETTINGS_PREFIX)) {\n\t\t\t\t\t\tconst folder = m.route.param(\"folder\")\n\t\t\t\t\t\tif (folder === \"templates\") {\n\t\t\t\t\t\t\tconst templateListId = m.route.param(\"id\")\n\t\t\t\t\t\t\t// We might have lost the membership on the template list\n\t\t\t\t\t\t\tconst haveOpenedFolder = templates.some((t) => t.id === templateListId)\n\n\t\t\t\t\t\t\t// When user first creates a template group from the dummy list, we need to switch them to\n\t\t\t\t\t\t\t// the viewer for their newly created list.\n\t\t\t\t\t\t\tif (this._dummyTemplateFolder.url || !haveOpenedFolder) {\n\t\t\t\t\t\t\t\tthis._setUrl(this._getUserOwnedTemplateSettingsFolder().url)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tm.redraw()\n\t\t\t} else if (isUpdateForTypeRef(CustomerInfoTypeRef, update)) {\n\t\t\t\tthis._customDomains.reset()\n\t\t\t\tthis._adminFolders.length = 0\n\t\t\t\t// When switching a plan we hide/show certain admin settings.\n\t\t\t\tawait this.populateAdminFolders()\n\n\t\t\t\tawait this._customDomains.getAsync()\n\t\t\t\tm.redraw()\n\t\t\t} else if (isUpdateForTypeRef(UserSettingsGroupRootTypeRef, update)) {\n\t\t\t\tawait this.reloadTemplateData()\n\t\t\t\tm.redraw()\n\t\t\t}\n\t\t}\n\n\t\tawait this._currentViewer?.entityEventsReceived(updates)\n\n\t\tawait this.detailsViewer?.entityEventsReceived(updates)\n\t}\n\n\tprivate async reloadTemplateData(): Promise<SettingsFolder<TemplateGroupInstance>[]> {\n\t\tconst [templates, knowledgeBases] = await Promise.all([this._makeTemplateFolders(), this._makeKnowledgeBaseFolders()])\n\t\tthis._templateFolders = templates\n\t\tthis._knowledgeBaseFolders = knowledgeBases\n\t\treturn templates\n\t}\n\n\tgetViewSlider(): ViewSlider | null {\n\t\treturn this.viewSlider\n\t}\n\n\t_bottomSection(): Children {\n\t\tconst isFirstPartyDomain = locator.domainConfigProvider().getCurrentDomainConfig().firstPartyDomain\n\n\t\treturn m(\".pb.pt-l.flex-no-shrink.flex.col.justify-end.gap-vpad\", [\n\t\t\t// Support button\n\t\t\tm(BaseButton, {\n\t\t\t\tclass: \"flash flex justify-center center-vertically pt-s pb-s plr-2l border-radius\",\n\t\t\t\tstyle: {\n\t\t\t\t\tmarginInline: \"auto\",\n\t\t\t\t\tborder: `1px solid ${theme.navigation_button}`,\n\t\t\t\t\tcolor: theme.navigation_button,\n\t\t\t\t},\n\t\t\t\tlabel: \"supportMenu_label\",\n\t\t\t\ttext: m(\".pl-m\", lang.getTranslation(\"supportMenu_label\").text),\n\t\t\t\ticon: m(Icon, {\n\t\t\t\t\ticon: Icons.SpeechBubbleFill,\n\t\t\t\t\tsize: IconSize.Medium,\n\t\t\t\t\tclass: \"center-h\",\n\t\t\t\t\tcontainer: \"div\",\n\t\t\t\t\tstyle: { fill: theme.navigation_button },\n\t\t\t\t}),\n\t\t\t\tonclick: () => void showSupportDialog(locator.logins),\n\t\t\t}),\n\t\t\t// About button\n\t\t\tisFirstPartyDomain ? this._aboutThisSoftwareLink() : null,\n\t\t])\n\t}\n\n\t_aboutThisSoftwareLink(): Children {\n\t\tconst label = lang.get(\"about_label\")\n\t\tconst versionLabel = `Tuta v${env.versionNumber}`\n\t\treturn m(\n\t\t\t\"button.text-center.small.no-text-decoration\",\n\t\t\t{\n\t\t\t\tstyle: {\n\t\t\t\t\tbackgroundColor: \"transparent\",\n\t\t\t\t},\n\t\t\t\thref: \"#\",\n\t\t\t\t\"aria-label\": label,\n\t\t\t\t\"aria-description\": versionLabel,\n\t\t\t\t\"aria-haspopup\": \"dialog\",\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.viewSlider.focusNextColumn()\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tconst dialog = Dialog.showActionDialog({\n\t\t\t\t\t\t\ttitle: \"about_label\",\n\t\t\t\t\t\t\tchild: () =>\n\t\t\t\t\t\t\t\tm(AboutDialog, {\n\t\t\t\t\t\t\t\t\tonShowSetupWizard: () => {\n\t\t\t\t\t\t\t\t\t\tdialog.close()\n\t\t\t\t\t\t\t\t\t\tlocator.showSetupWizard()\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tallowOkWithReturn: true,\n\t\t\t\t\t\t\tokAction: (dialog: Dialog) => dialog.close(),\n\t\t\t\t\t\t\tallowCancel: false,\n\t\t\t\t\t\t})\n\t\t\t\t\t}, 200)\n\t\t\t\t},\n\t\t\t},\n\t\t\t[\n\t\t\t\tm(\"\", versionLabel),\n\t\t\t\tm(\n\t\t\t\t\t\".b\",\n\t\t\t\t\t{\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tcolor: theme.navigation_button_selected,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tlabel,\n\t\t\t\t),\n\t\t\t],\n\t\t)\n\t}\n\n\tasync _makeTemplateFolders(): Promise<Array<SettingsFolder<TemplateGroupInstance>>> {\n\t\tconst userController = this.logins.getUserController()\n\t\tconst templateMemberships = userController.getTemplateMemberships()\n\t\treturn promiseMap(await loadTemplateGroupInstances(templateMemberships, locator.entityClient), (groupInstance) => {\n\t\t\tconst sharedGroupName = getNullableSharedGroupName(groupInstance.groupInfo, userController.userSettingsGroupRoot, true)\n\t\t\treturn new SettingsFolder(\n\t\t\t\t() => (sharedGroupName ? lang.makeTranslation(\"templateGroupDefaultName_label\", sharedGroupName) : \"templateGroupDefaultName_label\"),\n\t\t\t\t() => Icons.ListAlt,\n\t\t\t\t{\n\t\t\t\t\tfolder: \"templates\",\n\t\t\t\t\tid: getEtId(groupInstance.group),\n\t\t\t\t},\n\t\t\t\t() =>\n\t\t\t\t\tnew TemplateListView(\n\t\t\t\t\t\tgroupInstance,\n\t\t\t\t\t\tlocator.entityClient,\n\t\t\t\t\t\tthis.logins,\n\t\t\t\t\t\t(viewer) => this.replaceDetailsViewer(viewer),\n\t\t\t\t\t\t() => this.focusSettingsDetailsColumn(),\n\t\t\t\t\t),\n\t\t\t\tgroupInstance,\n\t\t\t)\n\t\t})\n\t}\n\n\tasync _makeKnowledgeBaseFolders(): Promise<Array<SettingsFolder<void>>> {\n\t\tconst userController = this.logins.getUserController()\n\t\tconst customer = await userController.loadCustomer()\n\n\t\tif (isCustomizationEnabledForCustomer(customer, FeatureType.KnowledgeBase)) {\n\t\t\tconst templateMemberships = (this.logins.getUserController() && this.logins.getUserController().getTemplateMemberships()) || []\n\t\t\treturn promiseMap(await loadTemplateGroupInstances(templateMemberships, locator.entityClient), (groupInstance) => {\n\t\t\t\tconst sharedGroupName = getNullableSharedGroupName(groupInstance.groupInfo, userController.userSettingsGroupRoot, true)\n\t\t\t\treturn new SettingsFolder(\n\t\t\t\t\t() => (sharedGroupName ? lang.makeTranslation(\"templateGroupDefaultName_label\", sharedGroupName) : \"templateGroupDefaultName_label\"),\n\t\t\t\t\t() => Icons.Book,\n\t\t\t\t\t{\n\t\t\t\t\t\tfolder: \"knowledgebase\",\n\t\t\t\t\t\tid: getEtId(groupInstance.group),\n\t\t\t\t\t},\n\t\t\t\t\t() =>\n\t\t\t\t\t\tnew KnowledgeBaseListView(\n\t\t\t\t\t\t\tlocator.entityClient,\n\t\t\t\t\t\t\tthis.logins,\n\t\t\t\t\t\t\tgroupInstance.groupRoot,\n\t\t\t\t\t\t\tgroupInstance.group,\n\t\t\t\t\t\t\t(viewer) => this.replaceDetailsViewer(viewer),\n\t\t\t\t\t\t\t() => this.focusSettingsDetailsColumn(),\n\t\t\t\t\t\t),\n\t\t\t\t\tundefined,\n\t\t\t\t)\n\t\t\t})\n\t\t} else {\n\t\t\treturn []\n\t\t}\n\t}\n\n\tprivate async updateShowAffiliateSettings() {\n\t\tconst customer = await this.logins.getUserController().loadCustomer()\n\t\tthis.showAffiliateSettings = isCustomizationEnabledForCustomer(customer, FeatureType.AffiliatePartner)\n\t}\n}\n\nfunction showRenameTemplateListDialog(instance: TemplateGroupInstance) {\n\tconst logins = locator.logins\n\tconst name = stream(getSharedGroupName(instance.groupInfo, logins.getUserController(), true))\n\tDialog.showActionDialog({\n\t\ttitle: \"renameTemplateList_label\",\n\t\tallowOkWithReturn: true,\n\t\tchild: {\n\t\t\tview: () =>\n\t\t\t\tm(TextField, {\n\t\t\t\t\tvalue: name(),\n\t\t\t\t\toninput: name,\n\t\t\t\t\tlabel: \"templateGroupName_label\",\n\t\t\t\t}),\n\t\t},\n\t\tokAction: (dialog: Dialog) => {\n\t\t\tdialog.close()\n\t\t\tconst { userSettingsGroupRoot } = logins.getUserController()\n\t\t\tconst existingGroupSettings = userSettingsGroupRoot.groupSettings.find((gc) => gc.group === instance.groupInfo.group)\n\t\t\tconst newName = name()\n\n\t\t\tif (existingGroupSettings) {\n\t\t\t\texistingGroupSettings.name = newName\n\t\t\t} else {\n\t\t\t\tconst newSettings = createGroupSettings({\n\t\t\t\t\tgroup: getEtId(instance.group),\n\t\t\t\t\tcolor: \"\",\n\t\t\t\t\tname: newName,\n\t\t\t\t\tdefaultAlarmsList: [],\n\t\t\t\t\tsourceUrl: null,\n\t\t\t\t})\n\t\t\t\tlogins.getUserController().userSettingsGroupRoot.groupSettings.push(newSettings)\n\t\t\t}\n\n\t\t\tlocator.entityClient.update(userSettingsGroupRoot).then(() => {\n\t\t\t\tif (isSharedGroupOwner(instance.group, logins.getUserController().user)) {\n\t\t\t\t\tinstance.groupInfo.name = newName\n\t\t\t\t\tlocator.entityClient.update(instance.groupInfo)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t})\n}\n"]}