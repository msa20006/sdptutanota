{"version":3,"file":"EnterDomainPage.js","sourceRoot":"","sources":["../../../../../src/mail-app/settings/emaildomain/EnterDomainPage.ts"],"names":[],"mappings":"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","sourcesContent":["import m, { Children, Vnode, VnodeDOM } from \"mithril\"\nimport { Autocapitalize, TextField } from \"../../../common/gui/base/TextField.js\"\nimport { isDomainName } from \"../../../common/misc/FormatValidator\"\nimport { Dialog } from \"../../../common/gui/base/Dialog\"\nimport type { AddDomainData } from \"./AddDomainWizard\"\nimport type { TranslationKey } from \"../../../common/misc/LanguageViewModel\"\nimport { lang } from \"../../../common/misc/LanguageViewModel\"\nimport type { WizardPageAttrs, WizardPageN } from \"../../../common/gui/base/WizardDialog.js\"\nimport { emitWizardEvent, WizardEventType } from \"../../../common/gui/base/WizardDialog.js\"\nimport { assertMainOrNode } from \"../../../common/api/common/Env\"\nimport { LoginButton } from \"../../../common/gui/base/buttons/LoginButton.js\"\n\nassertMainOrNode()\n\nexport class EnterDomainPage implements WizardPageN<AddDomainData> {\n\tprivate dom: HTMLElement | null = null\n\n\toncreate(vnode: VnodeDOM<WizardPageAttrs<AddDomainData>>) {\n\t\tthis.dom = vnode.dom as HTMLElement\n\t}\n\n\tview(vnode: Vnode<WizardPageAttrs<AddDomainData>>): Children {\n\t\treturn m(\"\", [\n\t\t\tm(\"h4.mt-l.text-center\", lang.get(\"enterCustomDomain_title\")),\n\t\t\tm(\".mt\", lang.get(\"enterDomainIntroduction_msg\")),\n\t\t\tm(\".mt\", lang.get(\"enterDomainGetReady_msg\")),\n\t\t\tm(TextField, {\n\t\t\t\tlabel: \"customDomain_label\",\n\t\t\t\tautocapitalize: Autocapitalize.none,\n\t\t\t\tvalue: vnode.attrs.data.domain(),\n\t\t\t\toninput: vnode.attrs.data.domain,\n\t\t\t\thelpLabel: () => {\n\t\t\t\t\tconst domain = vnode.attrs.data.domain()\n\t\t\t\t\tconst errorMsg = validateDomain(domain)\n\n\t\t\t\t\tif (errorMsg) {\n\t\t\t\t\t\treturn lang.get(errorMsg)\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn lang.get(\"enterDomainFieldHelp_label\", {\n\t\t\t\t\t\t\t\"{domain}\": domain.toLocaleLowerCase().trim(),\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}),\n\t\t\tm(\n\t\t\t\t\".flex-center.full-width.pt-l.mb-l\",\n\t\t\t\tm(LoginButton, {\n\t\t\t\t\tlabel: \"next_action\",\n\t\t\t\t\tclass: \"small-login-button\",\n\t\t\t\t\tonclick: () => emitWizardEvent(this.dom as HTMLElement, WizardEventType.SHOW_NEXT_PAGE),\n\t\t\t\t}),\n\t\t\t),\n\t\t])\n\t}\n}\n\nfunction validateDomain(domain: string): TranslationKey | null {\n\tlet cleanDomainName = domain.toLocaleLowerCase().trim()\n\n\tif (!cleanDomainName.length) {\n\t\treturn \"customDomainNeutral_msg\"\n\t}\n\n\tif (!isDomainName(cleanDomainName)) {\n\t\treturn \"customDomainInvalid_msg\"\n\t} else {\n\t\treturn null\n\t}\n}\n\nexport class EnterDomainPageAttrs implements WizardPageAttrs<AddDomainData> {\n\tdata: AddDomainData\n\n\tconstructor(domainData: AddDomainData) {\n\t\tthis.data = domainData\n\t}\n\n\theaderTitle(): TranslationKey {\n\t\treturn \"domainSetup_title\"\n\t}\n\n\tnextAction(showErrorDialog: boolean = true): Promise<boolean> {\n\t\tconst errorMsg = validateDomain(this.data.domain())\n\n\t\tif (errorMsg) {\n\t\t\treturn showErrorDialog ? Dialog.message(errorMsg).then(() => false) : Promise.resolve(false)\n\t\t} else {\n\t\t\treturn Promise.resolve(true)\n\t\t}\n\t}\n\n\tisSkipAvailable(): boolean {\n\t\treturn false\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn true\n\t}\n}\n"]}