import { isAndroidApp } from "./Env-chunk.js";
import { mithril_default } from "./mithril-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import { theme } from "./theme-chunk.js";
import { ButtonType } from "./Button-chunk.js";
import { Dialog } from "./Dialog-chunk.js";
import { locator } from "./CommonLocator-chunk.js";
import { BannerButton } from "./BannerButton-chunk.js";
import { PermissionType$1 as PermissionType } from "./PermissionType-chunk.js";

//#region src/common/settings/SettingsBannerButton.ts
function renderSettingsBannerButton(text, onclick, isDisabled, classes) {
	return mithril_default(BannerButton, {
		text,
		borderColor: theme.content_accent,
		color: theme.content_accent,
		class: "b full-width button-content " + classes,
		click: (event, dom) => {
			onclick(event, dom);
		},
		disabled: isDisabled ?? undefined
	});
}

//#endregion
//#region src/common/settings/NotificationPermissionsDialog.ts
function renderPermissionButton(permissionName, isPermissionGranted, onclick) {
	return renderSettingsBannerButton(isPermissionGranted ? "granted_msg" : permissionName, onclick, isPermissionGranted);
}
async function renderNotificationPermissionsDialog(onClose) {
	let isNotificationPermissionGranted = await locator.systemPermissionHandler.hasPermission(PermissionType.Notification);
	let isBatteryPermissionGranted = await locator.systemPermissionHandler.hasPermission(PermissionType.IgnoreBatteryOptimization);
	const headerBarAttrs = {
		left: [{
			label: "close_alt",
			click: () => dialog.close(),
			type: ButtonType.Secondary
		}],
		middle: "permissions_label",
		remove: () => onClose()
	};
	const dialog = Dialog.editSmallDialog(headerBarAttrs, () => mithril_default(NotificationPermissionsBody, {
		isNotificationPermissionGranted,
		isBatteryPermissionGranted,
		askForNotificationPermission: (isGranted) => {
			isNotificationPermissionGranted = isGranted;
			mithril_default.redraw();
		},
		askForBatteryNotificationPermission: async (isGranted) => {
			isBatteryPermissionGranted = isGranted;
			mithril_default.redraw();
		}
	}));
	dialog.show();
}
var NotificationPermissionsBody = class {
	view({ attrs }) {
		return [
			mithril_default("p.mb-s", lang.get("allowNotifications_msg")),
			renderPermissionButton("grant_notification_permission_action", attrs.isNotificationPermissionGranted, async () => {
				const isNotificationPermissionGranted = await locator.systemPermissionHandler.requestPermission(PermissionType.Notification, "grant_notification_permission_action");
				if (isNotificationPermissionGranted) locator.pushService.register();
				attrs.askForNotificationPermission(isNotificationPermissionGranted);
			}),
			!isAndroidApp() ? null : mithril_default("section.mt-s.mb", [mithril_default("p.mb-s.mt-s", lang.get("allowBatteryPermission_msg")), renderPermissionButton("grant_battery_permission_action", attrs.isBatteryPermissionGranted, async () => {
				const isBatteryPermissionGranted = await locator.systemPermissionHandler.requestPermission(PermissionType.IgnoreBatteryOptimization, "allowBatteryPermission_msg");
				attrs.askForBatteryNotificationPermission(isBatteryPermissionGranted);
			})])
		];
	}
};

//#endregion
export { NotificationPermissionsBody, renderNotificationPermissionsDialog, renderSettingsBannerButton };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTm90aWZpY2F0aW9uUGVybWlzc2lvbnNEaWFsb2ctY2h1bmsuanMiLCJuYW1lcyI6WyJ0ZXh0OiBUcmFuc2xhdGlvbktleSIsIm9uY2xpY2s6IENsaWNrSGFuZGxlciIsImlzRGlzYWJsZWQ/OiBib29sZWFuIiwiY2xhc3Nlcz86IHN0cmluZyIsImV2ZW50OiBNb3VzZUV2ZW50IiwiZG9tOiBIVE1MRWxlbWVudCIsInBlcm1pc3Npb25OYW1lOiBUcmFuc2xhdGlvbktleSIsImlzUGVybWlzc2lvbkdyYW50ZWQ6IGJvb2xlYW4iLCJvbmNsaWNrOiBDbGlja0hhbmRsZXIiLCJvbkNsb3NlOiAoKSA9PiB2b2lkIiwiaGVhZGVyQmFyQXR0cnM6IERpYWxvZ0hlYWRlckJhckF0dHJzIl0sInNvdXJjZXMiOlsiLi4vc3JjL2NvbW1vbi9zZXR0aW5ncy9TZXR0aW5nc0Jhbm5lckJ1dHRvbi50cyIsIi4uL3NyYy9jb21tb24vc2V0dGluZ3MvTm90aWZpY2F0aW9uUGVybWlzc2lvbnNEaWFsb2cudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHJhbnNsYXRpb25LZXkgfSBmcm9tIFwiLi4vbWlzYy9MYW5ndWFnZVZpZXdNb2RlbC5qc1wiXG5pbXBvcnQgeyBDbGlja0hhbmRsZXIgfSBmcm9tIFwiLi4vZ3VpL2Jhc2UvR3VpVXRpbHMuanNcIlxuaW1wb3J0IG0gZnJvbSBcIm1pdGhyaWxcIlxuaW1wb3J0IHsgQmFubmVyQnV0dG9uIH0gZnJvbSBcIi4uL2d1aS9iYXNlL2J1dHRvbnMvQmFubmVyQnV0dG9uLmpzXCJcbmltcG9ydCB7IHRoZW1lIH0gZnJvbSBcIi4uL2d1aS90aGVtZS5qc1wiXG5cbi8vLyBSZW5kZXJzIGEgYmFubmVyIGJ1dHRvbiB1c2VkIGluIHRoZSBvbmJvYXJkaW5nIHdpemFyZCBhbmQgbm90aWZpY2F0aW9uIHBlcm1pc3Npb24gZGlhbG9nXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyU2V0dGluZ3NCYW5uZXJCdXR0b24odGV4dDogVHJhbnNsYXRpb25LZXksIG9uY2xpY2s6IENsaWNrSGFuZGxlciwgaXNEaXNhYmxlZD86IGJvb2xlYW4sIGNsYXNzZXM/OiBzdHJpbmcpIHtcblx0cmV0dXJuIG0oQmFubmVyQnV0dG9uLCB7XG5cdFx0dGV4dCxcblx0XHRib3JkZXJDb2xvcjogdGhlbWUuY29udGVudF9hY2NlbnQsXG5cdFx0Y29sb3I6IHRoZW1lLmNvbnRlbnRfYWNjZW50LFxuXHRcdGNsYXNzOiBcImIgZnVsbC13aWR0aCBidXR0b24tY29udGVudCBcIiArIGNsYXNzZXMsXG5cdFx0Y2xpY2s6IChldmVudDogTW91c2VFdmVudCwgZG9tOiBIVE1MRWxlbWVudCkgPT4ge1xuXHRcdFx0b25jbGljayhldmVudCwgZG9tKVxuXHRcdH0sXG5cdFx0ZGlzYWJsZWQ6IGlzRGlzYWJsZWQgPz8gdW5kZWZpbmVkLFxuXHR9KVxufVxuIiwiaW1wb3J0IG0sIHsgQ29tcG9uZW50LCBWbm9kZSB9IGZyb20gXCJtaXRocmlsXCJcbmltcG9ydCB7IGxhbmcsIFRyYW5zbGF0aW9uS2V5IH0gZnJvbSBcIi4uL21pc2MvTGFuZ3VhZ2VWaWV3TW9kZWwuanNcIlxuaW1wb3J0IHsgaXNBbmRyb2lkQXBwIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vRW52LmpzXCJcbmltcG9ydCB7IERpYWxvZyB9IGZyb20gXCIuLi9ndWkvYmFzZS9EaWFsb2cuanNcIlxuaW1wb3J0IHsgRGlhbG9nSGVhZGVyQmFyQXR0cnMgfSBmcm9tIFwiLi4vZ3VpL2Jhc2UvRGlhbG9nSGVhZGVyQmFyLmpzXCJcbmltcG9ydCB7IEJ1dHRvblR5cGUgfSBmcm9tIFwiLi4vZ3VpL2Jhc2UvQnV0dG9uLmpzXCJcbmltcG9ydCB7IENsaWNrSGFuZGxlciB9IGZyb20gXCIuLi9ndWkvYmFzZS9HdWlVdGlscy5qc1wiXG5pbXBvcnQgeyBQZXJtaXNzaW9uVHlwZSB9IGZyb20gXCIuLi9uYXRpdmUvY29tbW9uL2dlbmVyYXRlZGlwYy9QZXJtaXNzaW9uVHlwZS5qc1wiXG5pbXBvcnQgeyBsb2NhdG9yIH0gZnJvbSBcIi4uL2FwaS9tYWluL0NvbW1vbkxvY2F0b3IuanNcIlxuaW1wb3J0IHsgcmVuZGVyU2V0dGluZ3NCYW5uZXJCdXR0b24gfSBmcm9tIFwiLi9TZXR0aW5nc0Jhbm5lckJ1dHRvbi5qc1wiXG5cbmZ1bmN0aW9uIHJlbmRlclBlcm1pc3Npb25CdXR0b24ocGVybWlzc2lvbk5hbWU6IFRyYW5zbGF0aW9uS2V5LCBpc1Blcm1pc3Npb25HcmFudGVkOiBib29sZWFuLCBvbmNsaWNrOiBDbGlja0hhbmRsZXIpIHtcblx0cmV0dXJuIHJlbmRlclNldHRpbmdzQmFubmVyQnV0dG9uKGlzUGVybWlzc2lvbkdyYW50ZWQgPyBcImdyYW50ZWRfbXNnXCIgOiBwZXJtaXNzaW9uTmFtZSwgb25jbGljaywgaXNQZXJtaXNzaW9uR3JhbnRlZClcbn1cblxuLy8vIFNob3dzIGEgZGlhbG9nIHRoYXQgYWxsb3dzIHRoZSB1c2VyIHRvIHNldCB0aGUgbm90aWZpY2F0aW9uIGFuZCBiYXR0ZXJ5IHBlcm1pc3Npb25zIG9uIG1vYmlsZS5cbi8vLyBJdCBzaG93cyB0aGUgc2FtZSBzY3JlZW4gYXMgdGhlIG5vdGlmaWNhdGlvbnMgcGFnZSBpbiB0aGUgb25ib2FyZGluZyB3aXphcmRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW5kZXJOb3RpZmljYXRpb25QZXJtaXNzaW9uc0RpYWxvZyhvbkNsb3NlOiAoKSA9PiB2b2lkKSB7XG5cdGxldCBpc05vdGlmaWNhdGlvblBlcm1pc3Npb25HcmFudGVkID0gYXdhaXQgbG9jYXRvci5zeXN0ZW1QZXJtaXNzaW9uSGFuZGxlci5oYXNQZXJtaXNzaW9uKFBlcm1pc3Npb25UeXBlLk5vdGlmaWNhdGlvbilcblx0bGV0IGlzQmF0dGVyeVBlcm1pc3Npb25HcmFudGVkID0gYXdhaXQgbG9jYXRvci5zeXN0ZW1QZXJtaXNzaW9uSGFuZGxlci5oYXNQZXJtaXNzaW9uKFBlcm1pc3Npb25UeXBlLklnbm9yZUJhdHRlcnlPcHRpbWl6YXRpb24pXG5cblx0Y29uc3QgaGVhZGVyQmFyQXR0cnM6IERpYWxvZ0hlYWRlckJhckF0dHJzID0ge1xuXHRcdGxlZnQ6IFtcblx0XHRcdHtcblx0XHRcdFx0bGFiZWw6IFwiY2xvc2VfYWx0XCIsXG5cdFx0XHRcdGNsaWNrOiAoKSA9PiBkaWFsb2cuY2xvc2UoKSxcblx0XHRcdFx0dHlwZTogQnV0dG9uVHlwZS5TZWNvbmRhcnksXG5cdFx0XHR9LFxuXHRcdF0sXG5cdFx0bWlkZGxlOiBcInBlcm1pc3Npb25zX2xhYmVsXCIsXG5cdFx0cmVtb3ZlOiAoKSA9PiBvbkNsb3NlKCksXG5cdH1cblx0Y29uc3QgZGlhbG9nID0gRGlhbG9nLmVkaXRTbWFsbERpYWxvZyhoZWFkZXJCYXJBdHRycywgKCkgPT5cblx0XHRtKE5vdGlmaWNhdGlvblBlcm1pc3Npb25zQm9keSwge1xuXHRcdFx0aXNOb3RpZmljYXRpb25QZXJtaXNzaW9uR3JhbnRlZCxcblx0XHRcdGlzQmF0dGVyeVBlcm1pc3Npb25HcmFudGVkLFxuXHRcdFx0YXNrRm9yTm90aWZpY2F0aW9uUGVybWlzc2lvbjogKGlzR3JhbnRlZCkgPT4ge1xuXHRcdFx0XHRpc05vdGlmaWNhdGlvblBlcm1pc3Npb25HcmFudGVkID0gaXNHcmFudGVkXG5cdFx0XHRcdG0ucmVkcmF3KClcblx0XHRcdH0sXG5cdFx0XHRhc2tGb3JCYXR0ZXJ5Tm90aWZpY2F0aW9uUGVybWlzc2lvbjogYXN5bmMgKGlzR3JhbnRlZCkgPT4ge1xuXHRcdFx0XHRpc0JhdHRlcnlQZXJtaXNzaW9uR3JhbnRlZCA9IGlzR3JhbnRlZFxuXHRcdFx0XHRtLnJlZHJhdygpXG5cdFx0XHR9LFxuXHRcdH0pLFxuXHQpXG5cdGRpYWxvZy5zaG93KClcbn1cblxuZXhwb3J0IGludGVyZmFjZSBOb3RpZmljYXRpb25QZXJtaXNzaW9uc0JvZHlBdHRycyB7XG5cdGlzTm90aWZpY2F0aW9uUGVybWlzc2lvbkdyYW50ZWQ6IGJvb2xlYW5cblx0aXNCYXR0ZXJ5UGVybWlzc2lvbkdyYW50ZWQ6IGJvb2xlYW5cblx0YXNrRm9yTm90aWZpY2F0aW9uUGVybWlzc2lvbjogKGlzR3JhbnRlZDogYm9vbGVhbikgPT4gdm9pZFxuXHRhc2tGb3JCYXR0ZXJ5Tm90aWZpY2F0aW9uUGVybWlzc2lvbjogKGlzR3JhbnRlZDogYm9vbGVhbikgPT4gdm9pZFxufVxuXG4vLy8gRGlzcGxheXMgYnV0dG9ucyB0byBncmFudCB0aGUgbm90aWZpY2F0aW9uIGFuZCBiYXR0ZXJ5IHBlcm1pc3Npb25zIHdpdGggZXhwbGFpbmluZyBwYXJhZ3JhcGhzXG5leHBvcnQgY2xhc3MgTm90aWZpY2F0aW9uUGVybWlzc2lvbnNCb2R5IGltcGxlbWVudHMgQ29tcG9uZW50PE5vdGlmaWNhdGlvblBlcm1pc3Npb25zQm9keUF0dHJzPiB7XG5cdHZpZXcoeyBhdHRycyB9OiBWbm9kZTxOb3RpZmljYXRpb25QZXJtaXNzaW9uc0JvZHlBdHRycz4pIHtcblx0XHRyZXR1cm4gW1xuXHRcdFx0bShcInAubWItc1wiLCBsYW5nLmdldChcImFsbG93Tm90aWZpY2F0aW9uc19tc2dcIikpLFxuXHRcdFx0cmVuZGVyUGVybWlzc2lvbkJ1dHRvbihcImdyYW50X25vdGlmaWNhdGlvbl9wZXJtaXNzaW9uX2FjdGlvblwiLCBhdHRycy5pc05vdGlmaWNhdGlvblBlcm1pc3Npb25HcmFudGVkLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdC8vIEFzayBmb3IgdGhlIG5vdGlmaWNhdGlvbiBwZXJtaXNzaW9uXG5cdFx0XHRcdGNvbnN0IGlzTm90aWZpY2F0aW9uUGVybWlzc2lvbkdyYW50ZWQgPSBhd2FpdCBsb2NhdG9yLnN5c3RlbVBlcm1pc3Npb25IYW5kbGVyLnJlcXVlc3RQZXJtaXNzaW9uKFxuXHRcdFx0XHRcdFBlcm1pc3Npb25UeXBlLk5vdGlmaWNhdGlvbixcblx0XHRcdFx0XHRcImdyYW50X25vdGlmaWNhdGlvbl9wZXJtaXNzaW9uX2FjdGlvblwiLFxuXHRcdFx0XHQpXG5cdFx0XHRcdC8vIFJlZ2lzdGVyIHRoZSBwdXNoIG5vdGlmaWNhdGlvbnMgaWYgZ3JhbnRlZFxuXHRcdFx0XHRpZiAoaXNOb3RpZmljYXRpb25QZXJtaXNzaW9uR3JhbnRlZCkge1xuXHRcdFx0XHRcdGxvY2F0b3IucHVzaFNlcnZpY2UucmVnaXN0ZXIoKVxuXHRcdFx0XHR9XG5cdFx0XHRcdGF0dHJzLmFza0Zvck5vdGlmaWNhdGlvblBlcm1pc3Npb24oaXNOb3RpZmljYXRpb25QZXJtaXNzaW9uR3JhbnRlZClcblx0XHRcdH0pLFxuXHRcdFx0IWlzQW5kcm9pZEFwcCgpXG5cdFx0XHRcdD8gbnVsbFxuXHRcdFx0XHQ6IG0oXCJzZWN0aW9uLm10LXMubWJcIiwgW1xuXHRcdFx0XHRcdFx0bShcInAubWItcy5tdC1zXCIsIGxhbmcuZ2V0KFwiYWxsb3dCYXR0ZXJ5UGVybWlzc2lvbl9tc2dcIikpLFxuXHRcdFx0XHRcdFx0cmVuZGVyUGVybWlzc2lvbkJ1dHRvbihcImdyYW50X2JhdHRlcnlfcGVybWlzc2lvbl9hY3Rpb25cIiwgYXR0cnMuaXNCYXR0ZXJ5UGVybWlzc2lvbkdyYW50ZWQsIGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdFx0Ly8gQXNrIGZvciBwZXJtaXNzaW9uIHRvIGRpc2FibGUgYmF0dGVyeSBvcHRpbWlzYXRpb25zXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGlzQmF0dGVyeVBlcm1pc3Npb25HcmFudGVkID0gYXdhaXQgbG9jYXRvci5zeXN0ZW1QZXJtaXNzaW9uSGFuZGxlci5yZXF1ZXN0UGVybWlzc2lvbihcblx0XHRcdFx0XHRcdFx0XHRQZXJtaXNzaW9uVHlwZS5JZ25vcmVCYXR0ZXJ5T3B0aW1pemF0aW9uLFxuXHRcdFx0XHRcdFx0XHRcdFwiYWxsb3dCYXR0ZXJ5UGVybWlzc2lvbl9tc2dcIixcblx0XHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdFx0XHRhdHRycy5hc2tGb3JCYXR0ZXJ5Tm90aWZpY2F0aW9uUGVybWlzc2lvbihpc0JhdHRlcnlQZXJtaXNzaW9uR3JhbnRlZClcblx0XHRcdFx0XHRcdH0pLFxuXHRcdFx0XHQgIF0pLFxuXHRcdF1cblx0fVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQU9PLFNBQVMsMkJBQTJCQSxNQUFzQkMsU0FBdUJDLFlBQXNCQyxTQUFrQjtBQUMvSCxRQUFPLGdCQUFFLGNBQWM7RUFDdEI7RUFDQSxhQUFhLE1BQU07RUFDbkIsT0FBTyxNQUFNO0VBQ2IsT0FBTyxpQ0FBaUM7RUFDeEMsT0FBTyxDQUFDQyxPQUFtQkMsUUFBcUI7QUFDL0MsV0FBUSxPQUFPLElBQUk7RUFDbkI7RUFDRCxVQUFVLGNBQWM7Q0FDeEIsRUFBQztBQUNGOzs7O0FDUEQsU0FBUyx1QkFBdUJDLGdCQUFnQ0MscUJBQThCQyxTQUF1QjtBQUNwSCxRQUFPLDJCQUEyQixzQkFBc0IsZ0JBQWdCLGdCQUFnQixTQUFTLG9CQUFvQjtBQUNySDtBQUlNLGVBQWUsb0NBQW9DQyxTQUFxQjtDQUM5RSxJQUFJLGtDQUFrQyxNQUFNLFFBQVEsd0JBQXdCLGNBQWMsZUFBZSxhQUFhO0NBQ3RILElBQUksNkJBQTZCLE1BQU0sUUFBUSx3QkFBd0IsY0FBYyxlQUFlLDBCQUEwQjtDQUU5SCxNQUFNQyxpQkFBdUM7RUFDNUMsTUFBTSxDQUNMO0dBQ0MsT0FBTztHQUNQLE9BQU8sTUFBTSxPQUFPLE9BQU87R0FDM0IsTUFBTSxXQUFXO0VBQ2pCLENBQ0Q7RUFDRCxRQUFRO0VBQ1IsUUFBUSxNQUFNLFNBQVM7Q0FDdkI7Q0FDRCxNQUFNLFNBQVMsT0FBTyxnQkFBZ0IsZ0JBQWdCLE1BQ3JELGdCQUFFLDZCQUE2QjtFQUM5QjtFQUNBO0VBQ0EsOEJBQThCLENBQUMsY0FBYztBQUM1QyxxQ0FBa0M7QUFDbEMsbUJBQUUsUUFBUTtFQUNWO0VBQ0QscUNBQXFDLE9BQU8sY0FBYztBQUN6RCxnQ0FBNkI7QUFDN0IsbUJBQUUsUUFBUTtFQUNWO0NBQ0QsRUFBQyxDQUNGO0FBQ0QsUUFBTyxNQUFNO0FBQ2I7SUFVWSw4QkFBTixNQUF5RjtDQUMvRixLQUFLLEVBQUUsT0FBZ0QsRUFBRTtBQUN4RCxTQUFPO0dBQ04sZ0JBQUUsVUFBVSxLQUFLLElBQUkseUJBQXlCLENBQUM7R0FDL0MsdUJBQXVCLHdDQUF3QyxNQUFNLGlDQUFpQyxZQUFZO0lBRWpILE1BQU0sa0NBQWtDLE1BQU0sUUFBUSx3QkFBd0Isa0JBQzdFLGVBQWUsY0FDZix1Q0FDQTtBQUVELFFBQUksZ0NBQ0gsU0FBUSxZQUFZLFVBQVU7QUFFL0IsVUFBTSw2QkFBNkIsZ0NBQWdDO0dBQ25FLEVBQUM7SUFDRCxjQUFjLEdBQ1osT0FDQSxnQkFBRSxtQkFBbUIsQ0FDckIsZ0JBQUUsZUFBZSxLQUFLLElBQUksNkJBQTZCLENBQUMsRUFDeEQsdUJBQXVCLG1DQUFtQyxNQUFNLDRCQUE0QixZQUFZO0lBRXZHLE1BQU0sNkJBQTZCLE1BQU0sUUFBUSx3QkFBd0Isa0JBQ3hFLGVBQWUsMkJBQ2YsNkJBQ0E7QUFDRCxVQUFNLG9DQUFvQywyQkFBMkI7R0FDckUsRUFBQyxBQUNELEVBQUM7RUFDTDtDQUNEO0FBQ0QifQ==