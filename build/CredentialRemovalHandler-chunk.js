import "./dist-chunk.js";
import { DeviceStorageUnavailableError } from "./DeviceStorageUnavailableError-chunk.js";

//#region src/common/login/CredentialRemovalHandler.ts
var NoopCredentialRemovalHandler = class {
	async onCredentialsRemoved(_) {}
};
var AppsCredentialRemovalHandler = class {
	constructor(pushApp, configFacade, appSpecificCredentialRemovalActions) {
		this.pushApp = pushApp;
		this.configFacade = configFacade;
		this.appSpecificCredentialRemovalActions = appSpecificCredentialRemovalActions;
	}
	async onCredentialsRemoved({ login, userId }) {
		await this.pushApp.invalidateAlarmsForUser(userId);
		try {
			await this.pushApp.removeUserFromNotifications(userId);
		} catch (e) {
			if (e instanceof DeviceStorageUnavailableError) console.warn("Could not remove SSE data: ", e);
else throw e;
		}
		await this.configFacade.delete(userId);
		await this.appSpecificCredentialRemovalActions(login, userId);
	}
};

//#endregion
export { AppsCredentialRemovalHandler, NoopCredentialRemovalHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3JlZGVudGlhbFJlbW92YWxIYW5kbGVyLWNodW5rLmpzIiwibmFtZXMiOlsiXzogQ3JlZGVudGlhbHNJbmZvIiwicHVzaEFwcDogTmF0aXZlUHVzaFNlcnZpY2VBcHAiLCJjb25maWdGYWNhZGU6IENvbmZpZ3VyYXRpb25EYXRhYmFzZSIsImFwcFNwZWNpZmljQ3JlZGVudGlhbFJlbW92YWxBY3Rpb25zOiAobG9naW46IHN0cmluZywgdXNlcklkOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4iXSwic291cmNlcyI6WyIuLi9zcmMvY29tbW9uL2xvZ2luL0NyZWRlbnRpYWxSZW1vdmFsSGFuZGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOYXRpdmVQdXNoU2VydmljZUFwcCB9IGZyb20gXCIuLi9uYXRpdmUvbWFpbi9OYXRpdmVQdXNoU2VydmljZUFwcC5qc1wiXG5pbXBvcnQgeyBDb25maWd1cmF0aW9uRGF0YWJhc2UgfSBmcm9tIFwiLi4vYXBpL3dvcmtlci9mYWNhZGVzL2xhenkvQ29uZmlndXJhdGlvbkRhdGFiYXNlLmpzXCJcbmltcG9ydCB7IENyZWRlbnRpYWxzSW5mbyB9IGZyb20gXCIuLi9uYXRpdmUvY29tbW9uL2dlbmVyYXRlZGlwYy9DcmVkZW50aWFsc0luZm8uanNcIlxuaW1wb3J0IHsgRGV2aWNlU3RvcmFnZVVuYXZhaWxhYmxlRXJyb3IgfSBmcm9tIFwiLi4vYXBpL2NvbW1vbi9lcnJvci9EZXZpY2VTdG9yYWdlVW5hdmFpbGFibGVFcnJvclwiXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlZGVudGlhbFJlbW92YWxIYW5kbGVyIHtcblx0b25DcmVkZW50aWFsc1JlbW92ZWQoY3JlZGVudGlhbEluZm86IENyZWRlbnRpYWxzSW5mbyk6IFByb21pc2U8dm9pZD5cbn1cblxuZXhwb3J0IGNsYXNzIE5vb3BDcmVkZW50aWFsUmVtb3ZhbEhhbmRsZXIgaW1wbGVtZW50cyBDcmVkZW50aWFsUmVtb3ZhbEhhbmRsZXIge1xuXHRhc3luYyBvbkNyZWRlbnRpYWxzUmVtb3ZlZChfOiBDcmVkZW50aWFsc0luZm8pOiBQcm9taXNlPHZvaWQ+IHt9XG59XG5cbmV4cG9ydCBjbGFzcyBBcHBzQ3JlZGVudGlhbFJlbW92YWxIYW5kbGVyIGltcGxlbWVudHMgQ3JlZGVudGlhbFJlbW92YWxIYW5kbGVyIHtcblx0Y29uc3RydWN0b3IoXG5cdFx0cHJpdmF0ZSByZWFkb25seSBwdXNoQXBwOiBOYXRpdmVQdXNoU2VydmljZUFwcCxcblx0XHRwcml2YXRlIHJlYWRvbmx5IGNvbmZpZ0ZhY2FkZTogQ29uZmlndXJhdGlvbkRhdGFiYXNlLFxuXHRcdHByaXZhdGUgcmVhZG9ubHkgYXBwU3BlY2lmaWNDcmVkZW50aWFsUmVtb3ZhbEFjdGlvbnM6IChsb2dpbjogc3RyaW5nLCB1c2VySWQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPixcblx0KSB7fVxuXG5cdGFzeW5jIG9uQ3JlZGVudGlhbHNSZW1vdmVkKHsgbG9naW4sIHVzZXJJZCB9OiBDcmVkZW50aWFsc0luZm8pIHtcblx0XHRhd2FpdCB0aGlzLnB1c2hBcHAuaW52YWxpZGF0ZUFsYXJtc0ZvclVzZXIodXNlcklkKVxuXHRcdHRyeSB7XG5cdFx0XHRhd2FpdCB0aGlzLnB1c2hBcHAucmVtb3ZlVXNlckZyb21Ob3RpZmljYXRpb25zKHVzZXJJZClcblx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRpZiAoZSBpbnN0YW5jZW9mIERldmljZVN0b3JhZ2VVbmF2YWlsYWJsZUVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCByZW1vdmUgU1NFIGRhdGE6IFwiLCBlKVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhyb3cgZVxuXHRcdFx0fVxuXHRcdH1cblx0XHRhd2FpdCB0aGlzLmNvbmZpZ0ZhY2FkZS5kZWxldGUodXNlcklkKVxuXG5cdFx0YXdhaXQgdGhpcy5hcHBTcGVjaWZpY0NyZWRlbnRpYWxSZW1vdmFsQWN0aW9ucyhsb2dpbiwgdXNlcklkKVxuXHR9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7SUFTYSwrQkFBTixNQUF1RTtDQUM3RSxNQUFNLHFCQUFxQkEsR0FBbUMsQ0FBRTtBQUNoRTtJQUVZLCtCQUFOLE1BQXVFO0NBQzdFLFlBQ2tCQyxTQUNBQyxjQUNBQyxxQ0FDaEI7RUFrQkYsS0FyQmtCO0VBcUJqQixLQXBCaUI7RUFvQmhCLEtBbkJnQjtDQUNkO0NBRUosTUFBTSxxQkFBcUIsRUFBRSxPQUFPLFFBQXlCLEVBQUU7QUFDOUQsUUFBTSxLQUFLLFFBQVEsd0JBQXdCLE9BQU87QUFDbEQsTUFBSTtBQUNILFNBQU0sS0FBSyxRQUFRLDRCQUE0QixPQUFPO0VBQ3RELFNBQVEsR0FBRztBQUNYLE9BQUksYUFBYSw4QkFDaEIsU0FBUSxLQUFLLCtCQUErQixFQUFFO0lBRTlDLE9BQU07RUFFUDtBQUNELFFBQU0sS0FBSyxhQUFhLE9BQU8sT0FBTztBQUV0QyxRQUFNLEtBQUssb0NBQW9DLE9BQU8sT0FBTztDQUM3RDtBQUNEIn0=