import { Mode, assertMainOrNodeBoot, isApp, isElectronClient, isIOSApp } from "./Env-chunk.js";
import { client } from "./ClientDetector-chunk.js";
import { mithril_default } from "./mithril-chunk.js";
import { noOp, remove } from "./dist2-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";

//#region src/common/misc/WindowFacade.ts
assertMainOrNodeBoot();
var WindowFacade = class {
	_windowSizeListeners;
	resizeTimeout;
	windowCloseConfirmation;
	_windowCloseListeners;
	_historyStateEventListeners = [];
	indexerFacade = null;
	_keyboardSize = 0;
	_keyboardSizeListeners = [];
	_ignoreNextPopstate = false;
	connectivityModel;
	logins = null;
	appBasedVisibilityChage = noOp;
	constructor() {
		this._windowSizeListeners = [];
		this.resizeTimeout = null;
		this.windowCloseConfirmation = false;
		this._windowCloseListeners = new Set();
		const onresize = () => {
			if (!this.resizeTimeout) {
				const cb = () => {
					this.resizeTimeout = null;
					this._resize();
				};
				this.resizeTimeout = client.isMobileDevice() ? setTimeout(cb, 66) : requestAnimationFrame(cb);
			}
		};
		window.onresize = onresize;
		window.onorientationchange = onresize;
	}
	/**
	* Add a window resize listener with a listenerId
	* @param listener Provides the new width and height of the window if the values change.
	*/
	addResizeListener(listener) {
		this._windowSizeListeners.push(listener);
	}
	removeResizeListener(listener) {
		remove(this._windowSizeListeners, listener);
	}
	addWindowCloseListener(listener) {
		this._windowCloseListeners.add(listener);
		this._checkWindowClosing(this._windowCloseListeners.size > 0);
		return () => {
			this._windowCloseListeners.delete(listener);
			this._checkWindowClosing(this._windowCloseListeners.size > 0);
		};
	}
	_notifyCloseListeners(e) {
		for (const f of this._windowCloseListeners) f(e);
	}
	addKeyboardSizeListener(listener) {
		this._keyboardSizeListeners.push(listener);
		listener(this._keyboardSize);
	}
	removeKeyboardSizeListener(listener) {
		remove(this._keyboardSizeListeners, listener);
	}
	openLink(href) {
		if (env.mode === Mode.App) window.open(href, "_system");
else window.open(href, "_blank");
	}
	init(logins, connectivityModel, appBasedVisibilityChage) {
		this.logins = logins;
		if (window.addEventListener && !isApp()) {
			window.addEventListener("beforeunload", (e) => this._beforeUnload(e));
			window.addEventListener("popstate", (e) => this._popState(e));
			window.addEventListener("unload", (e) => this._onUnload());
		}
		this.appBasedVisibilityChage = appBasedVisibilityChage ?? noOp;
		this.connectivityModel = connectivityModel;
		if (env.mode === Mode.App || env.mode === Mode.Desktop || env.mode === Mode.Admin) this.addPageInBackgroundListener();
		if (env.mode === Mode.Desktop && client.isMacOS && window.addEventListener) window.addEventListener("keydown", (e) => {
			if (!e.metaKey || e.key === "Meta") return;
			const target = e.target;
			if (target?.tagName === "INPUT" || target?.contentEditable === "true") e.stopPropagation();
else if (e.key === "ArrowLeft") window.history.back();
else if (e.key === "ArrowRight") window.history.forward();
		});
		this._resize();
	}
	_resize() {
		try {
			for (const listener of this._windowSizeListeners) listener(window.innerWidth, window.innerHeight);
		} finally {
			mithril_default.redraw();
		}
	}
	_checkWindowClosing(enable) {
		this.windowCloseConfirmation = enable;
	}
	_beforeUnload(e) {
		console.log("windowfacade._beforeUnload");
		this._notifyCloseListeners(e);
		if (this.windowCloseConfirmation) {
			let m = lang.get("closeWindowConfirmation_msg");
			e.returnValue = m;
			return m;
		} else {
			this.logins?.logout(true);
			return null;
		}
	}
	/**
	* add a function to call when onpopstate event occurs
	* @param listener: return true if this popstate may go ahead
	* @returns {Function}
	*/
	addHistoryEventListener(listener) {
		this._historyStateEventListeners.push(listener);
		return () => {
			const index = this._historyStateEventListeners.indexOf(listener);
			if (index !== -1) this._historyStateEventListeners.splice(index, 1);
		};
	}
	removeHistoryEventListener(listener) {
		remove(this._historyStateEventListeners, listener);
	}
	/**
	* calls the last history event listener that was added
	* and reverts the state change if it returns false
	* TODO: this also fires for forward-events and when the user jumps around in the history
	* TODO: by long-clicking the back/forward buttons.
	* TODO: solving this requires extensive bookkeeping because the events are indistinguishable by default
	* @param e: popstate DOM event
	* @private
	*/
	_popState(e) {
		const len = this._historyStateEventListeners.length;
		if (len === 0) return;
		if (this._ignoreNextPopstate) {
			this._ignoreNextPopstate = false;
			return;
		}
		if (!this._historyStateEventListeners[len - 1](e)) {
			this._ignoreNextPopstate = true;
			history.go(1);
		}
	}
	_onUnload() {
		if (this.windowCloseConfirmation && this.logins) this.logins.logout(true);
	}
	addOnlineListener(listener) {
		window.addEventListener("online", listener);
	}
	addOfflineListener(listener) {
		window.addEventListener("offline", listener);
	}
	async reload(args) {
		if (isApp() || isElectronClient()) {
			if (!Object.hasOwn(args, "noAutoLogin")) args.noAutoLogin = true;
			const { locator } = await import("./CommonLocator2-chunk.js");
			const stringifiedArgs = {};
			for (const [k, v] of Object.entries(args)) if (v != null) stringifiedArgs[k] = String(v);
			await locator.commonSystemFacade.reload(stringifiedArgs);
		} else window.location.reload();
	}
	addPageInBackgroundListener() {
		if (isIOSApp()) document.addEventListener("visibilitychange", () => {
			console.log("Visibility change, hidden: ", document.hidden);
			this.appBasedVisibilityChage(!document.hidden);
			if (!document.hidden) setTimeout(() => this.connectivityModel?.tryReconnect(false, true), 100);
		});
	}
	onKeyboardSizeChanged(size) {
		this._keyboardSize = size;
		for (let listener of this._keyboardSizeListeners) listener(size);
		if (size > 0) {
			const body = document.body;
			body.style.position = "unset";
			setTimeout(() => {
				body.style.position = "fixed";
			}, 200);
		}
	}
};
const windowFacade = new WindowFacade();

//#endregion
export { WindowFacade, windowFacade };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2luZG93RmFjYWRlLWNodW5rLmpzIiwibmFtZXMiOlsibGlzdGVuZXI6IHdpbmRvd1NpemVMaXN0ZW5lciIsImxpc3RlbmVyOiAoKSA9PiB1bmtub3duIiwiZTogRXZlbnQiLCJsaXN0ZW5lcjogS2V5Ym9hcmRTaXplTGlzdGVuZXIiLCJocmVmOiBzdHJpbmciLCJsb2dpbnM6IExvZ2luQ29udHJvbGxlciIsImNvbm5lY3Rpdml0eU1vZGVsOiBXZWJzb2NrZXRDb25uZWN0aXZpdHlNb2RlbCIsImFwcEJhc2VkVmlzaWJpbGl0eUNoYWdlOiAoKHZpc2libGU6IGJvb2xlYW4pID0+IHZvaWQpIHwgbnVsbCIsImVuYWJsZTogYm9vbGVhbiIsImU6IGFueSIsImxpc3RlbmVyOiAoZTogRXZlbnQpID0+IGJvb2xlYW4iLCJsaXN0ZW5lcjogKCkgPT4gdm9pZCIsImFyZ3M6IFBhcmFtcyIsInN0cmluZ2lmaWVkQXJnczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiIsInNpemU6IG51bWJlciIsIndpbmRvd0ZhY2FkZTogV2luZG93RmFjYWRlIl0sInNvdXJjZXMiOlsiLi4vc3JjL2NvbW1vbi9taXNjL1dpbmRvd0ZhY2FkZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbSwgeyBQYXJhbXMgfSBmcm9tIFwibWl0aHJpbFwiXG5pbXBvcnQgeyBhc3NlcnRNYWluT3JOb2RlQm9vdCwgaXNBcHAsIGlzRWxlY3Ryb25DbGllbnQsIGlzSU9TQXBwLCBNb2RlIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vRW52XCJcbmltcG9ydCB7IGxhbmcgfSBmcm9tIFwiLi9MYW5ndWFnZVZpZXdNb2RlbFwiXG5pbXBvcnQgeyBjbGllbnQgfSBmcm9tIFwiLi9DbGllbnREZXRlY3RvclwiXG5pbXBvcnQgdHlwZSB7IEluZGV4ZXIgfSBmcm9tIFwiLi4vLi4vbWFpbC1hcHAvd29ya2VyVXRpbHMvaW5kZXgvSW5kZXhlci5qc1wiXG5pbXBvcnQgeyBub09wLCByZW1vdmUgfSBmcm9tIFwiQHR1dGFvL3R1dGFub3RhLXV0aWxzXCJcbmltcG9ydCB7IFdlYnNvY2tldENvbm5lY3Rpdml0eU1vZGVsIH0gZnJvbSBcIi4vV2Vic29ja2V0Q29ubmVjdGl2aXR5TW9kZWwuanNcIlxuaW1wb3J0IHsgTG9naW5Db250cm9sbGVyIH0gZnJvbSBcIi4uL2FwaS9tYWluL0xvZ2luQ29udHJvbGxlci5qc1wiXG5cbmFzc2VydE1haW5Pck5vZGVCb290KClcbmV4cG9ydCB0eXBlIEtleWJvYXJkU2l6ZUxpc3RlbmVyID0gKGtleWJvYXJkU2l6ZTogbnVtYmVyKSA9PiB1bmtub3duXG5leHBvcnQgdHlwZSB3aW5kb3dTaXplTGlzdGVuZXIgPSAod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpID0+IHVua25vd25cblxuZXhwb3J0IGNsYXNzIFdpbmRvd0ZhY2FkZSB7XG5cdHByaXZhdGUgX3dpbmRvd1NpemVMaXN0ZW5lcnM6IHdpbmRvd1NpemVMaXN0ZW5lcltdXG5cdHJlc2l6ZVRpbWVvdXQ6IChBbmltYXRpb25GcmFtZUlEIHwgbnVsbCkgfCAoVGltZW91dElEIHwgbnVsbClcblx0d2luZG93Q2xvc2VDb25maXJtYXRpb246IGJvb2xlYW5cblx0cHJpdmF0ZSBfd2luZG93Q2xvc2VMaXN0ZW5lcnM6IFNldDwoZTogRXZlbnQpID0+IHVua25vd24+XG5cdHByaXZhdGUgX2hpc3RvcnlTdGF0ZUV2ZW50TGlzdGVuZXJzOiBBcnJheTwoZTogRXZlbnQpID0+IGJvb2xlYW4+ID0gW11cblx0cHJpdmF0ZSBpbmRleGVyRmFjYWRlOiBJbmRleGVyIHwgbnVsbCA9IG51bGxcblx0Ly8gZm9sbG93aW5nIHR3byBwcm9wZXJ0aWVzIGFyZSBmb3IgdGhlIGlPU1xuXHRwcml2YXRlIF9rZXlib2FyZFNpemU6IG51bWJlciA9IDBcblx0cHJpdmF0ZSBfa2V5Ym9hcmRTaXplTGlzdGVuZXJzOiBLZXlib2FyZFNpemVMaXN0ZW5lcltdID0gW11cblx0cHJpdmF0ZSBfaWdub3JlTmV4dFBvcHN0YXRlOiBib29sZWFuID0gZmFsc2Vcblx0cHJpdmF0ZSBjb25uZWN0aXZpdHlNb2RlbCE6IFdlYnNvY2tldENvbm5lY3Rpdml0eU1vZGVsXG5cdHByaXZhdGUgbG9naW5zOiBMb2dpbkNvbnRyb2xsZXIgfCBudWxsID0gbnVsbFxuXHRwcml2YXRlIGFwcEJhc2VkVmlzaWJpbGl0eUNoYWdlOiAodmlzaWJsZTogYm9vbGVhbikgPT4gdm9pZCA9IG5vT3BcblxuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHR0aGlzLl93aW5kb3dTaXplTGlzdGVuZXJzID0gW11cblx0XHR0aGlzLnJlc2l6ZVRpbWVvdXQgPSBudWxsXG5cdFx0dGhpcy53aW5kb3dDbG9zZUNvbmZpcm1hdGlvbiA9IGZhbHNlXG5cdFx0dGhpcy5fd2luZG93Q2xvc2VMaXN0ZW5lcnMgPSBuZXcgU2V0KClcblxuXHRcdGNvbnN0IG9ucmVzaXplID0gKCkgPT4ge1xuXHRcdFx0Ly8gc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0V2ZW50cy9yZXNpemVcblx0XHRcdGlmICghdGhpcy5yZXNpemVUaW1lb3V0KSB7XG5cdFx0XHRcdGNvbnN0IGNiID0gKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucmVzaXplVGltZW91dCA9IG51bGxcblxuXHRcdFx0XHRcdHRoaXMuX3Jlc2l6ZSgpIC8vIFRoZSBhY3R1YWxSZXNpemVIYW5kbGVyIHdpbGwgZXhlY3V0ZSBhdCBhIHJhdGUgb2YgMTVmcHNcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIE9uIG1vYmlsZSBkZXZpY2VzIHRoZXJlJ3MgdXN1YWxseSBubyByZXNpemUgYnV0IHdoZW4gY2hhbmdpbmcgb3JpZW50YXRpb24gaXQncyB0byBlYXJseSB0b1xuXHRcdFx0XHQvLyBtZWFzdXJlIHRoZSBzaXplIGluIHJlcXVlc3RBbmltYXRpb25GcmFtZSAoaXQncyB1c3VhbGx5IGluY29ycmVjdCBzaXplIGF0IHRoaXMgcG9pbnQpXG5cdFx0XHRcdHRoaXMucmVzaXplVGltZW91dCA9IGNsaWVudC5pc01vYmlsZURldmljZSgpID8gc2V0VGltZW91dChjYiwgNjYpIDogcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNiKVxuXHRcdFx0fVxuXHRcdH1cblx0XHR3aW5kb3cub25yZXNpemUgPSBvbnJlc2l6ZVxuXHRcdC8vIHNwZWNpZmlhbGx5IGZvciBpT1M6IHJvdGF0aW9uIHRocm91Z2ggdGhlIHVuc3VwcG9ydGVkIG9yaWVudGF0aW9uIChlLmcsIDkwIGRlZ3JlZXMgMyB0aW1lcykgd2lsbCBub3QgdHJpZ2dlciB0aGUgcmVzaXplIGFuZCB3ZSB3b3VsZG4ndCByZXNpemVcblx0XHQvLyBzb21lIHRoaW5ncyBzbyB3ZSByZWFjdCB0byBib3RoLCBpdCBpcyB0aHJvdHRsZWQgYW55d2F5XG5cdFx0d2luZG93Lm9ub3JpZW50YXRpb25jaGFuZ2UgPSBvbnJlc2l6ZVxuXHR9XG5cblx0LyoqXG5cdCAqIEFkZCBhIHdpbmRvdyByZXNpemUgbGlzdGVuZXIgd2l0aCBhIGxpc3RlbmVySWRcblx0ICogQHBhcmFtIGxpc3RlbmVyIFByb3ZpZGVzIHRoZSBuZXcgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgd2luZG93IGlmIHRoZSB2YWx1ZXMgY2hhbmdlLlxuXHQgKi9cblx0YWRkUmVzaXplTGlzdGVuZXIobGlzdGVuZXI6IHdpbmRvd1NpemVMaXN0ZW5lcikge1xuXHRcdHRoaXMuX3dpbmRvd1NpemVMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcilcblx0fVxuXG5cdHJlbW92ZVJlc2l6ZUxpc3RlbmVyKGxpc3RlbmVyOiB3aW5kb3dTaXplTGlzdGVuZXIpIHtcblx0XHRyZW1vdmUodGhpcy5fd2luZG93U2l6ZUxpc3RlbmVycywgbGlzdGVuZXIpXG5cdH1cblxuXHRhZGRXaW5kb3dDbG9zZUxpc3RlbmVyKGxpc3RlbmVyOiAoKSA9PiB1bmtub3duKTogKC4uLmFyZ3M6IEFycmF5PGFueT4pID0+IGFueSB7XG5cdFx0dGhpcy5fd2luZG93Q2xvc2VMaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKVxuXG5cdFx0dGhpcy5fY2hlY2tXaW5kb3dDbG9zaW5nKHRoaXMuX3dpbmRvd0Nsb3NlTGlzdGVuZXJzLnNpemUgPiAwKVxuXG5cdFx0cmV0dXJuICgpID0+IHtcblx0XHRcdHRoaXMuX3dpbmRvd0Nsb3NlTGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcilcblxuXHRcdFx0dGhpcy5fY2hlY2tXaW5kb3dDbG9zaW5nKHRoaXMuX3dpbmRvd0Nsb3NlTGlzdGVuZXJzLnNpemUgPiAwKVxuXHRcdH1cblx0fVxuXG5cdF9ub3RpZnlDbG9zZUxpc3RlbmVycyhlOiBFdmVudCkge1xuXHRcdGZvciAoY29uc3QgZiBvZiB0aGlzLl93aW5kb3dDbG9zZUxpc3RlbmVycykge1xuXHRcdFx0ZihlKVxuXHRcdH1cblx0fVxuXG5cdGFkZEtleWJvYXJkU2l6ZUxpc3RlbmVyKGxpc3RlbmVyOiBLZXlib2FyZFNpemVMaXN0ZW5lcikge1xuXHRcdHRoaXMuX2tleWJvYXJkU2l6ZUxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKVxuXG5cdFx0bGlzdGVuZXIodGhpcy5fa2V5Ym9hcmRTaXplKVxuXHR9XG5cblx0cmVtb3ZlS2V5Ym9hcmRTaXplTGlzdGVuZXIobGlzdGVuZXI6IEtleWJvYXJkU2l6ZUxpc3RlbmVyKSB7XG5cdFx0cmVtb3ZlKHRoaXMuX2tleWJvYXJkU2l6ZUxpc3RlbmVycywgbGlzdGVuZXIpXG5cdH1cblxuXHRvcGVuTGluayhocmVmOiBzdHJpbmcpIHtcblx0XHRpZiAoZW52Lm1vZGUgPT09IE1vZGUuQXBwKSB7XG5cdFx0XHR3aW5kb3cub3BlbihocmVmLCBcIl9zeXN0ZW1cIilcblx0XHR9IGVsc2Uge1xuXHRcdFx0d2luZG93Lm9wZW4oaHJlZiwgXCJfYmxhbmtcIilcblx0XHR9XG5cdH1cblxuXHRpbml0KGxvZ2luczogTG9naW5Db250cm9sbGVyLCBjb25uZWN0aXZpdHlNb2RlbDogV2Vic29ja2V0Q29ubmVjdGl2aXR5TW9kZWwsIGFwcEJhc2VkVmlzaWJpbGl0eUNoYWdlOiAoKHZpc2libGU6IGJvb2xlYW4pID0+IHZvaWQpIHwgbnVsbCkge1xuXHRcdHRoaXMubG9naW5zID0gbG9naW5zXG5cblx0XHRpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIgJiYgIWlzQXBwKCkpIHtcblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiYmVmb3JldW5sb2FkXCIsIChlKSA9PiB0aGlzLl9iZWZvcmVVbmxvYWQoZSkpXG5cdFx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIChlKSA9PiB0aGlzLl9wb3BTdGF0ZShlKSlcblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidW5sb2FkXCIsIChlKSA9PiB0aGlzLl9vblVubG9hZCgpKVxuXHRcdH1cblxuXHRcdHRoaXMuYXBwQmFzZWRWaXNpYmlsaXR5Q2hhZ2UgPSBhcHBCYXNlZFZpc2liaWxpdHlDaGFnZSA/PyBub09wXG5cdFx0dGhpcy5jb25uZWN0aXZpdHlNb2RlbCA9IGNvbm5lY3Rpdml0eU1vZGVsXG5cblx0XHRpZiAoZW52Lm1vZGUgPT09IE1vZGUuQXBwIHx8IGVudi5tb2RlID09PSBNb2RlLkRlc2t0b3AgfHwgZW52Lm1vZGUgPT09IE1vZGUuQWRtaW4pIHtcblx0XHRcdHRoaXMuYWRkUGFnZUluQmFja2dyb3VuZExpc3RlbmVyKClcblx0XHR9XG5cblx0XHQvLyBuZWVkZWQgdG8gaGVscCB0aGUgTWFjT3MgZGVza3RvcCBjbGllbnQgdG8gZGlzdGluZ3Vpc2ggYmV0d2VlbiBDbWQrQXJyb3cgdG8gbmF2aWdhdGUgdGhlIGhpc3Rvcnlcblx0XHQvLyBhbmQgQ21kK0Fycm93IHRvIG5hdmlnYXRlIGEgdGV4dCBlZGl0b3Jcblx0XHRpZiAoZW52Lm1vZGUgPT09IE1vZGUuRGVza3RvcCAmJiBjbGllbnQuaXNNYWNPUyAmJiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikge1xuXHRcdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG5cdFx0XHRcdGlmICghZS5tZXRhS2V5IHx8IGUua2V5ID09PSBcIk1ldGFcIikgcmV0dXJuXG5cblx0XHRcdFx0Y29uc3QgdGFyZ2V0ID0gZS50YXJnZXQgYXMgSFRNTEVsZW1lbnQgfCBudWxsXG5cdFx0XHRcdC8vIHByZXZlbnQgaGlzdG9yeSBuYXYgaWYgdGhlIGFjdGl2ZSBlbGVtZW50IGlzIGFuIGlucHV0IC8gc3F1aXJlIGVkaXRvclxuXHRcdFx0XHRpZiAodGFyZ2V0Py50YWdOYW1lID09PSBcIklOUFVUXCIgfHwgdGFyZ2V0Py5jb250ZW50RWRpdGFibGUgPT09IFwidHJ1ZVwiKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKVxuXHRcdFx0XHR9IGVsc2UgaWYgKGUua2V5ID09PSBcIkFycm93TGVmdFwiKSB7XG5cdFx0XHRcdFx0d2luZG93Lmhpc3RvcnkuYmFjaygpXG5cdFx0XHRcdH0gZWxzZSBpZiAoZS5rZXkgPT09IFwiQXJyb3dSaWdodFwiKSB7XG5cdFx0XHRcdFx0d2luZG93Lmhpc3RvcnkuZm9yd2FyZCgpXG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0Ly8gY2FsbCB0aGUgcmVzaXplIGxpc3RlbmVycyBvbmNlIHRvIG1ha2Ugc3VyZSBldmVyeW9uZVxuXHRcdC8vIGhhcyB0aGUgY3VycmVudCB3aW5kb3cgc2l6ZSBvbmNlIHdlJ3JlIGRvbmUgaW5pdGlhbGl6aW5nXG5cdFx0dGhpcy5fcmVzaXplKClcblx0fVxuXG5cdF9yZXNpemUoKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdGhpcy5fd2luZG93U2l6ZUxpc3RlbmVycykge1xuXHRcdFx0XHRsaXN0ZW5lcih3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KVxuXHRcdFx0fVxuXHRcdH0gZmluYWxseSB7XG5cdFx0XHRtLnJlZHJhdygpXG5cdFx0fVxuXHR9XG5cblx0X2NoZWNrV2luZG93Q2xvc2luZyhlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLndpbmRvd0Nsb3NlQ29uZmlybWF0aW9uID0gZW5hYmxlXG5cdH1cblxuXHRfYmVmb3JlVW5sb2FkKGU6IGFueSk6IHN0cmluZyB8IG51bGwge1xuXHRcdC8vIEJlZm9yZVVubG9hZEV2ZW50XG5cdFx0Y29uc29sZS5sb2coXCJ3aW5kb3dmYWNhZGUuX2JlZm9yZVVubG9hZFwiKVxuXG5cdFx0dGhpcy5fbm90aWZ5Q2xvc2VMaXN0ZW5lcnMoZSlcblxuXHRcdGlmICh0aGlzLndpbmRvd0Nsb3NlQ29uZmlybWF0aW9uKSB7XG5cdFx0XHRsZXQgbSA9IGxhbmcuZ2V0KFwiY2xvc2VXaW5kb3dDb25maXJtYXRpb25fbXNnXCIpXG5cdFx0XHRlLnJldHVyblZhbHVlID0gbVxuXHRcdFx0cmV0dXJuIG1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5sb2dpbnM/LmxvZ291dCh0cnVlKVxuXHRcdFx0cmV0dXJuIG51bGxcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogYWRkIGEgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIG9ucG9wc3RhdGUgZXZlbnQgb2NjdXJzXG5cdCAqIEBwYXJhbSBsaXN0ZW5lcjogcmV0dXJuIHRydWUgaWYgdGhpcyBwb3BzdGF0ZSBtYXkgZ28gYWhlYWRcblx0ICogQHJldHVybnMge0Z1bmN0aW9ufVxuXHQgKi9cblx0YWRkSGlzdG9yeUV2ZW50TGlzdGVuZXIobGlzdGVuZXI6IChlOiBFdmVudCkgPT4gYm9vbGVhbik6ICgpID0+IHZvaWQge1xuXHRcdHRoaXMuX2hpc3RvcnlTdGF0ZUV2ZW50TGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpXG5cblx0XHRyZXR1cm4gKCkgPT4ge1xuXHRcdFx0Y29uc3QgaW5kZXggPSB0aGlzLl9oaXN0b3J5U3RhdGVFdmVudExpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKVxuXG5cdFx0XHRpZiAoaW5kZXggIT09IC0xKSB7XG5cdFx0XHRcdHRoaXMuX2hpc3RvcnlTdGF0ZUV2ZW50TGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSlcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZW1vdmVIaXN0b3J5RXZlbnRMaXN0ZW5lcihsaXN0ZW5lcjogKGU6IEV2ZW50KSA9PiBib29sZWFuKTogdm9pZCB7XG5cdFx0cmVtb3ZlKHRoaXMuX2hpc3RvcnlTdGF0ZUV2ZW50TGlzdGVuZXJzLCBsaXN0ZW5lcilcblx0fVxuXG5cdC8qKlxuXHQgKiBjYWxscyB0aGUgbGFzdCBoaXN0b3J5IGV2ZW50IGxpc3RlbmVyIHRoYXQgd2FzIGFkZGVkXG5cdCAqIGFuZCByZXZlcnRzIHRoZSBzdGF0ZSBjaGFuZ2UgaWYgaXQgcmV0dXJucyBmYWxzZVxuXHQgKiBUT0RPOiB0aGlzIGFsc28gZmlyZXMgZm9yIGZvcndhcmQtZXZlbnRzIGFuZCB3aGVuIHRoZSB1c2VyIGp1bXBzIGFyb3VuZCBpbiB0aGUgaGlzdG9yeVxuXHQgKiBUT0RPOiBieSBsb25nLWNsaWNraW5nIHRoZSBiYWNrL2ZvcndhcmQgYnV0dG9ucy5cblx0ICogVE9ETzogc29sdmluZyB0aGlzIHJlcXVpcmVzIGV4dGVuc2l2ZSBib29ra2VlcGluZyBiZWNhdXNlIHRoZSBldmVudHMgYXJlIGluZGlzdGluZ3Vpc2hhYmxlIGJ5IGRlZmF1bHRcblx0ICogQHBhcmFtIGU6IHBvcHN0YXRlIERPTSBldmVudFxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0X3BvcFN0YXRlKGU6IEV2ZW50KSB7XG5cdFx0Y29uc3QgbGVuID0gdGhpcy5faGlzdG9yeVN0YXRlRXZlbnRMaXN0ZW5lcnMubGVuZ3RoXG5cdFx0aWYgKGxlbiA9PT0gMCkgcmV0dXJuXG5cblx0XHRpZiAodGhpcy5faWdub3JlTmV4dFBvcHN0YXRlKSB7XG5cdFx0XHR0aGlzLl9pZ25vcmVOZXh0UG9wc3RhdGUgPSBmYWxzZVxuXHRcdFx0cmV0dXJuXG5cdFx0fVxuXG5cdFx0aWYgKCF0aGlzLl9oaXN0b3J5U3RhdGVFdmVudExpc3RlbmVyc1tsZW4gLSAxXShlKSkge1xuXHRcdFx0dGhpcy5faWdub3JlTmV4dFBvcHN0YXRlID0gdHJ1ZVxuXHRcdFx0Ly8gZ28gMSBwYWdlIGZvcndhcmQgaW4gdGhlIGhpc3Rvcnlcblx0XHRcdC8vIHRoaXMgcmV2ZXJ0cyB0aGUgc3RhdGUgY2hhbmdlIChpZiB0aGUgZXZlbnQgd2FzIHRyaWdnZXJlZCBieSBhIGJhY2stYnV0dG9uIHByZXNzKVxuXHRcdFx0aGlzdG9yeS5nbygxKVxuXHRcdH1cblx0fVxuXG5cdF9vblVubG9hZCgpIHtcblx0XHRpZiAodGhpcy53aW5kb3dDbG9zZUNvbmZpcm1hdGlvbiAmJiB0aGlzLmxvZ2lucykge1xuXHRcdFx0dGhpcy5sb2dpbnMubG9nb3V0KHRydWUpXG5cdFx0fVxuXHR9XG5cblx0YWRkT25saW5lTGlzdGVuZXIobGlzdGVuZXI6ICgpID0+IHZvaWQpIHtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9ubGluZVwiLCBsaXN0ZW5lcilcblx0fVxuXG5cdGFkZE9mZmxpbmVMaXN0ZW5lcihsaXN0ZW5lcjogKCkgPT4gdm9pZCkge1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwib2ZmbGluZVwiLCBsaXN0ZW5lcilcblx0fVxuXG5cdGFzeW5jIHJlbG9hZChhcmdzOiBQYXJhbXMpIHtcblx0XHRpZiAoaXNBcHAoKSB8fCBpc0VsZWN0cm9uQ2xpZW50KCkpIHtcblx0XHRcdGlmICghT2JqZWN0Lmhhc093bihhcmdzLCBcIm5vQXV0b0xvZ2luXCIpKSB7XG5cdFx0XHRcdGFyZ3Mubm9BdXRvTG9naW4gPSB0cnVlXG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHsgbG9jYXRvciB9ID0gYXdhaXQgaW1wb3J0KFwiLi4vYXBpL21haW4vQ29tbW9uTG9jYXRvclwiKVxuXG5cdFx0XHRjb25zdCBzdHJpbmdpZmllZEFyZ3M6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuXHRcdFx0Zm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMoYXJncykpIHtcblx0XHRcdFx0aWYgKHYgIT0gbnVsbCkge1xuXHRcdFx0XHRcdHN0cmluZ2lmaWVkQXJnc1trXSA9IFN0cmluZyh2KVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRhd2FpdCBsb2NhdG9yLmNvbW1vblN5c3RlbUZhY2FkZS5yZWxvYWQoc3RyaW5naWZpZWRBcmdzKVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcblx0XHR9XG5cdH1cblxuXHRhZGRQYWdlSW5CYWNrZ3JvdW5kTGlzdGVuZXIoKSB7XG5cdFx0Ly8gRm9yIEFuZHJvaWQgaXQncyBoYW5kbGVkIG1hbnVhbGx5IGZyb20gbmF0aXZlIGJlY2F1c2UgdmlzaWJpbGl0eWNoYW5nZSBsaXN0ZW5lciBpcyBub3QgY2FsbGVkIGFmdGVyIHRoZVxuXHRcdC8vIGFwcCB3YXMgaW5hY3RpdmUgZm9yIHNvbWUgdGltZS5cblx0XHQvLyBTZWUgTmF0aXZlV3JhcHBlckNvbW1hbmRzLmpzXG5cdFx0aWYgKGlzSU9TQXBwKCkpIHtcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsICgpID0+IHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJWaXNpYmlsaXR5IGNoYW5nZSwgaGlkZGVuOiBcIiwgZG9jdW1lbnQuaGlkZGVuKVxuXG5cdFx0XHRcdHRoaXMuYXBwQmFzZWRWaXNpYmlsaXR5Q2hhZ2UoIWRvY3VtZW50LmhpZGRlbilcblxuXHRcdFx0XHRpZiAoIWRvY3VtZW50LmhpZGRlbikge1xuXHRcdFx0XHRcdC8vIE9uIGlPUyBkZXZpY2VzIHRoZSBXZWJTb2NrZXQgY2xvc2UgZXZlbnQgZmlyZXMgd2hlbiB0aGUgYXBwIGNvbWVzIGJhY2sgdG8gZm9yZWdyb3VuZFxuXHRcdFx0XHRcdC8vIHNvIHdlIHRyeSB0byByZWNvbm5lY3Qgd2l0aCBhIGRlbGF5IHRvIHJlY2VpdmUgX2Nsb3NlIGV2ZW50IGZpcnN0LiBPdGhlcndpc2Vcblx0XHRcdFx0XHQvLyB3ZSBtYXkgdHJ5IHRvIHJlY29ubmVjdCB3aGlsZSB3ZSB0aGluayB0aGF0IHdlJ3JlIHN0aWxsIGNvbm5lY3RlZFxuXHRcdFx0XHRcdC8vIChlLmcuIGZpcnN0IHJlY29ubmVjdCBhbmQgdGhlbiByZWNlaXZlIGNsb3NlKS5cblx0XHRcdFx0XHQvLyBXZSB1c2VkIHRvIGhhbmRsZSBpdCBpbiB0aGUgRXZlbnRCdXMgYW5kIHJlY29ubmVjdCBpbW1lZGlhdGVseSBidXQgaXNJb3NBcHAoKVxuXHRcdFx0XHRcdC8vIGNoZWNrIGRvZXMgbm90IHdvcmsgaW4gdGhlIHdvcmtlciBjdXJyZW50bHkuXG5cdFx0XHRcdFx0Ly8gRG9pbmcgdGhpcyBmb3IgYWxsIGFwcHMganVzdCB0byBiZSBzdXJlLlxuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4gdGhpcy5jb25uZWN0aXZpdHlNb2RlbD8udHJ5UmVjb25uZWN0KGZhbHNlLCB0cnVlKSwgMTAwKVxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH1cblx0fVxuXG5cdG9uS2V5Ym9hcmRTaXplQ2hhbmdlZChzaXplOiBudW1iZXIpIHtcblx0XHR0aGlzLl9rZXlib2FyZFNpemUgPSBzaXplXG5cblx0XHRmb3IgKGxldCBsaXN0ZW5lciBvZiB0aGlzLl9rZXlib2FyZFNpemVMaXN0ZW5lcnMpIHtcblx0XHRcdGxpc3RlbmVyKHNpemUpXG5cdFx0fVxuXG5cdFx0aWYgKHNpemUgPiAwKSB7XG5cdFx0XHQvLyByZXNldCBwb3NpdGlvbiBmaXhlZCBmb3IgdGhlIGJvZHkgdG8gYWxsb3cgc2Nyb2xsaW5nIGluIGRpYWxvZ3Mgb24gaU9TXG5cdFx0XHQvLyBodHRwczovL2dpdGh1Yi5jb20vc2NvdHRqZWhsL0RldmljZS1CdWdzL2lzc3Vlcy8xNFxuXHRcdFx0Y29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHkgYXMgYW55XG5cdFx0XHRib2R5LnN0eWxlLnBvc2l0aW9uID0gXCJ1bnNldFwiXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0Ym9keS5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIlxuXHRcdFx0fSwgMjAwKVxuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgY29uc3Qgd2luZG93RmFjYWRlOiBXaW5kb3dGYWNhZGUgPSBuZXcgV2luZG93RmFjYWRlKClcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQVNBLHNCQUFzQjtJQUlULGVBQU4sTUFBbUI7Q0FDekIsQUFBUTtDQUNSO0NBQ0E7Q0FDQSxBQUFRO0NBQ1IsQUFBUSw4QkFBNEQsQ0FBRTtDQUN0RSxBQUFRLGdCQUFnQztDQUV4QyxBQUFRLGdCQUF3QjtDQUNoQyxBQUFRLHlCQUFpRCxDQUFFO0NBQzNELEFBQVEsc0JBQStCO0NBQ3ZDLEFBQVE7Q0FDUixBQUFRLFNBQWlDO0NBQ3pDLEFBQVEsMEJBQXNEO0NBRTlELGNBQWM7QUFDYixPQUFLLHVCQUF1QixDQUFFO0FBQzlCLE9BQUssZ0JBQWdCO0FBQ3JCLE9BQUssMEJBQTBCO0FBQy9CLE9BQUssd0JBQXdCLElBQUk7RUFFakMsTUFBTSxXQUFXLE1BQU07QUFFdEIsUUFBSyxLQUFLLGVBQWU7SUFDeEIsTUFBTSxLQUFLLE1BQU07QUFDaEIsVUFBSyxnQkFBZ0I7QUFFckIsVUFBSyxTQUFTO0lBQ2Q7QUFJRCxTQUFLLGdCQUFnQixPQUFPLGdCQUFnQixHQUFHLFdBQVcsSUFBSSxHQUFHLEdBQUcsc0JBQXNCLEdBQUc7R0FDN0Y7RUFDRDtBQUNELFNBQU8sV0FBVztBQUdsQixTQUFPLHNCQUFzQjtDQUM3Qjs7Ozs7Q0FNRCxrQkFBa0JBLFVBQThCO0FBQy9DLE9BQUsscUJBQXFCLEtBQUssU0FBUztDQUN4QztDQUVELHFCQUFxQkEsVUFBOEI7QUFDbEQsU0FBTyxLQUFLLHNCQUFzQixTQUFTO0NBQzNDO0NBRUQsdUJBQXVCQyxVQUF1RDtBQUM3RSxPQUFLLHNCQUFzQixJQUFJLFNBQVM7QUFFeEMsT0FBSyxvQkFBb0IsS0FBSyxzQkFBc0IsT0FBTyxFQUFFO0FBRTdELFNBQU8sTUFBTTtBQUNaLFFBQUssc0JBQXNCLE9BQU8sU0FBUztBQUUzQyxRQUFLLG9CQUFvQixLQUFLLHNCQUFzQixPQUFPLEVBQUU7RUFDN0Q7Q0FDRDtDQUVELHNCQUFzQkMsR0FBVTtBQUMvQixPQUFLLE1BQU0sS0FBSyxLQUFLLHNCQUNwQixHQUFFLEVBQUU7Q0FFTDtDQUVELHdCQUF3QkMsVUFBZ0M7QUFDdkQsT0FBSyx1QkFBdUIsS0FBSyxTQUFTO0FBRTFDLFdBQVMsS0FBSyxjQUFjO0NBQzVCO0NBRUQsMkJBQTJCQSxVQUFnQztBQUMxRCxTQUFPLEtBQUssd0JBQXdCLFNBQVM7Q0FDN0M7Q0FFRCxTQUFTQyxNQUFjO0FBQ3RCLE1BQUksSUFBSSxTQUFTLEtBQUssSUFDckIsUUFBTyxLQUFLLE1BQU0sVUFBVTtJQUU1QixRQUFPLEtBQUssTUFBTSxTQUFTO0NBRTVCO0NBRUQsS0FBS0MsUUFBeUJDLG1CQUErQ0MseUJBQThEO0FBQzFJLE9BQUssU0FBUztBQUVkLE1BQUksT0FBTyxxQkFBcUIsT0FBTyxFQUFFO0FBQ3hDLFVBQU8saUJBQWlCLGdCQUFnQixDQUFDLE1BQU0sS0FBSyxjQUFjLEVBQUUsQ0FBQztBQUNyRSxVQUFPLGlCQUFpQixZQUFZLENBQUMsTUFBTSxLQUFLLFVBQVUsRUFBRSxDQUFDO0FBQzdELFVBQU8saUJBQWlCLFVBQVUsQ0FBQyxNQUFNLEtBQUssV0FBVyxDQUFDO0VBQzFEO0FBRUQsT0FBSywwQkFBMEIsMkJBQTJCO0FBQzFELE9BQUssb0JBQW9CO0FBRXpCLE1BQUksSUFBSSxTQUFTLEtBQUssT0FBTyxJQUFJLFNBQVMsS0FBSyxXQUFXLElBQUksU0FBUyxLQUFLLE1BQzNFLE1BQUssNkJBQTZCO0FBS25DLE1BQUksSUFBSSxTQUFTLEtBQUssV0FBVyxPQUFPLFdBQVcsT0FBTyxpQkFDekQsUUFBTyxpQkFBaUIsV0FBVyxDQUFDLE1BQU07QUFDekMsUUFBSyxFQUFFLFdBQVcsRUFBRSxRQUFRLE9BQVE7R0FFcEMsTUFBTSxTQUFTLEVBQUU7QUFFakIsT0FBSSxRQUFRLFlBQVksV0FBVyxRQUFRLG9CQUFvQixPQUM5RCxHQUFFLGlCQUFpQjtTQUNULEVBQUUsUUFBUSxZQUNwQixRQUFPLFFBQVEsTUFBTTtTQUNYLEVBQUUsUUFBUSxhQUNwQixRQUFPLFFBQVEsU0FBUztFQUV6QixFQUFDO0FBS0gsT0FBSyxTQUFTO0NBQ2Q7Q0FFRCxVQUFVO0FBQ1QsTUFBSTtBQUNILFFBQUssTUFBTSxZQUFZLEtBQUsscUJBQzNCLFVBQVMsT0FBTyxZQUFZLE9BQU8sWUFBWTtFQUVoRCxVQUFTO0FBQ1QsbUJBQUUsUUFBUTtFQUNWO0NBQ0Q7Q0FFRCxvQkFBb0JDLFFBQWlCO0FBQ3BDLE9BQUssMEJBQTBCO0NBQy9CO0NBRUQsY0FBY0MsR0FBdUI7QUFFcEMsVUFBUSxJQUFJLDZCQUE2QjtBQUV6QyxPQUFLLHNCQUFzQixFQUFFO0FBRTdCLE1BQUksS0FBSyx5QkFBeUI7R0FDakMsSUFBSSxJQUFJLEtBQUssSUFBSSw4QkFBOEI7QUFDL0MsS0FBRSxjQUFjO0FBQ2hCLFVBQU87RUFDUCxPQUFNO0FBQ04sUUFBSyxRQUFRLE9BQU8sS0FBSztBQUN6QixVQUFPO0VBQ1A7Q0FDRDs7Ozs7O0NBT0Qsd0JBQXdCQyxVQUE2QztBQUNwRSxPQUFLLDRCQUE0QixLQUFLLFNBQVM7QUFFL0MsU0FBTyxNQUFNO0dBQ1osTUFBTSxRQUFRLEtBQUssNEJBQTRCLFFBQVEsU0FBUztBQUVoRSxPQUFJLFVBQVUsR0FDYixNQUFLLDRCQUE0QixPQUFPLE9BQU8sRUFBRTtFQUVsRDtDQUNEO0NBRUQsMkJBQTJCQSxVQUF1QztBQUNqRSxTQUFPLEtBQUssNkJBQTZCLFNBQVM7Q0FDbEQ7Ozs7Ozs7Ozs7Q0FXRCxVQUFVUixHQUFVO0VBQ25CLE1BQU0sTUFBTSxLQUFLLDRCQUE0QjtBQUM3QyxNQUFJLFFBQVEsRUFBRztBQUVmLE1BQUksS0FBSyxxQkFBcUI7QUFDN0IsUUFBSyxzQkFBc0I7QUFDM0I7RUFDQTtBQUVELE9BQUssS0FBSyw0QkFBNEIsTUFBTSxHQUFHLEVBQUUsRUFBRTtBQUNsRCxRQUFLLHNCQUFzQjtBQUczQixXQUFRLEdBQUcsRUFBRTtFQUNiO0NBQ0Q7Q0FFRCxZQUFZO0FBQ1gsTUFBSSxLQUFLLDJCQUEyQixLQUFLLE9BQ3hDLE1BQUssT0FBTyxPQUFPLEtBQUs7Q0FFekI7Q0FFRCxrQkFBa0JTLFVBQXNCO0FBQ3ZDLFNBQU8saUJBQWlCLFVBQVUsU0FBUztDQUMzQztDQUVELG1CQUFtQkEsVUFBc0I7QUFDeEMsU0FBTyxpQkFBaUIsV0FBVyxTQUFTO0NBQzVDO0NBRUQsTUFBTSxPQUFPQyxNQUFjO0FBQzFCLE1BQUksT0FBTyxJQUFJLGtCQUFrQixFQUFFO0FBQ2xDLFFBQUssT0FBTyxPQUFPLE1BQU0sY0FBYyxDQUN0QyxNQUFLLGNBQWM7R0FHcEIsTUFBTSxFQUFFLFNBQVMsR0FBRyxNQUFNLE9BQU87R0FFakMsTUFBTUMsa0JBQTBDLENBQUU7QUFDbEQsUUFBSyxNQUFNLENBQUMsR0FBRyxFQUFFLElBQUksT0FBTyxRQUFRLEtBQUssQ0FDeEMsS0FBSSxLQUFLLEtBQ1IsaUJBQWdCLEtBQUssT0FBTyxFQUFFO0FBR2hDLFNBQU0sUUFBUSxtQkFBbUIsT0FBTyxnQkFBZ0I7RUFDeEQsTUFDQSxRQUFPLFNBQVMsUUFBUTtDQUV6QjtDQUVELDhCQUE4QjtBQUk3QixNQUFJLFVBQVUsQ0FDYixVQUFTLGlCQUFpQixvQkFBb0IsTUFBTTtBQUNuRCxXQUFRLElBQUksK0JBQStCLFNBQVMsT0FBTztBQUUzRCxRQUFLLHlCQUF5QixTQUFTLE9BQU87QUFFOUMsUUFBSyxTQUFTLE9BUWIsWUFBVyxNQUFNLEtBQUssbUJBQW1CLGFBQWEsT0FBTyxLQUFLLEVBQUUsSUFBSTtFQUV6RSxFQUFDO0NBRUg7Q0FFRCxzQkFBc0JDLE1BQWM7QUFDbkMsT0FBSyxnQkFBZ0I7QUFFckIsT0FBSyxJQUFJLFlBQVksS0FBSyx1QkFDekIsVUFBUyxLQUFLO0FBR2YsTUFBSSxPQUFPLEdBQUc7R0FHYixNQUFNLE9BQU8sU0FBUztBQUN0QixRQUFLLE1BQU0sV0FBVztBQUN0QixjQUFXLE1BQU07QUFDaEIsU0FBSyxNQUFNLFdBQVc7R0FDdEIsR0FBRSxJQUFJO0VBQ1A7Q0FDRDtBQUNEO01BRVlDLGVBQTZCLElBQUkifQ==