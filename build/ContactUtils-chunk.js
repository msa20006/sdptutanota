import { assertMainOrNode } from "./Env-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import { ContactMessengerHandleType, ContactSocialType } from "./TutanotaConstants-chunk.js";
import { isoDateToBirthday } from "./BirthdayUtils-chunk.js";
import { formatDate } from "./Formatter-chunk.js";

//#region src/common/contactsFunctionality/ContactUtils.ts
assertMainOrNode();
function getContactDisplayName(contact) {
	if (contact.nickname != null && contact.nickname !== "") return contact.nickname;
else return `${contact.firstName} ${contact.lastName}`.trim();
}
function getContactListName(contact) {
	let name = `${contact.firstName} ${contact.lastName}`.trim();
	if (name.length === 0) name = contact.company.trim();
	return name;
}
function formatBirthdayNumeric(birthday) {
	if (birthday.year) return formatDate(new Date(Number(birthday.year), Number(birthday.month) - 1, Number(birthday.day)));
else return lang.formats.simpleDateWithoutYear.format(new Date(Number(2016), Number(birthday.month) - 1, Number(birthday.day)));
}
function formatContactDate(isoDate) {
	if (isoDate) try {
		return formatBirthdayNumeric(isoDateToBirthday(isoDate));
	} catch (e) {}
	return "";
}
function getSocialUrl(contactId) {
	let socialUrlType = "";
	let http = "https://";
	let worldwidew = "www.";
	const isSchemePrefixed = contactId.socialId.indexOf("http") !== -1;
	const isWwwDotPrefixed = contactId.socialId.indexOf(worldwidew) !== -1;
	if (!isSchemePrefixed && !isWwwDotPrefixed) switch (contactId.type) {
		case ContactSocialType.TWITTER:
			socialUrlType = "twitter.com/";
			break;
		case ContactSocialType.FACEBOOK:
			socialUrlType = "facebook.com/";
			break;
		case ContactSocialType.XING:
			socialUrlType = "xing.com/profile/";
			break;
		case ContactSocialType.LINKED_IN: socialUrlType = "linkedin.com/in/";
	}
	if (isSchemePrefixed) http = "";
	if (isSchemePrefixed || isWwwDotPrefixed) worldwidew = "";
	return `${http}${worldwidew}${socialUrlType}${contactId.socialId.trim()}`;
}
function getWebsiteUrl(websiteUrl) {
	let http = "https://";
	let worldwidew = "www.";
	const isSchemePrefixed = websiteUrl.indexOf("http") !== -1;
	const isWwwDotPrefixed = websiteUrl.indexOf(worldwidew) !== -1;
	if (isSchemePrefixed) http = "";
	if (isSchemePrefixed || isWwwDotPrefixed) worldwidew = "";
	return `${http}${worldwidew}${websiteUrl}`.trim();
}
function getMessengerHandleUrl(handle) {
	const replaceNumberExp = new RegExp(/[^0-9+]/g);
	switch (handle.type) {
		case ContactMessengerHandleType.SIGNAL: return `sgnl://signal.me/#p/${handle.handle.replaceAll(replaceNumberExp, "")}`;
		case ContactMessengerHandleType.WHATSAPP: return `whatsapp://send?phone=${handle.handle.replaceAll(replaceNumberExp, "")}`;
		case ContactMessengerHandleType.TELEGRAM: return `tg://resolve?domain=${handle.handle}`;
		case ContactMessengerHandleType.DISCORD: return `discord://-/users/${handle.handle}`;
		default: return "";
	}
}
function extractStructuredMailAddresses(addresses) {
	return addresses.map((address) => ({
		address: address.address,
		type: address.type,
		customTypeName: address.customTypeName
	}));
}
function extractStructuredAddresses(addresses) {
	return addresses.map((address) => ({
		address: address.address,
		type: address.type,
		customTypeName: address.customTypeName
	}));
}
function extractStructuredPhoneNumbers(numbers) {
	return numbers.map((number) => ({
		number: number.number,
		type: number.type,
		customTypeName: number.customTypeName
	}));
}
function extractStructuredCustomDates(dates) {
	return dates.map((date) => ({
		dateIso: date.dateIso,
		type: date.type,
		customTypeName: date.customTypeName
	}));
}
function extractStructuredWebsites(websites) {
	return websites.map((website) => ({
		url: website.url,
		type: website.type,
		customTypeName: website.customTypeName
	}));
}
function extractStructuredRelationships(relationships) {
	return relationships.map((relation) => ({
		person: relation.person,
		type: relation.type,
		customTypeName: relation.customTypeName
	}));
}
function extractStructuredMessengerHandle(handles) {
	return handles.map((handle) => ({
		type: handle.type,
		customTypeName: handle.customTypeName,
		handle: handle.handle
	}));
}

//#endregion
export { extractStructuredAddresses, extractStructuredCustomDates, extractStructuredMailAddresses, extractStructuredMessengerHandle, extractStructuredPhoneNumbers, extractStructuredRelationships, extractStructuredWebsites, formatBirthdayNumeric, formatContactDate, getContactDisplayName, getContactListName, getMessengerHandleUrl, getSocialUrl, getWebsiteUrl };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udGFjdFV0aWxzLWNodW5rLmpzIiwibmFtZXMiOlsiY29udGFjdDogQ29udGFjdE5hbWVzIiwiY29udGFjdDogQ29udGFjdCIsImJpcnRoZGF5OiBCaXJ0aGRheSIsImlzb0RhdGU6IHN0cmluZyB8IG51bGwiLCJjb250YWN0SWQ6IENvbnRhY3RTb2NpYWxJZCIsIndlYnNpdGVVcmw6IHN0cmluZyIsImhhbmRsZTogQ29udGFjdE1lc3NlbmdlckhhbmRsZSIsImFkZHJlc3NlczogQ29udGFjdE1haWxBZGRyZXNzW10iLCJhZGRyZXNzZXM6IENvbnRhY3RBZGRyZXNzW10iLCJudW1iZXJzOiBDb250YWN0UGhvbmVOdW1iZXJbXSIsImRhdGVzOiBDb250YWN0Q3VzdG9tRGF0ZVtdIiwid2Vic2l0ZXM6IENvbnRhY3RXZWJzaXRlW10iLCJyZWxhdGlvbnNoaXBzOiBDb250YWN0UmVsYXRpb25zaGlwW10iLCJoYW5kbGVzOiBDb250YWN0TWVzc2VuZ2VySGFuZGxlW10iXSwic291cmNlcyI6WyIuLi9zcmMvY29tbW9uL2NvbnRhY3RzRnVuY3Rpb25hbGl0eS9Db250YWN0VXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXNzZXJ0TWFpbk9yTm9kZSB9IGZyb20gXCIuLi9hcGkvY29tbW9uL0Vudi5qc1wiXG5pbXBvcnQge1xuXHRCaXJ0aGRheSxcblx0Q29udGFjdCxcblx0Q29udGFjdEFkZHJlc3MsXG5cdENvbnRhY3RDdXN0b21EYXRlLFxuXHRDb250YWN0TWFpbEFkZHJlc3MsXG5cdENvbnRhY3RNZXNzZW5nZXJIYW5kbGUsXG5cdENvbnRhY3RQaG9uZU51bWJlcixcblx0Q29udGFjdFJlbGF0aW9uc2hpcCxcblx0Q29udGFjdFNvY2lhbElkLFxuXHRDb250YWN0V2Vic2l0ZSxcbn0gZnJvbSBcIi4uL2FwaS9lbnRpdGllcy90dXRhbm90YS9UeXBlUmVmcy5qc1wiXG5pbXBvcnQgeyBmb3JtYXREYXRlIH0gZnJvbSBcIi4uL21pc2MvRm9ybWF0dGVyLmpzXCJcbmltcG9ydCB7IGxhbmcgfSBmcm9tIFwiLi4vbWlzYy9MYW5ndWFnZVZpZXdNb2RlbC5qc1wiXG5pbXBvcnQgeyBpc29EYXRlVG9CaXJ0aGRheSB9IGZyb20gXCIuLi9hcGkvY29tbW9uL3V0aWxzL0JpcnRoZGF5VXRpbHMuanNcIlxuaW1wb3J0IHtcblx0Q29udGFjdEFkZHJlc3NUeXBlLFxuXHRDb250YWN0Q3VzdG9tRGF0ZVR5cGUsXG5cdENvbnRhY3RNZXNzZW5nZXJIYW5kbGVUeXBlLFxuXHRDb250YWN0UGhvbmVOdW1iZXJUeXBlLFxuXHRDb250YWN0UmVsYXRpb25zaGlwVHlwZSxcblx0Q29udGFjdFNvY2lhbFR5cGUsXG5cdENvbnRhY3RXZWJzaXRlVHlwZSxcbn0gZnJvbSBcIi4uL2FwaS9jb21tb24vVHV0YW5vdGFDb25zdGFudHMuanNcIlxuaW1wb3J0IHsgU3RydWN0dXJlZE1haWxBZGRyZXNzIH0gZnJvbSBcIi4uL25hdGl2ZS9jb21tb24vZ2VuZXJhdGVkaXBjL1N0cnVjdHVyZWRNYWlsQWRkcmVzcy5qc1wiXG5pbXBvcnQgeyBTdHJ1Y3R1cmVkQWRkcmVzcyB9IGZyb20gXCIuLi9uYXRpdmUvY29tbW9uL2dlbmVyYXRlZGlwYy9TdHJ1Y3R1cmVkQWRkcmVzcy5qc1wiXG5pbXBvcnQgeyBTdHJ1Y3R1cmVkUGhvbmVOdW1iZXIgfSBmcm9tIFwiLi4vbmF0aXZlL2NvbW1vbi9nZW5lcmF0ZWRpcGMvU3RydWN0dXJlZFBob25lTnVtYmVyLmpzXCJcbmltcG9ydCB7IFN0cnVjdHVyZWRDdXN0b21EYXRlIH0gZnJvbSBcIi4uL25hdGl2ZS9jb21tb24vZ2VuZXJhdGVkaXBjL1N0cnVjdHVyZWRDdXN0b21EYXRlLmpzXCJcbmltcG9ydCB7IFN0cnVjdHVyZWRXZWJzaXRlIH0gZnJvbSBcIi4uL25hdGl2ZS9jb21tb24vZ2VuZXJhdGVkaXBjL1N0cnVjdHVyZWRXZWJzaXRlLmpzXCJcbmltcG9ydCB7IFN0cnVjdHVyZWRSZWxhdGlvbnNoaXAgfSBmcm9tIFwiLi4vbmF0aXZlL2NvbW1vbi9nZW5lcmF0ZWRpcGMvU3RydWN0dXJlZFJlbGF0aW9uc2hpcC5qc1wiXG5pbXBvcnQgeyBTdHJ1Y3R1cmVkTWVzc2VuZ2VySGFuZGxlIH0gZnJvbSBcIi4uL25hdGl2ZS9jb21tb24vZ2VuZXJhdGVkaXBjL1N0cnVjdHVyZWRNZXNzZW5nZXJIYW5kbGUuanNcIlxuaW1wb3J0IHsgU3RydWN0dXJlZENvbnRhY3QgfSBmcm9tIFwiLi4vbmF0aXZlL2NvbW1vbi9nZW5lcmF0ZWRpcGMvU3RydWN0dXJlZENvbnRhY3QuanNcIlxuXG5hc3NlcnRNYWluT3JOb2RlKClcblxuZXhwb3J0IHR5cGUgQ29udGFjdE5hbWVzID0gUGljazxDb250YWN0LCBcIm5pY2tuYW1lXCIgfCBcImZpcnN0TmFtZVwiIHwgXCJsYXN0TmFtZVwiPlxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29udGFjdERpc3BsYXlOYW1lKGNvbnRhY3Q6IENvbnRhY3ROYW1lcyk6IHN0cmluZyB7XG5cdGlmIChjb250YWN0Lm5pY2tuYW1lICE9IG51bGwgJiYgY29udGFjdC5uaWNrbmFtZSAhPT0gXCJcIikge1xuXHRcdHJldHVybiBjb250YWN0Lm5pY2tuYW1lXG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGAke2NvbnRhY3QuZmlyc3ROYW1lfSAke2NvbnRhY3QubGFzdE5hbWV9YC50cmltKClcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29udGFjdExpc3ROYW1lKGNvbnRhY3Q6IENvbnRhY3QpOiBzdHJpbmcge1xuXHRsZXQgbmFtZSA9IGAke2NvbnRhY3QuZmlyc3ROYW1lfSAke2NvbnRhY3QubGFzdE5hbWV9YC50cmltKClcblxuXHRpZiAobmFtZS5sZW5ndGggPT09IDApIHtcblx0XHRuYW1lID0gY29udGFjdC5jb21wYW55LnRyaW0oKVxuXHR9XG5cblx0cmV0dXJuIG5hbWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdEJpcnRoZGF5TnVtZXJpYyhiaXJ0aGRheTogQmlydGhkYXkpOiBzdHJpbmcge1xuXHRpZiAoYmlydGhkYXkueWVhcikge1xuXHRcdHJldHVybiBmb3JtYXREYXRlKG5ldyBEYXRlKE51bWJlcihiaXJ0aGRheS55ZWFyKSwgTnVtYmVyKGJpcnRoZGF5Lm1vbnRoKSAtIDEsIE51bWJlcihiaXJ0aGRheS5kYXkpKSlcblx0fSBlbHNlIHtcblx0XHQvL2lmIG5vIHllYXIgaXMgc3BlY2lmaWVkIGEgbGVhcCB5ZWFyIGlzIHVzZWQgdG8gYWxsb3cgMi8yOSBhcyBiaXJ0aGRheVxuXHRcdHJldHVybiBsYW5nLmZvcm1hdHMuc2ltcGxlRGF0ZVdpdGhvdXRZZWFyLmZvcm1hdChuZXcgRGF0ZShOdW1iZXIoMjAxNiksIE51bWJlcihiaXJ0aGRheS5tb250aCkgLSAxLCBOdW1iZXIoYmlydGhkYXkuZGF5KSkpXG5cdH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBnaXZlbiBkYXRlIG9mIHRoZSBjb250YWN0IGFzIGZvcm1hdHRlZCBzdHJpbmcgdXNpbmcgZGVmYXVsdCBkYXRlIGZvcm1hdHRlciBpbmNsdWRpbmcgZGF0ZSwgbW9udGggYW5kIHllYXIuXG4gKiBJZiBkYXRlIGNvbnRhaW5zIG5vIHllYXIgb25seSBtb250aCBhbmQgZGF5IHdpbGwgYmUgaW5jbHVkZWQuXG4gKiBJZiB0aGVyZSBpcyBubyBkYXRlIG9yIGFuIGludmFsaWQgYmlydGhkYXkgZm9ybWF0IGFuIGVtcHR5IHN0cmluZyByZXR1cm5zLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0Q29udGFjdERhdGUoaXNvRGF0ZTogc3RyaW5nIHwgbnVsbCk6IHN0cmluZyB7XG5cdGlmIChpc29EYXRlKSB7XG5cdFx0dHJ5IHtcblx0XHRcdHJldHVybiBmb3JtYXRCaXJ0aGRheU51bWVyaWMoaXNvRGF0ZVRvQmlydGhkYXkoaXNvRGF0ZSkpXG5cdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0Ly8gY2FudCBmb3JtYXQsIGNhbnQgZG8gYW55dGhpbmdcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gXCJcIlxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U29jaWFsVXJsKGNvbnRhY3RJZDogQ29udGFjdFNvY2lhbElkKTogc3RyaW5nIHtcblx0bGV0IHNvY2lhbFVybFR5cGUgPSBcIlwiXG5cdGxldCBodHRwID0gXCJodHRwczovL1wiXG5cdGxldCB3b3JsZHdpZGV3ID0gXCJ3d3cuXCJcblxuXHRjb25zdCBpc1NjaGVtZVByZWZpeGVkID0gY29udGFjdElkLnNvY2lhbElkLmluZGV4T2YoXCJodHRwXCIpICE9PSAtMVxuXHRjb25zdCBpc1d3d0RvdFByZWZpeGVkID0gY29udGFjdElkLnNvY2lhbElkLmluZGV4T2Yod29ybGR3aWRldykgIT09IC0xXG5cblx0aWYgKCFpc1NjaGVtZVByZWZpeGVkICYmICFpc1d3d0RvdFByZWZpeGVkKSB7XG5cdFx0c3dpdGNoIChjb250YWN0SWQudHlwZSkge1xuXHRcdFx0Y2FzZSBDb250YWN0U29jaWFsVHlwZS5UV0lUVEVSOlxuXHRcdFx0XHRzb2NpYWxVcmxUeXBlID0gXCJ0d2l0dGVyLmNvbS9cIlxuXHRcdFx0XHRicmVha1xuXG5cdFx0XHRjYXNlIENvbnRhY3RTb2NpYWxUeXBlLkZBQ0VCT09LOlxuXHRcdFx0XHRzb2NpYWxVcmxUeXBlID0gXCJmYWNlYm9vay5jb20vXCJcblx0XHRcdFx0YnJlYWtcblxuXHRcdFx0Y2FzZSBDb250YWN0U29jaWFsVHlwZS5YSU5HOlxuXHRcdFx0XHRzb2NpYWxVcmxUeXBlID0gXCJ4aW5nLmNvbS9wcm9maWxlL1wiXG5cdFx0XHRcdGJyZWFrXG5cblx0XHRcdGNhc2UgQ29udGFjdFNvY2lhbFR5cGUuTElOS0VEX0lOOlxuXHRcdFx0XHRzb2NpYWxVcmxUeXBlID0gXCJsaW5rZWRpbi5jb20vaW4vXCJcblx0XHR9XG5cdH1cblxuXHRpZiAoaXNTY2hlbWVQcmVmaXhlZCkge1xuXHRcdGh0dHAgPSBcIlwiXG5cdH1cblxuXHRpZiAoaXNTY2hlbWVQcmVmaXhlZCB8fCBpc1d3d0RvdFByZWZpeGVkKSB7XG5cdFx0d29ybGR3aWRldyA9IFwiXCJcblx0fVxuXG5cdHJldHVybiBgJHtodHRwfSR7d29ybGR3aWRld30ke3NvY2lhbFVybFR5cGV9JHtjb250YWN0SWQuc29jaWFsSWQudHJpbSgpfWBcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFdlYnNpdGVVcmwod2Vic2l0ZVVybDogc3RyaW5nKTogc3RyaW5nIHtcblx0bGV0IGh0dHAgPSBcImh0dHBzOi8vXCJcblx0bGV0IHdvcmxkd2lkZXcgPSBcInd3dy5cIlxuXG5cdGNvbnN0IGlzU2NoZW1lUHJlZml4ZWQgPSB3ZWJzaXRlVXJsLmluZGV4T2YoXCJodHRwXCIpICE9PSAtMVxuXHRjb25zdCBpc1d3d0RvdFByZWZpeGVkID0gd2Vic2l0ZVVybC5pbmRleE9mKHdvcmxkd2lkZXcpICE9PSAtMVxuXG5cdGlmIChpc1NjaGVtZVByZWZpeGVkKSB7XG5cdFx0aHR0cCA9IFwiXCJcblx0fVxuXG5cdGlmIChpc1NjaGVtZVByZWZpeGVkIHx8IGlzV3d3RG90UHJlZml4ZWQpIHtcblx0XHR3b3JsZHdpZGV3ID0gXCJcIlxuXHR9XG5cblx0cmV0dXJuIGAke2h0dHB9JHt3b3JsZHdpZGV3fSR7d2Vic2l0ZVVybH1gLnRyaW0oKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWVzc2VuZ2VySGFuZGxlVXJsKGhhbmRsZTogQ29udGFjdE1lc3NlbmdlckhhbmRsZSk6IHN0cmluZyB7XG5cdGNvbnN0IHJlcGxhY2VOdW1iZXJFeHAgPSBuZXcgUmVnRXhwKC9bXjAtOStdL2cpXG5cdHN3aXRjaCAoaGFuZGxlLnR5cGUpIHtcblx0XHRjYXNlIENvbnRhY3RNZXNzZW5nZXJIYW5kbGVUeXBlLlNJR05BTDpcblx0XHRcdHJldHVybiBgc2dubDovL3NpZ25hbC5tZS8jcC8ke2hhbmRsZS5oYW5kbGUucmVwbGFjZUFsbChyZXBsYWNlTnVtYmVyRXhwLCBcIlwiKX1gXG5cdFx0Y2FzZSBDb250YWN0TWVzc2VuZ2VySGFuZGxlVHlwZS5XSEFUU0FQUDpcblx0XHRcdHJldHVybiBgd2hhdHNhcHA6Ly9zZW5kP3Bob25lPSR7aGFuZGxlLmhhbmRsZS5yZXBsYWNlQWxsKHJlcGxhY2VOdW1iZXJFeHAsIFwiXCIpfWBcblx0XHRjYXNlIENvbnRhY3RNZXNzZW5nZXJIYW5kbGVUeXBlLlRFTEVHUkFNOlxuXHRcdFx0cmV0dXJuIGB0ZzovL3Jlc29sdmU/ZG9tYWluPSR7aGFuZGxlLmhhbmRsZX1gXG5cdFx0Y2FzZSBDb250YWN0TWVzc2VuZ2VySGFuZGxlVHlwZS5ESVNDT1JEOlxuXHRcdFx0cmV0dXJuIGBkaXNjb3JkOi8vLS91c2Vycy8ke2hhbmRsZS5oYW5kbGV9YFxuXHRcdGRlZmF1bHQ6XG5cdFx0XHRyZXR1cm4gXCJcIlxuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0U3RydWN0dXJlZE1haWxBZGRyZXNzZXMoYWRkcmVzc2VzOiBDb250YWN0TWFpbEFkZHJlc3NbXSk6IFJlYWRvbmx5QXJyYXk8U3RydWN0dXJlZE1haWxBZGRyZXNzPiB7XG5cdHJldHVybiBhZGRyZXNzZXMubWFwKChhZGRyZXNzKSA9PiAoe1xuXHRcdGFkZHJlc3M6IGFkZHJlc3MuYWRkcmVzcyxcblx0XHR0eXBlOiBhZGRyZXNzLnR5cGUgYXMgQ29udGFjdEFkZHJlc3NUeXBlLFxuXHRcdGN1c3RvbVR5cGVOYW1lOiBhZGRyZXNzLmN1c3RvbVR5cGVOYW1lLFxuXHR9KSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RTdHJ1Y3R1cmVkQWRkcmVzc2VzKGFkZHJlc3NlczogQ29udGFjdEFkZHJlc3NbXSk6IFJlYWRvbmx5QXJyYXk8U3RydWN0dXJlZEFkZHJlc3M+IHtcblx0cmV0dXJuIGFkZHJlc3Nlcy5tYXAoKGFkZHJlc3MpID0+ICh7XG5cdFx0YWRkcmVzczogYWRkcmVzcy5hZGRyZXNzLFxuXHRcdHR5cGU6IGFkZHJlc3MudHlwZSBhcyBDb250YWN0QWRkcmVzc1R5cGUsXG5cdFx0Y3VzdG9tVHlwZU5hbWU6IGFkZHJlc3MuY3VzdG9tVHlwZU5hbWUsXG5cdH0pKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFN0cnVjdHVyZWRQaG9uZU51bWJlcnMobnVtYmVyczogQ29udGFjdFBob25lTnVtYmVyW10pOiBSZWFkb25seUFycmF5PFN0cnVjdHVyZWRQaG9uZU51bWJlcj4ge1xuXHRyZXR1cm4gbnVtYmVycy5tYXAoKG51bWJlcikgPT4gKHtcblx0XHRudW1iZXI6IG51bWJlci5udW1iZXIsXG5cdFx0dHlwZTogbnVtYmVyLnR5cGUgYXMgQ29udGFjdFBob25lTnVtYmVyVHlwZSxcblx0XHRjdXN0b21UeXBlTmFtZTogbnVtYmVyLmN1c3RvbVR5cGVOYW1lLFxuXHR9KSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RTdHJ1Y3R1cmVkQ3VzdG9tRGF0ZXMoZGF0ZXM6IENvbnRhY3RDdXN0b21EYXRlW10pOiBSZWFkb25seUFycmF5PFN0cnVjdHVyZWRDdXN0b21EYXRlPiB7XG5cdHJldHVybiBkYXRlcy5tYXAoKGRhdGUpID0+ICh7XG5cdFx0ZGF0ZUlzbzogZGF0ZS5kYXRlSXNvLFxuXHRcdHR5cGU6IGRhdGUudHlwZSBhcyBDb250YWN0Q3VzdG9tRGF0ZVR5cGUsXG5cdFx0Y3VzdG9tVHlwZU5hbWU6IGRhdGUuY3VzdG9tVHlwZU5hbWUsXG5cdH0pKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFN0cnVjdHVyZWRXZWJzaXRlcyh3ZWJzaXRlczogQ29udGFjdFdlYnNpdGVbXSk6IFJlYWRvbmx5QXJyYXk8U3RydWN0dXJlZFdlYnNpdGU+IHtcblx0cmV0dXJuIHdlYnNpdGVzLm1hcCgod2Vic2l0ZSkgPT4gKHtcblx0XHR1cmw6IHdlYnNpdGUudXJsLFxuXHRcdHR5cGU6IHdlYnNpdGUudHlwZSBhcyBDb250YWN0V2Vic2l0ZVR5cGUsXG5cdFx0Y3VzdG9tVHlwZU5hbWU6IHdlYnNpdGUuY3VzdG9tVHlwZU5hbWUsXG5cdH0pKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFN0cnVjdHVyZWRSZWxhdGlvbnNoaXBzKHJlbGF0aW9uc2hpcHM6IENvbnRhY3RSZWxhdGlvbnNoaXBbXSk6IFJlYWRvbmx5QXJyYXk8U3RydWN0dXJlZFJlbGF0aW9uc2hpcD4ge1xuXHRyZXR1cm4gcmVsYXRpb25zaGlwcy5tYXAoKHJlbGF0aW9uKSA9PiAoe1xuXHRcdHBlcnNvbjogcmVsYXRpb24ucGVyc29uLFxuXHRcdHR5cGU6IHJlbGF0aW9uLnR5cGUgYXMgQ29udGFjdFJlbGF0aW9uc2hpcFR5cGUsXG5cdFx0Y3VzdG9tVHlwZU5hbWU6IHJlbGF0aW9uLmN1c3RvbVR5cGVOYW1lLFxuXHR9KSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RTdHJ1Y3R1cmVkTWVzc2VuZ2VySGFuZGxlKGhhbmRsZXM6IENvbnRhY3RNZXNzZW5nZXJIYW5kbGVbXSk6IFJlYWRvbmx5QXJyYXk8U3RydWN0dXJlZE1lc3NlbmdlckhhbmRsZT4ge1xuXHRyZXR1cm4gaGFuZGxlcy5tYXAoKGhhbmRsZSkgPT4gKHtcblx0XHR0eXBlOiBoYW5kbGUudHlwZSBhcyBDb250YWN0TWVzc2VuZ2VySGFuZGxlVHlwZSxcblx0XHRjdXN0b21UeXBlTmFtZTogaGFuZGxlLmN1c3RvbVR5cGVOYW1lLFxuXHRcdGhhbmRsZTogaGFuZGxlLmhhbmRsZSxcblx0fSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUJpcnRoZGF5T2ZDb250YWN0KGNvbnRhY3Q6IFN0cnVjdHVyZWRDb250YWN0KSB7XG5cdGlmIChjb250YWN0LmJpcnRoZGF5ICE9IG51bGwpIHtcblx0XHR0cnkge1xuXHRcdFx0aXNvRGF0ZVRvQmlydGhkYXkoY29udGFjdC5iaXJ0aGRheSlcblx0XHRcdHJldHVybiBjb250YWN0LmJpcnRoZGF5XG5cdFx0fSBjYXRjaCAoXykge1xuXHRcdFx0cmV0dXJuIG51bGxcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIG51bGxcblx0fVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBa0NBLGtCQUFrQjtBQUlYLFNBQVMsc0JBQXNCQSxTQUErQjtBQUNwRSxLQUFJLFFBQVEsWUFBWSxRQUFRLFFBQVEsYUFBYSxHQUNwRCxRQUFP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