import { mithril_default } from "./mithril-chunk.js";
import { downcast, memoized } from "./dist2-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import { theme } from "./theme-chunk.js";
import { CalendarAttendeeStatus, EndType, RepeatPeriod, getAttendeeStatus } from "./TutanotaConstants-chunk.js";
import { createCalendarEventAttendee, createEncryptedMailAddress } from "./TypeRefs-chunk.js";
import { cleanMailAddress, findAttendeeInAddresses, isAllDayEvent } from "./CommonCalendarUtils-chunk.js";
import { getRepeatEndTimeForDisplay, getTimeZone } from "./CalendarUtils-chunk.js";
import { hasError } from "./ErrorUtils-chunk.js";
import { Icons } from "./Icons-chunk.js";
import { pureComponent } from "./Dialog-chunk.js";
import { BootIcons, Icon, IconSize } from "./Icon-chunk.js";
import { formatDateWithMonth } from "./Formatter-chunk.js";
import { createRepeatRuleFrequencyValues, formatEventDuration, getDisplayEventTitle, iconForAttendeeStatus } from "./CalendarGuiUtils-chunk.js";
import { UpgradeRequiredError } from "./UpgradeRequiredError-chunk.js";
import { BannerButton } from "./BannerButton-chunk.js";
import { showPlanUpgradeRequiredDialog } from "./SubscriptionDialogs-chunk.js";
import { ExternalLink } from "./ExternalLink-chunk.js";

//#region src/calendar-app/calendar/gui/eventpopup/EventPreviewView.ts
const ReplyButtons = pureComponent((participation) => {
	const colors = {
		borderColor: theme.content_button,
		color: theme.content_fg
	};
	const highlightColors = {
		borderColor: theme.content_accent,
		color: theme.content_accent
	};
	const makeStatusButtonAttrs = (status, text) => Object.assign({
		text,
		class: "width-min-content",
		click: async () => {
			try {
				await participation.setParticipation(status);
			} catch (e) {
				if (e instanceof UpgradeRequiredError) {
					const ordered = await showPlanUpgradeRequiredDialog(e.plans, e.message);
					if (!ordered) return;
					await participation.setParticipation(status);
				} else throw e;
			}
		}
	}, participation.ownAttendee.status === status ? highlightColors : colors);
	return mithril_default(".flex.col", [mithril_default(".small", lang.get("invitedToEvent_msg")), mithril_default(".flex.items-center.mt-s", [
		mithril_default(BannerButton, makeStatusButtonAttrs(CalendarAttendeeStatus.ACCEPTED, "yes_label")),
		mithril_default(BannerButton, makeStatusButtonAttrs(CalendarAttendeeStatus.TENTATIVE, "maybe_label")),
		mithril_default(BannerButton, makeStatusButtonAttrs(CalendarAttendeeStatus.DECLINED, "no_label"))
	])]);
});
var EventPreviewView = class {
	getLocationUrl;
	constructor() {
		this.getLocationUrl = memoized(getLocationUrl);
	}
	view(vnode) {
		const { event, sanitizedDescription, participation } = vnode.attrs;
		const attendees = prepareAttendees(event.attendees, event.organizer);
		const eventTitle = getDisplayEventTitle(event.summary);
		return mithril_default(".flex.col.smaller.scroll.visible-scrollbar", [
			this.renderRow(BootIcons.Calendar, [mithril_default("span.h3", eventTitle)]),
			this.renderRow(Icons.Time, [formatEventDuration(event, getTimeZone(), false), this.renderRepeatRule(event.repeatRule, isAllDayEvent(event))]),
			this.renderLocation(event.location),
			this.renderAttendeesSection(attendees, participation),
			this.renderAttendanceSection(event, attendees, participation),
			this.renderDescription(sanitizedDescription)
		]);
	}
	renderRow(headerIcon, children, isAlignedLeft) {
		return mithril_default(".flex.pb-s", { class: isAlignedLeft ? "items-start" : "items-center" }, [this.renderSectionIndicator(headerIcon, isAlignedLeft ? { marginTop: "2px" } : undefined), mithril_default(".selectable.text-break.full-width", children)]);
	}
	renderSectionIndicator(icon, style = {}) {
		return mithril_default(Icon, {
			icon,
			class: "pr",
			size: IconSize.Medium,
			style: Object.assign({
				fill: theme.content_button,
				display: "block"
			}, style)
		});
	}
	renderRepeatRule(rule, isAllDay) {
		if (rule == null) return null;
		const frequency = formatRepetitionFrequency(rule);
		if (frequency) return mithril_default("", frequency + formatRepetitionEnd(rule, isAllDay));
else return mithril_default("", lang.get("unknownRepetition_msg"));
	}
	renderLocation(location) {
		if (location == null || location.trim().length === 0) return null;
		return this.renderRow(Icons.Pin, [mithril_default(".text-ellipsis.selectable", mithril_default(ExternalLink, {
			href: this.getLocationUrl(location.trim()).toString(),
			text: location,
			isCompanySite: false
		}))]);
	}
	renderAttendeesSection(attendees, participation) {
		if (attendees.length === 0) return null;
		return this.renderRow(Icons.People, [mithril_default(".flex-wrap", attendees.map((a) => this.renderAttendee(a, participation)))], true);
	}
	/**
	* if we're an attendee of this event, this renders a selector to be able to set our own attendance.
	* @param event if the event is not in a calendar, we don't want to set our attendance from here.
	* @param attendees list of attendees (including the organizer)
	* @param participation
	* @private
	*/
	renderAttendanceSection(event, attendees, participation) {
		if (attendees.length === 0 || participation == null || event._ownerGroup == null) return null;
		return mithril_default(".flex.pb-s", [this.renderSectionIndicator(BootIcons.Contacts), mithril_default(ReplyButtons, participation)]);
	}
	renderAttendee(attendee, participation) {
		const attendeeField = hasError(attendee.address) ? lang.get("corruptedValue_msg") : attendee.address.address;
		/** we might have a more current local attendance for ourselves. */
		const status = participation != null && cleanMailAddress(attendee.address.address) === participation.ownAttendee.address.address ? getAttendeeStatus(participation.ownAttendee) : getAttendeeStatus(attendee);
		return mithril_default(".flex.items-center", [mithril_default(Icon, {
			icon: iconForAttendeeStatus[status],
			style: { fill: theme.content_fg },
			class: "mr-s"
		}), mithril_default(".span.line-break-anywhere.selectable", attendeeField)]);
	}
	renderDescription(sanitizedDescription) {
		if (sanitizedDescription == null || sanitizedDescription.length === 0) return null;
		return this.renderRow(Icons.AlignLeft, [mithril_default.trust(sanitizedDescription)], true);
	}
};
function getLocationUrl(text) {
	const osmHref = `https://www.openstreetmap.org/search?query=${text}`;
	let url;
	try {
		url = new URL(text);
	} catch {
		url = new URL(osmHref);
	}
	return url;
}
function formatRepetitionFrequency(repeatRule) {
	if (repeatRule.interval === "1") {
		const frequency = createRepeatRuleFrequencyValues().find((frequency$1) => frequency$1.value === repeatRule.frequency);
		if (frequency) return frequency.name;
	} else return lang.get("repetition_msg", {
		"{interval}": repeatRule.interval,
		"{timeUnit}": getFrequencyTimeUnit(downcast(repeatRule.frequency))
	});
	return null;
}
function formatRepetitionEnd(repeatRule, isAllDay) {
	switch (repeatRule.endType) {
		case EndType.Count:
			if (!repeatRule.endValue) return "";
			return ", " + lang.get("times_msg", { "{amount}": repeatRule.endValue });
		case EndType.UntilDate: {
			const repeatEndTime = getRepeatEndTimeForDisplay(repeatRule, isAllDay, getTimeZone());
			return " " + lang.get("until_label") + " " + formatDateWithMonth(repeatEndTime);
		}
		default: return "";
	}
}
function getFrequencyTimeUnit(frequency) {
	switch (frequency) {
		case RepeatPeriod.DAILY: return lang.get("days_label");
		case RepeatPeriod.WEEKLY: return lang.get("weeks_label");
		case RepeatPeriod.MONTHLY: return lang.get("pricing.months_label");
		case RepeatPeriod.ANNUALLY: return lang.get("years_label");
		default: throw new Error("Unknown calendar event repeat rule frequency: " + frequency);
	}
}
function prepareAttendees(attendees, organizer) {
	const attendeesCopy = attendees.slice();
	if (organizer != null && attendeesCopy.length > 0 && !findAttendeeInAddresses(attendeesCopy, [organizer.address])) attendeesCopy.unshift(createCalendarEventAttendee({
		address: createEncryptedMailAddress({
			address: organizer.address,
			name: ""
		}),
		status: CalendarAttendeeStatus.ADDED
	}));
	return attendeesCopy;
}

//#endregion
export { EventPreviewView, ReplyButtons, formatRepetitionEnd, formatRepetitionFrequency, getLocationUrl };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXZlbnRQcmV2aWV3Vmlldy1jaHVuay5qcyIsIm5hbWVzIjpbInBhcnRpY2lwYXRpb246IE5vbk51bGxhYmxlPEV2ZW50UHJldmlld1ZpZXdBdHRyc1tcInBhcnRpY2lwYXRpb25cIl0+Iiwic3RhdHVzOiBDYWxlbmRhckF0dGVuZGVlU3RhdHVzIiwidGV4dDogVHJhbnNsYXRpb25LZXkiLCJ2bm9kZTogVm5vZGU8RXZlbnRQcmV2aWV3Vmlld0F0dHJzPiIsImhlYWRlckljb246IEFsbEljb25zIiwiY2hpbGRyZW46IENoaWxkcmVuIiwiaXNBbGlnbmVkTGVmdD86IGJvb2xlYW4iLCJpY29uOiBBbGxJY29ucyIsInN0eWxlOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IiwicnVsZTogQ2FsZW5kYXJSZXBlYXRSdWxlIHwgbnVsbCIsImlzQWxsRGF5OiBib29sZWFuIiwibG9jYXRpb246IHN0cmluZyB8IG51bGwiLCJhdHRlbmRlZXM6IEFycmF5PENhbGVuZGFyRXZlbnRBdHRlbmRlZT4iLCJwYXJ0aWNpcGF0aW9uOiBFdmVudFByZXZpZXdWaWV3QXR0cnNbXCJwYXJ0aWNpcGF0aW9uXCJdIiwiZXZlbnQ6IEV2ZW50UHJldmlld1ZpZXdBdHRyc1tcImV2ZW50XCJdIiwiYXR0ZW5kZWU6IENhbGVuZGFyRXZlbnRBdHRlbmRlZSIsInNhbml0aXplZERlc2NyaXB0aW9uOiBzdHJpbmcgfCBudWxsIiwidGV4dDogc3RyaW5nIiwicmVwZWF0UnVsZTogUmVwZWF0UnVsZSIsImZyZXF1ZW5jeSIsImZyZXF1ZW5jeTogUmVwZWF0UGVyaW9kIiwib3JnYW5pemVyOiBFbmNyeXB0ZWRNYWlsQWRkcmVzcyB8IG51bGwiXSwic291cmNlcyI6WyIuLi9zcmMvY2FsZW5kYXItYXBwL2NhbGVuZGFyL2d1aS9ldmVudHBvcHVwL0V2ZW50UHJldmlld1ZpZXcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDYWxlbmRhckV2ZW50LCBDYWxlbmRhckV2ZW50QXR0ZW5kZWUsIENhbGVuZGFyUmVwZWF0UnVsZSwgRW5jcnlwdGVkTWFpbEFkZHJlc3MgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2FwaS9lbnRpdGllcy90dXRhbm90YS9UeXBlUmVmcy5qc1wiXG5pbXBvcnQgeyBjcmVhdGVDYWxlbmRhckV2ZW50QXR0ZW5kZWUsIGNyZWF0ZUVuY3J5cHRlZE1haWxBZGRyZXNzIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvbW1vbi9hcGkvZW50aXRpZXMvdHV0YW5vdGEvVHlwZVJlZnMuanNcIlxuaW1wb3J0IG0sIHsgQ2hpbGRyZW4sIENvbXBvbmVudCwgVm5vZGUgfSBmcm9tIFwibWl0aHJpbFwiXG5pbXBvcnQgeyBBbGxJY29ucywgSWNvbiwgSWNvblNpemUgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2d1aS9iYXNlL0ljb24uanNcIlxuaW1wb3J0IHsgdGhlbWUgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2d1aS90aGVtZS5qc1wiXG5pbXBvcnQgeyBCb290SWNvbnMgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2d1aS9iYXNlL2ljb25zL0Jvb3RJY29ucy5qc1wiXG5pbXBvcnQgeyBJY29ucyB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vZ3VpL2Jhc2UvaWNvbnMvSWNvbnMuanNcIlxuaW1wb3J0IHsgZ2V0UmVwZWF0RW5kVGltZUZvckRpc3BsYXksIGdldFRpbWVab25lIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvbW1vbi9jYWxlbmRhci9kYXRlL0NhbGVuZGFyVXRpbHMuanNcIlxuaW1wb3J0IHsgQ2FsZW5kYXJBdHRlbmRlZVN0YXR1cywgRW5kVHlwZSwgZ2V0QXR0ZW5kZWVTdGF0dXMsIFJlcGVhdFBlcmlvZCB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vYXBpL2NvbW1vbi9UdXRhbm90YUNvbnN0YW50cy5qc1wiXG5pbXBvcnQgeyBkb3duY2FzdCwgbWVtb2l6ZWQgfSBmcm9tIFwiQHR1dGFvL3R1dGFub3RhLXV0aWxzXCJcbmltcG9ydCB7IGxhbmcsIFRyYW5zbGF0aW9uS2V5IH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvbW1vbi9taXNjL0xhbmd1YWdlVmlld01vZGVsLmpzXCJcbmltcG9ydCB0eXBlIHsgUmVwZWF0UnVsZSB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vYXBpL2VudGl0aWVzL3N5cy9UeXBlUmVmcy5qc1wiXG5pbXBvcnQgeyBjbGVhbk1haWxBZGRyZXNzLCBmaW5kQXR0ZW5kZWVJbkFkZHJlc3NlcywgaXNBbGxEYXlFdmVudCB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vYXBpL2NvbW1vbi91dGlscy9Db21tb25DYWxlbmRhclV0aWxzLmpzXCJcbmltcG9ydCB7IGZvcm1hdERhdGVXaXRoTW9udGggfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL21pc2MvRm9ybWF0dGVyLmpzXCJcbmltcG9ydCB7IEJhbm5lckJ1dHRvbiwgQmFubmVyQnV0dG9uQXR0cnMgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2d1aS9iYXNlL2J1dHRvbnMvQmFubmVyQnV0dG9uLmpzXCJcbmltcG9ydCB7IHB1cmVDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2d1aS9iYXNlL1B1cmVDb21wb25lbnQuanNcIlxuaW1wb3J0IHsgQ2FsZW5kYXJFdmVudFByZXZpZXdWaWV3TW9kZWwgfSBmcm9tIFwiLi9DYWxlbmRhckV2ZW50UHJldmlld1ZpZXdNb2RlbC5qc1wiXG5pbXBvcnQgeyBVcGdyYWRlUmVxdWlyZWRFcnJvciB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vYXBpL21haW4vVXBncmFkZVJlcXVpcmVkRXJyb3IuanNcIlxuaW1wb3J0IHsgc2hvd1BsYW5VcGdyYWRlUmVxdWlyZWREaWFsb2cgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL21pc2MvU3Vic2NyaXB0aW9uRGlhbG9ncy5qc1wiXG5pbXBvcnQgeyBFeHRlcm5hbExpbmsgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29tbW9uL2d1aS9iYXNlL0V4dGVybmFsTGluay5qc1wiXG5cbmltcG9ydCB7IGNyZWF0ZVJlcGVhdFJ1bGVGcmVxdWVuY3lWYWx1ZXMsIGZvcm1hdEV2ZW50RHVyYXRpb24sIGdldERpc3BsYXlFdmVudFRpdGxlLCBpY29uRm9yQXR0ZW5kZWVTdGF0dXMgfSBmcm9tIFwiLi4vQ2FsZW5kYXJHdWlVdGlscy5qc1wiXG5pbXBvcnQgeyBoYXNFcnJvciB9IGZyb20gXCIuLi8uLi8uLi8uLi9jb21tb24vYXBpL2NvbW1vbi91dGlscy9FcnJvclV0aWxzLmpzXCJcblxuZXhwb3J0IHR5cGUgRXZlbnRQcmV2aWV3Vmlld0F0dHJzID0ge1xuXHRldmVudDogT21pdDxDYWxlbmRhckV2ZW50LCBcImRlc2NyaXB0aW9uXCI+XG5cdHNhbml0aXplZERlc2NyaXB0aW9uOiBzdHJpbmcgfCBudWxsXG5cdHBhcnRpY2lwYXRpb24/OiBSZXR1cm5UeXBlPHR5cGVvZiBDYWxlbmRhckV2ZW50UHJldmlld1ZpZXdNb2RlbC5wcm90b3R5cGUuZ2V0UGFydGljaXBhdGlvblNldHRlckFuZFRoZW4+XG59XG5cbi8qKiB0aGUgYnV0dG9ucyBlbmFibGluZyB0aGUgdXNlciB0byB2aWV3IHRoZWlyIGN1cnJlbnQgcGFydGljaXBhdGlvbiBzdGF0dXMgb24gYW4gZXZlbnQgYW5kIHRvIHRyaWdnZXIgYSBjaGFuZ2UgdG8gaXQsIGluY2x1ZGluZ1xuICogYSBtYWlsIHRvIHRoZSBvcmdhbml6ZXIuICovXG5leHBvcnQgY29uc3QgUmVwbHlCdXR0b25zID0gcHVyZUNvbXBvbmVudCgocGFydGljaXBhdGlvbjogTm9uTnVsbGFibGU8RXZlbnRQcmV2aWV3Vmlld0F0dHJzW1wicGFydGljaXBhdGlvblwiXT4pID0+IHtcblx0Y29uc3QgY29sb3JzID0ge1xuXHRcdGJvcmRlckNvbG9yOiB0aGVtZS5jb250ZW50X2J1dHRvbixcblx0XHRjb2xvcjogdGhlbWUuY29udGVudF9mZyxcblx0fVxuXG5cdGNvbnN0IGhpZ2hsaWdodENvbG9ycyA9IHtcblx0XHRib3JkZXJDb2xvcjogdGhlbWUuY29udGVudF9hY2NlbnQsXG5cdFx0Y29sb3I6IHRoZW1lLmNvbnRlbnRfYWNjZW50LFxuXHR9XG5cblx0Y29uc3QgbWFrZVN0YXR1c0J1dHRvbkF0dHJzID0gKHN0YXR1czogQ2FsZW5kYXJBdHRlbmRlZVN0YXR1cywgdGV4dDogVHJhbnNsYXRpb25LZXkpOiBCYW5uZXJCdXR0b25BdHRycyA9PlxuXHRcdE9iamVjdC5hc3NpZ24oXG5cdFx0XHR7XG5cdFx0XHRcdHRleHQsXG5cdFx0XHRcdGNsYXNzOiBcIndpZHRoLW1pbi1jb250ZW50XCIsXG5cdFx0XHRcdGNsaWNrOiBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdGF3YWl0IHBhcnRpY2lwYXRpb24uc2V0UGFydGljaXBhdGlvbihzdGF0dXMpXG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0aWYgKGUgaW5zdGFuY2VvZiBVcGdyYWRlUmVxdWlyZWRFcnJvcikge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBvcmRlcmVkID0gYXdhaXQgc2hvd1BsYW5VcGdyYWRlUmVxdWlyZWREaWFsb2coZS5wbGFucywgZS5tZXNzYWdlKVxuXHRcdFx0XHRcdFx0XHRpZiAoIW9yZGVyZWQpIHJldHVyblxuXHRcdFx0XHRcdFx0XHRhd2FpdCBwYXJ0aWNpcGF0aW9uLnNldFBhcnRpY2lwYXRpb24oc3RhdHVzKVxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dGhyb3cgZVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSxcblx0XHRcdH0sXG5cdFx0XHRwYXJ0aWNpcGF0aW9uLm93bkF0dGVuZGVlLnN0YXR1cyA9PT0gc3RhdHVzID8gaGlnaGxpZ2h0Q29sb3JzIDogY29sb3JzLFxuXHRcdClcblxuXHRyZXR1cm4gbShcIi5mbGV4LmNvbFwiLCBbXG5cdFx0bShcIi5zbWFsbFwiLCBsYW5nLmdldChcImludml0ZWRUb0V2ZW50X21zZ1wiKSksXG5cdFx0bShcIi5mbGV4Lml0ZW1zLWNlbnRlci5tdC1zXCIsIFtcblx0XHRcdG0oQmFubmVyQnV0dG9uLCBtYWtlU3RhdHVzQnV0dG9uQXR0cnMoQ2FsZW5kYXJBdHRlbmRlZVN0YXR1cy5BQ0NFUFRFRCwgXCJ5ZXNfbGFiZWxcIikpLFxuXHRcdFx0bShCYW5uZXJCdXR0b24sIG1ha2VTdGF0dXNCdXR0b25BdHRycyhDYWxlbmRhckF0dGVuZGVlU3RhdHVzLlRFTlRBVElWRSwgXCJtYXliZV9sYWJlbFwiKSksXG5cdFx0XHRtKEJhbm5lckJ1dHRvbiwgbWFrZVN0YXR1c0J1dHRvbkF0dHJzKENhbGVuZGFyQXR0ZW5kZWVTdGF0dXMuREVDTElORUQsIFwibm9fbGFiZWxcIikpLFxuXHRcdF0pLFxuXHRdKVxufSlcblxuZXhwb3J0IGNsYXNzIEV2ZW50UHJldmlld1ZpZXcgaW1wbGVtZW50cyBDb21wb25lbnQ8RXZlbnRQcmV2aWV3Vmlld0F0dHJzPiB7XG5cdC8vIENhY2hlIHRoZSBwYXJzZWQgVVJMLCBzbyB3ZSBkb24ndCBwYXJzZSB0aGUgVVJMIG9uIGV2ZXJ5IHNpbmdsZSB2aWV3IGNhbGxcblx0cHJpdmF0ZSByZWFkb25seSBnZXRMb2NhdGlvblVybDogdHlwZW9mIGdldExvY2F0aW9uVXJsXG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0dGhpcy5nZXRMb2NhdGlvblVybCA9IG1lbW9pemVkKGdldExvY2F0aW9uVXJsKVxuXHR9XG5cblx0dmlldyh2bm9kZTogVm5vZGU8RXZlbnRQcmV2aWV3Vmlld0F0dHJzPik6IENoaWxkcmVuIHtcblx0XHRjb25zdCB7IGV2ZW50LCBzYW5pdGl6ZWREZXNjcmlwdGlvbiwgcGFydGljaXBhdGlvbiB9ID0gdm5vZGUuYXR0cnNcblx0XHRjb25zdCBhdHRlbmRlZXMgPSBwcmVwYXJlQXR0ZW5kZWVzKGV2ZW50LmF0dGVuZGVlcywgZXZlbnQub3JnYW5pemVyKVxuXHRcdGNvbnN0IGV2ZW50VGl0bGUgPSBnZXREaXNwbGF5RXZlbnRUaXRsZShldmVudC5zdW1tYXJ5KVxuXG5cdFx0cmV0dXJuIG0oXCIuZmxleC5jb2wuc21hbGxlci5zY3JvbGwudmlzaWJsZS1zY3JvbGxiYXJcIiwgW1xuXHRcdFx0dGhpcy5yZW5kZXJSb3coQm9vdEljb25zLkNhbGVuZGFyLCBbbShcInNwYW4uaDNcIiwgZXZlbnRUaXRsZSldKSxcblx0XHRcdHRoaXMucmVuZGVyUm93KEljb25zLlRpbWUsIFtmb3JtYXRFdmVudER1cmF0aW9uKGV2ZW50LCBnZXRUaW1lWm9uZSgpLCBmYWxzZSksIHRoaXMucmVuZGVyUmVwZWF0UnVsZShldmVudC5yZXBlYXRSdWxlLCBpc0FsbERheUV2ZW50KGV2ZW50KSldKSxcblx0XHRcdHRoaXMucmVuZGVyTG9jYXRpb24oZXZlbnQubG9jYXRpb24pLFxuXHRcdFx0dGhpcy5yZW5kZXJBdHRlbmRlZXNTZWN0aW9uKGF0dGVuZGVlcywgcGFydGljaXBhdGlvbiksXG5cdFx0XHR0aGlzLnJlbmRlckF0dGVuZGFuY2VTZWN0aW9uKGV2ZW50LCBhdHRlbmRlZXMsIHBhcnRpY2lwYXRpb24pLFxuXHRcdFx0dGhpcy5yZW5kZXJEZXNjcmlwdGlvbihzYW5pdGl6ZWREZXNjcmlwdGlvbiksXG5cdFx0XSlcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyUm93KGhlYWRlckljb246IEFsbEljb25zLCBjaGlsZHJlbjogQ2hpbGRyZW4sIGlzQWxpZ25lZExlZnQ/OiBib29sZWFuKTogQ2hpbGRyZW4ge1xuXHRcdHJldHVybiBtKFxuXHRcdFx0XCIuZmxleC5wYi1zXCIsXG5cdFx0XHR7XG5cdFx0XHRcdGNsYXNzOiBpc0FsaWduZWRMZWZ0ID8gXCJpdGVtcy1zdGFydFwiIDogXCJpdGVtcy1jZW50ZXJcIixcblx0XHRcdH0sXG5cdFx0XHRbdGhpcy5yZW5kZXJTZWN0aW9uSW5kaWNhdG9yKGhlYWRlckljb24sIGlzQWxpZ25lZExlZnQgPyB7IG1hcmdpblRvcDogXCIycHhcIiB9IDogdW5kZWZpbmVkKSwgbShcIi5zZWxlY3RhYmxlLnRleHQtYnJlYWsuZnVsbC13aWR0aFwiLCBjaGlsZHJlbildLFxuXHRcdClcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyU2VjdGlvbkluZGljYXRvcihpY29uOiBBbGxJY29ucywgc3R5bGU6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fSk6IENoaWxkcmVuIHtcblx0XHRyZXR1cm4gbShJY29uLCB7XG5cdFx0XHRpY29uLFxuXHRcdFx0Y2xhc3M6IFwicHJcIixcblx0XHRcdHNpemU6IEljb25TaXplLk1lZGl1bSxcblx0XHRcdHN0eWxlOiBPYmplY3QuYXNzaWduKFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0ZmlsbDogdGhlbWUuY29udGVudF9idXR0b24sXG5cdFx0XHRcdFx0ZGlzcGxheTogXCJibG9ja1wiLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdHlsZSxcblx0XHRcdCksXG5cdFx0fSlcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyUmVwZWF0UnVsZShydWxlOiBDYWxlbmRhclJlcGVhdFJ1bGUgfCBudWxsLCBpc0FsbERheTogYm9vbGVhbik6IENoaWxkcmVuIHtcblx0XHRpZiAocnVsZSA9PSBudWxsKSByZXR1cm4gbnVsbFxuXG5cdFx0Y29uc3QgZnJlcXVlbmN5ID0gZm9ybWF0UmVwZXRpdGlvbkZyZXF1ZW5jeShydWxlKVxuXG5cdFx0aWYgKGZyZXF1ZW5jeSkge1xuXHRcdFx0cmV0dXJuIG0oXCJcIiwgZnJlcXVlbmN5ICsgZm9ybWF0UmVwZXRpdGlvbkVuZChydWxlLCBpc0FsbERheSkpXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIElmIHdlIGNhbm5vdCBwcm9wZXJseSBwcm9jZXNzIHRoZSBmcmVxdWVuY3kgd2UganVzdCBpbmRpY2F0ZSB0aGF0IHRoZSBldmVudCBpcyBwYXJ0IG9mIGEgc2VyaWVzLlxuXHRcdFx0cmV0dXJuIG0oXCJcIiwgbGFuZy5nZXQoXCJ1bmtub3duUmVwZXRpdGlvbl9tc2dcIikpXG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJMb2NhdGlvbihsb2NhdGlvbjogc3RyaW5nIHwgbnVsbCk6IENoaWxkcmVuIHtcblx0XHRpZiAobG9jYXRpb24gPT0gbnVsbCB8fCBsb2NhdGlvbi50cmltKCkubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbFxuXHRcdHJldHVybiB0aGlzLnJlbmRlclJvdyhJY29ucy5QaW4sIFtcblx0XHRcdG0oXG5cdFx0XHRcdFwiLnRleHQtZWxsaXBzaXMuc2VsZWN0YWJsZVwiLFxuXHRcdFx0XHRtKEV4dGVybmFsTGluaywge1xuXHRcdFx0XHRcdGhyZWY6IHRoaXMuZ2V0TG9jYXRpb25VcmwobG9jYXRpb24udHJpbSgpKS50b1N0cmluZygpLFxuXHRcdFx0XHRcdHRleHQ6IGxvY2F0aW9uLFxuXHRcdFx0XHRcdGlzQ29tcGFueVNpdGU6IGZhbHNlLFxuXHRcdFx0XHR9KSxcblx0XHRcdCksXG5cdFx0XSlcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyQXR0ZW5kZWVzU2VjdGlvbihhdHRlbmRlZXM6IEFycmF5PENhbGVuZGFyRXZlbnRBdHRlbmRlZT4sIHBhcnRpY2lwYXRpb246IEV2ZW50UHJldmlld1ZpZXdBdHRyc1tcInBhcnRpY2lwYXRpb25cIl0pOiBDaGlsZHJlbiB7XG5cdFx0aWYgKGF0dGVuZGVlcy5sZW5ndGggPT09IDApIHJldHVybiBudWxsXG5cdFx0cmV0dXJuIHRoaXMucmVuZGVyUm93KFxuXHRcdFx0SWNvbnMuUGVvcGxlLFxuXHRcdFx0W1xuXHRcdFx0XHRtKFxuXHRcdFx0XHRcdFwiLmZsZXgtd3JhcFwiLFxuXHRcdFx0XHRcdGF0dGVuZGVlcy5tYXAoKGEpID0+IHRoaXMucmVuZGVyQXR0ZW5kZWUoYSwgcGFydGljaXBhdGlvbikpLFxuXHRcdFx0XHQpLFxuXHRcdFx0XSxcblx0XHRcdHRydWUsXG5cdFx0KVxuXHR9XG5cblx0LyoqXG5cdCAqIGlmIHdlJ3JlIGFuIGF0dGVuZGVlIG9mIHRoaXMgZXZlbnQsIHRoaXMgcmVuZGVycyBhIHNlbGVjdG9yIHRvIGJlIGFibGUgdG8gc2V0IG91ciBvd24gYXR0ZW5kYW5jZS5cblx0ICogQHBhcmFtIGV2ZW50IGlmIHRoZSBldmVudCBpcyBub3QgaW4gYSBjYWxlbmRhciwgd2UgZG9uJ3Qgd2FudCB0byBzZXQgb3VyIGF0dGVuZGFuY2UgZnJvbSBoZXJlLlxuXHQgKiBAcGFyYW0gYXR0ZW5kZWVzIGxpc3Qgb2YgYXR0ZW5kZWVzIChpbmNsdWRpbmcgdGhlIG9yZ2FuaXplcilcblx0ICogQHBhcmFtIHBhcnRpY2lwYXRpb25cblx0ICogQHByaXZhdGVcblx0ICovXG5cdHByaXZhdGUgcmVuZGVyQXR0ZW5kYW5jZVNlY3Rpb24oXG5cdFx0ZXZlbnQ6IEV2ZW50UHJldmlld1ZpZXdBdHRyc1tcImV2ZW50XCJdLFxuXHRcdGF0dGVuZGVlczogQXJyYXk8Q2FsZW5kYXJFdmVudEF0dGVuZGVlPixcblx0XHRwYXJ0aWNpcGF0aW9uOiBFdmVudFByZXZpZXdWaWV3QXR0cnNbXCJwYXJ0aWNpcGF0aW9uXCJdLFxuXHQpOiBDaGlsZHJlbiB7XG5cdFx0aWYgKGF0dGVuZGVlcy5sZW5ndGggPT09IDAgfHwgcGFydGljaXBhdGlvbiA9PSBudWxsIHx8IGV2ZW50Ll9vd25lckdyb3VwID09IG51bGwpIHJldHVybiBudWxsXG5cdFx0cmV0dXJuIG0oXCIuZmxleC5wYi1zXCIsIFt0aGlzLnJlbmRlclNlY3Rpb25JbmRpY2F0b3IoQm9vdEljb25zLkNvbnRhY3RzKSwgbShSZXBseUJ1dHRvbnMsIHBhcnRpY2lwYXRpb24pXSlcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyQXR0ZW5kZWUoYXR0ZW5kZWU6IENhbGVuZGFyRXZlbnRBdHRlbmRlZSwgcGFydGljaXBhdGlvbjogRXZlbnRQcmV2aWV3Vmlld0F0dHJzW1wicGFydGljaXBhdGlvblwiXSk6IENoaWxkcmVuIHtcblx0XHRjb25zdCBhdHRlbmRlZUZpZWxkID0gaGFzRXJyb3IoYXR0ZW5kZWUuYWRkcmVzcykgPyBsYW5nLmdldChcImNvcnJ1cHRlZFZhbHVlX21zZ1wiKSA6IGF0dGVuZGVlLmFkZHJlc3MuYWRkcmVzc1xuXHRcdC8qKiB3ZSBtaWdodCBoYXZlIGEgbW9yZSBjdXJyZW50IGxvY2FsIGF0dGVuZGFuY2UgZm9yIG91cnNlbHZlcy4gKi9cblx0XHRjb25zdCBzdGF0dXMgPVxuXHRcdFx0cGFydGljaXBhdGlvbiAhPSBudWxsICYmIGNsZWFuTWFpbEFkZHJlc3MoYXR0ZW5kZWUuYWRkcmVzcy5hZGRyZXNzKSA9PT0gcGFydGljaXBhdGlvbi5vd25BdHRlbmRlZS5hZGRyZXNzLmFkZHJlc3Ncblx0XHRcdFx0PyBnZXRBdHRlbmRlZVN0YXR1cyhwYXJ0aWNpcGF0aW9uLm93bkF0dGVuZGVlKVxuXHRcdFx0XHQ6IGdldEF0dGVuZGVlU3RhdHVzKGF0dGVuZGVlKVxuXG5cdFx0cmV0dXJuIG0oXCIuZmxleC5pdGVtcy1jZW50ZXJcIiwgW1xuXHRcdFx0bShJY29uLCB7XG5cdFx0XHRcdGljb246IGljb25Gb3JBdHRlbmRlZVN0YXR1c1tzdGF0dXNdLFxuXHRcdFx0XHRzdHlsZToge1xuXHRcdFx0XHRcdGZpbGw6IHRoZW1lLmNvbnRlbnRfZmcsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGNsYXNzOiBcIm1yLXNcIixcblx0XHRcdH0pLFxuXHRcdFx0bShcIi5zcGFuLmxpbmUtYnJlYWstYW55d2hlcmUuc2VsZWN0YWJsZVwiLCBhdHRlbmRlZUZpZWxkKSxcblx0XHRdKVxuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJEZXNjcmlwdGlvbihzYW5pdGl6ZWREZXNjcmlwdGlvbjogc3RyaW5nIHwgbnVsbCkge1xuXHRcdGlmIChzYW5pdGl6ZWREZXNjcmlwdGlvbiA9PSBudWxsIHx8IHNhbml0aXplZERlc2NyaXB0aW9uLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGxcblx0XHRyZXR1cm4gdGhpcy5yZW5kZXJSb3coSWNvbnMuQWxpZ25MZWZ0LCBbbS50cnVzdChzYW5pdGl6ZWREZXNjcmlwdGlvbildLCB0cnVlKVxuXHR9XG59XG5cbi8qKlxuICogaWYgdGV4dCBpcyBhIHZhbGlkIGFic29sdXRlIHVybCwgdGhlbiByZXR1cm5zIGEgVVJMIHdpdGggdGV4dCBhcyB0aGUgaHJlZlxuICogb3RoZXJ3aXNlIHBhc3NlcyB0ZXh0IGFzIHRoZSBzZWFyY2ggcGFyYW1ldGVyIGZvciBvcGVuIHN0cmVldCBtYXBcbiAqIEBwYXJhbSB0ZXh0XG4gKiBAcmV0dXJucyB7Kn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvY2F0aW9uVXJsKHRleHQ6IHN0cmluZyk6IFVSTCB7XG5cdGNvbnN0IG9zbUhyZWYgPSBgaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvc2VhcmNoP3F1ZXJ5PSR7dGV4dH1gXG5cdGxldCB1cmxcblxuXHR0cnkge1xuXHRcdC8vIGlmIG5vdCBhIHZhbGlkIF9hYnNvbHV0ZV8gdXJsIHRoZW4gd2UgZ2V0IGFuIGV4Y2VwdGlvblxuXHRcdHVybCA9IG5ldyBVUkwodGV4dClcblx0fSBjYXRjaCB7XG5cdFx0dXJsID0gbmV3IFVSTChvc21IcmVmKVxuXHR9XG5cblx0cmV0dXJuIHVybFxufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0UmVwZXRpdGlvbkZyZXF1ZW5jeShyZXBlYXRSdWxlOiBSZXBlYXRSdWxlKTogc3RyaW5nIHwgbnVsbCB7XG5cdGlmIChyZXBlYXRSdWxlLmludGVydmFsID09PSBcIjFcIikge1xuXHRcdGNvbnN0IGZyZXF1ZW5jeSA9IGNyZWF0ZVJlcGVhdFJ1bGVGcmVxdWVuY3lWYWx1ZXMoKS5maW5kKChmcmVxdWVuY3kpID0+IGZyZXF1ZW5jeS52YWx1ZSA9PT0gcmVwZWF0UnVsZS5mcmVxdWVuY3kpXG5cblx0XHRpZiAoZnJlcXVlbmN5KSB7XG5cdFx0XHRyZXR1cm4gZnJlcXVlbmN5Lm5hbWVcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGxhbmcuZ2V0KFwicmVwZXRpdGlvbl9tc2dcIiwge1xuXHRcdFx0XCJ7aW50ZXJ2YWx9XCI6IHJlcGVhdFJ1bGUuaW50ZXJ2YWwsXG5cdFx0XHRcInt0aW1lVW5pdH1cIjogZ2V0RnJlcXVlbmN5VGltZVVuaXQoZG93bmNhc3QocmVwZWF0UnVsZS5mcmVxdWVuY3kpKSxcblx0XHR9KVxuXHR9XG5cblx0cmV0dXJuIG51bGxcbn1cblxuLyoqXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgcmV0dXJuZWQgc3RyaW5nIGluY2x1ZGVzIGEgbGVhZGluZyBzZXBhcmF0b3IgKFwiLCBcIiBvciBcIiBcIikuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRSZXBldGl0aW9uRW5kKHJlcGVhdFJ1bGU6IFJlcGVhdFJ1bGUsIGlzQWxsRGF5OiBib29sZWFuKTogc3RyaW5nIHtcblx0c3dpdGNoIChyZXBlYXRSdWxlLmVuZFR5cGUpIHtcblx0XHRjYXNlIEVuZFR5cGUuQ291bnQ6XG5cdFx0XHRpZiAoIXJlcGVhdFJ1bGUuZW5kVmFsdWUpIHtcblx0XHRcdFx0cmV0dXJuIFwiXCJcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIChcblx0XHRcdFx0XCIsIFwiICtcblx0XHRcdFx0bGFuZy5nZXQoXCJ0aW1lc19tc2dcIiwge1xuXHRcdFx0XHRcdFwie2Ftb3VudH1cIjogcmVwZWF0UnVsZS5lbmRWYWx1ZSxcblx0XHRcdFx0fSlcblx0XHRcdClcblxuXHRcdGNhc2UgRW5kVHlwZS5VbnRpbERhdGU6IHtcblx0XHRcdGNvbnN0IHJlcGVhdEVuZFRpbWUgPSBnZXRSZXBlYXRFbmRUaW1lRm9yRGlzcGxheShyZXBlYXRSdWxlLCBpc0FsbERheSwgZ2V0VGltZVpvbmUoKSlcblx0XHRcdHJldHVybiBcIiBcIiArIGxhbmcuZ2V0KFwidW50aWxfbGFiZWxcIikgKyBcIiBcIiArIGZvcm1hdERhdGVXaXRoTW9udGgocmVwZWF0RW5kVGltZSlcblx0XHR9XG5cblx0XHRkZWZhdWx0OlxuXHRcdFx0cmV0dXJuIFwiXCJcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRGcmVxdWVuY3lUaW1lVW5pdChmcmVxdWVuY3k6IFJlcGVhdFBlcmlvZCk6IHN0cmluZyB7XG5cdHN3aXRjaCAoZnJlcXVlbmN5KSB7XG5cdFx0Y2FzZSBSZXBlYXRQZXJpb2QuREFJTFk6XG5cdFx0XHRyZXR1cm4gbGFuZy5nZXQoXCJkYXlzX2xhYmVsXCIpXG5cblx0XHRjYXNlIFJlcGVhdFBlcmlvZC5XRUVLTFk6XG5cdFx0XHRyZXR1cm4gbGFuZy5nZXQoXCJ3ZWVrc19sYWJlbFwiKVxuXG5cdFx0Y2FzZSBSZXBlYXRQZXJpb2QuTU9OVEhMWTpcblx0XHRcdHJldHVybiBsYW5nLmdldChcInByaWNpbmcubW9udGhzX2xhYmVsXCIpXG5cblx0XHRjYXNlIFJlcGVhdFBlcmlvZC5BTk5VQUxMWTpcblx0XHRcdHJldHVybiBsYW5nLmdldChcInllYXJzX2xhYmVsXCIpXG5cblx0XHRkZWZhdWx0OlxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biBjYWxlbmRhciBldmVudCByZXBlYXQgcnVsZSBmcmVxdWVuY3k6IFwiICsgZnJlcXVlbmN5KVxuXHR9XG59XG5cbmZ1bmN0aW9uIHByZXBhcmVBdHRlbmRlZXMoYXR0ZW5kZWVzOiBBcnJheTxDYWxlbmRhckV2ZW50QXR0ZW5kZWU+LCBvcmdhbml6ZXI6IEVuY3J5cHRlZE1haWxBZGRyZXNzIHwgbnVsbCk6IEFycmF5PENhbGVuZGFyRXZlbnRBdHRlbmRlZT4ge1xuXHQvLyBXZSBjb3B5IHRoZSBhdHRlbmRlZXMgYXJyYXkgc28gdGhhdCB3ZSBjYW4gYWRkIHRoZSBvcmdhbml6ZXIsIGluIHRoZSBjYXNlIHRoYXQgdGhleSBhcmUgbm90IGFscmVhZHkgaW4gYXR0ZW5kZWVzXG5cdC8vIFRoaXMgaXMganVzdCBmb3IgZGlzcGxheSBwdXJwb3Nlcy4gV2UgbmVlZCB0byBjb3B5IGJlY2F1c2UgZXZlbnQuYXR0ZW5kZWVzIGlzIHRoZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIHRoZSBldmVudFxuXHQvLyBzbyB3ZSBjYW4ndCBtb2RpZnkgaXRcblx0Y29uc3QgYXR0ZW5kZWVzQ29weSA9IGF0dGVuZGVlcy5zbGljZSgpXG5cblx0aWYgKG9yZ2FuaXplciAhPSBudWxsICYmIGF0dGVuZGVlc0NvcHkubGVuZ3RoID4gMCAmJiAhZmluZEF0dGVuZGVlSW5BZGRyZXNzZXMoYXR0ZW5kZWVzQ29weSwgW29yZ2FuaXplci5hZGRyZXNzXSkpIHtcblx0XHRhdHRlbmRlZXNDb3B5LnVuc2hpZnQoXG5cdFx0XHRjcmVhdGVDYWxlbmRhckV2ZW50QXR0ZW5kZWUoe1xuXHRcdFx0XHRhZGRyZXNzOiBjcmVhdGVFbmNyeXB0ZWRNYWlsQWRkcmVzcyh7XG5cdFx0XHRcdFx0YWRkcmVzczogb3JnYW5pemVyLmFkZHJlc3MsXG5cdFx0XHRcdFx0bmFtZTogXCJcIixcblx0XHRcdFx0fSksXG5cdFx0XHRcdHN0YXR1czogQ2FsZW5kYXJBdHRlbmRlZVN0YXR1cy5BRERFRCwgLy8gV2UgZG9uJ3Qga25vdyB3aGV0aGVyIHRoZSBvcmdhbml6ZXIgd2lsbCBiZSBhdHRlbmRpbmcgb3Igbm90IGluIHRoaXMgY2FzZVxuXHRcdFx0fSksXG5cdFx0KVxuXHR9XG5cblx0cmV0dXJuIGF0dGVuZGVlc0NvcHlcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7TUFnQ2EsZUFBZSxjQUFjLENBQUNBLGtCQUF1RTtDQUNqSCxNQUFNLFNBQVM7RUFDZCxhQUFhLE1BQU07RUFDbkIsT0FBTyxNQUFNO0NBQ2I7Q0FFRCxNQUFNLGtCQUFrQjtFQUN2QixhQUFhLE1BQU07RUFDbkIsT0FBTyxNQUFNO0NBQ2I7Q0FFRCxNQUFNLHdCQUF3QixDQUFDQyxRQUFnQ0MsU0FDOUQsT0FBTyxPQUNOO0VBQ0M7RUFDQSxPQUFPO0VBQ1AsT0FBTyxZQUFZO0FBQ2xCLE9BQUk7QUFDSCxVQUFNLGNBQWMsaUJBQWlCLE9BQU87R0FDNUMsU0FBUSxHQUFHO0FBQ1gsUUFBSSxhQUFhLHNCQUFzQjtLQUN0QyxNQUFNLFVBQVUsTUFBTSw4QkFBOEIsRUFBRSxPQUFPLEVBQUUsUUFBUTtBQUN2RSxVQUFLLFFBQVM7QUFDZCxXQUFNLGNBQWMsaUJBQWlCLE9BQU87SUFDNUMsTUFDQSxPQUFNO0dBRVA7RUFDRDtDQUNELEdBQ0QsY0FBYyxZQUFZLFdBQVcsU0FBUyxrQkFBa0IsT0FDaEU7QUFFRixRQUFPLGdCQUFFLGFBQWEsQ0FDckIsZ0JBQUUsVUFB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