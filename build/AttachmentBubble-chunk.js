import { mithril_default } from "./mithril-chunk.js";
import { defer, noOp } from "./dist2-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import { TransformEnum, animations, ease, height, opacity, transform, width } from "./styles-chunk.js";
import { theme } from "./theme-chunk.js";
import { Keys } from "./TutanotaConstants-chunk.js";
import { focusNext, focusPrevious } from "./KeyManager-chunk.js";
import { modal } from "./RootView-chunk.js";
import { px } from "./size-chunk.js";
import { getSafeAreaInsetBottom } from "./HtmlUtils-chunk.js";
import { hasError } from "./ErrorUtils-chunk.js";
import { Button, ButtonType } from "./Button-chunk.js";
import { Icons } from "./Icons-chunk.js";
import { BootIcons, Icon } from "./Icon-chunk.js";
import { formatStorageSize } from "./Formatter-chunk.js";
import { getFileBaseName, getFileExtension, isTutanotaFile } from "./FileUtils-chunk.js";
import { CALENDAR_MIME_TYPE, MAIL_MIME_TYPES, VCARD_MIME_TYPES } from "./SharedMailUtils-chunk.js";
import { BubbleButton, bubbleButtonHeight, bubbleButtonPadding } from "./BubbleButton-chunk.js";

//#region src/common/gui/AttachmentBubble.ts
let AttachmentType = function(AttachmentType$1) {
	AttachmentType$1[AttachmentType$1["GENERIC"] = 0] = "GENERIC";
	AttachmentType$1[AttachmentType$1["CONTACT"] = 1] = "CONTACT";
	AttachmentType$1[AttachmentType$1["CALENDAR"] = 2] = "CALENDAR";
	AttachmentType$1[AttachmentType$1["MAIL"] = 3] = "MAIL";
	return AttachmentType$1;
}({});
var AttachmentBubble = class {
	dom = null;
	view(vnode) {
		const { attachment } = vnode.attrs;
		if (isTutanotaFile(attachment) && hasError(attachment)) return mithril_default(BubbleButton, {
			label: "emptyString_msg",
			text: "corrupted_msg",
			icon: Icons.Warning,
			onclick: noOp
		});
else {
			const extension = getFileExtension(attachment.name);
			const rest = getFileBaseName(attachment.name);
			return mithril_default(BubbleButton, {
				label: lang.makeTranslation("attachment_name", attachment.name),
				text: lang.makeTranslation("attachment_base_name", rest),
				icon: getAttachmentIcon(vnode.attrs.type),
				onclick: () => {
					showAttachmentDetailsPopup(this.dom, vnode.attrs).then(() => this.dom?.focus());
				}
			}, `${extension}, ${formatStorageSize(Number(attachment.size))}`);
		}
	}
	oncreate(vnode) {
		this.dom = vnode.dom;
	}
};
async function showAttachmentDetailsPopup(dom, attrs) {
	const parentRect = dom.getBoundingClientRect();
	const panel = new AttachmentDetailsPopup(parentRect, parentRect.width, attrs);
	panel.show();
	return panel.deferAfterClose;
}
function getAttachmentIcon(type) {
	switch (type) {
		case AttachmentType.CONTACT: return Icons.People;
		case AttachmentType.CALENDAR: return BootIcons.Calendar;
		default: return Icons.Attachment;
	}
}
function getAttachmentType(mimeType) {
	if (Object.values(VCARD_MIME_TYPES).includes(mimeType)) return AttachmentType.CONTACT;
else if (mimeType === CALENDAR_MIME_TYPE) return AttachmentType.CALENDAR;
else if (Object.values(MAIL_MIME_TYPES).includes(mimeType)) return AttachmentType.MAIL;
	return AttachmentType.GENERIC;
}
var AttachmentDetailsPopup = class {
	_shortcuts = [];
	domContent = null;
	domPanel = null;
	closeDefer = defer();
	focusedBeforeShown = null;
	get deferAfterClose() {
		return this.closeDefer.promise;
	}
	constructor(targetRect, targetWidth, attrs) {
		this.targetRect = targetRect;
		this.targetWidth = targetWidth;
		this.attrs = attrs;
		this._shortcuts.push({
			key: Keys.ESC,
			exec: () => this.onClose(),
			help: "close_alt"
		});
		this._shortcuts.push({
			key: Keys.TAB,
			shift: true,
			exec: () => this.domContent ? focusPrevious(this.domContent) : false,
			help: "selectPrevious_action"
		});
		this._shortcuts.push({
			key: Keys.TAB,
			shift: false,
			exec: () => this.domContent ? focusNext(this.domContent) : false,
			help: "selectNext_action"
		});
		if (attrs.open) this._shortcuts.push({
			key: Keys.O,
			exec: () => this.thenClose(attrs.open),
			help: "open_action"
		});
		if (attrs.download) this._shortcuts.push({
			key: Keys.D,
			exec: () => this.thenClose(attrs.download),
			help: "download_action"
		});
		if (attrs.remove) this._shortcuts.push({
			key: Keys.DELETE,
			exec: () => this.thenClose(attrs.remove),
			help: "remove_action"
		});
		if (attrs.fileImport) this._shortcuts.push({
			key: Keys.I,
			exec: () => this.thenClose(attrs.fileImport),
			help: "import_action"
		});
		this.view = this.view.bind(this);
	}
	view() {
		return mithril_default(".abs.bubble-color.border-radius.overflow-hidden.flex.flex-column", {
			class: bubbleButtonPadding(),
			style: {
				width: px(this.targetWidth),
				opacity: "0"
			},
			oncreate: (vnode) => {
				this.domPanel = vnode.dom;
				deferToNextFrame(() => this.animatePanel().then(() => this.domContent && focusNext(this.domContent)));
			},
			onclick: () => this.onClose()
		}, this.renderContent());
	}
	renderContent() {
		const { remove, open, download, attachment, fileImport, type } = this.attrs;
		return mithril_default(".flex.mb-s.pr", { oncreate: (vnode) => this.domContent = vnode.dom }, [mithril_default(Icon, {
			icon: getAttachmentIcon(type),
			class: "pr-s flex items-center",
			style: {
				fill: theme.button_bubble_fg,
				"background-color": "initial",
				minHeight: px(bubbleButtonHeight())
			}
		}), mithril_default(
			".flex.col.flex-grow",
			{ style: {
				minHeight: px(bubbleButtonHeight()),
				lineHeight: px(bubbleButtonHeight())
			} },
			mithril_default(".span.break-all.smaller", attachment.name),
			// bottom info is inside the same column as file text to align them
			mithril_default(".flex.row.justify-between.items-center", [mithril_default("span.smaller", `${formatStorageSize(Number(attachment.size))}`), mithril_default(".flex.no-wrap", [
				remove ? mithril_default(Button, {
					type: ButtonType.Secondary,
					label: "remove_action",
					click: () => this.thenClose(remove)
				}) : null,
				fileImport ? mithril_default(Button, {
					type: ButtonType.Secondary,
					label: "import_action",
					click: () => this.thenClose(fileImport)
				}) : null,
				open ? mithril_default(Button, {
					type: ButtonType.Secondary,
					label: "open_action",
					click: () => this.thenClose(open)
				}) : null,
				download ? mithril_default(Button, {
					type: ButtonType.Secondary,
					label: "download_action",
					click: () => this.thenClose(download)
				}) : null
			])])
)]);
	}
	thenClose(action) {
		action?.();
		this.onClose();
	}
	async animatePanel() {
		const { targetRect, domPanel, domContent } = this;
		if (domPanel == null || domContent == null) return;
		const initialHeight = bubbleButtonHeight();
		const targetHeight = domContent.offsetHeight === 0 ? 85 : domContent.offsetHeight;
		if (domContent.offsetHeight === 0) console.log("got offsetHeight 0, panel contains content:", domPanel.contains(domContent), "content style:", domContent.style, "panel style:", domPanel.style);
		const targetWidth = Math.max(targetRect.width, 300);
		domPanel.style.width = px(targetRect.width);
		domPanel.style.height = px(initialHeight);
		domPanel.style.top = px(targetRect.top);
		if (targetRect.left + targetWidth > window.innerWidth) domPanel.style.right = px(24);
else domPanel.style.left = px(targetRect.left);
		const mutations = [opacity(0, 1, true), height(initialHeight, targetHeight)];
		if (targetRect.width !== targetWidth) mutations.push(width(targetRect.width, targetWidth));
		const spaceBelow = window.innerHeight - getSafeAreaInsetBottom() - targetRect.top - targetHeight - initialHeight;
		if (spaceBelow < 0) mutations.push(transform(TransformEnum.TranslateY, 0, spaceBelow));
		await animations.add(domPanel, mutations, { easing: ease.out });
	}
	show() {
		this.focusedBeforeShown = document.activeElement;
		modal.displayUnique(this, true);
	}
	backgroundClick(e) {
		modal.remove(this);
	}
	async hideAnimation() {
		if (this.domPanel == null) return;
		const startHeight = this.domPanel.offsetHeight;
		const startWidth = this.domPanel.offsetWidth;
		await animations.add(this.domPanel, [
			height(startHeight, 30),
			width(startWidth, this.targetWidth),
			opacity(1, 0, false)
		], { easing: ease.out });
	}
	onClose() {
		modal.remove(this);
		this.closeDefer.resolve();
	}
	shortcuts() {
		return this._shortcuts;
	}
	popState(e) {
		modal.remove(this);
		return false;
	}
	callingElement() {
		return this.focusedBeforeShown;
	}
};
/** try and execute stuff after the next rendering frame */
const deferToNextFrame = (fn) => {
	window.requestAnimationFrame(() => {
		window.requestAnimationFrame(fn);
	});
};

//#endregion
export { AttachmentBubble, AttachmentType, getAttachmentType };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXR0YWNobWVudEJ1YmJsZS1jaHVuay5qcyIsIm5hbWVzIjpbInZub2RlOiBWbm9kZTxBdHRhY2htZW50QnViYmxlQXR0cnM+Iiwidm5vZGU6IFZub2RlRE9NPEF0dGFjaG1lbnRCdWJibGVBdHRycz4iLCJkb206IEhUTUxFbGVtZW50IiwiYXR0cnM6IEF0dGFjaG1lbnRCdWJibGVBdHRycyIsInR5cGU6IEF0dGFjaG1lbnRUeXBlIiwibWltZVR5cGU6IHN0cmluZyIsInRhcmdldFJlY3Q6IFBvc1JlY3QiLCJ0YXJnZXRXaWR0aDogbnVtYmVyIiwiYWN0aW9uOiBUaHVuayB8IG51bGwiLCJlOiBNb3VzZUV2ZW50IiwiZTogRXZlbnQiLCJmbjogVGh1bmsiXSwic291cmNlcyI6WyIuLi9zcmMvY29tbW9uL2d1aS9BdHRhY2htZW50QnViYmxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtLCB7IENoaWxkcmVuLCBDb21wb25lbnQsIFZub2RlLCBWbm9kZURPTSB9IGZyb20gXCJtaXRocmlsXCJcbmltcG9ydCB7IEF0dGFjaG1lbnQgfSBmcm9tIFwiLi4vbWFpbEZ1bmN0aW9uYWxpdHkvU2VuZE1haWxNb2RlbC5qc1wiXG5pbXBvcnQgeyBCdXR0b24sIEJ1dHRvblR5cGUgfSBmcm9tIFwiLi9iYXNlL0J1dHRvbi5qc1wiXG5pbXBvcnQgeyBJY29ucyB9IGZyb20gXCIuL2Jhc2UvaWNvbnMvSWNvbnMuanNcIlxuaW1wb3J0IHsgZm9ybWF0U3RvcmFnZVNpemUgfSBmcm9tIFwiLi4vbWlzYy9Gb3JtYXR0ZXIuanNcIlxuaW1wb3J0IHsgZGVmZXIsIERlZmVycmVkT2JqZWN0LCBub09wLCBUaHVuayB9IGZyb20gXCJAdHV0YW8vdHV0YW5vdGEtdXRpbHNcIlxuaW1wb3J0IHsgbW9kYWwsIE1vZGFsQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS9Nb2RhbC5qc1wiXG5pbXBvcnQgeyBmb2N1c05leHQsIGZvY3VzUHJldmlvdXMsIFNob3J0Y3V0IH0gZnJvbSBcIi4uL21pc2MvS2V5TWFuYWdlci5qc1wiXG5pbXBvcnQgeyBQb3NSZWN0IH0gZnJvbSBcIi4vYmFzZS9Ecm9wZG93bi5qc1wiXG5pbXBvcnQgeyBLZXlzIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vVHV0YW5vdGFDb25zdGFudHMuanNcIlxuaW1wb3J0IHsgcHggfSBmcm9tIFwiLi9zaXplLmpzXCJcbmltcG9ydCB7IEFsbEljb25zLCBJY29uIH0gZnJvbSBcIi4vYmFzZS9JY29uLmpzXCJcbmltcG9ydCB7IHRoZW1lIH0gZnJvbSBcIi4vdGhlbWUuanNcIlxuaW1wb3J0IHsgYW5pbWF0aW9ucywgaGVpZ2h0LCBvcGFjaXR5LCB0cmFuc2Zvcm0sIFRyYW5zZm9ybUVudW0sIHdpZHRoIH0gZnJvbSBcIi4vYW5pbWF0aW9uL0FuaW1hdGlvbnMuanNcIlxuaW1wb3J0IHsgZWFzZSB9IGZyb20gXCIuL2FuaW1hdGlvbi9FYXNpbmcuanNcIlxuaW1wb3J0IHsgZ2V0RmlsZUJhc2VOYW1lLCBnZXRGaWxlRXh0ZW5zaW9uLCBpc1R1dGFub3RhRmlsZSB9IGZyb20gXCIuLi9hcGkvY29tbW9uL3V0aWxzL0ZpbGVVdGlscy5qc1wiXG5pbXBvcnQgeyBnZXRTYWZlQXJlYUluc2V0Qm90dG9tIH0gZnJvbSBcIi4vSHRtbFV0aWxzLmpzXCJcbmltcG9ydCB7IGhhc0Vycm9yIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vdXRpbHMvRXJyb3JVdGlscy5qc1wiXG5pbXBvcnQgeyBCdWJibGVCdXR0b24sIGJ1YmJsZUJ1dHRvbkhlaWdodCwgYnViYmxlQnV0dG9uUGFkZGluZyB9IGZyb20gXCIuL2Jhc2UvYnV0dG9ucy9CdWJibGVCdXR0b24uanNcIlxuaW1wb3J0IHsgQm9vdEljb25zIH0gZnJvbSBcIi4vYmFzZS9pY29ucy9Cb290SWNvbnMuanNcIlxuaW1wb3J0IHsgQ0FMRU5EQVJfTUlNRV9UWVBFLCBNQUlMX01JTUVfVFlQRVMsIFZDQVJEX01JTUVfVFlQRVMgfSBmcm9tIFwiLi4vZmlsZS9GaWxlQ29udHJvbGxlci5qc1wiXG5pbXBvcnQgeyBsYW5nIH0gZnJvbSBcIi4uL21pc2MvTGFuZ3VhZ2VWaWV3TW9kZWwuanNcIlxuXG5leHBvcnQgZW51bSBBdHRhY2htZW50VHlwZSB7XG5cdEdFTkVSSUMsXG5cdENPTlRBQ1QsXG5cdENBTEVOREFSLFxuXHRNQUlMLFxufVxuXG5leHBvcnQgdHlwZSBBdHRhY2htZW50QnViYmxlQXR0cnMgPSB7XG5cdGF0dGFjaG1lbnQ6IEF0dGFjaG1lbnRcblx0ZG93bmxvYWQ6IFRodW5rIHwgbnVsbFxuXHRvcGVuOiBUaHVuayB8IG51bGxcblx0cmVtb3ZlOiBUaHVuayB8IG51bGxcblx0ZmlsZUltcG9ydDogVGh1bmsgfCBudWxsXG5cdHR5cGU6IEF0dGFjaG1lbnRUeXBlXG59XG5cbmV4cG9ydCBjbGFzcyBBdHRhY2htZW50QnViYmxlIGltcGxlbWVudHMgQ29tcG9uZW50PEF0dGFjaG1lbnRCdWJibGVBdHRycz4ge1xuXHRwcml2YXRlIGRvbTogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbFxuXG5cdHZpZXcodm5vZGU6IFZub2RlPEF0dGFjaG1lbnRCdWJibGVBdHRycz4pOiBDaGlsZHJlbiB7XG5cdFx0Y29uc3QgeyBhdHRhY2htZW50IH0gPSB2bm9kZS5hdHRyc1xuXHRcdGlmIChpc1R1dGFub3RhRmlsZShhdHRhY2htZW50KSAmJiBoYXNFcnJvcihhdHRhY2htZW50KSkge1xuXHRcdFx0cmV0dXJuIG0oQnViYmxlQnV0dG9uLCB7XG5cdFx0XHRcdGxhYmVsOiBcImVtcHR5U3RyaW5nX21zZ1wiLFxuXHRcdFx0XHR0ZXh0OiBcImNvcnJ1cHRlZF9tc2dcIixcblx0XHRcdFx0aWNvbjogSWNvbnMuV2FybmluZyxcblx0XHRcdFx0b25jbGljazogbm9PcCxcblx0XHRcdH0pXG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IGV4dGVuc2lvbiA9IGdldEZpbGVFeHRlbnNpb24oYXR0YWNobWVudC5uYW1lKVxuXHRcdFx0Y29uc3QgcmVzdCA9IGdldEZpbGVCYXNlTmFtZShhdHRhY2htZW50Lm5hbWUpXG5cdFx0XHRyZXR1cm4gbShcblx0XHRcdFx0QnViYmxlQnV0dG9uLFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bGFiZWw6IGxhbmcubWFrZVRyYW5zbGF0aW9uKFwiYXR0YWNobWVudF9uYW1lXCIsIGF0dGFjaG1lbnQubmFtZSksXG5cdFx0XHRcdFx0dGV4dDogbGFuZy5tYWtlVHJhbnNsYXRpb24oXCJhdHRhY2htZW50X2Jhc2VfbmFtZVwiLCByZXN0KSxcblx0XHRcdFx0XHRpY29uOiBnZXRBdHRhY2htZW50SWNvbih2bm9kZS5hdHRycy50eXBlKSxcblx0XHRcdFx0XHRvbmNsaWNrOiAoKSA9PiB7XG5cdFx0XHRcdFx0XHRzaG93QXR0YWNobWVudERldGFpbHNQb3B1cCh0aGlzLmRvbSEsIHZub2RlLmF0dHJzKS50aGVuKCgpID0+IHRoaXMuZG9tPy5mb2N1cygpKVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGAke2V4dGVuc2lvbn0sICR7Zm9ybWF0U3RvcmFnZVNpemUoTnVtYmVyKGF0dGFjaG1lbnQuc2l6ZSkpfWAsXG5cdFx0XHQpXG5cdFx0fVxuXHR9XG5cblx0b25jcmVhdGUodm5vZGU6IFZub2RlRE9NPEF0dGFjaG1lbnRCdWJibGVBdHRycz4pOiB2b2lkIHtcblx0XHR0aGlzLmRvbSA9IHZub2RlLmRvbSBhcyBIVE1MRWxlbWVudFxuXHR9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNob3dBdHRhY2htZW50RGV0YWlsc1BvcHVwKGRvbTogSFRNTEVsZW1lbnQsIGF0dHJzOiBBdHRhY2htZW50QnViYmxlQXR0cnMpOiBQcm9taXNlPHZvaWQ+IHtcblx0Y29uc3QgcGFyZW50UmVjdCA9IGRvbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuXHRjb25zdCBwYW5lbCA9IG5ldyBBdHRhY2htZW50RGV0YWlsc1BvcHVwKHBhcmVudFJlY3QsIHBhcmVudFJlY3Qud2lkdGgsIGF0dHJzKVxuXHRwYW5lbC5zaG93KClcblx0cmV0dXJuIHBhbmVsLmRlZmVyQWZ0ZXJDbG9zZVxufVxuXG5mdW5jdGlvbiBnZXRBdHRhY2htZW50SWNvbih0eXBlOiBBdHRhY2htZW50VHlwZSk6IEFsbEljb25zIHtcblx0c3dpdGNoICh0eXBlKSB7XG5cdFx0Y2FzZSBBdHRhY2htZW50VHlwZS5DT05UQUNUOlxuXHRcdFx0cmV0dXJuIEljb25zLlBlb3BsZVxuXHRcdGNhc2UgQXR0YWNobWVudFR5cGUuQ0FMRU5EQVI6XG5cdFx0XHRyZXR1cm4gQm9vdEljb25zLkNhbGVuZGFyXG5cdFx0ZGVmYXVsdDpcblx0XHRcdHJldHVybiBJY29ucy5BdHRhY2htZW50XG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEF0dGFjaG1lbnRUeXBlKG1pbWVUeXBlOiBzdHJpbmcpIHtcblx0aWYgKE9iamVjdC52YWx1ZXM8c3RyaW5nPihWQ0FSRF9NSU1FX1RZUEVTKS5pbmNsdWRlcyhtaW1lVHlwZSkpIHtcblx0XHRyZXR1cm4gQXR0YWNobWVudFR5cGUuQ09OVEFDVFxuXHR9IGVsc2UgaWYgKG1pbWVUeXBlID09PSBDQUxFTkRBUl9NSU1FX1RZUEUpIHtcblx0XHRyZXR1cm4gQXR0YWNobWVudFR5cGUuQ0FMRU5EQVJcblx0fSBlbHNlIGlmIChPYmplY3QudmFsdWVzPHN0cmluZz4oTUFJTF9NSU1FX1RZUEVTKS5pbmNsdWRlcyhtaW1lVHlwZSkpIHtcblx0XHRyZXR1cm4gQXR0YWNobWVudFR5cGUuTUFJTFxuXHR9XG5cblx0cmV0dXJuIEF0dGFjaG1lbnRUeXBlLkdFTkVSSUNcbn1cblxuZXhwb3J0IGNsYXNzIEF0dGFjaG1lbnREZXRhaWxzUG9wdXAgaW1wbGVtZW50cyBNb2RhbENvbXBvbmVudCB7XG5cdHByaXZhdGUgcmVhZG9ubHkgX3Nob3J0Y3V0czogQXJyYXk8U2hvcnRjdXQ+ID0gW11cblx0cHJpdmF0ZSBkb21Db250ZW50OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsXG5cdHByaXZhdGUgZG9tUGFuZWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGxcblx0cHJpdmF0ZSBjbG9zZURlZmVyOiBEZWZlcnJlZE9iamVjdDx2b2lkPiA9IGRlZmVyKClcblx0cHJpdmF0ZSBmb2N1c2VkQmVmb3JlU2hvd246IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGxcblxuXHRnZXQgZGVmZXJBZnRlckNsb3NlKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdHJldHVybiB0aGlzLmNsb3NlRGVmZXIucHJvbWlzZVxuXHR9XG5cblx0Y29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSB0YXJnZXRSZWN0OiBQb3NSZWN0LCBwcml2YXRlIHJlYWRvbmx5IHRhcmdldFdpZHRoOiBudW1iZXIsIHByaXZhdGUgcmVhZG9ubHkgYXR0cnM6IEF0dGFjaG1lbnRCdWJibGVBdHRycykge1xuXHRcdHRoaXMuX3Nob3J0Y3V0cy5wdXNoKHtcblx0XHRcdGtleTogS2V5cy5FU0MsXG5cdFx0XHRleGVjOiAoKSA9PiB0aGlzLm9uQ2xvc2UoKSxcblx0XHRcdGhlbHA6IFwiY2xvc2VfYWx0XCIsXG5cdFx0fSlcblx0XHR0aGlzLl9zaG9ydGN1dHMucHVzaCh7XG5cdFx0XHRrZXk6IEtleXMuVEFCLFxuXHRcdFx0c2hpZnQ6IHRydWUsXG5cdFx0XHRleGVjOiAoKSA9PiAodGhpcy5kb21Db250ZW50ID8gZm9jdXNQcmV2aW91cyh0aGlzLmRvbUNvbnRlbnQpIDogZmFsc2UpLFxuXHRcdFx0aGVscDogXCJzZWxlY3RQcmV2aW91c19hY3Rpb25cIixcblx0XHR9KVxuXHRcdHRoaXMuX3Nob3J0Y3V0cy5wdXNoKHtcblx0XHRcdGtleTogS2V5cy5UQUIsXG5cdFx0XHRzaGlmdDogZmFsc2UsXG5cdFx0XHRleGVjOiAoKSA9PiAodGhpcy5kb21Db250ZW50ID8gZm9jdXNOZXh0KHRoaXMuZG9tQ29udGVudCkgOiBmYWxzZSksXG5cdFx0XHRoZWxwOiBcInNlbGVjdE5leHRfYWN0aW9uXCIsXG5cdFx0fSlcblx0XHRpZiAoYXR0cnMub3Blbikge1xuXHRcdFx0dGhpcy5fc2hvcnRjdXRzLnB1c2goe1xuXHRcdFx0XHRrZXk6IEtleXMuTyxcblx0XHRcdFx0ZXhlYzogKCkgPT4gdGhpcy50aGVuQ2xvc2UoYXR0cnMub3BlbiksXG5cdFx0XHRcdGhlbHA6IFwib3Blbl9hY3Rpb25cIixcblx0XHRcdH0pXG5cdFx0fVxuXHRcdGlmIChhdHRycy5kb3dubG9hZCkge1xuXHRcdFx0dGhpcy5fc2hvcnRjdXRzLnB1c2goe1xuXHRcdFx0XHRrZXk6IEtleXMuRCxcblx0XHRcdFx0ZXhlYzogKCkgPT4gdGhpcy50aGVuQ2xvc2UoYXR0cnMuZG93bmxvYWQpLFxuXHRcdFx0XHRoZWxwOiBcImRvd25sb2FkX2FjdGlvblwiLFxuXHRcdFx0fSlcblx0XHR9XG5cdFx0aWYgKGF0dHJzLnJlbW92ZSkge1xuXHRcdFx0dGhpcy5fc2hvcnRjdXRzLnB1c2goe1xuXHRcdFx0XHRrZXk6IEtleXMuREVMRVRFLFxuXHRcdFx0XHRleGVjOiAoKSA9PiB0aGlzLnRoZW5DbG9zZShhdHRycy5yZW1vdmUpLFxuXHRcdFx0XHRoZWxwOiBcInJlbW92ZV9hY3Rpb25cIixcblx0XHRcdH0pXG5cdFx0fVxuXHRcdGlmIChhdHRycy5maWxlSW1wb3J0KSB7XG5cdFx0XHR0aGlzLl9zaG9ydGN1dHMucHVzaCh7XG5cdFx0XHRcdGtleTogS2V5cy5JLFxuXHRcdFx0XHRleGVjOiAoKSA9PiB0aGlzLnRoZW5DbG9zZShhdHRycy5maWxlSW1wb3J0KSxcblx0XHRcdFx0aGVscDogXCJpbXBvcnRfYWN0aW9uXCIsXG5cdFx0XHR9KVxuXHRcdH1cblx0XHR0aGlzLnZpZXcgPSB0aGlzLnZpZXcuYmluZCh0aGlzKVxuXHR9XG5cblx0dmlldygpOiBDaGlsZHJlbiB7XG5cdFx0cmV0dXJuIG0oXG5cdFx0XHRcIi5hYnMuYnViYmxlLWNvbG9yLmJvcmRlci1yYWRpdXMub3ZlcmZsb3ctaGlkZGVuLmZsZXguZmxleC1jb2x1bW5cIixcblx0XHRcdHtcblx0XHRcdFx0Y2xhc3M6IGJ1YmJsZUJ1dHRvblBhZGRpbmcoKSxcblx0XHRcdFx0c3R5bGU6IHtcblx0XHRcdFx0XHR3aWR0aDogcHgodGhpcy50YXJnZXRXaWR0aCksXG5cdFx0XHRcdFx0Ly8gc2VlIGhhY2sgZGVzY3JpcHRpb24gYmVsb3cuIGlmICM1NTg3IHBlcnNpc3RzLCB3ZSBtaWdodCB0cnkgdmlzaWJpbGl0eTogaGlkZGVuIGluc3RlYWQ/XG5cdFx0XHRcdFx0b3BhY2l0eTogXCIwXCIsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdG9uY3JlYXRlOiAodm5vZGUpID0+IHtcblx0XHRcdFx0XHR0aGlzLmRvbVBhbmVsID0gdm5vZGUuZG9tIGFzIEhUTUxFbGVtZW50XG5cdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIGhhY2sgdG8gZ2V0IFwibmF0dXJhbFwiIHZpZXcgc2l6ZSBidXQgcmVuZGVyIGl0IGludmlzaWJseSBmaXJzdCBhbmQgdGhlbiBzaG93IHRoZSBwYW5lbCB3aXRoIGluZmVycmVkIHNpemUuXG5cdFx0XHRcdFx0Ly8gYWxzbyBmb2N1cyB0aGUgZmlyc3QgdGFiYmFibGUgZWxlbWVudCBpbiB0aGUgY29udGVudCBhZnRlciB0aGUgcGFuZWwgb3BlbnMuXG5cdFx0XHRcdFx0ZGVmZXJUb05leHRGcmFtZSgoKSA9PiB0aGlzLmFuaW1hdGVQYW5lbCgpLnRoZW4oKCkgPT4gdGhpcy5kb21Db250ZW50ICYmIGZvY3VzTmV4dCh0aGlzLmRvbUNvbnRlbnQpKSlcblx0XHRcdFx0fSxcblx0XHRcdFx0b25jbGljazogKCkgPT4gdGhpcy5vbkNsb3NlKCksXG5cdFx0XHR9LFxuXHRcdFx0dGhpcy5yZW5kZXJDb250ZW50KCksXG5cdFx0KVxuXHR9XG5cblx0cHJpdmF0ZSByZW5kZXJDb250ZW50KCk6IENoaWxkcmVuIHtcblx0XHQvLyBXZSBhcmUgdHJ5aW5nIHRvIG1ha2Ugc29tZSBjb250ZW50cyBsb29rIGxpa2UgdGhlIGF0dGFjaG1lbnQgYnV0dG9uIHRvIG1ha2UgdGhlIHRyYW5zaXRpb24gbG9vayBzbW9vdGguXG5cdFx0Ly8gSXQgaXMgc29tZXdoYXQgaGFyZGVyIGFzIGl0IGxvb2tzIGRpZmZlcmVudCB3aXRoIG1vYmlsZSBsYXlvdXQuXG5cdFx0Y29uc3QgeyByZW1vdmUsIG9wZW4sIGRvd25sb2FkLCBhdHRhY2htZW50LCBmaWxlSW1wb3J0LCB0eXBlIH0gPSB0aGlzLmF0dHJzXG5cdFx0cmV0dXJuIG0oXG5cdFx0XHRcIi5mbGV4Lm1iLXMucHJcIixcblx0XHRcdHtcblx0XHRcdFx0b25jcmVhdGU6ICh2bm9kZSkgPT4gKHRoaXMuZG9tQ29udGVudCA9IHZub2RlLmRvbSBhcyBIVE1MRWxlbWVudCksXG5cdFx0XHR9LFxuXHRcdFx0W1xuXHRcdFx0XHRtKEljb24sIHtcblx0XHRcdFx0XHRpY29uOiBnZXRBdHRhY2htZW50SWNvbih0eXBlKSxcblx0XHRcdFx0XHRjbGFzczogXCJwci1zIGZsZXggaXRlbXMtY2VudGVyXCIsXG5cdFx0XHRcdFx0c3R5bGU6IHtcblx0XHRcdFx0XHRcdGZpbGw6IHRoZW1lLmJ1dHRvbl9idWJibGVfZmcsXG5cdFx0XHRcdFx0XHRcImJhY2tncm91bmQtY29sb3JcIjogXCJpbml0aWFsXCIsXG5cdFx0XHRcdFx0XHRtaW5IZWlnaHQ6IHB4KGJ1YmJsZUJ1dHRvbkhlaWdodCgpKSxcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHR9KSxcblx0XHRcdFx0Ly8gIGZsZXgtZ3JvdyB0byBjb3ZlciB0aGUgYnViYmxlIGluIGNhc2UgaXQncyBiaWdnZXIgdGhhbiBvdXIgY29udGVudFxuXHRcdFx0XHRtKFxuXHRcdFx0XHRcdFwiLmZsZXguY29sLmZsZXgtZ3Jvd1wiLFxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdHN0eWxlOiB7XG5cdFx0XHRcdFx0XHRcdG1pbkhlaWdodDogcHgoYnViYmxlQnV0dG9uSGVpZ2h0KCkpLFxuXHRcdFx0XHRcdFx0XHQvLyBzZXQgbGluZS1oZWlnaHQgdG8gcG9zaXRpb24gdGhlIHRleHQgbGlrZSBpbiB0aGUgYnV0dG9uXG5cdFx0XHRcdFx0XHRcdGxpbmVIZWlnaHQ6IHB4KGJ1YmJsZUJ1dHRvbkhlaWdodCgpKSxcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRtKFwiLnNwYW4uYnJlYWstYWxsLnNtYWxsZXJcIiwgYXR0YWNobWVudC5uYW1lKSxcblx0XHRcdFx0XHQvLyBib3R0b20gaW5mbyBpcyBpbnNpZGUgdGhlIHNhbWUgY29sdW1uIGFzIGZpbGUgdGV4dCB0byBhbGlnbiB0aGVtXG5cdFx0XHRcdFx0bShcIi5mbGV4LnJvdy5qdXN0aWZ5LWJldHdlZW4uaXRlbXMtY2VudGVyXCIsIFtcblx0XHRcdFx0XHRcdG0oXCJzcGFuLnNtYWxsZXJcIiwgYCR7Zm9ybWF0U3RvcmFnZVNpemUoTnVtYmVyKGF0dGFjaG1lbnQuc2l6ZSkpfWApLFxuXHRcdFx0XHRcdFx0bShcIi5mbGV4Lm5vLXdyYXBcIiwgW1xuXHRcdFx0XHRcdFx0XHRyZW1vdmUgPyBtKEJ1dHRvbiwgeyB0eXBlOiBCdXR0b25UeXBlLlNlY29uZGFyeSwgbGFiZWw6IFwicmVtb3ZlX2FjdGlvblwiLCBjbGljazogKCkgPT4gdGhpcy50aGVuQ2xvc2UocmVtb3ZlKSB9KSA6IG51bGwsXG5cdFx0XHRcdFx0XHRcdGZpbGVJbXBvcnRcblx0XHRcdFx0XHRcdFx0XHQ/IG0oQnV0dG9uLCB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6IEJ1dHRvblR5cGUuU2Vjb25kYXJ5LFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRsYWJlbDogXCJpbXBvcnRfYWN0aW9uXCIsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNsaWNrOiAoKSA9PiB0aGlzLnRoZW5DbG9zZShmaWxlSW1wb3J0KSxcblx0XHRcdFx0XHRcdFx0XHQgIH0pXG5cdFx0XHRcdFx0XHRcdFx0OiBudWxsLFxuXHRcdFx0XHRcdFx0XHRvcGVuID8gbShCdXR0b24sIHsgdHlwZTogQnV0dG9uVHlwZS5TZWNvbmRhcnksIGxhYmVsOiBcIm9wZW5fYWN0aW9uXCIsIGNsaWNrOiAoKSA9PiB0aGlzLnRoZW5DbG9zZShvcGVuKSB9KSA6IG51bGwsXG5cdFx0XHRcdFx0XHRcdGRvd25sb2FkID8gbShCdXR0b24sIHsgdHlwZTogQnV0dG9uVHlwZS5TZWNvbmRhcnksIGxhYmVsOiBcImRvd25sb2FkX2FjdGlvblwiLCBjbGljazogKCkgPT4gdGhpcy50aGVuQ2xvc2UoZG93bmxvYWQpIH0pIDogbnVsbCxcblx0XHRcdFx0XHRcdF0pLFxuXHRcdFx0XHRcdF0pLFxuXHRcdFx0XHQpLFxuXHRcdFx0XSxcblx0XHQpXG5cdH1cblxuXHRwcml2YXRlIHRoZW5DbG9zZShhY3Rpb246IFRodW5rIHwgbnVsbCk6IHZvaWQge1xuXHRcdGFjdGlvbj8uKClcblx0XHR0aGlzLm9uQ2xvc2UoKVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBhbmltYXRlUGFuZWwoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgeyB0YXJnZXRSZWN0LCBkb21QYW5lbCwgZG9tQ29udGVudCB9ID0gdGhpc1xuXHRcdGlmIChkb21QYW5lbCA9PSBudWxsIHx8IGRvbUNvbnRlbnQgPT0gbnVsbCkgcmV0dXJuXG5cdFx0Y29uc3QgaW5pdGlhbEhlaWdodCA9IGJ1YmJsZUJ1dHRvbkhlaWdodCgpXG5cdFx0Ly8gdGhlcmUgaXMgYSBwb3NzaWJpbGl0eSB0aGF0IHdlIGdldCAwIGhlcmUgaW4gc29tZSBjaXJjdW1zdGFuY2VzLCBidXQgaXQncyB1bmNsZWFyIHdoZW4uXG5cdFx0Ly8gbWlnaHQgaGF2ZSBzb21ldGhpbmcgdG8gZG8gd2l0aCB0aGUgb3BhY2l0eTogMCBoYWNrIGFib3ZlIG9yIGJlY2F1c2UgdGhlIG9yaWdpbmFsIDI0bXNcblx0XHQvLyBkZWxheSB3YXMgbm90IGVub3VnaC4gaHR0cHM6Ly9naXRodWIuY29tL3R1dGFvL3R1dGFub3RhL2lzc3Vlcy81NTg3XG5cdFx0Ly8gODUgaXMgYSB2YWx1ZSB0aGF0IGZpdHMgZm9yIGEgc2luZ2xlIGxpbmUgb2YgYXR0YWNobWVudCBuYW1lLCBidXQgbG9va3Mgd2VpcmQgZm9yIG1vcmUgd2hpbGVcblx0XHQvLyBrZWVwaW5nIHRoZSBidXR0b25zIGFjY2Vzc2libGUuXG5cdFx0Ly8gaWYgdGhlIHJlcG9ydHMgY29udGludWUsIHdlIGNhbiBhc2sgZm9yIGxvZ3MuXG5cdFx0Y29uc3QgdGFyZ2V0SGVpZ2h0ID0gZG9tQ29udGVudC5vZmZzZXRIZWlnaHQgPT09IDAgPyA4NSA6IGRvbUNvbnRlbnQub2Zmc2V0SGVpZ2h0XG5cdFx0aWYgKGRvbUNvbnRlbnQub2Zmc2V0SGVpZ2h0ID09PSAwKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0XCJnb3Qgb2Zmc2V0SGVpZ2h0IDAsIHBhbmVsIGNvbnRhaW5zIGNvbnRlbnQ6XCIsXG5cdFx0XHRcdGRvbVBhbmVsLmNvbnRhaW5zKGRvbUNvbnRlbnQpLFxuXHRcdFx0XHRcImNvbnRlbnQgc3R5bGU6XCIsXG5cdFx0XHRcdGRvbUNvbnRlbnQuc3R5bGUsXG5cdFx0XHRcdFwicGFuZWwgc3R5bGU6XCIsXG5cdFx0XHRcdGRvbVBhbmVsLnN0eWxlLFxuXHRcdFx0KVxuXHRcdH1cblx0XHQvLyBmb3IgdmVyeSBzaG9ydCBhdHRhY2htZW50IGJ1YmJsZXMsIHdlIG5lZWQgdG8gc2V0IGEgbWluIHdpZHRoIHNvIHRoZSBidXR0b25zIGZpdC5cblx0XHRjb25zdCB0YXJnZXRXaWR0aCA9IE1hdGgubWF4KHRhcmdldFJlY3Qud2lkdGgsIDMwMClcblx0XHRkb21QYW5lbC5zdHlsZS53aWR0aCA9IHB4KHRhcmdldFJlY3Qud2lkdGgpXG5cdFx0ZG9tUGFuZWwuc3R5bGUuaGVpZ2h0ID0gcHgoaW5pdGlhbEhlaWdodClcblx0XHQvLyBhZGQgaGFsZiB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIC5idXR0b24gaGVpZ2h0IG9mIDQ0cHggYW5kIDMwcHggZm9yIHBpeGVsLXBlcmZlY3QgcG9zaXRpb25pbmdcblx0XHRkb21QYW5lbC5zdHlsZS50b3AgPSBweCh0YXJnZXRSZWN0LnRvcClcblxuXHRcdC8vVmVyaWZ5IGlmIHRoZSBhdHRhY2htZW50IGJ1YmJsZSBpcyBnb2luZyB0byBvdmVyZmxvdyB0aGUgc2NyZWVuXG5cdFx0Ly9pZiB5ZXMsIGludmVydCB0aGUgc2lkZSBvZiB0aGUgbWFyZ2luIGFuZCBkaXNjb3VudCB0aGUgYnViYmxlIHdpZHRoXG5cdFx0aWYgKHRhcmdldFJlY3QubGVmdCArIHRhcmdldFdpZHRoID4gd2luZG93LmlubmVyV2lkdGgpIHtcblx0XHRcdGRvbVBhbmVsLnN0eWxlLnJpZ2h0ID0gcHgoMjQpXG5cdFx0fSBlbHNlIHtcblx0XHRcdGRvbVBhbmVsLnN0eWxlLmxlZnQgPSBweCh0YXJnZXRSZWN0LmxlZnQpXG5cdFx0fVxuXG5cdFx0Y29uc3QgbXV0YXRpb25zID0gW29wYWNpdHkoMCwgMSwgdHJ1ZSksIGhlaWdodChpbml0aWFsSGVpZ2h0LCB0YXJnZXRIZWlnaHQpXVxuXHRcdGlmICh0YXJnZXRSZWN0LndpZHRoICE9PSB0YXJnZXRXaWR0aCkge1xuXHRcdFx0bXV0YXRpb25zLnB1c2god2lkdGgodGFyZ2V0UmVjdC53aWR0aCwgdGFyZ2V0V2lkdGgpKVxuXHRcdH1cblx0XHQvLyBzcGFjZSBiZWxvdyB0aGUgcGFuZWwgYWZ0ZXIgaXQgZnVsbHkgZXh0ZW5kcyBtaW51cyBhIGJpdC5cblx0XHRjb25zdCBzcGFjZUJlbG93ID0gd2luZG93LmlubmVySGVpZ2h0IC0gZ2V0U2FmZUFyZWFJbnNldEJvdHRvbSgpIC0gdGFyZ2V0UmVjdC50b3AgLSB0YXJnZXRIZWlnaHQgLSBpbml0aWFsSGVpZ2h0XG5cdFx0aWYgKHNwYWNlQmVsb3cgPCAwKSB7XG5cdFx0XHRtdXRhdGlvbnMucHVzaCh0cmFuc2Zvcm0oVHJhbnNmb3JtRW51bS5UcmFuc2xhdGVZLCAwLCBzcGFjZUJlbG93KSlcblx0XHR9XG5cblx0XHRhd2FpdCBhbmltYXRpb25zLmFkZChkb21QYW5lbCwgbXV0YXRpb25zLCB7XG5cdFx0XHRlYXNpbmc6IGVhc2Uub3V0LFxuXHRcdH0pXG5cdH1cblxuXHRzaG93KCkge1xuXHRcdHRoaXMuZm9jdXNlZEJlZm9yZVNob3duID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBhcyBIVE1MRWxlbWVudFxuXHRcdG1vZGFsLmRpc3BsYXlVbmlxdWUodGhpcywgdHJ1ZSlcblx0fVxuXG5cdGJhY2tncm91bmRDbGljayhlOiBNb3VzZUV2ZW50KTogdm9pZCB7XG5cdFx0bW9kYWwucmVtb3ZlKHRoaXMpXG5cdH1cblxuXHRhc3luYyBoaWRlQW5pbWF0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICh0aGlzLmRvbVBhbmVsID09IG51bGwpIHJldHVyblxuXHRcdGNvbnN0IHN0YXJ0SGVpZ2h0ID0gdGhpcy5kb21QYW5lbC5vZmZzZXRIZWlnaHRcblx0XHRjb25zdCBzdGFydFdpZHRoID0gdGhpcy5kb21QYW5lbC5vZmZzZXRXaWR0aFxuXHRcdGF3YWl0IGFuaW1hdGlvbnMuYWRkKHRoaXMuZG9tUGFuZWwsIFtoZWlnaHQoc3RhcnRIZWlnaHQsIDMwKSwgd2lkdGgoc3RhcnRXaWR0aCwgdGhpcy50YXJnZXRXaWR0aCksIG9wYWNpdHkoMSwgMCwgZmFsc2UpXSwge1xuXHRcdFx0ZWFzaW5nOiBlYXNlLm91dCxcblx0XHR9KVxuXHR9XG5cblx0b25DbG9zZSgpOiB2b2lkIHtcblx0XHRtb2RhbC5yZW1vdmUodGhpcylcblx0XHR0aGlzLmNsb3NlRGVmZXIucmVzb2x2ZSgpXG5cdH1cblxuXHRzaG9ydGN1dHMoKTogU2hvcnRjdXRbXSB7XG5cdFx0cmV0dXJuIHRoaXMuX3Nob3J0Y3V0c1xuXHR9XG5cblx0cG9wU3RhdGUoZTogRXZlbnQpOiBib29sZWFuIHtcblx0XHRtb2RhbC5yZW1vdmUodGhpcylcblx0XHRyZXR1cm4gZmFsc2Vcblx0fVxuXG5cdGNhbGxpbmdFbGVtZW50KCk6IEhUTUxFbGVtZW50IHwgbnVsbCB7XG5cdFx0cmV0dXJuIHRoaXMuZm9jdXNlZEJlZm9yZVNob3duXG5cdH1cbn1cblxuLyoqIHRyeSBhbmQgZXhlY3V0ZSBzdHVmZiBhZnRlciB0aGUgbmV4dCByZW5kZXJpbmcgZnJhbWUgKi9cbmNvbnN0IGRlZmVyVG9OZXh0RnJhbWUgPSAoZm46IFRodW5rKSA9PiB7XG5cdHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuXHRc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