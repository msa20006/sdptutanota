import { assertMainOrNode, isDesktop, isOfflineStorageAvailable } from "./Env-chunk.js";
import { assertNotNull, noOp } from "./dist2-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import { windowFacade } from "./WindowFacade-chunk.js";
import { UserTypeRef } from "./TypeRefs2-chunk.js";
import { OfflineDbClosedError, isOfflineError } from "./ErrorUtils-chunk.js";
import { AccessBlockedError, AccessDeactivatedError, AccessExpiredError, ConnectionError, InsufficientStorageError, InvalidSoftwareVersionError, NotAuthenticatedError, RequestTimeoutError, ServiceUnavailableError, SessionExpiredError } from "./RestError-chunk.js";
import { OutOfSyncError } from "./OutOfSyncError-chunk.js";
import { CancelledError } from "./CancelledError-chunk.js";
import { IndexingNotSupportedError, QuotaExceededError } from "./QuotaExceededError-chunk.js";
import { SessionType } from "./SessionType-chunk.js";
import { Dialog } from "./Dialog-chunk.js";
import { locator } from "./CommonLocator-chunk.js";
import { UserError } from "./UserError-chunk.js";
import { showProgressDialog } from "./ProgressDialog-chunk.js";
import { showMoreStorageNeededOrderDialog } from "./SubscriptionDialogs-chunk.js";
import { showSnackBar } from "./SnackBar-chunk.js";
import { credentialsToUnencrypted } from "./Credentials-chunk.js";
import { showErrorDialogNotLoggedIn, showErrorNotification } from "./ErrorReporter-chunk.js";
import { showRequestPasswordDialog } from "./PasswordRequestDialog-chunk.js";

//#region src/common/misc/ErrorHandlerImpl.ts
assertMainOrNode();
let unknownErrorDialogActive = false;
let notConnectedDialogActive = false;
let invalidSoftwareVersionActive = false;
let loginDialogActive = false;
let isLoggingOut = false;
let serviceUnavailableDialogActive = false;
let requestTimeoutDialogActive = false;
let shownQuotaError = false;
const ignoredMessages = [
	"webkitExitFullScreen",
	"googletag",
	"avast_submit"
];
async function handleUncaughtErrorImpl(e) {
	const { logins, interWindowEventSender, worker, search } = locator;
	if (isLoggingOut) return;
	if (e instanceof UserError) return showUserError(e);
	if (isOfflineError(e)) showOfflineMessage();
else if (e instanceof InvalidSoftwareVersionError) {
		if (!invalidSoftwareVersionActive) {
			invalidSoftwareVersionActive = true;
			Dialog.message("outdatedClient_msg").then(() => invalidSoftwareVersionActive = false);
		}
	} else if (e instanceof NotAuthenticatedError || e instanceof AccessBlockedError || e instanceof AccessDeactivatedError || e instanceof AccessExpiredError) {
		if (logins.isUserLoggedIn()) logoutIfNoPasswordPrompt();
	} else if (e instanceof SessionExpiredError) reloginForExpiredSession();
else if (e instanceof OutOfSyncError) {
		const isOffline = isOfflineStorageAvailable() && logins.isUserLoggedIn() && logins.getUserController().sessionType === SessionType.Persistent;
		await Dialog.message("outOfSync_label", lang.get(isOffline ? "dataExpiredOfflineDb_msg" : "dataExpired_msg"));
		const { userId } = logins.getUserController();
		if (isDesktop()) {
			await interWindowEventSender?.localUserDataInvalidated(userId);
			await worker.getWorkerInterface().sqlCipherFacade.deleteDb(userId);
		}
		await logins.logout(false);
		await windowFacade.reload({ noAutoLogin: true });
	} else if (e instanceof InsufficientStorageError) if (logins.getUserController().isGlobalAdmin()) showMoreStorageNeededOrderDialog("insufficientStorageAdmin_msg");
else {
		const errorMessage = lang.makeTranslation("insufficientStorageUser_msg", lang.get("insufficientStorageUser_msg") + " " + lang.get("contactAdmin_msg"));
		Dialog.message(errorMessage);
	}
else if (e instanceof ServiceUnavailableError) {
		if (!serviceUnavailableDialogActive) {
			serviceUnavailableDialogActive = true;
			Dialog.message("serviceUnavailable_msg").then(() => {
				serviceUnavailableDialogActive = false;
			});
		}
	} else if (e instanceof RequestTimeoutError) {
		if (!requestTimeoutDialogActive) {
			requestTimeoutDialogActive = true;
			Dialog.message("requestTimeout_msg").then(() => {
				requestTimeoutDialogActive = false;
			});
		}
	} else if (e instanceof IndexingNotSupportedError) {
		console.log("Indexing not supported", e);
		if ("indexingSupported" in search) search.indexingSupported = false;
	} else if (e instanceof QuotaExceededError) {
		if (!shownQuotaError) {
			shownQuotaError = true;
			Dialog.message("storageQuotaExceeded_msg");
		}
	} else if (e instanceof OfflineDbClosedError) {
		if (!loginDialogActive) throw e;
	} else if (ignoredError(e)) {} else if (!unknownErrorDialogActive) {
		unknownErrorDialogActive = true;
		if (logins.isUserLoggedIn()) {
			const { ignored } = await showErrorNotification(e);
			unknownErrorDialogActive = false;
			if (ignored) ignoredMessages.push(e.message);
		} else {
			console.log("Unknown error", e);
			showErrorDialogNotLoggedIn(e).then(() => unknownErrorDialogActive = false);
		}
	}
}
function showOfflineMessage() {
	if (!notConnectedDialogActive) {
		notConnectedDialogActive = true;
		showSnackBar({
			message: "serverNotReachable_msg",
			button: {
				label: "ok_action",
				click: () => {}
			},
			onClose: () => {
				notConnectedDialogActive = false;
			}
		});
	}
}
function logoutIfNoPasswordPrompt() {
	if (!loginDialogActive) windowFacade.reload({});
}
async function reloginForExpiredSession() {
	if (loginDialogActive) return;
	const { logins, loginFacade, secondFactorHandler, credentialsProvider, cacheStorage } = locator;
	await logins.waitForPartialLogin();
	console.log("RELOGIN", logins.isUserLoggedIn());
	const oldSessionType = logins.getUserController().sessionType;
	const userId = logins.getUserController().user._id;
	const mailAddress = assertNotNull(logins.getUserController().userGroupInfo.mailAddress, "could not get mailAddress from userGroupInfo");
	const oldCredentials = await credentialsProvider.getDecryptedCredentialsByUserId(userId);
	await cacheStorage?.deleteIfExists(UserTypeRef, null, userId);
	const sessionReset = loginFacade.resetSession();
	loginDialogActive = true;
	const dialog = showRequestPasswordDialog({
		action: async (pw) => {
			await sessionReset;
			let credentials;
			let databaseKey;
			try {
				const newSessionData = await logins.createSession(mailAddress, pw, oldSessionType, oldCredentials?.databaseKey);
				credentials = newSessionData.credentials;
				databaseKey = newSessionData.databaseKey;
			} catch (e) {
				if (e instanceof CancelledError || e instanceof AccessBlockedError || e instanceof NotAuthenticatedError || e instanceof AccessDeactivatedError || e instanceof ConnectionError) {
					const { getLoginErrorMessage } = await import("./LoginUtils2-chunk.js");
					return lang.getTranslationText(getLoginErrorMessage(e, false));
				} else throw e;
			} finally {
				secondFactorHandler.closeWaitingForSecondFactorDialog();
			}
			await credentialsProvider.deleteByUserId(userId, { deleteOfflineDb: false });
			if (oldSessionType === SessionType.Persistent) await credentialsProvider.store(credentialsToUnencrypted(credentials, databaseKey));
			loginDialogActive = false;
			dialog.close();
			return "";
		},
		cancel: {
			textId: "logout_label",
			action() {
				windowFacade.reload({});
			}
		}
	});
}
function ignoredError(e) {
	return e.message != null && ignoredMessages.some((s) => e.message.includes(s));
}
function disableErrorHandlingDuringLogout() {
	isLoggingOut = true;
	showProgressDialog("loggingOut_msg", new Promise(noOp));
}
if (typeof window !== "undefined") window.tutao.testError = () => handleUncaughtErrorImpl(new Error("test error!"));
function showUserError(error) {
	return Dialog.message(lang.makeTranslation("error_msg", error.message));
}

//#endregion
export { disableErrorHandlingDuringLogout as disableErrorHandlingDuringLogout$1, handleUncaughtErrorImpl, reloginForExpiredSession, showUserError };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXJyb3JIYW5kbGVySW1wbC1jaHVuay5qcyIsIm5hbWVzIjpbImU6IEVycm9yIiwiY3JlZGVudGlhbHM6IENyZWRlbnRpYWxzIiwiZGF0YWJhc2VLZXk6IFVpbnQ4QXJyYXkgfCBudWxsIiwiZXJyb3I6IFVzZXJFcnJvciJdLCJzb3VyY2VzIjpbIi4uL3NyYy9jb21tb24vbWlzYy9FcnJvckhhbmRsZXJJbXBsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG5cdEFjY2Vzc0Jsb2NrZWRFcnJvcixcblx0QWNjZXNzRGVhY3RpdmF0ZWRFcnJvcixcblx0QWNjZXNzRXhwaXJlZEVycm9yLFxuXHRDb25uZWN0aW9uRXJyb3IsXG5cdEluc3VmZmljaWVudFN0b3JhZ2VFcnJvcixcblx0SW52YWxpZFNvZnR3YXJlVmVyc2lvbkVycm9yLFxuXHROb3RBdXRoZW50aWNhdGVkRXJyb3IsXG5cdFJlcXVlc3RUaW1lb3V0RXJyb3IsXG5cdFNlcnZpY2VVbmF2YWlsYWJsZUVycm9yLFxuXHRTZXNzaW9uRXhwaXJlZEVycm9yLFxufSBmcm9tIFwiLi4vYXBpL2NvbW1vbi9lcnJvci9SZXN0RXJyb3JcIlxuaW1wb3J0IHsgRGlhbG9nIH0gZnJvbSBcIi4uL2d1aS9iYXNlL0RpYWxvZ1wiXG5pbXBvcnQgeyBsYW5nIH0gZnJvbSBcIi4vTGFuZ3VhZ2VWaWV3TW9kZWxcIlxuaW1wb3J0IHsgYXNzZXJ0TWFpbk9yTm9kZSwgaXNEZXNrdG9wLCBpc09mZmxpbmVTdG9yYWdlQXZhaWxhYmxlIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vRW52XCJcbmltcG9ydCB7IGFzc2VydE5vdE51bGwsIG5vT3AgfSBmcm9tIFwiQHR1dGFvL3R1dGFub3RhLXV0aWxzXCJcbmltcG9ydCB7IE91dE9mU3luY0Vycm9yIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vZXJyb3IvT3V0T2ZTeW5jRXJyb3JcIlxuaW1wb3J0IHsgc2hvd1Byb2dyZXNzRGlhbG9nIH0gZnJvbSBcIi4uL2d1aS9kaWFsb2dzL1Byb2dyZXNzRGlhbG9nXCJcbmltcG9ydCB7IEluZGV4aW5nTm90U3VwcG9ydGVkRXJyb3IgfSBmcm9tIFwiLi4vYXBpL2NvbW1vbi9lcnJvci9JbmRleGluZ05vdFN1cHBvcnRlZEVycm9yXCJcbmltcG9ydCB7IHdpbmRvd0ZhY2FkZSB9IGZyb20gXCIuL1dpbmRvd0ZhY2FkZVwiXG5pbXBvcnQgeyBsb2NhdG9yIH0gZnJvbSBcIi4uL2FwaS9tYWluL0NvbW1vbkxvY2F0b3JcIlxuaW1wb3J0IHsgUXVvdGFFeGNlZWRlZEVycm9yIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vZXJyb3IvUXVvdGFFeGNlZWRlZEVycm9yXCJcbmltcG9ydCB7IFVzZXJFcnJvciB9IGZyb20gXCIuLi9hcGkvbWFpbi9Vc2VyRXJyb3JcIlxuaW1wb3J0IHsgc2hvd01vcmVTdG9yYWdlTmVlZGVkT3JkZXJEaWFsb2cgfSBmcm9tIFwiLi9TdWJzY3JpcHRpb25EaWFsb2dzXCJcbmltcG9ydCB7IHNob3dTbmFja0JhciB9IGZyb20gXCIuLi9ndWkvYmFzZS9TbmFja0JhclwiXG5pbXBvcnQgeyBDcmVkZW50aWFscywgY3JlZGVudGlhbHNUb1VuZW5jcnlwdGVkIH0gZnJvbSBcIi4vY3JlZGVudGlhbHMvQ3JlZGVudGlhbHNcIlxuaW1wb3J0IHsgc2hvd0Vycm9yRGlhbG9nTm90TG9nZ2VkSW4sIHNob3dFcnJvck5vdGlmaWNhdGlvbiB9IGZyb20gXCIuL0Vycm9yUmVwb3J0ZXJcIlxuaW1wb3J0IHsgQ2FuY2VsbGVkRXJyb3IgfSBmcm9tIFwiLi4vYXBpL2NvbW1vbi9lcnJvci9DYW5jZWxsZWRFcnJvclwiXG5cbmltcG9ydCB7IFNlc3Npb25UeXBlIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vU2Vzc2lvblR5cGUuanNcIlxuaW1wb3J0IHsgT2ZmbGluZURiQ2xvc2VkRXJyb3IgfSBmcm9tIFwiLi4vYXBpL2NvbW1vbi9lcnJvci9PZmZsaW5lRGJDbG9zZWRFcnJvci5qc1wiXG5pbXBvcnQgeyBVc2VyVHlwZVJlZiB9IGZyb20gXCIuLi9hcGkvZW50aXRpZXMvc3lzL1R5cGVSZWZzLmpzXCJcbmltcG9ydCB7IGlzT2ZmbGluZUVycm9yIH0gZnJvbSBcIi4uL2FwaS9jb21tb24vdXRpbHMvRXJyb3JVdGlscy5qc1wiXG5pbXBvcnQgeyBzaG93UmVxdWVzdFBhc3N3b3JkRGlhbG9nIH0gZnJvbSBcIi4vcGFzc3dvcmRzL1Bhc3N3b3JkUmVxdWVzdERpYWxvZy5qc1wiXG5cbmFzc2VydE1haW5Pck5vZGUoKVxuXG5sZXQgdW5rbm93bkVycm9yRGlhbG9nQWN0aXZlID0gZmFsc2VcbmxldCBub3RDb25uZWN0ZWREaWFsb2dBY3RpdmUgPSBmYWxzZVxubGV0IGludmFsaWRTb2Z0d2FyZVZlcnNpb25BY3RpdmUgPSBmYWxzZVxubGV0IGxvZ2luRGlhbG9nQWN0aXZlID0gZmFsc2VcbmxldCBpc0xvZ2dpbmdPdXQgPSBmYWxzZVxubGV0IHNlcnZpY2VVbmF2YWlsYWJsZURpYWxvZ0FjdGl2ZSA9IGZhbHNlXG5sZXQgcmVxdWVzdFRpbWVvdXREaWFsb2dBY3RpdmUgPSBmYWxzZVxubGV0IHNob3duUXVvdGFFcnJvciA9IGZhbHNlXG5sZXQgc2hvd2luZ0ltcG9ydEVycm9yID0gZmFsc2VcbmNvbnN0IGlnbm9yZWRNZXNzYWdlcyA9IFtcIndlYmtpdEV4aXRGdWxsU2NyZWVuXCIsIFwiZ29vZ2xldGFnXCIsIFwiYXZhc3Rfc3VibWl0XCJdXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVVbmNhdWdodEVycm9ySW1wbChlOiBFcnJvcikge1xuXHRjb25zdCB7IGxvZ2lucywgaW50ZXJXaW5kb3dFdmVudFNlbmRlciwgd29ya2VyLCBzZWFyY2ggfSA9IGxvY2F0b3JcblxuXHRpZiAoaXNMb2dnaW5nT3V0KSB7XG5cdFx0Ly8gaWdub3JlIGFsbCBlcnJvcnMgd2hpbGUgbG9nZ2luZyBvdXRcblx0XHRyZXR1cm5cblx0fVxuXG5cdGlmIChlIGluc3RhbmNlb2YgVXNlckVycm9yKSB7XG5cdFx0cmV0dXJuIHNob3dVc2VyRXJyb3IoZSlcblx0fVxuXG5cdGlmIChpc09mZmxpbmVFcnJvcihlKSkge1xuXHRcdHNob3dPZmZsaW5lTWVzc2FnZSgpXG5cdH0gZWxzZSBpZiAoZSBpbnN0YW5jZW9mIEludmFsaWRTb2Z0d2FyZVZlcnNpb25FcnJvcikge1xuXHRcdGlmICghaW52YWxpZFNvZnR3YXJlVmVyc2lvbkFjdGl2ZSkge1xuXHRcdFx0aW52YWxpZFNvZnR3YXJlVmVyc2lvbkFjdGl2ZSA9IHRydWVcblx0XHRcdERpYWxvZy5tZXNzYWdlKFwib3V0ZGF0ZWRDbGllbnRfbXNnXCIpLnRoZW4oKCkgPT4gKGludmFsaWRTb2Z0d2FyZVZlcnNpb25BY3RpdmUgPSBmYWxzZSkpXG5cdFx0fVxuXHR9IGVsc2UgaWYgKFxuXHRcdGUgaW5zdGFuY2VvZiBOb3RBdXRoZW50aWNhdGVkRXJyb3IgfHxcblx0XHRlIGluc3RhbmNlb2YgQWNjZXNzQmxvY2tlZEVycm9yIHx8XG5cdFx0ZSBpbnN0YW5jZW9mIEFjY2Vzc0RlYWN0aXZhdGVkRXJyb3IgfHxcblx0XHRlIGluc3RhbmNlb2YgQWNjZXNzRXhwaXJlZEVycm9yXG5cdCkge1xuXHRcdC8vIElmIHRoZSBzZXNzaW9uIGlzIGNsb3NlZCAoZS5nLiBwYXNzd29yZCBpcyBjaGFuZ2VkKSB3ZSBsb2cgdXNlciBvdXQgZm9yY2VmdWxseSBzbyB3ZSByZWxvYWQgdGhlIHBhZ2Vcblx0XHRpZiAobG9naW5zLmlzVXNlckxvZ2dlZEluKCkpIHtcblx0XHRcdGxvZ291dElmTm9QYXNzd29yZFByb21wdCgpXG5cdFx0fVxuXHR9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBTZXNzaW9uRXhwaXJlZEVycm9yKSB7XG5cdFx0cmVsb2dpbkZvckV4cGlyZWRTZXNzaW9uKClcblx0fSBlbHNlIGlmIChlIGluc3RhbmNlb2YgT3V0T2ZTeW5jRXJyb3IpIHtcblx0XHRjb25zdCBpc09mZmxpbmUgPSBpc09mZmxpbmVTdG9yYWdlQXZhaWxhYmxlKCkgJiYgbG9naW5zLmlzVXNlckxvZ2dlZEluKCkgJiYgbG9naW5zLmdldFVzZXJDb250cm9sbGVyKCkuc2Vzc2lvblR5cGUgPT09IFNlc3Npb25UeXBlLlBlcnNpc3RlbnRcblxuXHRcdGF3YWl0IERpYWxvZy5tZXNzYWdlKFwib3V0T2ZTeW5jX2xhYmVsXCIsIGxhbmcuZ2V0KGlzT2ZmbGluZSA/IFwiZGF0YUV4cGlyZWRPZmZsaW5lRGJfbXNnXCIgOiBcImRhdGFFeHBpcmVkX21zZ1wiKSlcblxuXHRcdGNvbnN0IHsgdXNlcklkIH0gPSBsb2dpbnMuZ2V0VXNlckNvbnRyb2xsZXIoKVxuXHRcdGlmIChpc0Rlc2t0b3AoKSkge1xuXHRcdFx0YXdhaXQgaW50ZXJXaW5kb3dFdmVudFNlbmRlcj8ubG9jYWxVc2VyRGF0YUludmFsaWRhdGVkKHVzZXJJZClcblx0XHRcdGF3YWl0IHdvcmtlci5nZXRXb3JrZXJJbnRlcmZhY2UoKS5zcWxDaXBoZXJGYWNhZGUuZGVsZXRlRGIodXNlcklkKVxuXHRcdH1cblx0XHRhd2FpdCBsb2dpbnMubG9nb3V0KGZhbHNlKVxuXHRcdGF3YWl0IHdpbmRvd0ZhY2FkZS5yZWxvYWQoeyBub0F1dG9Mb2dpbjogdHJ1ZSB9KVxuXHR9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBJbnN1ZmZpY2llbnRTdG9yYWdlRXJyb3IpIHtcblx0XHRpZiAobG9naW5zLmdldFVzZXJDb250cm9sbGVyKCkuaXNHbG9iYWxBZG1pbigpKSB7XG5cdFx0XHRzaG93TW9yZVN0b3JhZ2VOZWVkZWRPcmRlckRpYWxvZyhcImluc3VmZmljaWVudFN0b3JhZ2VBZG1pbl9tc2dcIilcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gbGFuZy5tYWtlVHJhbnNsYXRpb24oXG5cdFx0XHRcdFwiaW5zdWZmaWNpZW50U3RvcmFnZVVzZXJfbXNnXCIsXG5cdFx0XHRcdGxhbmcuZ2V0KFwiaW5zdWZmaWNpZW50U3RvcmFnZVVzZXJfbXNnXCIpICsgXCIgXCIgKyBsYW5nLmdldChcImNvbnRhY3RBZG1pbl9tc2dcIiksXG5cdFx0XHQpXG5cdFx0XHREaWFsb2cubWVzc2FnZShlcnJvck1lc3NhZ2UpXG5cdFx0fVxuXHR9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBTZXJ2aWNlVW5hdmFpbGFibGVFcnJvcikge1xuXHRcdGlmICghc2VydmljZVVuYXZhaWxhYmxlRGlhbG9nQWN0aXZlKSB7XG5cdFx0XHRzZXJ2aWNlVW5hdmFpbGFibGVEaWFsb2dBY3RpdmUgPSB0cnVlXG5cdFx0XHREaWFsb2cubWVzc2FnZShcInNlcnZpY2VVbmF2YWlsYWJsZV9tc2dcIikudGhlbigoKSA9PiB7XG5cdFx0XHRcdHNlcnZpY2VVbmF2YWlsYWJsZURpYWxvZ0FjdGl2ZSA9IGZhbHNlXG5cdFx0XHR9KVxuXHRcdH1cblx0fSBlbHNlIGlmIChlIGluc3RhbmNlb2YgUmVxdWVzdFRpbWVvdXRFcnJvcikge1xuXHRcdGlmICghcmVxdWVzdFRpbWVvdXREaWFsb2dBY3RpdmUpIHtcblx0XHRcdHJlcXVlc3RUaW1lb3V0RGlhbG9nQWN0aXZlID0gdHJ1ZVxuXHRcdFx0RGlhbG9nLm1lc3NhZ2UoXCJyZXF1ZXN0VGltZW91dF9tc2dcIikudGhlbigoKSA9PiB7XG5cdFx0XHRcdHJlcXVlc3RUaW1lb3V0RGlhbG9nQWN0aXZlID0gZmFsc2Vcblx0XHRcdH0pXG5cdFx0fVxuXHR9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBJbmRleGluZ05vdFN1cHBvcnRlZEVycm9yKSB7XG5cdFx0Y29uc29sZS5sb2coXCJJbmRleGluZyBub3Qgc3VwcG9ydGVkXCIsIGUpXG5cdFx0aWYgKFwiaW5kZXhpbmdTdXBwb3J0ZWRcIiBpbiBzZWFyY2gpIHtcblx0XHRcdC8vIHNlYXJjaCBjYW4gYmUgaW4gdHdvIGZsYXZvdXJzOiBcIlNlYXJjaE1vZGVsXCIgYW5kIFwiQ2FsZW5kYXJTZWFyY2hNb2RlbC4gT25seSBcIlNlYXJjaE1vZGVsXCIgaGFzIGluZGV4aW5nXG5cdFx0XHRzZWFyY2guaW5kZXhpbmdTdXBwb3J0ZWQgPSBmYWxzZVxuXHRcdH1cblx0fSBlbHNlIGlmIChlIGluc3RhbmNlb2YgUXVvdGFFeGNlZWRlZEVycm9yKSB7XG5cdFx0aWYgKCFzaG93blF1b3RhRXJyb3IpIHtcblx0XHRcdHNob3duUXVvdGFFcnJvciA9IHRydWVcblx0XHRcdERpYWxvZy5tZXNzYWdlKFwic3RvcmFnZVF1b3RhRXhjZWVkZWRfbXNnXCIpXG5cdFx0fVxuXHR9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBPZmZsaW5lRGJDbG9zZWRFcnJvcikge1xuXHRcdGlmICghbG9naW5EaWFsb2dBY3RpdmUpIHtcblx0XHRcdHRocm93IGVcblx0XHR9XG5cdH0gZWxzZSBpZiAoaWdub3JlZEVycm9yKGUpKSB7XG5cdFx0Ly8gaWdub3JlLCB0aGlzIGlzIG5vdCBvdXIgY29kZVxuXHR9IGVsc2Uge1xuXHRcdGlmICghdW5rbm93bkVycm9yRGlhbG9nQWN0aXZlKSB7XG5cdFx0XHR1bmtub3duRXJyb3JEaWFsb2dBY3RpdmUgPSB0cnVlXG5cblx0XHRcdC8vIG9ubHkgbG9nZ2VkIGluIHVzZXJzIGNhbiByZXBvcnQgZXJyb3JzIGJlY2F1c2Ugd2Ugc2VuZCBtYWlsIGZvciB0aGF0LlxuXHRcdFx0aWYgKGxvZ2lucy5pc1VzZXJMb2dnZWRJbigpKSB7XG5cdFx0XHRcdGNvbnN0IHsgaWdub3JlZCB9ID0gYXdhaXQgc2hvd0Vycm9yTm90aWZpY2F0aW9uKGUpXG5cdFx0XHRcdHVua25vd25FcnJvckRpYWxvZ0FjdGl2ZSA9IGZhbHNlXG5cdFx0XHRcdGlmIChpZ25vcmVkKSB7XG5cdFx0XHRcdFx0aWdub3JlZE1lc3NhZ2VzLnB1c2goZS5tZXNzYWdlKVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIlVua25vd24gZXJyb3JcIiwgZSlcblx0XHRcdFx0c2hvd0Vycm9yRGlhbG9nTm90TG9nZ2VkSW4oZSkudGhlbigoKSA9PiAodW5rbm93bkVycm9yRGlhbG9nQWN0aXZlID0gZmFsc2UpKVxuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBzaG93T2ZmbGluZU1lc3NhZ2UoKSB7XG5cdGlmICghbm90Q29ubmVjdGVkRGlhbG9nQWN0aXZlKSB7XG5cdFx0bm90Q29ubmVjdGVkRGlhbG9nQWN0aXZlID0gdHJ1ZVxuXHRcdHNob3dTbmFja0Jhcih7XG5cdFx0XHRtZXNzYWdlOiBcInNlcnZlck5vdFJlYWNoYWJsZV9tc2dcIixcblx0XHRcdGJ1dHRvbjoge1xuXHRcdFx0XHRsYWJlbDogXCJva19hY3Rpb25cIixcblx0XHRcdFx0Y2xpY2s6ICgpID0+IHt9LFxuXHRcdFx0fSxcblx0XHRcdG9uQ2xvc2U6ICgpID0+IHtcblx0XHRcdFx0bm90Q29ubmVjdGVkRGlhbG9nQWN0aXZlID0gZmFsc2Vcblx0XHRcdH0sXG5cdFx0fSlcblx0fVxufVxuXG5mdW5jdGlvbiBsb2dvdXRJZk5vUGFzc3dvcmRQcm9tcHQoKSB7XG5cdGlmICghbG9naW5EaWFsb2dBY3RpdmUpIHtcblx0XHR3aW5kb3dGYWNhZGUucmVsb2FkKHt9KVxuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWxvZ2luRm9yRXhwaXJlZFNlc3Npb24oKSB7XG5cdGlmIChsb2dpbkRpYWxvZ0FjdGl2ZSkge1xuXHRcdHJldHVyblxuXHR9XG5cdGNvbnN0IHsgbG9naW5zLCBsb2dpbkZhY2FkZSwgc2Vjb25kRmFjdG9ySGFuZGxlciwgY3JlZGVudGlhbHNQcm92aWRlciwgY2FjaGVTdG9yYWdlIH0gPSBsb2NhdG9yXG5cdC8vIE1ha2Ugc3VyZSB0aGF0IHBhcnRpYWwgbG9naW4gcGFydCBpcyBjb21wbGV0ZSBiZWZvcmUgd2Ugd2lsbCB0cnkgdG8gbWFrZSBhIG5ldyBzZXNzaW9uLlxuXHQvLyBPdGhlcndpc2Ugd2UgcnVuIGludG8gYSByYWNlIGNvbmRpdGlvbiB3aGVyZSBsb2dpbiBmYWlsdXJlIGFycml2ZXMgYmVmb3JlIHdlIGluaXRpYWxpemUgdXNlckNvbnRyb2xsZXIuXG5cdGF3YWl0IGxvZ2lucy53YWl0Rm9yUGFydGlhbExvZ2luKClcblx0Y29uc29sZS5sb2coXCJSRUxPR0lOXCIsIGxvZ2lucy5pc1VzZXJMb2dnZWRJbigpKVxuXHRjb25zdCBvbGRTZXNzaW9uVHlwZSA9IGxvZ2lucy5nZXRVc2VyQ29udHJvbGxlcigpLnNlc3Npb25UeXBlXG5cdGNvbnN0IHVzZXJJZCA9IGxvZ2lucy5nZXRVc2VyQ29udHJvbGxlcigpLnVzZXIuX2lkXG5cdGNvbnN0IG1haWxBZGRyZXNzID0gYXNzZXJ0Tm90TnVsbChsb2dpbnMuZ2V0VXNlckNvbnRyb2xsZXIoKS51c2VyR3JvdXBJbmZvLm1haWxBZGRyZXNzLCBcImNvdWxkIG5vdCBnZXQgbWFpbEFkZHJlc3MgZnJvbSB1c2VyR3JvdXBJbmZvXCIpXG5cdC8vIEZldGNoIG9sZCBjcmVkZW50aWFscyB0byBwcmVzZXJ2ZSBkYXRhYmFzZSBrZXkgaWYgaXQncyB0aGVyZVxuXHRjb25zdCBvbGRDcmVkZW50aWFscyA9IGF3YWl0IGNyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0RGVjcnlwdGVkQ3JlZGVudGlhbHNCeVVzZXJJZCh1c2VySWQpXG5cdC8vIHdlJ3JlIGRlbGV0aW5nIHRoZSBvdXRkYXRlZCB1c2VyIGhlcmUgYmVjYXVzZSBiZWZvcmUgcmVzZXRTZXNzaW9uKCkgdGhlIGNhY2hlIGlzIHN0aWxsIG9wZW4gYW5kIGNhbiBiZSBtb2RpZmllZC5cblx0YXdhaXQgY2FjaGVTdG9yYWdlPy5kZWxldGVJZkV4aXN0cyhVc2VyVHlwZVJlZiwgbnVsbCwgdXNlcklkKVxuXHRjb25zdCBzZXNzaW9uUmVzZXQgPSBsb2dpbkZhY2FkZS5yZXNldFNlc3Npb24oKVxuXHRsb2dpbkRpYWxvZ0FjdGl2ZSA9IHRydWVcblxuXHRjb25zdCBkaWFsb2cgPSBzaG93UmVxdWVzdFBhc3N3b3JkRGlhbG9nKHtcblx0XHRhY3Rpb246IGFzeW5jIChwdykgPT4ge1xuXHRcdFx0YXdhaXQgc2Vzc2lvblJlc2V0XG5cdFx0XHRsZXQgY3JlZGVudGlhbHM6IENyZWRlbnRpYWxzXG5cdFx0XHRsZXQgZGF0YWJhc2VLZXk6IFVpbnQ4QXJyYXkgfCBudWxsXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBuZXdTZXNzaW9uRGF0YSA9IGF3YWl0IGxvZ2lucy5jcmVhdGVTZXNzaW9uKG1haWxBZGRyZXNzLCBwdywgb2xkU2Vzc2lvblR5cGUsIG9sZENyZWRlbnRpYWxzPy5kYXRhYmFzZUtleSlcblx0XHRcdFx0Y3JlZGVudGlhbHMgPSBuZXdTZXNzaW9uRGF0YS5jcmVkZW50aWFsc1xuXHRcdFx0XHRkYXRhYmFzZUtleSA9IG5ld1Nlc3Npb25EYXRhLmRhdGFiYXNlS2V5XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHRlIGluc3RhbmNlb2YgQ2FuY2VsbGVkRXJyb3IgfHxcblx0XHRcdFx0XHRlIGluc3RhbmNlb2YgQWNjZXNzQmxvY2tlZEVycm9yIHx8XG5cdFx0XHRcdFx0ZSBpbnN0YW5jZW9mIE5vdEF1dGhlbnRpY2F0ZWRFcnJvciB8fFxuXHRcdFx0XHRcdGUgaW5zdGFuY2VvZiBBY2Nlc3NEZWFjdGl2YXRlZEVycm9yIHx8XG5cdFx0XHRcdFx0ZSBpbnN0YW5jZW9mIENvbm5lY3Rpb25FcnJvclxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRjb25zdCB7IGdldExvZ2luRXJyb3JNZXNzYWdlIH0gPSBhd2FpdCBpbXBvcnQoXCIuLi9taXNjL0xvZ2luVXRpbHMuanNcIilcblx0XHRcdFx0XHRyZXR1cm4gbGFuZy5nZXRUcmFuc2xhdGlvblRleHQoZ2V0TG9naW5FcnJvck1lc3NhZ2UoZSwgZmFsc2UpKVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRocm93IGVcblx0XHRcdFx0fVxuXHRcdFx0fSBmaW5hbGx5IHtcblx0XHRcdFx0Ly8gT25jZSBsb2dpbiBzdWNjZWVkcyB3ZSBuZWVkIHRvIG1hbnVhbGx5IGNsb3NlIHRoZSBkaWFsb2dcblx0XHRcdFx0c2Vjb25kRmFjdG9ySGFuZGxlci5jbG9zZVdhaXRpbmdGb3JTZWNvbmRGYWN0b3JEaWFsb2coKVxuXHRcdFx0fVxuXHRcdFx0YXdhaXQgY3JlZGVudGlhbHNQcm92aWRlci5kZWxldGVCeVVzZXJJZCh1c2VySWQsIHsgZGVsZXRlT2ZmbGluZURiOiBmYWxzZSB9KVxuXHRcdFx0aWYgKG9sZFNlc3Npb25UeXBlID09PSBTZXNzaW9uVHlwZS5QZXJzaXN0ZW50KSB7XG5cdFx0XHRcdGF3YWl0IGNyZWRlbnRpYWxzUHJvdmlkZXIuc3RvcmUoY3JlZGVudGlhbHNUb1VuZW5jcnlwdGVkKGNyZWRlbnRpYWxzLCBkYXRhYmFzZUtleSkpXG5cdFx0XHR9XG5cdFx0XHRsb2dpbkRpYWxvZ0FjdGl2ZSA9IGZhbHNlXG5cdFx0XHRkaWFsb2cuY2xvc2UoKVxuXHRcdFx0cmV0dXJuIFwiXCJcblx0XHR9LFxuXHRcdGNhbmNlbDoge1xuXHRcdFx0dGV4dElkOiBcImxvZ291dF9sYWJlbFwiLFxuXHRcdFx0YWN0aW9uKCkge1xuXHRcdFx0XHR3aW5kb3dGYWNhZGUucmVsb2FkKHt9KVxuXHRcdFx0fSxcblx0XHR9LFxuXHR9KVxufVxuXG5mdW5jdGlvbiBpZ25vcmVkRXJyb3IoZTogRXJyb3IpOiBib29sZWFuIHtcblx0cmV0dXJuIGUubWVzc2FnZSAhPSBudWxsICYmIGlnbm9yZWRNZXNzYWdlcy5zb21lKChzKSA9PiBlLm1lc3NhZ2UuaW5jbHVkZXMocykpXG59XG5cbi8qKlxuICogVHJ5aW5nIHRvIGhhbmRsZSBlcnJvcnMgZHVyaW5nIGxvZ291dCBjYW4gY2F1c2UgdW5oYW5kbGVkIGVycm9yIGxvb3BzLCBzbyB3ZSBqdXN0IHdhbnQgdG8gaWdub3JlIHRoZW1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRpc2FibGVFcnJvckhhbmRsaW5nRHVyaW5nTG9nb3V0KCkge1xuXHRpc0xvZ2dpbmdPdXQgPSB0cnVlXG5cdHNob3dQcm9ncmVzc0RpYWxvZyhcImxvZ2dpbmdPdXRfbXNnXCIsIG5ldyBQcm9taXNlKG5vT3ApKVxufVxuXG5mdW5jdGlvbiBoYW5kbGVJbXBvcnRFcnJvcigpIHtcblx0aWYgKHNob3dpbmdJbXBvcnRFcnJvcikge1xuXHRcdHJldHVyblxuXHR9XG5cblx0c2hvd2luZ0ltcG9ydEVycm9yID0gdHJ1ZVxuXHRjb25zdCBtZXNzYWdlID1cblx0XHRcIlRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBsb2FkaW5nIHBhcnQgb2YgdGhlIGFwcC4gSXQgbWlnaHQgYmUgdGhhdCB5b3UgYXJlIG9mZmxpbmUsIHJ1bm5pbmcgYW4gb3V0ZGF0ZWQgdmVyc2lvbiwgb3IgeW91ciBicm93c2VyIGlzIGJsb2NraW5nIHRoZSByZXF1ZXN0LlwiXG5cdERpYWxvZy5jaG9pY2UobGFuZy5tYWtlVHJhbnNsYXRpb24oXCJlcnJvcl9tc2dcIiwgbWVzc2FnZSksIFtcblx0XHR7XG5cdFx0XHR0ZXh0OiBcImNsb3NlX2FsdFwiLFxuXHRcdFx0dmFsdWU6IGZhbHNlLFxuXHRcdH0sXG5cdFx0e1xuXHRcdFx0dGV4dDogXCJyZWxvYWRQYWdlX2FjdGlvblwiLFxuXHRcdFx0dmFsdWU6IHRydWUsXG5cdFx0fSxcblx0XSkudGhlbigocmVsb2FkKSA9PiB7XG5cdFx0c2hvd2luZ0ltcG9ydEVycm9yID0gZmFsc2VcblxuXHRcdGlmIChyZWxvYWQpIHtcblx0XHRcdHdpbmRvd0ZhY2FkZS5yZWxvYWQoe30pXG5cdFx0fVxuXHR9KVxufVxuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHQvLyBAdHMtaWdub3JlXG5cdHdpbmRvdy50dXRhby50ZXN0RXJyb3IgPSAoKSA9PiBoYW5kbGVVbmNhdWdodEVycm9ySW1wbChuZXcgRXJyb3IoXCJ0ZXN0IGVycm9yIVwiKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dVc2VyRXJyb3IoZXJyb3I6IFVzZXJFcnJvcik6IFByb21pc2U8dm9pZD4ge1xuXHRyZXR1cm4gRGlhbG9nLm1lc3NhZ2UobGFuZy5tYWtlVHJhbnNsYXRpb24oXCJlcnJvcl9tc2dcIiwgZXJyb3IubWVzc2FnZSkpXG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQ0Esa0JBQWtCO0FBRWxCLElBQUksMkJBQTJCO0FBQy9CLElBQUksMkJBQTJCO0FBQy9CLElBQUks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