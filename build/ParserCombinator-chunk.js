import { TutanotaError } from "./dist-chunk.js";
import { downcast } from "./dist2-chunk.js";

//#region src/common/misc/parsing/ParserCombinator.ts
var ParserError = class extends TutanotaError {
	filename;
	constructor(message, filename) {
		super("ParserError", message);
		this.filename = filename ?? null;
	}
};
const combineParsers = downcast((...parsers) => (iterator) => parsers.map((p) => p(iterator)));
function makeCharacterParser(character) {
	return (iterator) => {
		let value = iterator.peek();
		if (value === character) {
			iterator.next();
			return value;
		}
		const sliceStart = Math.max(iterator.position - 10, 0);
		const sliceEnd = Math.min(iterator.position + 10, iterator.iteratee.length - 1);
		throw new ParserError(`expected character "${character}" got "${value}" near ${iterator.iteratee.slice(sliceStart, sliceEnd)}`);
	};
}
function makeNotCharacterParser(character) {
	return (iterator) => {
		let value = iterator.peek();
		if (value && value !== character) {
			iterator.next();
			return value;
		}
		const sliceStart = Math.max(iterator.position - 10, 0);
		const sliceEnd = Math.min(iterator.position + 10, iterator.iteratee.length - 1);
		throw new ParserError(`expected character "${character}" got "${value}" near ${iterator.iteratee.slice(sliceStart, sliceEnd)}`);
	};
}
function makeZeroOrMoreParser(anotherParser) {
	return (iterator) => {
		const result = [];
		try {
			let parseResult = anotherParser(iterator);
			while (true) {
				result.push(parseResult);
				parseResult = anotherParser(iterator);
			}
		} catch (e) {}
		return result;
	};
}
function mapParser(parser, mapper) {
	return (iterator) => {
		return mapper(parser(iterator));
	};
}
function makeOneOrMoreParser(parser) {
	return mapParser(makeZeroOrMoreParser(parser), (value) => {
		if (value.length === 0) throw new ParserError("Expected at least one value, got none");
		return value;
	});
}
function maybeParse(parser) {
	return (iterator) => {
		const iteratorPosition = iterator.position;
		try {
			return parser(iterator);
		} catch (e) {
			if (e instanceof ParserError) iterator.position = iteratorPosition;
			return null;
		}
	};
}
function makeSeparatedByParser(separatorParser, valueParser) {
	return (iterator) => {
		const result = [];
		result.push(valueParser(iterator));
		while (true) {
			try {
				separatorParser(iterator);
			} catch (e) {
				break;
			}
			result.push(valueParser(iterator));
		}
		return result;
	};
}
function makeEitherParser(parserA, parserB) {
	return (iterator) => {
		const iteratorPosition = iterator.position;
		try {
			return parserA(iterator);
		} catch (e) {
			if (e instanceof ParserError) {
				iterator.position = iteratorPosition;
				return parserB(iterator);
			}
			throw e;
		}
	};
}
function makeOneOfCharactersParser(allowed) {
	return (iterator) => {
		const value = iterator.peek();
		if (value && allowed.includes(value)) {
			iterator.next();
			return value;
		}
		throw new ParserError(`Expected one of ${allowed.map((c) => `"${c}"`).join(", ")}, but got "${value}\n${context(iterator, iterator.position, 10)}"`);
	};
}
const numberParser = mapParser(makeOneOrMoreParser(makeOneOfCharactersParser([
	"0",
	"1",
	"2",
	"3",
	"4",
	"5",
	"6",
	"7",
	"8",
	"9"
])), (values) => parseInt(values.join(""), 10));
var StringIterator = class {
	iteratee;
	position = -1;
	constructor(iteratee) {
		this.iteratee = iteratee;
	}
	next() {
		const value = this.iteratee[++this.position];
		const done = this.position >= this.iteratee.length;
		return done ? {
			done: true,
			value: undefined
		} : {
			done: false,
			value
		};
	}
	peek() {
		return this.iteratee[this.position + 1] ?? null;
	}
};
function context(iterator, contextCentre, contextRadius = 10) {
	const sliceStart = Math.max(contextCentre - contextRadius, 0);
	const sliceEnd = Math.min(contextCentre + contextRadius, iterator.iteratee.length - 1);
	const sliceLength = sliceEnd - sliceStart;
	const actualPosition = contextCentre - (2 * contextRadius - sliceLength);
	return iterator.iteratee.slice(sliceStart, sliceEnd);
}

//#endregion
export { ParserError, StringIterator, combineParsers, makeCharacterParser, makeEitherParser, makeNotCharacterParser, makeSeparatedByParser, makeZeroOrMoreParser, mapParser, maybeParse, numberParser };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUGFyc2VyQ29tYmluYXRvci1jaHVuay5qcyIsIm5hbWVzIjpbIm1lc3NhZ2U6IHN0cmluZyIsImZpbGVuYW1lPzogc3RyaW5nIiwiY29tYmluZVBhcnNlcnM6ICg8QSwgQj4oYXJnMDogUGFyc2VyPEE+LCBhcmcxOiBQYXJzZXI8Qj4pID0+IFBhcnNlcjxbQSwgQl0+KSAmXG5cdCg8QSwgQiwgQz4oYXJnMDogUGFyc2VyPEE+LCBhcmcxOiBQYXJzZXI8Qj4sIGFyZzI6IFBhcnNlcjxDPikgPT4gUGFyc2VyPFtBLCBCLCBDXT4pICZcblx0KDxBLCBCLCBDLCBEPihhcmcwOiBQYXJzZXI8QT4sIGFyZzE6IFBhcnNlcjxCPiwgYXJnMjogUGFyc2VyPEM+LCBhcmczOiBQYXJzZXI8RD4pID0+IFBhcnNlcjxbQSwgQiwgQywgRF0+KSAmXG5cdCg8QSwgQiwgQywgRCwgRT4oYXJnMDogUGFyc2VyPEE+LCBhcmcxOiBQYXJzZXI8Qj4sIGFyZzI6IFBhcnNlcjxDPiwgYXJnMzogUGFyc2VyPEQ+LCBhcmc0OiBQYXJzZXI8RT4pID0+IFBhcnNlcjxbQSwgQiwgQywgRCwgRV0+KSIsIml0ZXJhdG9yOiBTdHJpbmdJdGVyYXRvciIsImNoYXJhY3Rlcjogc3RyaW5nIiwiYW5vdGhlclBhcnNlcjogUGFyc2VyPFQ+IiwicmVzdWx0OiBUW10iLCJwYXJzZXI6IFBhcnNlcjxUPiIsIm1hcHBlcjogKGFyZzA6IFQpID0+IFIiLCJ2YWx1ZTogQXJyYXk8VD4iLCJzZXBhcmF0b3JQYXJzZXI6IFBhcnNlcjxTPiIsInZhbHVlUGFyc2VyOiBQYXJzZXI8VD4iLCJwYXJzZXJBOiBQYXJzZXI8QT4iLCJwYXJzZXJCOiBQYXJzZXI8Qj4iLCJhbGxvd2VkOiBBcnJheTxzdHJpbmc+IiwibnVtYmVyUGFyc2VyOiBQYXJzZXI8bnVtYmVyPiIsIml0ZXJhdGVlOiBzdHJpbmciLCJkb25lOiBib29sZWFuIiwiY29udGV4dENlbnRyZTogbnVtYmVyIiwiY29udGV4dFJhZGl1czogbnVtYmVyIl0sInNvdXJjZXMiOlsiLi4vc3JjL2NvbW1vbi9taXNjL3BhcnNpbmcvUGFyc2VyQ29tYmluYXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAYnVuZGxlSW50bzpjb21tb24tbWluXG5cbmltcG9ydCB7IGRvd25jYXN0IH0gZnJvbSBcIkB0dXRhby90dXRhbm90YS11dGlsc1wiXG5pbXBvcnQgeyBUdXRhbm90YUVycm9yIH0gZnJvbSBcIkB0dXRhby90dXRhbm90YS1lcnJvclwiXG5cbmV4cG9ydCB0eXBlIFBhcnNlcjxUPiA9IChhcmcwOiBTdHJpbmdJdGVyYXRvcikgPT4gVFxuXG5leHBvcnQgY2xhc3MgUGFyc2VyRXJyb3IgZXh0ZW5kcyBUdXRhbm90YUVycm9yIHtcblx0ZmlsZW5hbWU6IHN0cmluZyB8IG51bGxcblxuXHRjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIGZpbGVuYW1lPzogc3RyaW5nKSB7XG5cdFx0c3VwZXIoXCJQYXJzZXJFcnJvclwiLCBtZXNzYWdlKVxuXHRcdHRoaXMuZmlsZW5hbWUgPSBmaWxlbmFtZSA/PyBudWxsXG5cdH1cbn1cblxuZXhwb3J0IGNvbnN0IGNvbWJpbmVQYXJzZXJzOiAoPEEsIEI+KGFyZzA6IFBhcnNlcjxBPiwgYXJnMTogUGFyc2VyPEI+KSA9PiBQYXJzZXI8W0EsIEJdPikgJlxuXHQoPEEsIEIsIEM+KGFyZzA6IFBhcnNlcjxBPiwgYXJnMTogUGFyc2VyPEI+LCBhcmcyOiBQYXJzZXI8Qz4pID0+IFBhcnNlcjxbQSwgQiwgQ10+KSAmXG5cdCg8QSwgQiwgQywgRD4oYXJnMDogUGFyc2VyPEE+LCBhcmcxOiBQYXJzZXI8Qj4sIGFyZzI6IFBhcnNlcjxDPiwgYXJnMzogUGFyc2VyPEQ+KSA9PiBQYXJzZXI8W0EsIEIsIEMsIERdPikgJlxuXHQoPEEsIEIsIEMsIEQsIEU+KGFyZzA6IFBhcnNlcjxBPiwgYXJnMTogUGFyc2VyPEI+LCBhcmcyOiBQYXJzZXI8Qz4sIGFyZzM6IFBhcnNlcjxEPiwgYXJnNDogUGFyc2VyPEU+KSA9PiBQYXJzZXI8W0EsIEIsIEMsIEQsIEVdPikgPSBkb3duY2FzdChcblx0KC4uLnBhcnNlcnM6IGFueVtdKSA9PlxuXHRcdChpdGVyYXRvcjogU3RyaW5nSXRlcmF0b3IpID0+XG5cdFx0XHRwYXJzZXJzLm1hcCgocCkgPT4gcChpdGVyYXRvcikpLFxuKVxuXG5leHBvcnQgZnVuY3Rpb24gbWFrZUNoYXJhY3RlclBhcnNlcihjaGFyYWN0ZXI6IHN0cmluZyk6IFBhcnNlcjxzdHJpbmc+IHtcblx0cmV0dXJuIChpdGVyYXRvcjogU3RyaW5nSXRlcmF0b3IpID0+IHtcblx0XHRsZXQgdmFsdWUgPSBpdGVyYXRvci5wZWVrKClcblxuXHRcdGlmICh2YWx1ZSA9PT0gY2hhcmFjdGVyKSB7XG5cdFx0XHRpdGVyYXRvci5uZXh0KClcblx0XHRcdHJldHVybiB2YWx1ZVxuXHRcdH1cblxuXHRcdGNvbnN0IHNsaWNlU3RhcnQgPSBNYXRoLm1heChpdGVyYXRvci5wb3NpdGlvbiAtIDEwLCAwKVxuXHRcdGNvbnN0IHNsaWNlRW5kID0gTWF0aC5taW4oaXRlcmF0b3IucG9zaXRpb24gKyAxMCwgaXRlcmF0b3IuaXRlcmF0ZWUubGVuZ3RoIC0gMSlcblx0XHR0aHJvdyBuZXcgUGFyc2VyRXJyb3IoYGV4cGVjdGVkIGNoYXJhY3RlciBcIiR7Y2hhcmFjdGVyfVwiIGdvdCBcIiR7dmFsdWV9XCIgbmVhciAke2l0ZXJhdG9yLml0ZXJhdGVlLnNsaWNlKHNsaWNlU3RhcnQsIHNsaWNlRW5kKX1gKVxuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlTm90Q2hhcmFjdGVyUGFyc2VyKGNoYXJhY3Rlcjogc3RyaW5nKTogUGFyc2VyPHN0cmluZz4ge1xuXHRyZXR1cm4gKGl0ZXJhdG9yOiBTdHJpbmdJdGVyYXRvcikgPT4ge1xuXHRcdGxldCB2YWx1ZSA9IGl0ZXJhdG9yLnBlZWsoKVxuXG5cdFx0aWYgKHZhbHVlICYmIHZhbHVlICE9PSBjaGFyYWN0ZXIpIHtcblx0XHRcdGl0ZXJhdG9yLm5leHQoKVxuXHRcdFx0cmV0dXJuIHZhbHVlXG5cdFx0fVxuXG5cdFx0Y29uc3Qgc2xpY2VTdGFydCA9IE1hdGgubWF4KGl0ZXJhdG9yLnBvc2l0aW9uIC0gMTAsIDApXG5cdFx0Y29uc3Qgc2xpY2VFbmQgPSBNYXRoLm1pbihpdGVyYXRvci5wb3NpdGlvbiArIDEwLCBpdGVyYXRvci5pdGVyYXRlZS5sZW5ndGggLSAxKVxuXHRcdHRocm93IG5ldyBQYXJzZXJFcnJvcihgZXhwZWN0ZWQgY2hhcmFjdGVyIFwiJHtjaGFyYWN0ZXJ9XCIgZ290IFwiJHt2YWx1ZX1cIiBuZWFyICR7aXRlcmF0b3IuaXRlcmF0ZWUuc2xpY2Uoc2xpY2VTdGFydCwgc2xpY2VFbmQpfWApXG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VaZXJvT3JNb3JlUGFyc2VyPFQ+KGFub3RoZXJQYXJzZXI6IFBhcnNlcjxUPik6IFBhcnNlcjxBcnJheTxUPj4ge1xuXHRyZXR1cm4gKGl0ZXJhdG9yOiBTdHJpbmdJdGVyYXRvcikgPT4ge1xuXHRcdGNvbnN0IHJlc3VsdDogVFtdID0gW11cblxuXHRcdHRyeSB7XG5cdFx0XHRsZXQgcGFyc2VSZXN1bHQgPSBhbm90aGVyUGFyc2VyKGl0ZXJhdG9yKVxuXG5cdFx0XHR3aGlsZSAodHJ1ZSkge1xuXHRcdFx0XHRyZXN1bHQucHVzaChwYXJzZVJlc3VsdClcblx0XHRcdFx0cGFyc2VSZXN1bHQgPSBhbm90aGVyUGFyc2VyKGl0ZXJhdG9yKVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdC8qIGVtcHR5ICovXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdFxuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXBQYXJzZXI8VCwgUj4ocGFyc2VyOiBQYXJzZXI8VD4sIG1hcHBlcjogKGFyZzA6IFQpID0+IFIpOiBQYXJzZXI8Uj4ge1xuXHRyZXR1cm4gKGl0ZXJhdG9yOiBTdHJpbmdJdGVyYXRvcikgPT4ge1xuXHRcdHJldHVybiBtYXBwZXIocGFyc2VyKGl0ZXJhdG9yKSlcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFrZU9uZU9yTW9yZVBhcnNlcjxUPihwYXJzZXI6IFBhcnNlcjxUPik6IFBhcnNlcjxBcnJheTxUPj4ge1xuXHRyZXR1cm4gbWFwUGFyc2VyKG1ha2VaZXJvT3JNb3JlUGFyc2VyKHBhcnNlciksICh2YWx1ZTogQXJyYXk8VD4pID0+IHtcblx0XHRpZiAodmFsdWUubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgUGFyc2VyRXJyb3IoXCJFeHBlY3RlZCBhdCBsZWFzdCBvbmUgdmFsdWUsIGdvdCBub25lXCIpXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHZhbHVlXG5cdH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXliZVBhcnNlPFQ+KHBhcnNlcjogUGFyc2VyPFQ+KTogUGFyc2VyPFQgfCBudWxsPiB7XG5cdHJldHVybiAoaXRlcmF0b3IpID0+IHtcblx0XHRjb25zdCBpdGVyYXRvclBvc2l0aW9uID0gaXRlcmF0b3IucG9zaXRpb25cblxuXHRcdHRyeSB7XG5cdFx0XHRyZXR1cm4gcGFyc2VyKGl0ZXJhdG9yKVxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdGlmIChlIGluc3RhbmNlb2YgUGFyc2VyRXJyb3IpIHtcblx0XHRcdFx0aXRlcmF0b3IucG9zaXRpb24gPSBpdGVyYXRvclBvc2l0aW9uXG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbFxuXHRcdH1cblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFrZVNlcGFyYXRlZEJ5UGFyc2VyPFMsIFQ+KHNlcGFyYXRvclBhcnNlcjogUGFyc2VyPFM+LCB2YWx1ZVBhcnNlcjogUGFyc2VyPFQ+KTogUGFyc2VyPEFycmF5PFQ+PiB7XG5cdHJldHVybiAoaXRlcmF0b3IpID0+IHtcblx0XHRjb25zdCByZXN1bHQ6IFRbXSA9IFtdXG5cdFx0cmVzdWx0LnB1c2godmFsdWVQYXJzZXIoaXRlcmF0b3IpKVxuXG5cdFx0d2hpbGUgKHRydWUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHNlcGFyYXRvclBhcnNlcihpdGVyYXRvcilcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0YnJlYWtcblx0XHRcdH1cblxuXHRcdFx0cmVzdWx0LnB1c2godmFsdWVQYXJzZXIoaXRlcmF0b3IpKVxuXHRcdH1cblxuXHRcdHJldHVybiByZXN1bHRcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFrZUVpdGhlclBhcnNlcjxBLCBCPihwYXJzZXJBOiBQYXJzZXI8QT4sIHBhcnNlckI6IFBhcnNlcjxCPik6IFBhcnNlcjxBIHwgQj4ge1xuXHRyZXR1cm4gKGl0ZXJhdG9yKSA9PiB7XG5cdFx0Y29uc3QgaXRlcmF0b3JQb3NpdGlvbiA9IGl0ZXJhdG9yLnBvc2l0aW9uXG5cblx0XHR0cnkge1xuXHRcdFx0cmV0dXJuIHBhcnNlckEoaXRlcmF0b3IpXG5cdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0aWYgKGUgaW5zdGFuY2VvZiBQYXJzZXJFcnJvcikge1xuXHRcdFx0XHRpdGVyYXRvci5wb3NpdGlvbiA9IGl0ZXJhdG9yUG9zaXRpb25cblx0XHRcdFx0cmV0dXJuIHBhcnNlckIoaXRlcmF0b3IpXG5cdFx0XHR9XG5cblx0XHRcdHRocm93IGVcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VPbmVPZkNoYXJhY3RlcnNQYXJzZXIoYWxsb3dlZDogQXJyYXk8c3RyaW5nPik6IFBhcnNlcjxzdHJpbmc+IHtcblx0cmV0dXJuIChpdGVyYXRvcjogU3RyaW5nSXRlcmF0b3IpID0+IHtcblx0XHRjb25zdCB2YWx1ZSA9IGl0ZXJhdG9yLnBlZWsoKVxuXG5cdFx0aWYgKHZhbHVlICYmIGFsbG93ZWQuaW5jbHVkZXModmFsdWUpKSB7XG5cdFx0XHRpdGVyYXRvci5uZXh0KClcblx0XHRcdHJldHVybiB2YWx1ZVxuXHRcdH1cblxuXHRcdHRocm93IG5ldyBQYXJzZXJFcnJvcihgRXhwZWN0ZWQgb25lIG9mICR7YWxsb3dlZC5tYXAoKGMpID0+IGBcIiR7Y31cImApLmpvaW4oXCIsIFwiKX0sIGJ1dCBnb3QgXCIke3ZhbHVlfVxcbiR7Y29udGV4dChpdGVyYXRvciwgaXRlcmF0b3IucG9zaXRpb24sIDEwKX1cImApXG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VOb3RPbmVPZkNoYXJhY3RlcnNQYXJzZXIobm90QWxsb3dlZDogQXJyYXk8c3RyaW5nPik6IFBhcnNlcjxzdHJpbmc+IHtcblx0cmV0dXJuIChpdGVyYXRvcjogU3RyaW5nSXRlcmF0b3IpID0+IHtcblx0XHRjb25zdCB2YWx1ZSA9IGl0ZXJhdG9yLnBlZWsoKVxuXG5cdFx0aWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuXHRcdFx0dGhyb3cgbmV3IFBhcnNlckVycm9yKFwidW5leHBlY3RlZCBlbmQgb2YgaW5wdXRcIilcblx0XHR9XG5cblx0XHRpZiAoIW5vdEFsbG93ZWQuaW5jbHVkZXModmFsdWUpKSB7XG5cdFx0XHRpdGVyYXRvci5uZXh0KClcblx0XHRcdHJldHVybiB2YWx1ZVxuXHRcdH1cblxuXHRcdHRocm93IG5ldyBQYXJzZXJFcnJvcihgRXhwZWN0ZWQgbm9uZSBvZiAke25vdEFsbG93ZWQubWFwKChjKSA9PiBgXCIke2N9XCJgKS5qb2luKFwiLCBcIil9LCBidXQgZ290IFwiJHt2YWx1ZX1cIlxcbiR7Y29udGV4dChpdGVyYXRvciwgaXRlcmF0b3IucG9zaXRpb24sIDEwKX1gKVxuXHR9XG59XG5cbmV4cG9ydCBjb25zdCBudW1iZXJQYXJzZXI6IFBhcnNlcjxudW1iZXI+ID0gbWFwUGFyc2VyKFxuXHRtYWtlT25lT3JNb3JlUGFyc2VyKG1ha2VPbmVPZkNoYXJhY3RlcnNQYXJzZXIoW1wiMFwiLCBcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCIsIFwiNlwiLCBcIjdcIiwgXCI4XCIsIFwiOVwiXSkpLFxuXHQodmFsdWVzKSA9PiBwYXJzZUludCh2YWx1ZXMuam9pbihcIlwiKSwgMTApLFxuKVxuXG5leHBvcnQgY2xhc3MgU3RyaW5nSXRlcmF0b3Ige1xuXHRpdGVyYXRlZTogc3RyaW5nXG5cdHBvc2l0aW9uOiBudW1iZXIgPSAtMVxuXG5cdGNvbnN0cnVjdG9yKGl0ZXJhdGVlOiBzdHJpbmcpIHtcblx0XHR0aGlzLml0ZXJhdGVlID0gaXRlcmF0ZWVcblx0fVxuXG5cdG5leHQoKTogSXRlcmF0b3JSZXN1bHQ8c3RyaW5nPiB7XG5cdFx0Y29uc3QgdmFsdWUgPSB0aGlzLml0ZXJhdGVlWysrdGhpcy5wb3NpdGlvbl1cblx0XHRjb25zdCBkb25lOiBib29sZWFuID0gdGhpcy5wb3NpdGlvbiA+PSB0aGlzLml0ZXJhdGVlLmxlbmd0aFxuXHRcdHJldHVybiBkb25lXG5cdFx0XHQ/IHtcblx0XHRcdFx0XHRkb25lOiB0cnVlLFxuXHRcdFx0XHRcdHZhbHVlOiB1bmRlZmluZWQsXG5cdFx0XHQgIH1cblx0XHRcdDoge1xuXHRcdFx0XHRcdGRvbmU6IGZhbHNlLFxuXHRcdFx0XHRcdHZhbHVlLFxuXHRcdFx0ICB9XG5cdH1cblxuXHRwZWVrKCk6IHN0cmluZyB8IG51bGwge1xuXHRcdHJldHVybiB0aGlzLml0ZXJhdGVlW3RoaXMucG9zaXRpb24gKyAxXSA/PyBudWxsXG5cdH1cbn1cblxuZnVuY3Rpb24gY29udGV4dChpdGVyYXRvcjogU3RyaW5nSXRlcmF0b3IsIGNvbnRleHRDZW50cmU6IG51bWJlciwgY29udGV4dFJhZGl1czogbnVtYmVyID0gMTApOiBzdHJpbmcge1xuXHRjb25zdCBzbGljZVN0YXJ0ID0gTWF0aC5tYXgoY29udGV4dENlbnRyZSAtIGNvbnRleHRSYWRpdXMsIDApXG5cdGNvbnN0IHNsaWNlRW5kID0gTWF0aC5taW4oY29udGV4dENlbnRyZSArIGNvbnRleHRSYWRpdXMsIGl0ZXJhdG9yLml0ZXJhdGVlLmxlbmd0aCAtIDEpXG5cdGNvbnN0IHNsaWNlTGVuZ3RoID0gc2xpY2VFbmQgLSBzbGljZVN0YXJ0XG5cdGNvbnN0IGFjdHVhbFBvc2l0aW9uID0gY29udGV4dENlbnRyZSAtICgyICogY29udGV4dFJhZGl1cyAtIHNsaWNlTGVuZ3RoKVxuXHRyZXR1cm4gaXRlcmF0b3IuaXRlcmF0ZWUuc2xpY2Uoc2xp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