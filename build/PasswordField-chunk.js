import { assertMainOrNode } from "./Env-chunk.js";
import { mithril_default } from "./mithril-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import { Icons } from "./Icons-chunk.js";
import { Autocomplete, TextField, TextFieldType } from "./Dialog-chunk.js";
import { ButtonSize } from "./IconButton-chunk.js";
import { CompletenessIndicator } from "./ProgressDialog-chunk.js";
import { isSecurePassword, scaleToVisualPasswordStrength } from "./PasswordUtils-chunk.js";
import { ToggleButton } from "./ToggleButton-chunk.js";

//#region src/common/gui/base/StatusField.ts
assertMainOrNode();
var StatusField = class {
	view(vnode) {
		const { status } = vnode.attrs;
		if (!status) return null;
		return mithril_default("", lang.get(status.text));
	}
};

//#endregion
//#region src/common/misc/passwords/PasswordField.ts
var PasswordField = class PasswordField {
	isPasswordRevealed = false;
	view(vnode) {
		const attrs = vnode.attrs;
		const { passwordStrength, status, label,...textFieldAttrs } = attrs;
		return mithril_default(TextField, {
			...textFieldAttrs,
			label: label === undefined ? "password_label" : label,
			autocompleteAs: attrs.autocompleteAs ? attrs.autocompleteAs : Autocomplete.currentPassword,
			type: this.isPasswordRevealed ? TextFieldType.Text : TextFieldType.Password,
			helpLabel: () => PasswordField.renderHelpLabel(textFieldAttrs.value, passwordStrength, status, textFieldAttrs.helpLabel ?? null),
			injectionsRight: () => {
				return [PasswordField.renderRevealIcon(this.isPasswordRevealed, (newValue) => this.isPasswordRevealed = newValue), textFieldAttrs.injectionsRight ? textFieldAttrs.injectionsRight() : null];
			}
		});
	}
	static renderRevealIcon(isPasswordRevealed, onRevealToggled) {
		return mithril_default(ToggleButton, {
			title: isPasswordRevealed ? "concealPassword_action" : "revealPassword_action",
			toggled: isPasswordRevealed,
			onToggled: (value, e) => {
				onRevealToggled(value);
				e.stopPropagation();
			},
			icon: isPasswordRevealed ? Icons.NoEye : Icons.Eye,
			size: ButtonSize.Compact
		});
	}
	static renderHelpLabel(value, strength, status, helpLabel) {
		const displayedStatus = PasswordField.parseStatusSetting(status, value, strength);
		return mithril_default(".mt-xs", [mithril_default(".flex.items-center", [strength != undefined ? mithril_default(CompletenessIndicator, {
			class: "mr-s",
			percentageCompleted: scaleToVisualPasswordStrength(strength)
		}) : null, displayedStatus ? mithril_default(StatusField, { status: displayedStatus }) : null]), helpLabel ? helpLabel() : null]);
	}
	static parseStatusSetting(status, password, strength) {
		if (status === "auto" && strength != undefined) return PasswordField.getPasswordStatus(password, strength);
else if (status && typeof status !== "string") return status;
else return null;
	}
	static getPasswordStatus(password, strength) {
		if (password === "") return {
			type: "neutral",
			text: "password1Neutral_msg"
		};
else if (isSecurePassword(strength)) return {
			type: "valid",
			text: "passwordValid_msg"
		};
else return {
			type: "invalid",
			text: "password1InvalidUnsecure_msg"
		};
	}
};

//#endregion
export { PasswordField };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUGFzc3dvcmRGaWVsZC1jaHVuay5qcyIsIm5hbWVzIjpbInZub2RlOiBWbm9kZTxTdGF0dXNGaWVsZEF0dHJzPiIsInZub2RlOiBWbm9kZTxQYXNzd29yZEZpZWxkQXR0cnM+IiwiaXNQYXNzd29yZFJldmVhbGVkOiBib29sZWFuIiwib25SZXZlYWxUb2dnbGVkOiAodmFsdWU6IGJvb2xlYW4pID0+IHVua25vd24iLCJ2YWx1ZTogc3RyaW5nIiwic3RyZW5ndGg6IG51bWJlciB8IHVuZGVmaW5lZCIsInN0YXR1czogU3RhdHVzU2V0dGluZyB8IHVuZGVmaW5lZCIsImhlbHBMYWJlbDogbGF6eTxDaGlsZHJlbj4gfCBudWxsIiwicGFzc3dvcmQ6IHN0cmluZyIsInN0cmVuZ3RoOiBudW1iZXIiXSwic291cmNlcyI6WyIuLi9zcmMvY29tbW9uL2d1aS9iYXNlL1N0YXR1c0ZpZWxkLnRzIiwiLi4vc3JjL2NvbW1vbi9taXNjL3Bhc3N3b3Jkcy9QYXNzd29yZEZpZWxkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtLCB7IENoaWxkcmVuLCBDb21wb25lbnQsIFZub2RlIH0gZnJvbSBcIm1pdGhyaWxcIlxuaW1wb3J0IHsgbGFuZyB9IGZyb20gXCIuLi8uLi9taXNjL0xhbmd1YWdlVmlld01vZGVsXCJcbmltcG9ydCB0eXBlIHsgVHJhbnNsYXRpb25LZXkgfSBmcm9tIFwiLi4vLi4vbWlzYy9MYW5ndWFnZVZpZXdNb2RlbFwiXG5pbXBvcnQgeyBhc3NlcnRNYWluT3JOb2RlIH0gZnJvbSBcIi4uLy4uL2FwaS9jb21tb24vRW52XCJcblxuYXNzZXJ0TWFpbk9yTm9kZSgpXG5leHBvcnQgdHlwZSBTdGF0dXNUeXBlID0gXCJuZXV0cmFsXCIgfCBcInZhbGlkXCIgfCBcImludmFsaWRcIlxuZXhwb3J0IHR5cGUgU3RhdHVzRmllbGRBdHRycyA9IHtcblx0c3RhdHVzOiBTdGF0dXNcbn1cblxuZXhwb3J0IGNsYXNzIFN0YXR1c0ZpZWxkIGltcGxlbWVudHMgQ29tcG9uZW50PFN0YXR1c0ZpZWxkQXR0cnM+IHtcblx0dmlldyh2bm9kZTogVm5vZGU8U3RhdHVzRmllbGRBdHRycz4pOiBDaGlsZHJlbiB7XG5cdFx0Y29uc3QgeyBzdGF0dXMgfSA9IHZub2RlLmF0dHJzXG5cdFx0aWYgKCFzdGF0dXMpIHJldHVybiBudWxsXG5cdFx0cmV0dXJuIG0oXCJcIiwgbGFuZy5nZXQoc3RhdHVzLnRleHQpKVxuXHR9XG59XG5cbmV4cG9ydCB0eXBlIFN0YXR1cyA9IHtcblx0dHlwZTogU3RhdHVzVHlwZVxuXHR0ZXh0OiBUcmFuc2xhdGlvbktleVxufVxuIiwiaW1wb3J0IG0sIHsgQ2hpbGRyZW4sIENvbXBvbmVudCwgVm5vZGUgfSBmcm9tIFwibWl0aHJpbFwiXG5pbXBvcnQgeyBUb2dnbGVCdXR0b24gfSBmcm9tIFwiLi4vLi4vZ3VpL2Jhc2UvYnV0dG9ucy9Ub2dnbGVCdXR0b24uanNcIlxuaW1wb3J0IHsgSWNvbnMgfSBmcm9tIFwiLi4vLi4vZ3VpL2Jhc2UvaWNvbnMvSWNvbnMuanNcIlxuaW1wb3J0IHsgQnV0dG9uU2l6ZSB9IGZyb20gXCIuLi8uLi9ndWkvYmFzZS9CdXR0b25TaXplLmpzXCJcbmltcG9ydCB7IEF1dG9jb21wbGV0ZSwgVGV4dEZpZWxkLCBUZXh0RmllbGRBdHRycywgVGV4dEZpZWxkVHlwZSB9IGZyb20gXCIuLi8uLi9ndWkvYmFzZS9UZXh0RmllbGQuanNcIlxuaW1wb3J0IHsgQ29tcGxldGVuZXNzSW5kaWNhdG9yIH0gZnJvbSBcIi4uLy4uL2d1aS9Db21wbGV0ZW5lc3NJbmRpY2F0b3IuanNcIlxuaW1wb3J0IHsgaXNTZWN1cmVQYXNzd29yZCwgc2NhbGVUb1Zpc3VhbFBhc3N3b3JkU3RyZW5ndGggfSBmcm9tIFwiLi9QYXNzd29yZFV0aWxzLmpzXCJcbmltcG9ydCB7IFN0YXR1cywgU3RhdHVzRmllbGQgfSBmcm9tIFwiLi4vLi4vZ3VpL2Jhc2UvU3RhdHVzRmllbGQuanNcIlxuaW1wb3J0IHR5cGUgeyBsYXp5IH0gZnJvbSBcIkB0dXRhby90dXRhbm90YS11dGlsc1wiXG5pbXBvcnQgdHlwZSB7IFRyYW5zbGF0aW9uS2V5LCBNYXliZVRyYW5zbGF0aW9uIH0gZnJvbSBcIi4uL0xhbmd1YWdlVmlld01vZGVsLmpzXCJcblxudHlwZSBTdGF0dXNTZXR0aW5nID0gU3RhdHVzIHwgXCJhdXRvXCJcblxuZXhwb3J0IGludGVyZmFjZSBQYXNzd29yZEZpZWxkQXR0cnMgZXh0ZW5kcyBPbWl0PFRleHRGaWVsZEF0dHJzLCBcImxhYmVsXCIgfCBcInR5cGVcIj4ge1xuXHRsYWJlbD86IE1heWJlVHJhbnNsYXRpb25cblx0cGFzc3dvcmRTdHJlbmd0aD86IG51bWJlclxuXHRzdGF0dXM/OiBTdGF0dXNTZXR0aW5nXG59XG5cbmV4cG9ydCBjbGFzcyBQYXNzd29yZEZpZWxkIGltcGxlbWVudHMgQ29tcG9uZW50PFBhc3N3b3JkRmllbGRBdHRycz4ge1xuXHRwcml2YXRlIGlzUGFzc3dvcmRSZXZlYWxlZDogYm9vbGVhbiA9IGZhbHNlXG5cblx0dmlldyh2bm9kZTogVm5vZGU8UGFzc3dvcmRGaWVsZEF0dHJzPikge1xuXHRcdGNvbnN0IGF0dHJzID0gdm5vZGUuYXR0cnNcblx0XHQvLyBTZXBhcmF0ZSBhbmQgcGFzcyB0aGUgZ2VuZXJpYyBgVGV4dEZpZWxkQXR0cnNgIGF0dHJpYnV0ZXMgc28gdGhlIHVzZXIgY2FuIHN0aWxsIHVzZSBhbGwgb2YgYFRleHRGaWVsZHNgIHByb3BlcnRpZXNcblx0XHRjb25zdCB7IHBhc3N3b3JkU3RyZW5ndGgsIHN0YXR1cywgbGFiZWwsIC4uLnRleHRGaWVsZEF0dHJzIH0gPSBhdHRyc1xuXHRcdHJldHVybiBtKFRleHRGaWVsZCwge1xuXHRcdFx0Li4udGV4dEZpZWxkQXR0cnMsXG5cdFx0XHRsYWJlbDogbGFiZWwgPT09IHVuZGVmaW5lZCA/IFwicGFzc3dvcmRfbGFiZWxcIiA6IGxhYmVsLFxuXHRcdFx0YXV0b2NvbXBsZXRlQXM6IGF0dHJzLmF1dG9jb21wbGV0ZUFzID8gYXR0cnMuYXV0b2NvbXBsZXRlQXMgOiBBdXRvY29tcGxldGUuY3VycmVudFBhc3N3b3JkLFxuXHRcdFx0dHlwZTogdGhpcy5pc1Bhc3N3b3JkUmV2ZWFsZWQgPyBUZXh0RmllbGRUeXBlLlRleHQgOiBUZXh0RmllbGRUeXBlLlBhc3N3b3JkLFxuXHRcdFx0aGVscExhYmVsOiAoKSA9PiBQYXNzd29yZEZpZWxkLnJlbmRlckhlbHBMYWJlbCh0ZXh0RmllbGRBdHRycy52YWx1ZSwgcGFzc3dvcmRTdHJlbmd0aCwgc3RhdHVzLCB0ZXh0RmllbGRBdHRycy5oZWxwTGFiZWwgPz8gbnVsbCksXG5cdFx0XHRpbmplY3Rpb25zUmlnaHQ6ICgpID0+IHtcblx0XHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0XHRQYXNzd29yZEZpZWxkLnJlbmRlclJldmVhbEljb24odGhpcy5pc1Bhc3N3b3JkUmV2ZWFsZWQsIChuZXdWYWx1ZSkgPT4gKHRoaXMuaXNQYXNzd29yZFJldmVhbGVkID0gbmV3VmFsdWUpKSxcblx0XHRcdFx0XHR0ZXh0RmllbGRBdHRycy5pbmplY3Rpb25zUmlnaHQgPyB0ZXh0RmllbGRBdHRycy5pbmplY3Rpb25zUmlnaHQoKSA6IG51bGwsXG5cdFx0XHRcdF1cblx0XHRcdH0sXG5cdFx0fSlcblx0fVxuXG5cdHByaXZhdGUgc3RhdGljIHJlbmRlclJldmVhbEljb24oaXNQYXNzd29yZFJldmVhbGVkOiBib29sZWFuLCBvblJldmVhbFRvZ2dsZWQ6ICh2YWx1ZTogYm9vbGVhbikgPT4gdW5rbm93bik6IENoaWxkcmVuIHtcblx0XHRyZXR1cm4gbShUb2dnbGVCdXR0b24sIHtcblx0XHRcdHRpdGxlOiBpc1Bhc3N3b3JkUmV2ZWFsZWQgPyBcImNvbmNlYWxQYXNzd29yZF9hY3Rpb25cIiA6IFwicmV2ZWFsUGFzc3dvcmRfYWN0aW9uXCIsXG5cdFx0XHR0b2dnbGVkOiBpc1Bhc3N3b3JkUmV2ZWFsZWQsXG5cdFx0XHRvblRvZ2dsZWQ6ICh2YWx1ZSwgZSkgPT4ge1xuXHRcdFx0XHRvblJldmVhbFRvZ2dsZWQodmFsdWUpXG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKClcblx0XHRcdH0sXG5cdFx0XHRpY29uOiBpc1Bhc3N3b3JkUmV2ZWFsZWQgPyBJY29ucy5Ob0V5ZSA6IEljb25zLkV5ZSxcblx0XHRcdHNpemU6IEJ1dHRvblNpemUuQ29tcGFjdCxcblx0XHR9KVxuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgcmVuZGVySGVscExhYmVsKHZhbHVlOiBzdHJpbmcsIHN0cmVuZ3RoOiBudW1iZXIgfCB1bmRlZmluZWQsIHN0YXR1czogU3RhdHVzU2V0dGluZyB8IHVuZGVmaW5lZCwgaGVscExhYmVsOiBsYXp5PENoaWxkcmVuPiB8IG51bGwpOiBDaGlsZHJlbiB7XG5cdFx0Y29uc3QgZGlzcGxheWVkU3RhdHVzID0gUGFzc3dvcmRGaWVsZC5wYXJzZVN0YXR1c1NldHRpbmcoc3RhdHVzLCB2YWx1ZSwgc3RyZW5ndGgpXG5cdFx0cmV0dXJuIG0oXCIubXQteHNcIiwgW1xuXHRcdFx0bShcIi5mbGV4Lml0ZW1zLWNlbnRlclwiLCBbXG5cdFx0XHRcdHN0cmVuZ3RoICE9IHVuZGVmaW5lZFxuXHRcdFx0XHRcdD8gbShDb21wbGV0ZW5lc3NJbmRpY2F0b3IsIHtcblx0XHRcdFx0XHRcdFx0Y2xhc3M6IFwibXItc1wiLFxuXHRcdFx0XHRcdFx0XHRwZXJjZW50YWdlQ29tcGxldGVkOiBzY2FsZVRvVmlzdWFsUGFzc3dvcmRTdHJlbmd0aChzdHJlbmd0aCksXG5cdFx0XHRcdFx0ICB9KVxuXHRcdFx0XHRcdDogbnVsbCxcblx0XHRcdFx0ZGlzcGxheWVkU3RhdHVzID8gbShTdGF0dXNGaWVsZCwgeyBzdGF0dXM6IGRpc3BsYXllZFN0YXR1cyB9KSA6IG51bGwsXG5cdFx0XHRdKSxcblx0XHRcdGhlbHBMYWJlbCA/IGhlbHBMYWJlbCgpIDogbnVsbCxcblx0XHRdKVxuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgcGFyc2VTdGF0dXNTZXR0aW5nKHN0YXR1czogU3RhdHVzU2V0dGluZyB8IHVuZGVmaW5lZCwgcGFzc3dvcmQ6IHN0cmluZywgc3RyZW5ndGg6IG51bWJlciB8IHVuZGVmaW5lZCk6IFN0YXR1cyB8IG51bGwge1xuXHRcdGlmIChzdGF0dXMgPT09IFwiYXV0b1wiICYmIHN0cmVuZ3RoICE9IHVuZGVmaW5lZCkge1xuXHRcdFx0cmV0dXJuIFBhc3N3b3JkRmllbGQuZ2V0UGFzc3dvcmRTdGF0dXMocGFzc3dvcmQsIHN0cmVuZ3RoISlcblx0XHR9IGVsc2UgaWYgKHN0YXR1cyAmJiB0eXBlb2Ygc3RhdHVzICE9PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRyZXR1cm4gc3RhdHVzXG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBudWxsXG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBzdGF0aWMgZ2V0UGFzc3dvcmRTdGF0dXMocGFzc3dvcmQ6IHN0cmluZywgc3RyZW5ndGg6IG51bWJlcik6IFN0YXR1cyB7XG5cdFx0aWYgKHBhc3N3b3JkID09PSBcIlwiKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR0eXBlOiBcIm5ldXRyYWxcIixcblx0XHRcdFx0dGV4dDogXCJwYXNzd29yZDFOZXV0cmFsX21zZ1wiLFxuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoaXNTZWN1cmVQYXNzd29yZChzdHJlbmd0aCkpIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdHR5cGU6IFwidmFsaWRcIixcblx0XHRcdFx0dGV4dDogXCJwYXNzd29yZFZhbGlkX21zZ1wiLFxuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR0eXBlOiBcImludmFsaWRcIixcblx0XHRcdFx0dGV4dDogXCJwYXNzd29yZDFJbnZhbGlkVW5zZWN1cmVfbXNnXCIsXG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBS0Esa0JBQWtCO0lBTUwsY0FBTixNQUF5RDtDQUMvRCxLQUFLQSxPQUEwQztFQUM5QyxNQUFNLEVBQUUsUUFBUSxHQUFHLE1BQU07QUFDekIsT0FBSyxPQUFRLFFBQU87QUFDcEIsU0FBTyxnQkFBRSxJQUFJLEtBQUssSUFBSSxPQUFPLEtBQUssQ0FBQztDQUNuQztBQUNEOzs7O0lDRVksZ0JBQU4sTUFBTSxjQUF1RDtDQUNuRSxBQUFRLHFCQUE4QjtDQUV0QyxLQUFLQyxPQUFrQztFQUN0QyxNQUFNLFFBQVEsTUFBTTtFQUVwQixNQUFNLEVBQUUsa0JBQWtCLFFBQVEsTUFBTyxHQUFHLGdCQUFnQixHQUFHO0FBQy9ELFNBQU8sZ0JBQUUsV0FBVztHQUNuQixHQUFHO0dBQ0gsT0FBTyxVQUFVLFlBQVksbUJBQW1CO0dBQ2hELGdCQUFnQixNQUFNLGlCQUFpQixNQUFNLGlCQUFpQixhQUFhO0dBQzNFLE1BQU0sS0FBSyxxQkFBcUIsY0FBYyxPQUFPLGNBQWM7R0FDbkUsV0FBVyxNQUFNLGNBQWMsZ0JBQWdCLGVBQWUsT0FBTyxrQkFBa0IsUUFBUSxlQUFlLGFBQWEsS0FBSztHQUNoSSxpQkFBaUIsTUFBTTtBQUN0QixXQUFPLENBQ04sY0FBYyxpQkFBaUIsS0FBSyxvQkFBb0IsQ0FBQyxhQUFjLEtBQUsscUJBQXFCLFNBQVUsRUFDM0csZUFBZSxrQkFBa0IsZUFBZSxpQkFBaUIsR0FBRyxJQUNwRTtHQUNEO0VBQ0QsRUFBQztDQUNGO0NBRUQsT0FBZSxpQkFBaUJDLG9CQUE2QkMsaUJBQXdEO0FBQ3BILFNBQU8sZ0JBQUUsY0FBYztHQUN0QixPQUFPLHFCQUFxQiwyQkFBMkI7R0FDdkQsU0FBUztHQUNULFdBQVcsQ0FBQyxPQUFPLE1BQU07QUFDeEIsb0JBQWdCLE1BQU07QUFDdEIsTUFBRSxpQkFBaUI7R0FDbkI7R0FDRCxNQUFNLHFCQUFxQixNQUFNLFFBQVEsTUFBTTtHQUMvQyxNQUFNLFdBQVc7RUFDakIsRUFBQztDQUNGO0NBRUQsT0FBZSxnQkFBZ0JDLE9BQWVDLFVBQThCQyxRQUFtQ0MsV0FBNEM7RUFDMUosTUFBTSxrQkFBa0IsY0FBYyxtQkFBbUIsUUFBUSxPQUFPLFNBQVM7QUFDakYsU0FBTyxnQkFBRSxVQUFVLENBQ2xCLGdCQUFFLHNCQUFzQixDQUN2QixZQUFZLFlBQ1QsZ0JBQUUsdUJBQXVCO0dBQ3pCLE9BQU87R0FDUCxxQkFBcUIsOEJBQThCLFNBQVM7RUFDM0QsRUFBQyxHQUNGLE1BQ0gsa0JBQWtCLGdCQUFFLGFBQWEsRUFBRSxRQUFRLGdCQUFpQixFQUFDLEdBQUcsSUFDaEUsRUFBQyxFQUNGLFlBQVksV0FBVyxHQUFHLElBQzFCLEVBQUM7Q0FDRjtDQUVELE9BQWUsbUJBQW1CRCxRQUFtQ0UsVUFBa0JILFVBQTZDO0FBQ25JLE1BQUksV0FBVyxVQUFVLFlBQVksVUFDcEMsUUFBTyxjQUFjLGtCQUFrQixVQUFVLFNBQVU7U0FDakQsaUJBQWlCLFdBQVcsU0FDdEMsUUFBTztJQUVQLFFBQU87Q0FFUjtDQUVELE9BQWUsa0JBQWtCRyxVQUFrQkMsVUFBMEI7QUFDNUUsTUFBSSxhQUFhLEdBQ2hCLFFBQU87R0FDTixNQUFNO0dBQ04sTUFBTTtFQUNOO1NBQ1MsaUJBQWlCLFNBQVMsQ0FDcEMsUUFBTztHQUNOLE1BQU07R0FDTixNQUFNO0VBQ047SUFFRCxRQUFPO0dBQ04sTUFBTTtHQUNOLE1BQU07RUFDTjtDQUVGO0FBQ0QifQ==