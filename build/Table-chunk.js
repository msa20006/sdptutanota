import { assertMainOrNode } from "./Env-chunk.js";
import { mithril_default } from "./mithril-chunk.js";
import { downcast, neverNull } from "./dist2-chunk.js";
import { lang } from "./LanguageViewModel-chunk.js";
import { px, size } from "./size-chunk.js";
import { Icons } from "./Icons-chunk.js";
import { createDropdown } from "./Dialog-chunk.js";
import { progressIcon } from "./Icon-chunk.js";
import { ButtonSize, IconButton } from "./IconButton-chunk.js";
import { InfoIcon } from "./InfoIcon-chunk.js";

//#region src/common/gui/base/Table.ts
assertMainOrNode();
let ColumnWidth = function(ColumnWidth$1) {
	ColumnWidth$1["Small"] = ".column-width-small";
	ColumnWidth$1["Largest"] = ".column-width-largest";
	return ColumnWidth$1;
}({});
var Table = class Table {
	view(vnode) {
		const a = vnode.attrs;
		const loading = !a.lines;
		const alignments = a.columnAlignments || [];
		const lineAttrs = a.lines ? a.lines.map((lineAttrs$1) => this.createLine(lineAttrs$1, a.showActionButtonColumn, a.columnWidths, false, alignments, false)) : [];
		return mithril_default("", { class: a.class }, [
			mithril_default(`table.table${a.columnHeading ? ".table-header-border" : ""}`, [(a.columnHeading ? [this.createLine({
				cells: () => a.columnHeading.map((header) => {
					const text = this.isTableHeading(header) ? header.label : header;
					const info = this.isTableHeading(header) && header.helpText ? [lang.getTranslationText(header.helpText)] : undefined;
					return {
						main: lang.getTranslationText(text),
						info
					};
				}),
				actionButtonAttrs: loading ? null : a.addButtonAttrs
			}, a.showActionButtonColumn, a.columnWidths, true, alignments, a.verticalColumnHeadings ?? false, true)] : []).concat(lineAttrs)]),
			loading ? mithril_default(".flex-center.items-center.button-height", progressIcon()) : null,
			!loading && neverNull(a.lines).length === 0 ? mithril_default(".flex-center.items-center.button-height", lang.get("noEntries_msg")) : null
		]);
	}
	isTableHeading(textIdOrFunction) {
		return textIdOrFunction.label !== undefined;
	}
	createLine(lineAttrs, showActionButtonColumn, columnWidths, bold, columnAlignments, verticalText, useHelpButton = false) {
		let cells;
		if (typeof lineAttrs.cells == "function") cells = lineAttrs.cells().map((cellTextData, index) => mithril_default("td" + columnWidths[index], mithril_default("", { class: useHelpButton ? "flex items-center height-100p full-width" : "" }, mithril_default(".text-ellipsis.pr.pt-s" + (bold ? ".b" : "") + (cellTextData.click ? ".click" : "" + (cellTextData.mainStyle ? cellTextData.mainStyle : "")) + (columnAlignments[index] ? ".right" : ""), {
			title: cellTextData.main,
			onclick: cellTextData.click ? (event) => {
				const dom = downcast(event.target);
				cellTextData.click(event, dom);
			} : undefined
		}, verticalText ? mithril_default("span.vertical-text", cellTextData.main) : cellTextData.main), Table.renderHelpText(cellTextData, useHelpButton))));
else cells = lineAttrs.cells.map((text, index) => mithril_default("td.text-ellipsis.pr.pt-s.pb-s." + columnWidths[index] + (bold ? ".b" : "") + (columnAlignments[index] ? ".right" : ""), { title: text }, verticalText ? mithril_default("span.vertical-text", text) : text));
		if (showActionButtonColumn) cells.push(mithril_default("td", { style: { width: px(size.button_height_compact) } }, lineAttrs.actionButtonAttrs ? mithril_default(IconButton, lineAttrs.actionButtonAttrs) : []));
		return mithril_default("tr.selectable", cells);
	}
	static renderHelpText(cellTextData, useHelpButton) {
		const info = cellTextData.info;
		if (info == null) return undefined;
		if (useHelpButton) return mithril_default(InfoIcon, { text: info.join("\n") });
else return mithril_default(".small.text-ellipsis.pr" + (cellTextData.click ? ".click" : ""), { onclick: cellTextData.click ? (event) => {
			const dom = downcast(event.target);
			cellTextData.click(event, dom);
		} : undefined }, info.map((line) => mithril_default("", line)));
	}
};
function createRowActions(instance, currentElement, indexOfElement, prefixActions = []) {
	const elements = instance.getArray();
	const makeButtonAttrs = () => [
		...prefixActions,
		indexOfElement > 1 ? {
			label: "moveToTop_action",
			click: () => {
				elements.splice(indexOfElement, 1);
				elements.unshift(currentElement);
				instance.updateInstance();
			}
		} : null,
		indexOfElement > 0 ? {
			label: "moveUp_action",
			click: () => {
				let prev = elements[indexOfElement - 1];
				elements[indexOfElement - 1] = currentElement;
				elements[indexOfElement] = prev;
				instance.updateInstance();
			}
		} : null,
		indexOfElement < instance.getArray().length - 1 ? {
			label: "moveDown_action",
			click: () => {
				let next = elements[indexOfElement + 1];
				elements[indexOfElement + 1] = currentElement;
				elements[indexOfElement] = next;
				instance.updateInstance();
			}
		} : null,
		indexOfElement < instance.getArray().length - 2 ? {
			label: "moveToBottom_action",
			click: () => {
				elements.splice(indexOfElement, 1);
				elements.push(currentElement);
				instance.updateInstance();
			}
		} : null,
		{
			label: "delete_action",
			click: () => {
				elements.splice(indexOfElement, 1);
				instance.updateInstance();
			}
		}
	];
	return {
		title: "edit_action",
		click: createDropdown({
			lazyButtons: makeButtonAttrs,
			width: 260
		}),
		icon: Icons.More,
		size: ButtonSize.Compact
	};
}

//#endregion
export { ColumnWidth, Table, createRowActions };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGFibGUtY2h1bmsuanMiLCJuYW1lcyI6WyJ2bm9kZTogVm5vZGU8VGFibGVBdHRycz4iLCJsaW5lQXR0cnMiLCJ0ZXh0SWRPckZ1bmN0aW9uOiBUYWJsZUhlYWRpbmcgfCBNYXliZVRyYW5zbGF0aW9uIiwibGluZUF0dHJzOiBUYWJsZUxpbmVBdHRycyIsInNob3dBY3Rpb25CdXR0b25Db2x1bW46IGJvb2xlYW4iLCJjb2x1bW5XaWR0aHM6IFJlYWRvbmx5QXJyYXk8Q29sdW1uV2lkdGg+IiwiYm9sZDogYm9vbGVhbiIsImNvbHVtbkFsaWdubWVudHM6IEFycmF5PGJvb2xlYW4+IiwidmVydGljYWxUZXh0OiBib29sZWFuIiwidXNlSGVscEJ1dHRvbjogYm9vbGVhbiIsImV2ZW50OiBNb3VzZUV2ZW50IiwiY2VsbFRleHREYXRhOiBDZWxsVGV4dERhdGEiLCJpbnN0YW5jZTogVXBkYXRlYWJsZUluc3RhbmNlV2l0aEFycmF5PFQ+IiwiY3VycmVudEVsZW1lbnQ6IFQiLCJpbmRleE9mRWxlbWVudDogbnVtYmVyIiwicHJlZml4QWN0aW9uczogUmVhZG9ubHlBcnJheTxEcm9wZG93bkJ1dHRvbkF0dHJzPiIsIm1ha2VCdXR0b25BdHRyczogKCkgPT4gUmVhZG9ubHlBcnJheTxEcm9wZG93bkJ1dHRvbkF0dHJzIHwgbnVsbD4iXSwic291cmNlcyI6WyIuLi9zcmMvY29tbW9uL2d1aS9iYXNlL1RhYmxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtLCB7IENoaWxkcmVuLCBDb21wb25lbnQsIFZub2RlIH0gZnJvbSBcIm1pdGhyaWxcIlxuaW1wb3J0IHsgbGFuZywgTWF5YmVUcmFuc2xhdGlvbiB9IGZyb20gXCIuLi8uLi9taXNjL0xhbmd1YWdlVmlld01vZGVsXCJcbmltcG9ydCB7IHByb2dyZXNzSWNvbiB9IGZyb20gXCIuL0ljb25cIlxuaW1wb3J0IHsgZG93bmNhc3QsIG5ldmVyTnVsbCB9IGZyb20gXCJAdHV0YW8vdHV0YW5vdGEtdXRpbHNcIlxuaW1wb3J0IHsgY3JlYXRlRHJvcGRvd24sIERyb3Bkb3duQnV0dG9uQXR0cnMgfSBmcm9tIFwiLi9Ecm9wZG93bi5qc1wiXG5pbXBvcnQgeyBJY29ucyB9IGZyb20gXCIuL2ljb25zL0ljb25zXCJcbmltcG9ydCB0eXBlIHsgQ2xpY2tIYW5kbGVyIH0gZnJvbSBcIi4vR3VpVXRpbHNcIlxuaW1wb3J0IHsgYXNzZXJ0TWFpbk9yTm9kZSB9IGZyb20gXCIuLi8uLi9hcGkvY29tbW9uL0VudlwiXG5pbXBvcnQgeyBJY29uQnV0dG9uLCBJY29uQnV0dG9uQXR0cnMgfSBmcm9tIFwiLi9JY29uQnV0dG9uLmpzXCJcbmltcG9ydCB7IEJ1dHRvblNpemUgfSBmcm9tIFwiLi9CdXR0b25TaXplLmpzXCJcbmltcG9ydCB7IHB4LCBzaXplIH0gZnJvbSBcIi4uL3NpemUuanNcIlxuaW1wb3J0IHsgSW5mb0ljb24gfSBmcm9tIFwiLi9JbmZvSWNvbi5qc1wiXG5cbmFzc2VydE1haW5Pck5vZGUoKVxuXG5leHBvcnQgY29uc3QgZW51bSBDb2x1bW5XaWR0aCB7XG5cdC8vIHRoZSBjb2x1bW4gaGFzIGEgZml4ZWQgc21hbGwgd2lkdGhcblx0U21hbGwgPSBcIi5jb2x1bW4td2lkdGgtc21hbGxcIixcblx0Ly8gYWxsIExhcmdlc3QgY29sdW1ucyBlcXVhbGx5IHNoYXJlIHRoZSByZXN0IG9mIHRoZSBhdmFpbGFibGUgd2lkdGhcblx0TGFyZ2VzdCA9IFwiLmNvbHVtbi13aWR0aC1sYXJnZXN0XCIsXG59XG5cbmV4cG9ydCB0eXBlIFRhYmxlSGVhZGluZyA9IHtcblx0bGFiZWw6IE1heWJlVHJhbnNsYXRpb25cblx0aGVscFRleHQ/OiBNYXliZVRyYW5zbGF0aW9uXG59XG5cbi8qKlxuICogQHBhcmFtIGNvbHVtbkhlYWRpbmcgVGhlIHRleHRzIHRoYXQgc2hhbGwgYXBwZWFyIGFzIGhlYWRlcnMgb2YgZWFjaCBjb2x1bW4uIEVpdGhlciBhIHRleHRJZCBvciBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIHRyYW5zbGF0aW9uXG4gKiBAcGFyYW0gY29sdW1uV2lkdGhzIFRoZSBzaXplcyBvZiB0aGUgY29sdW1ucyBpbiBweC4gSWYgMCBpcyBzcGVjaWZpZWQgdGhlIGNvbHVtbiBzaGFyZXMgdGhlIHJlbWFpbmluZyBzcGFjZSB3aXRoIGFsbCBvdGhlciAnMCcgd2lkdGggY29sdW1ucy5cbiAqIEBwYXJhbSBjb2x1bW5BbGlnbm1lbnRzIHRydWUgZm9yIGEgY29sdW1uIHRoYXQncyBhbGlnbmVkIG9wcG9zaXRlIHRoZSBkZWZhdWx0LCBmYWxzZSBmb3Igb25lIHdpdGggdGhlIGRlZmF1bHQgYWxpZ25tZW50LlxuICogQHBhcmFtIHNob3dBY3Rpb25CdXR0b25Db2x1bW4gVHJ1ZSBpZiBhZGRCdXR0b24gaXMgc3BlY2lmaWVkIG9yIHRoZSB0YWJsZSBsaW5lcyBtYXkgY29udGFpbiBhY3Rpb24gYnV0dG9ucy5cbiAqIEBwYXJhbSBhZGRCdXR0b24gSWYgc2V0LCB0aGlzIGJ1dHRvbiBhcHBlYXJzIGJlc2lkZSB0aGUgZXhwYW5kZXIgYnV0dG9uLlxuICogQHBhcmFtIGxpbmVzIHRoZSBsaW5lcyBvZiB0aGUgdGFibGVcbiAqL1xuZXhwb3J0IHR5cGUgVGFibGVBdHRycyA9IHtcblx0Y29sdW1uSGVhZGluZz86IEFycmF5PFRhYmxlSGVhZGluZyB8IE1heWJlVHJhbnNsYXRpb24+XG5cdGNvbHVtbldpZHRoczogUmVhZG9ubHlBcnJheTxDb2x1bW5XaWR0aD5cblx0Y29sdW1uQWxpZ25tZW50cz86IEFycmF5PGJvb2xlYW4+XG5cdHZlcnRpY2FsQ29sdW1uSGVhZGluZ3M/OiBib29sZWFuXG5cdHNob3dBY3Rpb25CdXR0b25Db2x1bW46IGJvb2xlYW5cblx0YWRkQnV0dG9uQXR0cnM/OiBJY29uQnV0dG9uQXR0cnMgfCBudWxsXG5cdGxpbmVzOiBSZWFkb25seUFycmF5PFRhYmxlTGluZUF0dHJzPiB8IG51bGxcblx0Y2xhc3M/OiBzdHJpbmdcbn1cbmV4cG9ydCB0eXBlIENlbGxUZXh0RGF0YSA9IHtcblx0bWFpbjogc3RyaW5nXG5cdGluZm8/OiBzdHJpbmdbXVxuXHRjbGljaz86IENsaWNrSGFuZGxlclxuXHRtYWluU3R5bGU/OiBzdHJpbmdcbn1cbmV4cG9ydCB0eXBlIFRhYmxlTGluZUF0dHJzID0ge1xuXHRjZWxsczogc3RyaW5nW10gfCAoKCkgPT4gQ2VsbFRleHREYXRhW10pXG5cdGFjdGlvbkJ1dHRvbkF0dHJzPzogSWNvbkJ1dHRvbkF0dHJzIHwgbnVsbFxufVxuXG4vKipcbiAqIFNob3dzIGEgdGFibGUgb2YgVGFibGVMaW5lIGVudHJpZXMuIFRoZSBsYXN0IGNvbHVtbiBvZiB0aGUgdGFibGUgbWF5IHNob3cgYWN0aW9uIGJ1dHRvbnMgZm9yIGVhY2ggVGFibGVMaW5lIGFuZC9vciBhbiBhZGQgYnV0dG9uLlxuICogVGhlIHRhYmxlIHNob3dzIGEgbG9hZGluZyBzcGlubmVyIHVudGlsIHVwZGF0ZUVudHJpZXMoKSBpcyBjYWxsZWQgdGhlIGZpcnN0IHRpbWUuXG4gKi9cbmV4cG9ydCBjbGFzcyBUYWJsZSBpbXBsZW1lbnRzIENvbXBvbmVudDxUYWJsZUF0dHJzPiB7XG5cdHZpZXcodm5vZGU6IFZub2RlPFRhYmxlQXR0cnM+KTogQ2hpbGRyZW4ge1xuXHRcdGNvbnN0IGEgPSB2bm9kZS5hdHRyc1xuXHRcdGNvbnN0IGxvYWRpbmcgPSAhYS5saW5lc1xuXHRcdGNvbnN0IGFsaWdubWVudHMgPSBhLmNvbHVtbkFsaWdubWVudHMgfHwgW11cblx0XHRjb25zdCBsaW5lQXR0cnMgPSBhLmxpbmVzXG5cdFx0XHQ/IGEubGluZXMubWFwKChsaW5lQXR0cnMpID0+IHRoaXMuY3JlYXRlTGluZShsaW5lQXR0cnMsIGEuc2hvd0FjdGlvbkJ1dHRvbkNvbHVtbiwgYS5jb2x1bW5XaWR0aHMsIGZhbHNlLCBhbGlnbm1lbnRzLCBmYWxzZSkpXG5cdFx0XHQ6IFtdXG5cblx0XHRyZXR1cm4gbShcIlwiLCB7IGNsYXNzOiBhLmNsYXNzIH0sIFtcblx0XHRcdG0oYHRhYmxlLnRhYmxlJHthLmNvbHVtbkhlYWRpbmcgPyBcIi50YWJsZS1oZWFkZXItYm9yZGVyXCIgOiBcIlwifWAsIFtcblx0XHRcdFx0KGEuY29sdW1uSGVhZGluZ1xuXHRcdFx0XHRcdD8gW1xuXHRcdFx0XHRcdFx0XHR0aGlzLmNyZWF0ZUxpbmUoXG5cdFx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdFx0Y2VsbHM6ICgpID0+XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGEuY29sdW1uSGVhZGluZyEubWFwKChoZWFkZXIpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCB0ZXh0ID0gdGhpcy5pc1RhYmxlSGVhZGluZyhoZWFkZXIpID8gaGVhZGVyLmxhYmVsIDogaGVhZGVyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgaW5mbyA9IHRoaXMuaXNUYWJsZUhlYWRpbmcoaGVhZGVyKSAmJiBoZWFkZXIuaGVscFRleHQgPyBbbGFuZy5nZXRUcmFuc2xhdGlvblRleHQoaGVhZGVyLmhlbHBUZXh0KV0gOiB1bmRlZmluZWRcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWFpbjogbGFuZy5nZXRUcmFuc2xhdGlvblRleHQodGV4dCksXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpbmZvOiBpbmZvLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gc2F0aXNmaWVzIENlbGxUZXh0RGF0YVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9KSxcblx0XHRcdFx0XHRcdFx0XHRcdGFjdGlvbkJ1dHRvbkF0dHJzOiBsb2FkaW5nID8gbnVsbCA6IGEuYWRkQnV0dG9uQXR0cnMsXG5cdFx0XHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdFx0XHRhLnNob3dBY3Rpb25CdXR0b25Db2x1bW4sXG5cdFx0XHRcdFx0XHRcdFx0YS5jb2x1bW5XaWR0aHMsXG5cdFx0XHRcdFx0XHRcdFx0dHJ1ZSxcblx0XHRcdFx0XHRcdFx0XHRhbGlnbm1lbnRzLFxuXHRcdFx0XHRcdFx0XHRcdGEudmVydGljYWxDb2x1bW5IZWFkaW5ncyA/PyBmYWxzZSxcblx0XHRcdFx0XHRcdFx0XHR0cnVlLFxuXHRcdFx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdCAgXVxuXHRcdFx0XHRcdDogW11cblx0XHRcdFx0KS5jb25jYXQobGluZUF0dHJzKSxcblx0XHRcdF0pLFxuXHRcdFx0bG9hZGluZyA/IG0oXCIuZmxleC1jZW50ZXIuaXRlbXMtY2VudGVyLmJ1dHRvbi1oZWlnaHRcIiwgcHJvZ3Jlc3NJY29uKCkpIDogbnVsbCxcblx0XHRcdCFsb2FkaW5nICYmIG5ldmVyTnVsbChhLmxpbmVzKS5sZW5ndGggPT09IDAgPyBtKFwiLmZsZXgtY2VudGVyLml0ZW1zLWNlbnRlci5idXR0b24taGVpZ2h0XCIsIGxhbmcuZ2V0KFwibm9FbnRyaWVzX21zZ1wiKSkgOiBudWxsLFxuXHRcdF0pXG5cdH1cblxuXHRwcml2YXRlIGlzVGFibGVIZWFkaW5nKHRleHRJZE9yRnVuY3Rpb246IFRhYmxlSGVhZGluZyB8IE1heWJlVHJhbnNsYXRpb24pOiB0ZXh0SWRPckZ1bmN0aW9uIGlzIFRhYmxlSGVhZGluZyB7XG5cdFx0cmV0dXJuICh0ZXh0SWRPckZ1bmN0aW9uIGFzIFRhYmxlSGVhZGluZykubGFiZWwgIT09IHVuZGVmaW5lZFxuXHR9XG5cblx0cHJpdmF0ZSBjcmVhdGVMaW5lKFxuXHRcdGxpbmVBdHRyczogVGFibGVMaW5lQXR0cnMsXG5cdFx0c2hvd0FjdGlvbkJ1dHRvbkNvbHVtbjogYm9vbGVhbixcblx0XHRjb2x1bW5XaWR0aHM6IFJlYWRvbmx5QXJyYXk8Q29sdW1uV2lkdGg+LFxuXHRcdGJvbGQ6IGJvb2xlYW4sXG5cdFx0Y29sdW1uQWxpZ25tZW50czogQXJyYXk8Ym9vbGVhbj4sXG5cdFx0dmVydGljYWxUZXh0OiBib29sZWFuLFxuXHRcdHVzZUhlbHBCdXR0b246IGJvb2xlYW4gPSBmYWxzZSxcblx0KTogQ2hpbGRyZW4ge1xuXHRcdGxldCBjZWxsc1xuXG5cdFx0aWYgKHR5cGVvZiBsaW5lQXR0cnMuY2VsbHMgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRjZWxscyA9IGxpbmVBdHRycy5jZWxscygpLm1hcCgoY2VsbFRleHREYXRhLCBpbmRleCkgPT5cblx0XHRcdFx0bShcblx0XHRcdFx0XHRcInRkXCIgKyBjb2x1bW5XaWR0aHNbaW5kZXhdLFxuXHRcdFx0XHRcdG0oXG5cdFx0XHRcdFx0XHRcIlwiLFxuXHRcdFx0XHRcdFx0eyBjbGFzczogdXNlSGVscEJ1dHRvbiA/IFwiZmxleCBpdGVtcy1jZW50ZXIgaGVpZ2h0LTEwMHAgZnVsbC13aWR0aFwiIDogXCJcIiB9LFxuXHRcdFx0XHRcdFx0bShcblx0XHRcdFx0XHRcdFx0XCIudGV4dC1lbGxpcHNpcy5wci5wdC1zXCIgK1xuXHRcdFx0XHRcdFx0XHRcdChib2xkID8gXCIuYlwiIDogXCJcIikgK1xuXHRcdFx0XHRcdFx0XHRcdChjZWxsVGV4dERhdGEuY2xpY2sgPyBcIi5jbGlja1wiIDogXCJcIiArIChjZWxsVGV4dERhdGEubWFpblN0eWxlID8gY2VsbFRleHREYXRhLm1haW5TdHlsZSA6IFwiXCIpKSArXG5cdFx0XHRcdFx0XHRcdFx0KGNvbHVtbkFsaWdubWVudHNbaW5kZXhdID8gXCIucmlnaHRcIiA6IFwiXCIpLFxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0dGl0bGU6IGNlbGxUZXh0RGF0YS5tYWluLFxuXHRcdFx0XHRcdFx0XHRcdC8vIHNob3cgdGhlIHRleHQgYXMgdG9vbHRpcCwgc28gZWxsaXBzZWQgbGluZXMgY2FuIGJlIHNob3duXG5cdFx0XHRcdFx0XHRcdFx0b25jbGljazogY2VsbFRleHREYXRhLmNsaWNrXG5cdFx0XHRcdFx0XHRcdFx0XHQ/IChldmVudDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGRvbSA9IGRvd25jYXN0KGV2ZW50LnRhcmdldClcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjZWxsVGV4dERhdGEuY2xpY2shKGV2ZW50LCBkb20pXG5cdFx0XHRcdFx0XHRcdFx0XHQgIH1cblx0XHRcdFx0XHRcdFx0XHRcdDogdW5kZWZpbmVkLFxuXHRcdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0XHR2ZXJ0aWNhbFRleHQgPyBtKFwic3Bhbi52ZXJ0aWNhbC10ZXh0XCIsIGNlbGxUZXh0RGF0YS5tYWluKSA6IGNlbGxUZXh0RGF0YS5tYWluLFxuXHRcdFx0XHRcdFx0KSxcblx0XHRcdFx0XHRcdFRhYmxlLnJlbmRlckhlbHBUZXh0KGNlbGxUZXh0RGF0YSwgdXNlSGVscEJ1dHRvbiksXG5cdFx0XHRcdFx0KSxcblx0XHRcdFx0KSxcblx0XHRcdClcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2VsbHMgPSBsaW5lQXR0cnMuY2VsbHMubWFwKCh0ZXh0LCBpbmRleCkgPT5cblx0XHRcdFx0bShcblx0XHRcdFx0XHRcInRkLnRleHQtZWxsaXBzaXMucHIucHQtcy5wYi1zLlwiICsgY29sdW1uV2lkdGhzW2luZGV4XSArIChib2xkID8gXCIuYlwiIDogXCJcIikgKyAoY29sdW1uQWxpZ25tZW50c1tpbmRleF0gPyBcIi5yaWdodFwiIDogXCJcIiksXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0dGl0bGU6IHRleHQsIC8vIHNob3cgdGhlIHRleHQgYXMgdG9vbHRpcCwgc28gZWxsaXBzZWQgbGluZXMgY2FuIGJlIHNob3duXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHR2ZXJ0aWNhbFRleHQgPyBtKFwic3Bhbi52ZXJ0aWNhbC10ZXh0XCIsIHRleHQpIDogdGV4dCxcblx0XHRcdFx0KSxcblx0XHRcdClcblx0XHR9XG5cblx0XHRpZiAoc2hvd0FjdGlvbkJ1dHRvbkNvbHVtbikge1xuXHRcdFx0Y2VsbHMucHVzaChcblx0XHRcdFx0bShcblx0XHRcdFx0XHRcInRkXCIsXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0c3R5bGU6IHtcblx0XHRcdFx0XHRcdFx0d2lkdGg6IHB4KHNpemUuYnV0dG9uX2hlaWdodF9jb21wYWN0KSxcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRsaW5lQXR0cnMuYWN0aW9uQnV0dG9uQXR0cnMgPyBtKEljb25CdXR0b24sIGxpbmVBdHRycy5hY3Rpb25CdXR0b25BdHRycykgOiBbXSxcblx0XHRcdFx0KSxcblx0XHRcdClcblx0XHR9XG5cblx0XHRyZXR1cm4gbShcInRyLnNlbGVjdGFibGVcIiwgY2VsbHMpXG5cdH1cblxuXHRwcml2YXRlIHN0YXRpYyByZW5kZXJIZWxwVGV4dChjZWxsVGV4dERhdGE6IENlbGxUZXh0RGF0YSwgdXNlSGVscEJ1dHRvbjogYm9vbGVhbik6IENoaWxkcmVuIHtcblx0XHRjb25zdCBpbmZvID0gY2VsbFRleHREYXRhLmluZm9cblx0XHRpZiAoaW5mbyA9PSBudWxsKSB7XG5cdFx0XHRyZXR1cm4gdW5kZWZpbmVkXG5cdFx0fVxuXG5cdFx0aWYgKHVzZUhlbHBCdXR0b24pIHtcblx0XHRcdHJldHVybiBtKEluZm9JY29uLCB7IHRleHQ6IGluZm8uam9pbihcIlxcblwiKSB9KVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gbShcblx0XHRcdFx0XCIuc21hbGwudGV4dC1lbGxpcHNpcy5wclwiICsgKGNlbGxUZXh0RGF0YS5jbGljayA/IFwiLmNsaWNrXCIgOiBcIlwiKSxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG9uY2xpY2s6IGNlbGxUZXh0RGF0YS5jbGlja1xuXHRcdFx0XHRcdFx0PyAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBkb20gPSBkb3duY2FzdChldmVudC50YXJnZXQpXG5cdFx0XHRcdFx0XHRcdFx0Y2VsbFRleHREYXRhLmNsaWNrIShldmVudCwgZG9tKVxuXHRcdFx0XHRcdFx0ICB9XG5cdFx0XHRcdFx0XHQ6IHVuZGVmaW5lZCxcblx0XHRcdFx0fSxcblx0XHRcdFx0aW5mby5tYXAoKGxpbmUpID0+IG0oXCJcIiwgbGluZSkpLFxuXHRcdFx0KVxuXHRcdH1cblx0fVxufVxuXG5pbnRlcmZhY2UgVXBkYXRlYWJsZUluc3RhbmNlV2l0aEFycmF5PFQ+IHtcblx0Z2V0QXJyYXk6ICgpID0+IEFycmF5PFQ+XG5cdHVwZGF0ZUluc3RhbmNlOiAoKSA9PiBQcm9taXNlPHZvaWQ+XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSb3dBY3Rpb25zPFQ+KFxuXHRpbnN0YW5jZTogVXBkYXRlYWJsZUluc3RhbmNlV2l0aEFycmF5PFQ+LFxuXHRjdXJyZW50RWxlbWVudDogVCxcblx0aW5kZXhPZkVsZW1lbnQ6IG51bWJlcixcblx0cHJlZml4QWN0aW9uczogUmVhZG9ubHlBcnJheTxEcm9wZG93bkJ1dHRvbkF0dHJzPiA9IFtdLFxuKTogSWNvbkJ1dHRvbkF0dHJzIHtcblx0Y29uc3QgZWxlbWVudHMgPSBpbnN0YW5jZS5nZXRBcnJheSgpXG5cdGNvbnN0IG1ha2VCdXR0b25BdHRyczogKCkgPT4gUmVhZG9ubHlBcnJheTxEcm9wZG93bkJ1dHRvbkF0dHJzIHwgbnVsbD4gPSAoKSA9PiBbXG5cdFx0Li4ucHJlZml4QWN0aW9ucyxcblx0XHRpbmRleE9mRWxlbWVudCA+IDFcblx0XHRcdD8ge1xuXHRcdFx0XHRcdGxhYmVsOiBcIm1vdmVUb1RvcF9hY3Rpb25cIixcblx0XHRcdFx0XHRjbGljazogKCkgPT4ge1xuXHRcdFx0XHRcdFx0ZWxlbWVudHMuc3BsaWNlKGluZGV4T2ZFbGVtZW50LCAxKVxuXHRcdFx0XHRcdFx0ZWxlbWVudHMudW5zaGlmdChjdXJyZW50RWxlbWVudClcblx0XHRcdFx0XHRcdGluc3RhbmNlLnVwZGF0ZUluc3RhbmNlKClcblx0XHRcdFx0XHR9LFxuXHRcdFx0ICB9XG5cdFx0XHQ6IG51bGwsXG5cdFx0aW5kZXhPZkVsZW1lbnQgPiAwXG5cdFx0XHQ/IHtcblx0XHRcdFx0XHRsYWJlbDogXCJtb3ZlVXBfYWN0aW9uXCIsXG5cdFx0XHRcdFx0Y2xpY2s6ICgpID0+IHtcblx0XHRcdFx0XHRcdGxldCBwcmV2ID0gZWxlbWVudHNbaW5kZXhPZkVsZW1lbnQgLSAxXVxuXHRcdFx0XHRcdFx0ZWxlbWVudHNbaW5kZXhPZkVsZW1lbnQgLSAxXSA9IGN1cnJlbnRFbGVtZW50XG5cdFx0XHRcdFx0XHRlbGVtZW50c1tpbmRleE9mRWxlbWVudF0gPSBwcmV2XG5cdFx0XHRcdFx0XHRpbnN0YW5jZS51cGRhdGVJbnN0YW5jZSgpXG5cdFx0XHRcdFx0fSxcblx0XHRcdCAgfVxuXHRcdFx0OiBudWxsLFxuXHRcdGluZGV4T2ZFbGVtZW50IDwgaW5zdGFuY2UuZ2V0QXJyYXkoKS5sZW5ndGggLSAxXG5cdFx0XHQ/IHtcblx0XHRcdFx0XHRsYWJlbDogXCJtb3ZlRG93bl9hY3Rpb25cIixcblx0XHRcdFx0XHRjbGljazogKCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IG5leHQgPSBlbGVtZW50c1tpbmRleE9mRWxlbWVudCArIDFdXG5cdFx0XHRcdFx0XHRlbGVtZW50c1tpbmRleE9mRWxlbWVudCArIDFdID0gY3VycmVudEVsZW1lbnRcblx0XHRcdFx0XHRcdGVsZW1lbnRzW2luZGV4T2ZFbGVtZW50XSA9IG5leHRcblx0XHRcdFx0XHRcdGluc3RhbmNlLnVwZGF0ZUluc3RhbmNlKClcblx0XHRcdFx0XHR9LFxuXHRcdFx0ICB9XG5cdFx0XHQ6IG51bGwsXG5cdFx0aW5kZXhPZkVsZW1lbnQgPCBpbnN0YW5jZS5nZXRBcnJheSgpLmxlbmd0aCAtIDJcblx0XHRcdD8ge1xuXHRcdFx0XHRcdGxhYmVsOiBcIm1vdmVUb0JvdHRvbV9hY3Rpb25cIixcblx0XHRcdFx0XHRjbGljazogKCkgPT4ge1xuXHRcdFx0XHRcdFx0ZWxlbWVudHMuc3BsaWNlKGluZGV4T2ZFbGVtZW50LCAxKVxuXHRcdFx0XHRcdFx0ZWxlbWVudHMucHVzaChjdXJyZW50RWxlbWVudClcblx0XHRcdFx0XHRcdGluc3RhbmNlLnVwZGF0ZUluc3RhbmNlKClcblx0XHRcdFx0XHR9LFxuXHRcdFx0ICB9XG5cdFx0XHQ6IG51bGwsXG5cdFx0e1xuXHRcdFx0bGFiZWw6IFwiZGVsZXRlX2FjdGlvblwiLFxuXHRcdFx0Y2xpY2s6ICgpID0+IHtcblx0XHRcdFx0ZWxlbWVudHMuc3BsaWNlKGluZGV4T2ZFbGVtZW50LCAxKVxuXHRcdFx0XHRpbnN0YW5jZS51cGRhdGVJbnN0YW5jZSgpXG5cdFx0XHR9LFxuXHRcdH0sXG5cdF1cblx0cmV0dXJuIHtcblx0XHR0aXRsZTogXCJlZGl0X2FjdGlvblwiLFxuXHRcdGNsaWNrOiBjcmVhdGVEcm9wZG93bih7IGxhenlCdXR0b25zOiBtYWtlQnV0dG9uQXR0cnMsIHdpZHRoOiAyNjAgfSksXG5cdFx0aWNvbjogSWNvbnMuTW9yZSxcblx0XHRzaXplOiBCdXR0b25TaXplLkNvbXBhY3QsXG5cdH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBYUEsa0JBQWtCO0lBRUEsc0NBQVg7QUFFTjtBQUVBOztBQUNBO0lBd0NZLFFBQU4sTUFBTSxNQUF1QztDQUNuRCxLQUFLQSxPQUFvQztFQUN4QyxNQUFNLElBQUksTUFBTTtFQUNoQixNQUFNLFdBQVcsRUFBRTtFQUNuQixNQUFNLGFBQWEsRUFBRSxvQkFBb0IsQ0FBRTtFQUMzQyxNQUFNLFlBQVksRUFBRSxRQUNqQixFQUFFLE1BQU0sSUFBSSxDQUFDQyxnQkFBYyxLQUFLLFdBQVdBLGFBQVcsRUFBRSx3QkFBd0IsRUFBRSxjQUFjLE9BQU8sWUFBWSxNQUFNLENBQUMsR0FDMUgsQ0FBRTtBQUVMLFNBQU8sZ0JBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxNQUFPLEdBQUU7R0FDaEMsaUJBQUcsYUFBYSxFQUFFLGdCQUFnQix5QkFBeUIsR0FBRyxHQUFHLENBQ2hFLENBQUMsRUFBRSxnQkFDQSxDQUNBLEtBQUssV0FDSjtJQUNDLE9BQU8sTUFDTixFQUFFLGNBQWUsSUFBSSxDQUFDLFdBQVc7S0FDaEMsTUFBTSxPQUFPLEtBQUssZUFBZSxPQUFPLEdBQUcsT0FBTyxRQUFRO0tBQzFELE1BQU0sT0FBTyxLQUFLLGVBQWUsT0FBTyxJQUFJLE9BQU8sV0FBVyxDQUFDLEtBQUssbUJBQW1CLE9BQU8sU0FBUyxBQUFDLElBQUc7QUFDM0csWUFBTztNQUNOLE1BQU0sS0FBSyxtQkFBbUIsS0FBSztNQUM3QjtL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